{"version":3,"file":"index.umd.js","sources":["../node_modules/@comfyorg/litegraph/dist/litegraph.es.js","../src/litegraph/registerNodes.ts","../src/operators.ts","../src/FiftyComfyView.tsx","../src/index.ts"],"sourcesContent":["class CustomEventTarget extends EventTarget {\n  dispatch(type, detail) {\n    const event = new CustomEvent(type, { detail, cancelable: true });\n    return super.dispatchEvent(event);\n  }\n  addEventListener(type, listener, options) {\n    super.addEventListener(type, listener, options);\n  }\n  removeEventListener(type, listener, options) {\n    super.removeEventListener(type, listener, options);\n  }\n  /** @deprecated Use {@link dispatch}. */\n  dispatchEvent(event) {\n    return super.dispatchEvent(event);\n  }\n}\nconst SUBGRAPH_INPUT_ID = -10;\nconst SUBGRAPH_OUTPUT_ID = -20;\nconst constants = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({\n  __proto__: null,\n  SUBGRAPH_INPUT_ID,\n  SUBGRAPH_OUTPUT_ID\n}, Symbol.toStringTag, { value: \"Module\" }));\nconst zeroUuid = \"00000000-0000-0000-0000-000000000000\";\nconst randomStorage = new Uint32Array(31);\nfunction createUuidv4() {\n  if (typeof crypto?.randomUUID === \"function\") return crypto.randomUUID();\n  if (typeof crypto?.getRandomValues === \"function\") {\n    const random = crypto.getRandomValues(randomStorage);\n    let i = 0;\n    return \"10000000-1000-4000-8000-100000000000\".replaceAll(/[018]/g, (a) => (Number(a) ^ random[i++] * 3725290298461914e-24 >> Number(a) * 0.25).toString(16));\n  }\n  return \"10000000-1000-4000-8000-100000000000\".replaceAll(/[018]/g, (a) => (Number(a) ^ Math.random() * 16 >> Number(a) * 0.25).toString(16));\n}\nclass LLink {\n  static _drawDebug = false;\n  /** Link ID */\n  id;\n  parentId;\n  type;\n  /** Output node ID */\n  origin_id;\n  /** Output slot index */\n  origin_slot;\n  /** Input node ID */\n  target_id;\n  /** Input slot index */\n  target_slot;\n  data;\n  _data;\n  /** Centre point of the link, calculated during render only - can be inaccurate */\n  _pos;\n  /** @todo Clean up - never implemented in comfy. */\n  _last_time;\n  /** The last canvas 2D path that was used to render this link */\n  path;\n  /** @inheritdoc */\n  _centreAngle;\n  /** @inheritdoc */\n  _dragging;\n  #color;\n  /** Custom colour for this link only */\n  get color() {\n    return this.#color;\n  }\n  set color(value) {\n    this.#color = value === \"\" ? null : value;\n  }\n  get isFloatingOutput() {\n    return this.origin_id === -1 && this.origin_slot === -1;\n  }\n  get isFloatingInput() {\n    return this.target_id === -1 && this.target_slot === -1;\n  }\n  get isFloating() {\n    return this.isFloatingOutput || this.isFloatingInput;\n  }\n  /** `true` if this link is connected to a subgraph input node (the actual origin is in a different graph). */\n  get originIsIoNode() {\n    return this.origin_id === SUBGRAPH_INPUT_ID;\n  }\n  /** `true` if this link is connected to a subgraph output node (the actual target is in a different graph). */\n  get targetIsIoNode() {\n    return this.target_id === SUBGRAPH_OUTPUT_ID;\n  }\n  constructor(id, type, origin_id, origin_slot, target_id, target_slot, parentId) {\n    this.id = id;\n    this.type = type;\n    this.origin_id = origin_id;\n    this.origin_slot = origin_slot;\n    this.target_id = target_id;\n    this.target_slot = target_slot;\n    this.parentId = parentId;\n    this._data = null;\n    this._pos = new Float32Array(2);\n  }\n  /** @deprecated Use {@link LLink.create} */\n  static createFromArray(data) {\n    return new LLink(data[0], data[5], data[1], data[2], data[3], data[4]);\n  }\n  /**\n   * LLink static factory: creates a new LLink from the provided data.\n   * @param data Serialised LLink data to create the link from\n   * @returns A new LLink\n   */\n  static create(data) {\n    return new LLink(\n      data.id,\n      data.type,\n      data.origin_id,\n      data.origin_slot,\n      data.target_id,\n      data.target_slot,\n      data.parentId\n    );\n  }\n  /**\n   * Gets all reroutes from the output slot to this segment.  If this segment is a reroute, it will not be included.\n   * @returns An ordered array of all reroutes from the node output to\n   * this reroute or the reroute before it.  Otherwise, an empty array.\n   */\n  static getReroutes(network, linkSegment) {\n    if (!linkSegment.parentId) return [];\n    return network.reroutes.get(linkSegment.parentId)?.getReroutes() ?? [];\n  }\n  static getFirstReroute(network, linkSegment) {\n    return LLink.getReroutes(network, linkSegment).at(0);\n  }\n  /**\n   * Finds the reroute in the chain after the provided reroute ID.\n   * @param network The network this link belongs to\n   * @param linkSegment The starting point of the search (input side).\n   * Typically the LLink object itself, but can be any link segment.\n   * @param rerouteId The matching reroute will have this set as its {@link parentId}.\n   * @returns The reroute that was found, `undefined` if no reroute was found, or `null` if an infinite loop was detected.\n   */\n  static findNextReroute(network, linkSegment, rerouteId) {\n    if (!linkSegment.parentId) return;\n    return network.reroutes.get(linkSegment.parentId)?.findNextReroute(rerouteId);\n  }\n  /**\n   * Gets the origin node of a link.\n   * @param network The network to search\n   * @param linkId The ID of the link to get the origin node of\n   * @returns The origin node of the link, or `undefined` if the link is not found or the origin node is not found\n   */\n  static getOriginNode(network, linkId) {\n    const id = network.links.get(linkId)?.origin_id;\n    return network.getNodeById(id) ?? void 0;\n  }\n  /**\n   * Gets the target node of a link.\n   * @param network The network to search\n   * @param linkId The ID of the link to get the target node of\n   * @returns The target node of the link, or `undefined` if the link is not found or the target node is not found\n   */\n  static getTargetNode(network, linkId) {\n    const id = network.links.get(linkId)?.target_id;\n    return network.getNodeById(id) ?? void 0;\n  }\n  /**\n   * Resolves a link ID to the link, node, and slot objects.\n   * @param linkId The {@link id} of the link to resolve\n   * @param network The link network to search\n   * @returns An object containing the input and output nodes, as well as the input and output slots.\n   * @remarks This method is heavier than others; it will always resolve all objects.\n   * Whilst the performance difference should in most cases be negligible,\n   * it is recommended to use simpler methods where appropriate.\n   */\n  static resolve(linkId, network) {\n    return network.getLink(linkId)?.resolve(network);\n  }\n  /**\n   * Resolves a list of link IDs to the link, node, and slot objects.\n   * Discards invalid link IDs.\n   * @param linkIds An iterable of link {@link id}s to resolve\n   * @param network The link network to search\n   * @returns An array of resolved connections.  If a link is not found, it is not included in the array.\n   * @see {@link LLink.resolve}\n   */\n  static resolveMany(linkIds, network) {\n    const resolved = [];\n    for (const id of linkIds) {\n      const r = network.getLink(id)?.resolve(network);\n      if (r) resolved.push(r);\n    }\n    return resolved;\n  }\n  /**\n   * Resolves the primitive ID values stored in the link to the referenced objects.\n   * @param network The link network to search\n   * @returns An object containing the input and output nodes, as well as the input and output slots.\n   * @remarks This method is heavier than others; it will always resolve all objects.\n   * Whilst the performance difference should in most cases be negligible,\n   * it is recommended to use simpler methods where appropriate.\n   */\n  resolve(network) {\n    const inputNode = this.target_id === -1 ? void 0 : network.getNodeById(this.target_id) ?? void 0;\n    const input = inputNode?.inputs[this.target_slot];\n    const subgraphInput = this.originIsIoNode ? network.inputNode?.slots[this.origin_slot] : void 0;\n    if (subgraphInput) {\n      return { inputNode, input, subgraphInput, link: this };\n    }\n    const outputNode = this.origin_id === -1 ? void 0 : network.getNodeById(this.origin_id) ?? void 0;\n    const output = outputNode?.outputs[this.origin_slot];\n    const subgraphOutput = this.targetIsIoNode ? network.outputNode?.slots[this.target_slot] : void 0;\n    if (subgraphOutput) {\n      return { outputNode, output, subgraphInput: void 0, subgraphOutput, link: this };\n    }\n    return { inputNode, outputNode, input, output, subgraphInput, subgraphOutput, link: this };\n  }\n  configure(o) {\n    if (Array.isArray(o)) {\n      this.id = o[0];\n      this.origin_id = o[1];\n      this.origin_slot = o[2];\n      this.target_id = o[3];\n      this.target_slot = o[4];\n      this.type = o[5];\n    } else {\n      this.id = o.id;\n      this.type = o.type;\n      this.origin_id = o.origin_id;\n      this.origin_slot = o.origin_slot;\n      this.target_id = o.target_id;\n      this.target_slot = o.target_slot;\n      this.parentId = o.parentId;\n    }\n  }\n  /**\n   * Checks if the specified node id and output index are this link's origin (output side).\n   * @param nodeId ID of the node to check\n   * @param outputIndex The array index of the node output\n   * @returns `true` if the origin matches, otherwise `false`.\n   */\n  hasOrigin(nodeId, outputIndex) {\n    return this.origin_id === nodeId && this.origin_slot === outputIndex;\n  }\n  /**\n   * Checks if the specified node id and input index are this link's target (input side).\n   * @param nodeId ID of the node to check\n   * @param inputIndex The array index of the node input\n   * @returns `true` if the target matches, otherwise `false`.\n   */\n  hasTarget(nodeId, inputIndex) {\n    return this.target_id === nodeId && this.target_slot === inputIndex;\n  }\n  /**\n   * Creates a floating link from this link.\n   * @param slotType The side of the link that is still connected\n   * @param parentId The parent reroute ID of the link\n   * @returns A new LLink that is floating\n   */\n  toFloating(slotType, parentId) {\n    const exported = this.asSerialisable();\n    exported.id = -1;\n    exported.parentId = parentId;\n    if (slotType === \"input\") {\n      exported.origin_id = -1;\n      exported.origin_slot = -1;\n    } else {\n      exported.target_id = -1;\n      exported.target_slot = -1;\n    }\n    return LLink.create(exported);\n  }\n  /**\n   * Disconnects a link and removes it from the graph, cleaning up any reroutes that are no longer used\n   * @param network The container (LGraph) where reroutes should be updated\n   * @param keepReroutes If `undefined`, reroutes will be automatically removed if no links remain.\n   * If `input` or `output`, reroutes will not be automatically removed, and retain a connection to the input or output, respectively.\n   */\n  disconnect(network, keepReroutes) {\n    const reroutes = LLink.getReroutes(network, this);\n    const lastReroute = reroutes.at(-1);\n    const outputFloating = keepReroutes === \"output\" && lastReroute?.linkIds.size === 1 && lastReroute.floatingLinkIds.size === 0;\n    if (outputFloating || keepReroutes === \"input\" && lastReroute) {\n      const newLink = LLink.create(this);\n      newLink.id = -1;\n      if (keepReroutes === \"input\") {\n        newLink.origin_id = -1;\n        newLink.origin_slot = -1;\n        lastReroute.floating = { slotType: \"input\" };\n      } else {\n        newLink.target_id = -1;\n        newLink.target_slot = -1;\n        lastReroute.floating = { slotType: \"output\" };\n      }\n      network.addFloatingLink(newLink);\n    }\n    for (const reroute of reroutes) {\n      reroute.linkIds.delete(this.id);\n      if (!keepReroutes && !reroute.totalLinks) {\n        network.reroutes.delete(reroute.id);\n      }\n    }\n    network.links.delete(this.id);\n    if (this.originIsIoNode && network instanceof Subgraph) {\n      const subgraphInput = network.inputs.at(this.origin_slot);\n      if (!subgraphInput) throw new Error(\"Invalid link - subgraph input not found\");\n      subgraphInput.events.dispatch(\"input-disconnected\", { input: subgraphInput });\n    }\n  }\n  /**\n   * @deprecated Prefer {@link LLink.asSerialisable} (returns an object, not an array)\n   * @returns An array representing this LLink\n   */\n  serialize() {\n    return [\n      this.id,\n      this.origin_id,\n      this.origin_slot,\n      this.target_id,\n      this.target_slot,\n      this.type\n    ];\n  }\n  asSerialisable() {\n    const copy = {\n      id: this.id,\n      origin_id: this.origin_id,\n      origin_slot: this.origin_slot,\n      target_id: this.target_id,\n      target_slot: this.target_slot,\n      type: this.type\n    };\n    if (this.parentId) copy.parentId = this.parentId;\n    return copy;\n  }\n}\nvar NodeSlotType = /* @__PURE__ */ ((NodeSlotType2) => {\n  NodeSlotType2[NodeSlotType2[\"INPUT\"] = 1] = \"INPUT\";\n  NodeSlotType2[NodeSlotType2[\"OUTPUT\"] = 2] = \"OUTPUT\";\n  return NodeSlotType2;\n})(NodeSlotType || {});\nvar RenderShape = /* @__PURE__ */ ((RenderShape2) => {\n  RenderShape2[RenderShape2[\"BOX\"] = 1] = \"BOX\";\n  RenderShape2[RenderShape2[\"ROUND\"] = 2] = \"ROUND\";\n  RenderShape2[RenderShape2[\"CIRCLE\"] = 3] = \"CIRCLE\";\n  RenderShape2[RenderShape2[\"CARD\"] = 4] = \"CARD\";\n  RenderShape2[RenderShape2[\"ARROW\"] = 5] = \"ARROW\";\n  RenderShape2[RenderShape2[\"GRID\"] = 6] = \"GRID\";\n  RenderShape2[RenderShape2[\"HollowCircle\"] = 7] = \"HollowCircle\";\n  return RenderShape2;\n})(RenderShape || {});\nvar CanvasItem = /* @__PURE__ */ ((CanvasItem2) => {\n  CanvasItem2[CanvasItem2[\"Nothing\"] = 0] = \"Nothing\";\n  CanvasItem2[CanvasItem2[\"Node\"] = 1] = \"Node\";\n  CanvasItem2[CanvasItem2[\"Group\"] = 2] = \"Group\";\n  CanvasItem2[CanvasItem2[\"Reroute\"] = 4] = \"Reroute\";\n  CanvasItem2[CanvasItem2[\"Link\"] = 8] = \"Link\";\n  CanvasItem2[CanvasItem2[\"RerouteSlot\"] = 32] = \"RerouteSlot\";\n  CanvasItem2[CanvasItem2[\"SubgraphIoNode\"] = 64] = \"SubgraphIoNode\";\n  CanvasItem2[CanvasItem2[\"SubgraphIoSlot\"] = 128] = \"SubgraphIoSlot\";\n  return CanvasItem2;\n})(CanvasItem || {});\nvar LinkDirection = /* @__PURE__ */ ((LinkDirection2) => {\n  LinkDirection2[LinkDirection2[\"NONE\"] = 0] = \"NONE\";\n  LinkDirection2[LinkDirection2[\"UP\"] = 1] = \"UP\";\n  LinkDirection2[LinkDirection2[\"DOWN\"] = 2] = \"DOWN\";\n  LinkDirection2[LinkDirection2[\"LEFT\"] = 3] = \"LEFT\";\n  LinkDirection2[LinkDirection2[\"RIGHT\"] = 4] = \"RIGHT\";\n  LinkDirection2[LinkDirection2[\"CENTER\"] = 5] = \"CENTER\";\n  return LinkDirection2;\n})(LinkDirection || {});\nvar LinkRenderType = /* @__PURE__ */ ((LinkRenderType2) => {\n  LinkRenderType2[LinkRenderType2[\"HIDDEN_LINK\"] = -1] = \"HIDDEN_LINK\";\n  LinkRenderType2[LinkRenderType2[\"STRAIGHT_LINK\"] = 0] = \"STRAIGHT_LINK\";\n  LinkRenderType2[LinkRenderType2[\"LINEAR_LINK\"] = 1] = \"LINEAR_LINK\";\n  LinkRenderType2[LinkRenderType2[\"SPLINE_LINK\"] = 2] = \"SPLINE_LINK\";\n  return LinkRenderType2;\n})(LinkRenderType || {});\nvar LinkMarkerShape = /* @__PURE__ */ ((LinkMarkerShape2) => {\n  LinkMarkerShape2[LinkMarkerShape2[\"None\"] = 0] = \"None\";\n  LinkMarkerShape2[LinkMarkerShape2[\"Circle\"] = 1] = \"Circle\";\n  LinkMarkerShape2[LinkMarkerShape2[\"Arrow\"] = 2] = \"Arrow\";\n  return LinkMarkerShape2;\n})(LinkMarkerShape || {});\nvar TitleMode = /* @__PURE__ */ ((TitleMode2) => {\n  TitleMode2[TitleMode2[\"NORMAL_TITLE\"] = 0] = \"NORMAL_TITLE\";\n  TitleMode2[TitleMode2[\"NO_TITLE\"] = 1] = \"NO_TITLE\";\n  TitleMode2[TitleMode2[\"TRANSPARENT_TITLE\"] = 2] = \"TRANSPARENT_TITLE\";\n  TitleMode2[TitleMode2[\"AUTOHIDE_TITLE\"] = 3] = \"AUTOHIDE_TITLE\";\n  return TitleMode2;\n})(TitleMode || {});\nvar LGraphEventMode = /* @__PURE__ */ ((LGraphEventMode2) => {\n  LGraphEventMode2[LGraphEventMode2[\"ALWAYS\"] = 0] = \"ALWAYS\";\n  LGraphEventMode2[LGraphEventMode2[\"ON_EVENT\"] = 1] = \"ON_EVENT\";\n  LGraphEventMode2[LGraphEventMode2[\"NEVER\"] = 2] = \"NEVER\";\n  LGraphEventMode2[LGraphEventMode2[\"ON_TRIGGER\"] = 3] = \"ON_TRIGGER\";\n  LGraphEventMode2[LGraphEventMode2[\"BYPASS\"] = 4] = \"BYPASS\";\n  return LGraphEventMode2;\n})(LGraphEventMode || {});\nvar EaseFunction = /* @__PURE__ */ ((EaseFunction2) => {\n  EaseFunction2[\"LINEAR\"] = \"linear\";\n  EaseFunction2[\"EASE_IN_QUAD\"] = \"easeInQuad\";\n  EaseFunction2[\"EASE_OUT_QUAD\"] = \"easeOutQuad\";\n  EaseFunction2[\"EASE_IN_OUT_QUAD\"] = \"easeInOutQuad\";\n  return EaseFunction2;\n})(EaseFunction || {});\nvar Alignment = /* @__PURE__ */ ((Alignment2) => {\n  Alignment2[Alignment2[\"None\"] = 0] = \"None\";\n  Alignment2[Alignment2[\"Top\"] = 1] = \"Top\";\n  Alignment2[Alignment2[\"Bottom\"] = 2] = \"Bottom\";\n  Alignment2[Alignment2[\"Middle\"] = 4] = \"Middle\";\n  Alignment2[Alignment2[\"Left\"] = 8] = \"Left\";\n  Alignment2[Alignment2[\"Right\"] = 16] = \"Right\";\n  Alignment2[Alignment2[\"Centre\"] = 32] = \"Centre\";\n  Alignment2[Alignment2[\"TopLeft\"] = 9] = \"TopLeft\";\n  Alignment2[Alignment2[\"TopCentre\"] = 33] = \"TopCentre\";\n  Alignment2[Alignment2[\"TopRight\"] = 17] = \"TopRight\";\n  Alignment2[Alignment2[\"MidLeft\"] = 12] = \"MidLeft\";\n  Alignment2[Alignment2[\"MidCentre\"] = 36] = \"MidCentre\";\n  Alignment2[Alignment2[\"MidRight\"] = 20] = \"MidRight\";\n  Alignment2[Alignment2[\"BottomLeft\"] = 10] = \"BottomLeft\";\n  Alignment2[Alignment2[\"BottomCentre\"] = 34] = \"BottomCentre\";\n  Alignment2[Alignment2[\"BottomRight\"] = 18] = \"BottomRight\";\n  return Alignment2;\n})(Alignment || {});\nfunction hasFlag(flagSet, flag) {\n  return (flagSet & flag) === flag;\n}\nfunction distance(a, b) {\n  return Math.sqrt(\n    (b[0] - a[0]) * (b[0] - a[0]) + (b[1] - a[1]) * (b[1] - a[1])\n  );\n}\nfunction dist2(x1, y1, x2, y2) {\n  return (x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1);\n}\nfunction isInRectangle(x2, y, left, top, width2, height) {\n  return x2 >= left && x2 < left + width2 && y >= top && y < top + height;\n}\nfunction isPointInRect(point, rect) {\n  return point[0] >= rect[0] && point[0] < rect[0] + rect[2] && point[1] >= rect[1] && point[1] < rect[1] + rect[3];\n}\nfunction isInRect(x2, y, rect) {\n  return x2 >= rect[0] && x2 < rect[0] + rect[2] && y >= rect[1] && y < rect[1] + rect[3];\n}\nfunction isInsideRectangle(x2, y, left, top, width2, height) {\n  return left < x2 && left + width2 > x2 && top < y && top + height > y;\n}\nfunction overlapBounding(a, b) {\n  const aRight = a[0] + a[2];\n  const aBottom = a[1] + a[3];\n  const bRight = b[0] + b[2];\n  const bBottom = b[1] + b[3];\n  return a[0] > bRight || a[1] > bBottom || aRight < b[0] || aBottom < b[1] ? false : true;\n}\nfunction getCentre(rect) {\n  return [\n    rect[0] + rect[2] * 0.5,\n    rect[1] + rect[3] * 0.5\n  ];\n}\nfunction containsCentre(a, b) {\n  const centreX = b[0] + b[2] * 0.5;\n  const centreY = b[1] + b[3] * 0.5;\n  return isInRect(centreX, centreY, a);\n}\nfunction containsRect(a, b) {\n  const aRight = a[0] + a[2];\n  const aBottom = a[1] + a[3];\n  const bRight = b[0] + b[2];\n  const bBottom = b[1] + b[3];\n  const identical = a[0] === b[0] && a[1] === b[1] && aRight === bRight && aBottom === bBottom;\n  return !identical && a[0] <= b[0] && a[1] <= b[1] && aRight >= bRight && aBottom >= bBottom;\n}\nfunction findPointOnCurve(out, a, b, controlA, controlB, t = 0.5) {\n  const iT = 1 - t;\n  const c1 = iT * iT * iT;\n  const c2 = 3 * (iT * iT) * t;\n  const c3 = 3 * iT * (t * t);\n  const c4 = t * t * t;\n  out[0] = c1 * a[0] + c2 * controlA[0] + c3 * controlB[0] + c4 * b[0];\n  out[1] = c1 * a[1] + c2 * controlA[1] + c3 * controlB[1] + c4 * b[1];\n}\nfunction createBounds(objects, padding = 10) {\n  const bounds = new Float32Array([Infinity, Infinity, -Infinity, -Infinity]);\n  for (const obj of objects) {\n    const rect = obj.boundingRect;\n    bounds[0] = Math.min(bounds[0], rect[0]);\n    bounds[1] = Math.min(bounds[1], rect[1]);\n    bounds[2] = Math.max(bounds[2], rect[0] + rect[2]);\n    bounds[3] = Math.max(bounds[3], rect[1] + rect[3]);\n  }\n  if (!bounds.every((x2) => isFinite(x2))) return null;\n  return [\n    bounds[0] - padding,\n    bounds[1] - padding,\n    bounds[2] - bounds[0] + 2 * padding,\n    bounds[3] - bounds[1] + 2 * padding\n  ];\n}\nfunction snapPoint(pos, snapTo) {\n  if (!snapTo) return false;\n  pos[0] = snapTo * Math.round(pos[0] / snapTo);\n  pos[1] = snapTo * Math.round(pos[1] / snapTo);\n  return true;\n}\nfunction alignToContainer(rect, anchors, [containerX, containerY, containerWidth, containerHeight], [insetX, insetY] = [0, 0]) {\n  if (hasFlag(anchors, Alignment.Left)) {\n    rect[0] = containerX + insetX;\n  } else if (hasFlag(anchors, Alignment.Right)) {\n    rect[0] = containerX + containerWidth - insetX - rect[2];\n  } else if (hasFlag(anchors, Alignment.Centre)) {\n    rect[0] = containerX + containerWidth * 0.5 - rect[2] * 0.5;\n  }\n  if (hasFlag(anchors, Alignment.Top)) {\n    rect[1] = containerY + insetY;\n  } else if (hasFlag(anchors, Alignment.Bottom)) {\n    rect[1] = containerY + containerHeight - insetY - rect[3];\n  } else if (hasFlag(anchors, Alignment.Middle)) {\n    rect[1] = containerY + containerHeight * 0.5 - rect[3] * 0.5;\n  }\n  return rect;\n}\nfunction alignOutsideContainer(rect, anchors, [otherX, otherY, otherWidth, otherHeight], [outsetX, outsetY] = [0, 0]) {\n  if (hasFlag(anchors, Alignment.Left)) {\n    rect[0] = otherX - outsetX - rect[2];\n  } else if (hasFlag(anchors, Alignment.Right)) {\n    rect[0] = otherX + otherWidth + outsetX;\n  } else if (hasFlag(anchors, Alignment.Centre)) {\n    rect[0] = otherX + otherWidth * 0.5 - rect[2] * 0.5;\n  }\n  if (hasFlag(anchors, Alignment.Top)) {\n    rect[1] = otherY - outsetY - rect[3];\n  } else if (hasFlag(anchors, Alignment.Bottom)) {\n    rect[1] = otherY + otherHeight + outsetY;\n  } else if (hasFlag(anchors, Alignment.Middle)) {\n    rect[1] = otherY + otherHeight * 0.5 - rect[3] * 0.5;\n  }\n  return rect;\n}\nfunction clamp(value, min, max) {\n  return value < min ? min : value > max ? max : value;\n}\nclass Rectangle extends Float64Array {\n  #pos;\n  #size;\n  constructor(x2 = 0, y = 0, width2 = 0, height = 0) {\n    super(4);\n    this[0] = x2;\n    this[1] = y;\n    this[2] = width2;\n    this[3] = height;\n  }\n  static from([x2, y, width2, height]) {\n    return new Rectangle(x2, y, width2, height);\n  }\n  /**\n   * Creates a new rectangle positioned at the given centre, with the given width/height.\n   * @param centre The centre of the rectangle, as an `[x, y]` point\n   * @param width The width of the rectangle\n   * @param height The height of the rectangle.  Default: {@link width}\n   * @returns A new rectangle whose centre is at {@link x}\n   */\n  static fromCentre([x2, y], width2, height = width2) {\n    const left = x2 - width2 * 0.5;\n    const top = y - height * 0.5;\n    return new Rectangle(left, top, width2, height);\n  }\n  static ensureRect(rect) {\n    return rect instanceof Rectangle ? rect : new Rectangle(rect[0], rect[1], rect[2], rect[3]);\n  }\n  subarray(begin = 0, end) {\n    const byteOffset = begin << 3;\n    const length = end === void 0 ? end : end - begin;\n    return new Float64Array(this.buffer, byteOffset, length);\n  }\n  /**\n   * A reference to the position of the top-left corner of this rectangle.\n   *\n   * Updating the values of the returned object will update this rectangle.\n   */\n  get pos() {\n    this.#pos ??= this.subarray(0, 2);\n    return this.#pos;\n  }\n  set pos(value) {\n    this[0] = value[0];\n    this[1] = value[1];\n  }\n  /**\n   * A reference to the size of this rectangle.\n   *\n   * Updating the values of the returned object will update this rectangle.\n   */\n  get size() {\n    this.#size ??= this.subarray(2, 4);\n    return this.#size;\n  }\n  set size(value) {\n    this[2] = value[0];\n    this[3] = value[1];\n  }\n  // #region Property accessors\n  /** The x co-ordinate of the top-left corner of this rectangle. */\n  get x() {\n    return this[0];\n  }\n  set x(value) {\n    this[0] = value;\n  }\n  /** The y co-ordinate of the top-left corner of this rectangle. */\n  get y() {\n    return this[1];\n  }\n  set y(value) {\n    this[1] = value;\n  }\n  /** The width of this rectangle. */\n  get width() {\n    return this[2];\n  }\n  set width(value) {\n    this[2] = value;\n  }\n  /** The height of this rectangle. */\n  get height() {\n    return this[3];\n  }\n  set height(value) {\n    this[3] = value;\n  }\n  /** The x co-ordinate of the left edge of this rectangle. */\n  get left() {\n    return this[0];\n  }\n  set left(value) {\n    this[0] = value;\n  }\n  /** The y co-ordinate of the top edge of this rectangle. */\n  get top() {\n    return this[1];\n  }\n  set top(value) {\n    this[1] = value;\n  }\n  /** The x co-ordinate of the right edge of this rectangle. */\n  get right() {\n    return this[0] + this[2];\n  }\n  set right(value) {\n    this[0] = value - this[2];\n  }\n  /** The y co-ordinate of the bottom edge of this rectangle. */\n  get bottom() {\n    return this[1] + this[3];\n  }\n  set bottom(value) {\n    this[1] = value - this[3];\n  }\n  /** The x co-ordinate of the centre of this rectangle. */\n  get centreX() {\n    return this[0] + this[2] * 0.5;\n  }\n  /** The y co-ordinate of the centre of this rectangle. */\n  get centreY() {\n    return this[1] + this[3] * 0.5;\n  }\n  // #endregion Property accessors\n  /**\n   * Updates the rectangle to the values of {@link rect}.\n   * @param rect The rectangle to update to.\n   */\n  updateTo(rect) {\n    this[0] = rect[0];\n    this[1] = rect[1];\n    this[2] = rect[2];\n    this[3] = rect[3];\n  }\n  /**\n   * Checks if the point [{@link x}, {@link y}] is inside this rectangle.\n   * @param x The x-coordinate to check\n   * @param y The y-coordinate to check\n   * @returns `true` if the point is inside this rectangle, otherwise `false`.\n   */\n  containsXy(x2, y) {\n    const [left, top, width2, height] = this;\n    return x2 >= left && x2 < left + width2 && y >= top && y < top + height;\n  }\n  /**\n   * Checks if {@link point} is inside this rectangle.\n   * @param point The point to check\n   * @returns `true` if {@link point} is inside this rectangle, otherwise `false`.\n   */\n  containsPoint([x2, y]) {\n    const [left, top, width2, height] = this;\n    return x2 >= left && x2 < left + width2 && y >= top && y < top + height;\n  }\n  /**\n   * Checks if {@link other} is a smaller rectangle inside this rectangle.\n   * One **must** be larger than the other; identical rectangles are not considered to contain each other.\n   * @param other The rectangle to check\n   * @returns `true` if {@link other} is inside this rectangle, otherwise `false`.\n   */\n  containsRect(other) {\n    const { right, bottom } = this;\n    const otherRight = other[0] + other[2];\n    const otherBottom = other[1] + other[3];\n    const identical = this.x === other[0] && this.y === other[1] && right === otherRight && bottom === otherBottom;\n    return !identical && this.x <= other[0] && this.y <= other[1] && right >= otherRight && bottom >= otherBottom;\n  }\n  /**\n   * Checks if {@link rect} overlaps with this rectangle.\n   * @param rect The rectangle to check\n   * @returns `true` if {@link rect} overlaps with this rectangle, otherwise `false`.\n   */\n  overlaps(rect) {\n    return this.x < rect[0] + rect[2] && this.y < rect[1] + rect[3] && this.x + this.width > rect[0] && this.y + this.height > rect[1];\n  }\n  /**\n   * Finds the corner (if any) of this rectangle that contains the point [{@link x}, {@link y}].\n   * @param x The x-coordinate to check\n   * @param y The y-coordinate to check\n   * @param cornerSize Each corner is treated as an inset square with this width and height.\n   * @returns The compass direction of the corner that contains the point, or `undefined` if the point is not in any corner.\n   */\n  findContainingCorner(x2, y, cornerSize) {\n    if (this.isInTopLeftCorner(x2, y, cornerSize)) return \"NW\";\n    if (this.isInTopRightCorner(x2, y, cornerSize)) return \"NE\";\n    if (this.isInBottomLeftCorner(x2, y, cornerSize)) return \"SW\";\n    if (this.isInBottomRightCorner(x2, y, cornerSize)) return \"SE\";\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the top-left corner of this rectangle, otherwise `false`. */\n  isInTopLeftCorner(x2, y, cornerSize) {\n    return isInRectangle(x2, y, this.x, this.y, cornerSize, cornerSize);\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the top-right corner of this rectangle, otherwise `false`. */\n  isInTopRightCorner(x2, y, cornerSize) {\n    return isInRectangle(x2, y, this.right - cornerSize, this.y, cornerSize, cornerSize);\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the bottom-left corner of this rectangle, otherwise `false`. */\n  isInBottomLeftCorner(x2, y, cornerSize) {\n    return isInRectangle(x2, y, this.x, this.bottom - cornerSize, cornerSize, cornerSize);\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the bottom-right corner of this rectangle, otherwise `false`. */\n  isInBottomRightCorner(x2, y, cornerSize) {\n    return isInRectangle(x2, y, this.right - cornerSize, this.bottom - cornerSize, cornerSize, cornerSize);\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the top edge of this rectangle, otherwise `false`. */\n  isInTopEdge(x2, y, edgeSize) {\n    return isInRectangle(x2, y, this.x, this.y, this.width, edgeSize);\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the bottom edge of this rectangle, otherwise `false`. */\n  isInBottomEdge(x2, y, edgeSize) {\n    return isInRectangle(x2, y, this.x, this.bottom - edgeSize, this.width, edgeSize);\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the left edge of this rectangle, otherwise `false`. */\n  isInLeftEdge(x2, y, edgeSize) {\n    return isInRectangle(x2, y, this.x, this.y, edgeSize, this.height);\n  }\n  /** @returns `true` if the point [{@link x}, {@link y}] is in the right edge of this rectangle, otherwise `false`. */\n  isInRightEdge(x2, y, edgeSize) {\n    return isInRectangle(x2, y, this.right - edgeSize, this.y, edgeSize, this.height);\n  }\n  /** @returns The centre point of this rectangle, as a new {@link Point}. */\n  getCentre() {\n    return [this.centreX, this.centreY];\n  }\n  /** @returns The area of this rectangle. */\n  getArea() {\n    return this.width * this.height;\n  }\n  /** @returns The perimeter of this rectangle. */\n  getPerimeter() {\n    return 2 * (this.width + this.height);\n  }\n  /** @returns The top-left corner of this rectangle, as a new {@link Point}. */\n  getTopLeft() {\n    return [this[0], this[1]];\n  }\n  /** @returns The bottom-right corner of this rectangle, as a new {@link Point}. */\n  getBottomRight() {\n    return [this.right, this.bottom];\n  }\n  /** @returns The width and height of this rectangle, as a new {@link Size}. */\n  getSize() {\n    return [this[2], this[3]];\n  }\n  /** @returns The offset from the top-left of this rectangle to the point [{@link x}, {@link y}], as a new {@link Point}. */\n  getOffsetTo([x2, y]) {\n    return [x2 - this[0], y - this[1]];\n  }\n  /** @returns The offset from the point [{@link x}, {@link y}] to the top-left of this rectangle, as a new {@link Point}. */\n  getOffsetFrom([x2, y]) {\n    return [this[0] - x2, this[1] - y];\n  }\n  /** Resizes the rectangle without moving it, setting its top-left corner to [{@link x}, {@link y}]. */\n  resizeTopLeft(x1, y1) {\n    this[2] += this[0] - x1;\n    this[3] += this[1] - y1;\n    this[0] = x1;\n    this[1] = y1;\n  }\n  /** Resizes the rectangle without moving it, setting its bottom-left corner to [{@link x}, {@link y}]. */\n  resizeBottomLeft(x1, y2) {\n    this[2] += this[0] - x1;\n    this[3] = y2 - this[1];\n    this[0] = x1;\n  }\n  /** Resizes the rectangle without moving it, setting its top-right corner to [{@link x}, {@link y}]. */\n  resizeTopRight(x2, y1) {\n    this[2] = x2 - this[0];\n    this[3] += this[1] - y1;\n    this[1] = y1;\n  }\n  /** Resizes the rectangle without moving it, setting its bottom-right corner to [{@link x}, {@link y}]. */\n  resizeBottomRight(x2, y2) {\n    this[2] = x2 - this[0];\n    this[3] = y2 - this[1];\n  }\n  /** Sets the width without moving the right edge (changes position) */\n  setWidthRightAnchored(width2) {\n    const currentWidth = this[2];\n    this[2] = width2;\n    this[0] += currentWidth - width2;\n  }\n  /** Sets the height without moving the bottom edge (changes position) */\n  setHeightBottomAnchored(height) {\n    const currentHeight = this[3];\n    this[3] = height;\n    this[1] += currentHeight - height;\n  }\n  clone() {\n    return new Rectangle(this[0], this[1], this[2], this[3]);\n  }\n  /** Alias of {@link export}. */\n  toArray() {\n    return this.export();\n  }\n  /** @returns A new, untyped array (serializable) containing the values of this rectangle. */\n  export() {\n    return [this[0], this[1], this[2], this[3]];\n  }\n  /**\n   * Draws a debug outline of this rectangle.\n   * @internal Convenience debug/development interface; not for production use.\n   */\n  _drawDebug(ctx, colour = \"red\") {\n    const { strokeStyle, lineWidth } = ctx;\n    try {\n      ctx.strokeStyle = colour;\n      ctx.lineWidth = 0.5;\n      ctx.beginPath();\n      ctx.strokeRect(this[0], this[1], this[2], this[3]);\n    } finally {\n      ctx.strokeStyle = strokeStyle;\n      ctx.lineWidth = lineWidth;\n    }\n  }\n}\nfunction getNodeInputOnPos(node2, x2, y) {\n  const { inputs } = node2;\n  if (!inputs) return;\n  for (const [index, input] of inputs.entries()) {\n    const pos = node2.getInputPos(index);\n    const nameLength = input.label?.length ?? input.localized_name?.length ?? input.name?.length;\n    const width2 = 20 + (nameLength || 3) * 7;\n    if (isInRectangle(\n      x2,\n      y,\n      pos[0] - 10,\n      pos[1] - 10,\n      width2,\n      20\n    )) {\n      return { index, input, pos };\n    }\n  }\n}\nfunction getNodeOutputOnPos(node2, x2, y) {\n  const { outputs } = node2;\n  if (!outputs) return;\n  for (const [index, output] of outputs.entries()) {\n    const pos = node2.getOutputPos(index);\n    if (isInRectangle(\n      x2,\n      y,\n      pos[0] - 10,\n      pos[1] - 10,\n      40,\n      20\n    )) {\n      return { index, output, pos };\n    }\n  }\n}\nfunction isOverNodeInput(node2, canvasx, canvasy, slot_pos) {\n  const result = getNodeInputOnPos(node2, canvasx, canvasy);\n  if (!result) return -1;\n  if (slot_pos) {\n    slot_pos[0] = result.pos[0];\n    slot_pos[1] = result.pos[1];\n  }\n  return result.index;\n}\nfunction isOverNodeOutput(node2, canvasx, canvasy, slot_pos) {\n  const result = getNodeOutputOnPos(node2, canvasx, canvasy);\n  if (!result) return -1;\n  if (slot_pos) {\n    slot_pos[0] = result.pos[0];\n    slot_pos[1] = result.pos[1];\n  }\n  return result.index;\n}\nclass NullGraphError extends Error {\n  constructor(message = \"Attempted to access LGraph reference that was null or undefined.\", cause) {\n    super(message, { cause });\n    this.name = \"NullGraphError\";\n  }\n}\nclass LGraphIcon {\n  unicode;\n  fontFamily;\n  color;\n  bgColor;\n  fontSize;\n  circlePadding;\n  xOffset;\n  yOffset;\n  constructor({\n    unicode,\n    fontFamily = \"PrimeIcons\",\n    color = \"#e6c200\",\n    bgColor,\n    fontSize = 16,\n    circlePadding = 2,\n    xOffset = 0,\n    yOffset = 0\n  }) {\n    this.unicode = unicode;\n    this.fontFamily = fontFamily;\n    this.color = color;\n    this.bgColor = bgColor;\n    this.fontSize = fontSize;\n    this.circlePadding = circlePadding;\n    this.xOffset = xOffset;\n    this.yOffset = yOffset;\n  }\n  draw(ctx, x2, y) {\n    x2 += this.xOffset;\n    y += this.yOffset;\n    const { font, textBaseline, textAlign, fillStyle } = ctx;\n    ctx.font = `${this.fontSize}px '${this.fontFamily}'`;\n    ctx.textBaseline = \"middle\";\n    ctx.textAlign = \"center\";\n    const iconRadius = this.fontSize / 2 + this.circlePadding;\n    if (this.bgColor) {\n      ctx.beginPath();\n      ctx.arc(x2 + iconRadius, y, iconRadius, 0, 2 * Math.PI);\n      ctx.fillStyle = this.bgColor;\n      ctx.fill();\n    }\n    ctx.fillStyle = this.color;\n    ctx.fillText(this.unicode, x2 + iconRadius, y);\n    ctx.font = font;\n    ctx.textBaseline = textBaseline;\n    ctx.textAlign = textAlign;\n    ctx.fillStyle = fillStyle;\n  }\n}\nvar BadgePosition = /* @__PURE__ */ ((BadgePosition2) => {\n  BadgePosition2[\"TopLeft\"] = \"top-left\";\n  BadgePosition2[\"TopRight\"] = \"top-right\";\n  return BadgePosition2;\n})(BadgePosition || {});\nclass LGraphBadge {\n  text;\n  fgColor;\n  bgColor;\n  fontSize;\n  padding;\n  height;\n  cornerRadius;\n  icon;\n  xOffset;\n  yOffset;\n  constructor({\n    text,\n    fgColor = \"white\",\n    bgColor = \"#0F1F0F\",\n    fontSize = 12,\n    padding = 6,\n    height = 20,\n    cornerRadius = 5,\n    iconOptions,\n    xOffset = 0,\n    yOffset = 0\n  }) {\n    this.text = text;\n    this.fgColor = fgColor;\n    this.bgColor = bgColor;\n    this.fontSize = fontSize;\n    this.padding = padding;\n    this.height = height;\n    this.cornerRadius = cornerRadius;\n    if (iconOptions) {\n      this.icon = new LGraphIcon(iconOptions);\n    }\n    this.xOffset = xOffset;\n    this.yOffset = yOffset;\n  }\n  get visible() {\n    return (this.text?.length ?? 0) > 0 || !!this.icon;\n  }\n  getWidth(ctx) {\n    if (!this.visible) return 0;\n    const { font } = ctx;\n    let iconWidth = 0;\n    if (this.icon) {\n      ctx.font = `${this.icon.fontSize}px '${this.icon.fontFamily}'`;\n      iconWidth = ctx.measureText(this.icon.unicode).width + this.padding;\n    }\n    ctx.font = `${this.fontSize}px sans-serif`;\n    const textWidth = this.text ? ctx.measureText(this.text).width : 0;\n    ctx.font = font;\n    return iconWidth + textWidth + this.padding * 2;\n  }\n  draw(ctx, x2, y) {\n    if (!this.visible) return;\n    x2 += this.xOffset;\n    y += this.yOffset;\n    const { font, fillStyle, textBaseline, textAlign } = ctx;\n    ctx.font = `${this.fontSize}px sans-serif`;\n    const badgeWidth = this.getWidth(ctx);\n    const badgeX = 0;\n    ctx.fillStyle = this.bgColor;\n    ctx.beginPath();\n    if (ctx.roundRect) {\n      ctx.roundRect(x2 + badgeX, y, badgeWidth, this.height, this.cornerRadius);\n    } else {\n      ctx.rect(x2 + badgeX, y, badgeWidth, this.height);\n    }\n    ctx.fill();\n    let drawX = x2 + badgeX + this.padding;\n    const centerY = y + this.height / 2;\n    if (this.icon) {\n      this.icon.draw(ctx, drawX, centerY);\n      drawX += this.icon.fontSize + this.padding / 2 + 4;\n    }\n    if (this.text) {\n      ctx.fillStyle = this.fgColor;\n      ctx.textBaseline = \"middle\";\n      ctx.textAlign = \"left\";\n      ctx.fillText(this.text, drawX, centerY + 1);\n    }\n    ctx.font = font;\n    ctx.fillStyle = fillStyle;\n    ctx.textBaseline = textBaseline;\n    ctx.textAlign = textAlign;\n  }\n}\nclass LGraphButton extends LGraphBadge {\n  name;\n  _last_area = new Rectangle();\n  constructor(options) {\n    super(options);\n    this.name = options.name;\n  }\n  getWidth(ctx) {\n    if (!this.visible) return 0;\n    const { font } = ctx;\n    ctx.font = `${this.fontSize}px 'PrimeIcons'`;\n    const textWidth = this.text ? ctx.measureText(this.text).width : 0;\n    ctx.font = font;\n    return textWidth;\n  }\n  /**\n   * @internal\n   *\n   * Draws the button and updates its last rendered area for hit detection.\n   * @param ctx The canvas rendering context.\n   * @param x The x-coordinate to draw the button at.\n   * @param y The y-coordinate to draw the button at.\n   */\n  draw(ctx, x2, y) {\n    if (!this.visible) {\n      return;\n    }\n    const width2 = this.getWidth(ctx);\n    this._last_area[0] = x2 + this.xOffset;\n    this._last_area[1] = y + this.yOffset;\n    this._last_area[2] = width2;\n    this._last_area[3] = this.height;\n    const adjustedX = x2 + this.xOffset;\n    const adjustedY = y + this.yOffset;\n    const { font, fillStyle, textBaseline, textAlign } = ctx;\n    const titleTextColor = ctx.fillStyle || \"white\";\n    ctx.font = `${this.fontSize}px 'PrimeIcons'`;\n    ctx.fillStyle = titleTextColor;\n    ctx.textBaseline = \"middle\";\n    ctx.textAlign = \"center\";\n    const centerX = adjustedX + width2 / 2;\n    const centerY = adjustedY + this.height / 2;\n    if (this.text) {\n      ctx.fillText(this.text, centerX, centerY);\n    }\n    ctx.font = font;\n    ctx.fillStyle = fillStyle;\n    ctx.textBaseline = textBaseline;\n    ctx.textAlign = textAlign;\n  }\n  /**\n   * Checks if a point is inside the button's last rendered area.\n   * @param x The x-coordinate of the point.\n   * @param y The y-coordinate of the point.\n   * @returns `true` if the point is inside the button, otherwise `false`.\n   */\n  isPointInside(x2, y) {\n    return this._last_area.containsPoint([x2, y]);\n  }\n}\nconst ELLIPSIS = \"…\";\nconst TWO_DOT_LEADER = \"‥\";\nconst ONE_DOT_LEADER = \"․\";\nvar SlotType = /* @__PURE__ */ ((SlotType2) => {\n  SlotType2[\"Array\"] = \"array\";\n  SlotType2[SlotType2[\"Event\"] = -1] = \"Event\";\n  return SlotType2;\n})(SlotType || {});\nvar SlotShape = ((SlotShape2) => {\n  SlotShape2[SlotShape2[\"Box\"] = RenderShape.BOX] = \"Box\";\n  SlotShape2[SlotShape2[\"Arrow\"] = RenderShape.ARROW] = \"Arrow\";\n  SlotShape2[SlotShape2[\"Grid\"] = RenderShape.GRID] = \"Grid\";\n  SlotShape2[SlotShape2[\"Circle\"] = RenderShape.CIRCLE] = \"Circle\";\n  SlotShape2[SlotShape2[\"HollowCircle\"] = RenderShape.HollowCircle] = \"HollowCircle\";\n  return SlotShape2;\n})(SlotShape || {});\nvar SlotDirection = ((SlotDirection2) => {\n  SlotDirection2[SlotDirection2[\"Up\"] = LinkDirection.UP] = \"Up\";\n  SlotDirection2[SlotDirection2[\"Right\"] = LinkDirection.RIGHT] = \"Right\";\n  SlotDirection2[SlotDirection2[\"Down\"] = LinkDirection.DOWN] = \"Down\";\n  SlotDirection2[SlotDirection2[\"Left\"] = LinkDirection.LEFT] = \"Left\";\n  return SlotDirection2;\n})(SlotDirection || {});\nvar LabelPosition = /* @__PURE__ */ ((LabelPosition2) => {\n  LabelPosition2[\"Left\"] = \"left\";\n  LabelPosition2[\"Right\"] = \"right\";\n  return LabelPosition2;\n})(LabelPosition || {});\nfunction strokeShape(ctx, area, {\n  shape = RenderShape.BOX,\n  round_radius,\n  title_height,\n  title_mode = TitleMode.NORMAL_TITLE,\n  color,\n  padding = 6,\n  collapsed = false,\n  lineWidth: thickness = 1\n} = {}) {\n  round_radius ??= LiteGraph.ROUND_RADIUS;\n  color ??= LiteGraph.NODE_BOX_OUTLINE_COLOR;\n  if (title_mode === TitleMode.TRANSPARENT_TITLE) {\n    const height2 = title_height ?? LiteGraph.NODE_TITLE_HEIGHT;\n    area[1] -= height2;\n    area[3] += height2;\n  }\n  const { lineWidth, strokeStyle } = ctx;\n  ctx.lineWidth = thickness;\n  ctx.globalAlpha = 0.8;\n  ctx.strokeStyle = color;\n  ctx.beginPath();\n  const [x2, y, width2, height] = area;\n  switch (shape) {\n    case RenderShape.BOX: {\n      ctx.rect(\n        x2 - padding,\n        y - padding,\n        width2 + 2 * padding,\n        height + 2 * padding\n      );\n      break;\n    }\n    case RenderShape.ROUND:\n    case RenderShape.CARD: {\n      const radius = round_radius + padding;\n      const isCollapsed = shape === RenderShape.CARD && collapsed;\n      const cornerRadii = isCollapsed || shape === RenderShape.ROUND ? [radius] : [radius, 2, radius, 2];\n      ctx.roundRect(\n        x2 - padding,\n        y - padding,\n        width2 + 2 * padding,\n        height + 2 * padding,\n        cornerRadii\n      );\n      break;\n    }\n    case RenderShape.CIRCLE: {\n      const centerX = x2 + width2 / 2;\n      const centerY = y + height / 2;\n      const radius = Math.max(width2, height) / 2 + padding;\n      ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);\n      break;\n    }\n  }\n  ctx.stroke();\n  ctx.lineWidth = lineWidth;\n  ctx.strokeStyle = strokeStyle;\n  ctx.globalAlpha = 1;\n}\nfunction truncateTextToWidth(ctx, text, maxWidth) {\n  if (!(maxWidth > 0)) return \"\";\n  const fullWidth = ctx.measureText(text).width;\n  if (fullWidth <= maxWidth) return text;\n  const ellipsisWidth = ctx.measureText(ELLIPSIS).width * 0.75;\n  if (ellipsisWidth > maxWidth) {\n    const twoDotsWidth = ctx.measureText(TWO_DOT_LEADER).width * 0.75;\n    if (twoDotsWidth < maxWidth) return TWO_DOT_LEADER;\n    const oneDotWidth = ctx.measureText(ONE_DOT_LEADER).width * 0.75;\n    return oneDotWidth < maxWidth ? ONE_DOT_LEADER : \"\";\n  }\n  let min = 0;\n  let max = text.length;\n  let bestLen = 0;\n  while (min <= max) {\n    const mid = Math.floor((min + max) * 0.5);\n    if (mid === 0) {\n      min = mid + 1;\n      continue;\n    }\n    const sub = text.substring(0, mid);\n    const currentWidth = ctx.measureText(sub).width + ellipsisWidth;\n    if (currentWidth <= maxWidth) {\n      bestLen = mid;\n      min = mid + 1;\n    } else {\n      max = mid - 1;\n    }\n  }\n  return bestLen === 0 ? ELLIPSIS : text.substring(0, bestLen) + ELLIPSIS;\n}\nfunction drawTextInArea({ ctx, text, area, align = \"left\" }) {\n  const { left, right, bottom, width: width2, centreX } = area;\n  const fullWidth = ctx.measureText(text).width;\n  if (fullWidth <= width2) {\n    ctx.textAlign = align;\n    const x2 = align === \"left\" ? left : align === \"right\" ? right : centreX;\n    ctx.fillText(text, x2, bottom);\n    return;\n  }\n  const truncated = truncateTextToWidth(ctx, text, width2);\n  if (truncated.length === 0) return;\n  ctx.textAlign = \"left\";\n  ctx.fillText(truncated.slice(0, -1), left, bottom);\n  ctx.rect(left, bottom, width2, 1);\n  ctx.textAlign = \"right\";\n  const ellipsis = truncated.at(-1);\n  ctx.fillText(ellipsis, right, bottom, ctx.measureText(ellipsis).width * 0.75);\n}\nclass SlotBase {\n  name;\n  localized_name;\n  label;\n  type;\n  dir;\n  removable;\n  shape;\n  color_off;\n  color_on;\n  locked;\n  nameLocked;\n  widget;\n  _floatingLinks;\n  hasErrors;\n  boundingRect;\n  constructor(name, type, boundingRect) {\n    this.name = name;\n    this.type = type;\n    this.boundingRect = boundingRect ?? new Rectangle();\n  }\n  renderingColor(colorContext) {\n    return this.isConnected ? this.color_on || colorContext.getConnectedColor(this.type) : this.color_off || colorContext.getDisconnectedColor(this.type);\n  }\n}\nclass NodeSlot extends SlotBase {\n  pos;\n  /** The offset from the parent node to the centre point of this slot. */\n  get #centreOffset() {\n    const nodePos = this.node.pos;\n    const { boundingRect } = this;\n    const diameter = boundingRect[3];\n    return getCentre([\n      boundingRect[0] - nodePos[0],\n      boundingRect[1] - nodePos[1],\n      diameter,\n      diameter\n    ]);\n  }\n  #node;\n  get node() {\n    return this.#node;\n  }\n  get highlightColor() {\n    return LiteGraph.NODE_TEXT_HIGHLIGHT_COLOR ?? LiteGraph.NODE_SELECTED_TITLE_COLOR ?? LiteGraph.NODE_TEXT_COLOR;\n  }\n  constructor(slot, node2) {\n    const maybeSubgraphSlot = slot;\n    const { boundingRect, name, type, _listenerController, ...rest } = maybeSubgraphSlot;\n    const rectangle = boundingRect ? Rectangle.ensureRect(boundingRect) : new Rectangle();\n    super(name, type, rectangle);\n    Object.assign(this, rest);\n    this.#node = node2;\n  }\n  /**\n   * The label to display in the UI.\n   */\n  get renderingLabel() {\n    return this.label || this.localized_name || this.name || \"\";\n  }\n  draw(ctx, {\n    colorContext,\n    labelPosition = LabelPosition.Right,\n    lowQuality = false,\n    highlight = false,\n    doStroke = false\n  }) {\n    const originalFillStyle = ctx.fillStyle;\n    const originalStrokeStyle = ctx.strokeStyle;\n    const originalLineWidth = ctx.lineWidth;\n    const labelColor = highlight ? this.highlightColor : LiteGraph.NODE_TEXT_COLOR;\n    const pos = this.#centreOffset;\n    const slot_type = this.type;\n    const slot_shape = slot_type === SlotType.Array ? SlotShape.Grid : this.shape;\n    ctx.beginPath();\n    let doFill = true;\n    ctx.fillStyle = this.renderingColor(colorContext);\n    ctx.lineWidth = 1;\n    if (slot_type === SlotType.Event || slot_shape === SlotShape.Box) {\n      ctx.rect(pos[0] - 6 + 0.5, pos[1] - 5 + 0.5, 14, 10);\n    } else if (slot_shape === SlotShape.Arrow) {\n      ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n      ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n      ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n      ctx.closePath();\n    } else if (slot_shape === SlotShape.Grid) {\n      const gridSize = 3;\n      const cellSize = 2;\n      const spacing = 3;\n      for (let x2 = 0; x2 < gridSize; x2++) {\n        for (let y = 0; y < gridSize; y++) {\n          ctx.rect(\n            pos[0] - 4 + x2 * spacing,\n            pos[1] - 4 + y * spacing,\n            cellSize,\n            cellSize\n          );\n        }\n      }\n      doStroke = false;\n    } else {\n      if (lowQuality) {\n        ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8);\n      } else {\n        let radius;\n        if (slot_shape === SlotShape.HollowCircle) {\n          doFill = false;\n          doStroke = true;\n          ctx.lineWidth = 3;\n          ctx.strokeStyle = ctx.fillStyle;\n          radius = highlight ? 4 : 3;\n        } else {\n          radius = highlight ? 5 : 4;\n        }\n        ctx.arc(pos[0], pos[1], radius, 0, Math.PI * 2);\n      }\n    }\n    if (doFill) ctx.fill();\n    if (!lowQuality && doStroke) ctx.stroke();\n    const hideLabel = lowQuality || this.isWidgetInputSlot;\n    if (!hideLabel) {\n      const text = this.renderingLabel;\n      if (text) {\n        ctx.fillStyle = labelColor;\n        if (labelPosition === LabelPosition.Right) {\n          if (this.dir == LinkDirection.UP) {\n            ctx.fillText(text, pos[0], pos[1] - 10);\n          } else {\n            ctx.fillText(text, pos[0] + 10, pos[1] + 5);\n          }\n        } else {\n          if (this.dir == LinkDirection.DOWN) {\n            ctx.fillText(text, pos[0], pos[1] - 8);\n          } else {\n            ctx.fillText(text, pos[0] - 10, pos[1] + 5);\n          }\n        }\n      }\n    }\n    if (this.hasErrors) {\n      ctx.lineWidth = 2;\n      ctx.strokeStyle = \"red\";\n      ctx.beginPath();\n      ctx.arc(pos[0], pos[1], 12, 0, Math.PI * 2);\n      ctx.stroke();\n    }\n    ctx.fillStyle = originalFillStyle;\n    ctx.strokeStyle = originalStrokeStyle;\n    ctx.lineWidth = originalLineWidth;\n  }\n  drawCollapsed(ctx) {\n    const [x2, y] = this.collapsedPos;\n    const { fillStyle } = ctx;\n    ctx.fillStyle = \"#686\";\n    ctx.beginPath();\n    if (this.type === SlotType.Event || this.shape === RenderShape.BOX) {\n      ctx.rect(x2 - 7 + 0.5, y - 4, 14, 8);\n    } else if (this.shape === RenderShape.ARROW) {\n      const isInput = this instanceof NodeInputSlot;\n      if (isInput) {\n        ctx.moveTo(x2 + 8, y);\n        ctx.lineTo(x2 - 4, y - 4);\n        ctx.lineTo(x2 - 4, y + 4);\n      } else {\n        ctx.moveTo(x2 + 6, y);\n        ctx.lineTo(x2 - 6, y - 4);\n        ctx.lineTo(x2 - 6, y + 4);\n      }\n      ctx.closePath();\n    } else {\n      ctx.arc(x2, y, 4, 0, Math.PI * 2);\n    }\n    ctx.fill();\n    ctx.fillStyle = fillStyle;\n  }\n}\nclass LGraphGroup {\n  static minWidth = 140;\n  static minHeight = 80;\n  static resizeLength = 10;\n  static padding = 4;\n  static defaultColour = \"#335\";\n  id;\n  color;\n  title;\n  font;\n  font_size = LiteGraph.DEFAULT_GROUP_FONT || 24;\n  _bounding = new Float32Array([\n    10,\n    10,\n    LGraphGroup.minWidth,\n    LGraphGroup.minHeight\n  ]);\n  _pos = this._bounding.subarray(0, 2);\n  _size = this._bounding.subarray(2, 4);\n  /** @deprecated See {@link _children} */\n  _nodes = [];\n  _children = /* @__PURE__ */ new Set();\n  graph;\n  flags = {};\n  selected;\n  constructor(title, id) {\n    this.id = id ?? -1;\n    this.title = title || \"Group\";\n    const { pale_blue } = LGraphCanvas.node_colors;\n    this.color = pale_blue ? pale_blue.groupcolor : \"#AAA\";\n  }\n  /** @inheritdoc {@link IColorable.setColorOption} */\n  setColorOption(colorOption) {\n    if (colorOption == null) {\n      delete this.color;\n    } else {\n      this.color = colorOption.groupcolor;\n    }\n  }\n  /** @inheritdoc {@link IColorable.getColorOption} */\n  getColorOption() {\n    return Object.values(LGraphCanvas.node_colors).find(\n      (colorOption) => colorOption.groupcolor === this.color\n    ) ?? null;\n  }\n  /** Position of the group, as x,y co-ordinates in graph space */\n  get pos() {\n    return this._pos;\n  }\n  set pos(v2) {\n    if (!v2 || v2.length < 2) return;\n    this._pos[0] = v2[0];\n    this._pos[1] = v2[1];\n  }\n  /** Size of the group, as width,height in graph units */\n  get size() {\n    return this._size;\n  }\n  set size(v2) {\n    if (!v2 || v2.length < 2) return;\n    this._size[0] = Math.max(LGraphGroup.minWidth, v2[0]);\n    this._size[1] = Math.max(LGraphGroup.minHeight, v2[1]);\n  }\n  get boundingRect() {\n    return this._bounding;\n  }\n  get nodes() {\n    return this._nodes;\n  }\n  get titleHeight() {\n    return this.font_size * 1.4;\n  }\n  get children() {\n    return this._children;\n  }\n  get pinned() {\n    return !!this.flags.pinned;\n  }\n  /**\n   * Prevents the group being accidentally moved or resized by mouse interaction.\n   * Toggles pinned state if no value is provided.\n   */\n  pin(value) {\n    const newState = value === void 0 ? !this.pinned : value;\n    if (newState) this.flags.pinned = true;\n    else delete this.flags.pinned;\n  }\n  unpin() {\n    this.pin(false);\n  }\n  configure(o) {\n    this.id = o.id;\n    this.title = o.title;\n    this._bounding.set(o.bounding);\n    this.color = o.color;\n    this.flags = o.flags || this.flags;\n    if (o.font_size) this.font_size = o.font_size;\n  }\n  serialize() {\n    const b = this._bounding;\n    return {\n      id: this.id,\n      title: this.title,\n      bounding: [...b],\n      color: this.color,\n      font_size: this.font_size,\n      flags: this.flags\n    };\n  }\n  /**\n   * Draws the group on the canvas\n   * @param graphCanvas\n   * @param ctx\n   */\n  draw(graphCanvas, ctx) {\n    const { padding, resizeLength, defaultColour } = LGraphGroup;\n    const font_size = this.font_size || LiteGraph.DEFAULT_GROUP_FONT_SIZE;\n    const [x2, y] = this._pos;\n    const [width2, height] = this._size;\n    const color = this.color || defaultColour;\n    ctx.globalAlpha = 0.25 * graphCanvas.editor_alpha;\n    ctx.fillStyle = color;\n    ctx.strokeStyle = color;\n    ctx.beginPath();\n    ctx.rect(x2 + 0.5, y + 0.5, width2, font_size * 1.4);\n    ctx.fill();\n    ctx.fillStyle = color;\n    ctx.strokeStyle = color;\n    ctx.beginPath();\n    ctx.rect(x2 + 0.5, y + 0.5, width2, height);\n    ctx.fill();\n    ctx.globalAlpha = graphCanvas.editor_alpha;\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(x2 + width2, y + height);\n    ctx.lineTo(x2 + width2 - resizeLength, y + height);\n    ctx.lineTo(x2 + width2, y + height - resizeLength);\n    ctx.fill();\n    ctx.font = `${font_size}px ${LiteGraph.GROUP_FONT}`;\n    ctx.textAlign = \"left\";\n    ctx.fillText(this.title + (this.pinned ? \"📌\" : \"\"), x2 + padding, y + font_size);\n    if (LiteGraph.highlight_selected_group && this.selected) {\n      strokeShape(ctx, this._bounding, {\n        title_height: this.titleHeight,\n        padding\n      });\n    }\n  }\n  resize(width2, height) {\n    if (this.pinned) return false;\n    this._size[0] = Math.max(LGraphGroup.minWidth, width2);\n    this._size[1] = Math.max(LGraphGroup.minHeight, height);\n    return true;\n  }\n  move(deltaX, deltaY, skipChildren = false) {\n    if (this.pinned) return;\n    this._pos[0] += deltaX;\n    this._pos[1] += deltaY;\n    if (skipChildren === true) return;\n    for (const item of this._children) {\n      item.move(deltaX, deltaY);\n    }\n  }\n  /** @inheritdoc */\n  snapToGrid(snapTo) {\n    return this.pinned ? false : snapPoint(this.pos, snapTo);\n  }\n  recomputeInsideNodes() {\n    if (!this.graph) throw new NullGraphError();\n    const { nodes, reroutes, groups } = this.graph;\n    const children = this._children;\n    this._nodes.length = 0;\n    children.clear();\n    for (const node2 of nodes) {\n      if (containsCentre(this._bounding, node2.boundingRect)) {\n        this._nodes.push(node2);\n        children.add(node2);\n      }\n    }\n    for (const reroute of reroutes.values()) {\n      if (isPointInRect(reroute.pos, this._bounding))\n        children.add(reroute);\n    }\n    for (const group of groups) {\n      if (containsRect(this._bounding, group._bounding))\n        children.add(group);\n    }\n    groups.sort((a, b) => {\n      if (a === this) {\n        return children.has(b) ? -1 : 0;\n      } else if (b === this) {\n        return children.has(a) ? 1 : 0;\n      } else {\n        return 0;\n      }\n    });\n  }\n  /**\n   * Resizes and moves the group to neatly fit all given {@link objects}.\n   * @param objects All objects that should be inside the group\n   * @param padding Value in graph units to add to all sides of the group.  Default: 10\n   */\n  resizeTo(objects, padding = 10) {\n    const boundingBox = createBounds(objects, padding);\n    if (boundingBox === null) return;\n    this.pos[0] = boundingBox[0];\n    this.pos[1] = boundingBox[1] - this.titleHeight;\n    this.size[0] = boundingBox[2];\n    this.size[1] = boundingBox[3] + this.titleHeight;\n  }\n  /**\n   * Add nodes to the group and adjust the group's position and size accordingly\n   * @param nodes The nodes to add to the group\n   * @param padding The padding around the group\n   */\n  addNodes(nodes, padding = 10) {\n    if (!this._nodes && nodes.length === 0) return;\n    this.resizeTo([...this.children, ...this._nodes, ...nodes], padding);\n  }\n  getMenuOptions() {\n    return [\n      {\n        content: this.pinned ? \"Unpin\" : \"Pin\",\n        callback: () => {\n          if (this.pinned) this.unpin();\n          else this.pin();\n          this.setDirtyCanvas(false, true);\n        }\n      },\n      null,\n      { content: \"Title\", callback: LGraphCanvas.onShowPropertyEditor },\n      {\n        content: \"Color\",\n        has_submenu: true,\n        callback: LGraphCanvas.onMenuNodeColors\n      },\n      {\n        content: \"Font size\",\n        property: \"font_size\",\n        type: \"Number\",\n        callback: LGraphCanvas.onShowPropertyEditor\n      },\n      null,\n      { content: \"Remove\", callback: LGraphCanvas.onMenuNodeRemove }\n    ];\n  }\n  isPointInTitlebar(x2, y) {\n    const b = this.boundingRect;\n    return isInRectangle(x2, y, b[0], b[1], b[2], this.titleHeight);\n  }\n  isInResize(x2, y) {\n    const b = this.boundingRect;\n    const right = b[0] + b[2];\n    const bottom = b[1] + b[3];\n    return x2 < right && y < bottom && x2 - right + (y - bottom) > -LGraphGroup.resizeLength;\n  }\n  isPointInside = LGraphNode.prototype.isPointInside;\n  setDirtyCanvas = LGraphNode.prototype.setDirtyCanvas;\n}\nclass Reroute {\n  /**\n   * Initialises a new link reroute object.\n   * @param id Unique identifier for this reroute\n   * @param network The network of links this reroute belongs to.  Internally converted to a WeakRef.\n   * @param pos Position in graph coordinates\n   * @param linkIds Link IDs ({@link LLink.id}) of all links that use this reroute\n   */\n  constructor(id, network, pos, parentId, linkIds, floatingLinkIds) {\n    this.id = id;\n    this.#network = new WeakRef(network);\n    this.parentId = parentId;\n    if (pos) this.pos = pos;\n    this.linkIds = new Set(linkIds);\n    this.floatingLinkIds = new Set(floatingLinkIds);\n  }\n  static radius = 10;\n  /** Maximum distance from reroutes to their bezier curve control points. */\n  static maxSplineOffset = 80;\n  static drawIdBadge = false;\n  static slotRadius = 5;\n  /** Distance from reroute centre to slot centre. */\n  static get slotOffset() {\n    const gap = Reroute.slotRadius * 0.33;\n    return Reroute.radius + gap + Reroute.slotRadius;\n  }\n  #malloc = new Float32Array(8);\n  /** The network this reroute belongs to.  Contains all valid links and reroutes. */\n  #network;\n  #parentId;\n  get parentId() {\n    return this.#parentId;\n  }\n  /** Ignores attempts to create an infinite loop. @inheritdoc */\n  set parentId(value) {\n    if (value === this.id) return;\n    if (this.getReroutes() === null) return;\n    this.#parentId = value;\n  }\n  get parent() {\n    return this.#network.deref()?.getReroute(this.#parentId);\n  }\n  /** This property is only defined on the last reroute of a floating reroute chain (closest to input end). */\n  floating;\n  #pos = this.#malloc.subarray(0, 2);\n  /** @inheritdoc */\n  get pos() {\n    return this.#pos;\n  }\n  set pos(value) {\n    if (!(value?.length >= 2))\n      throw new TypeError(\"Reroute.pos is an x,y point, and expects an indexable with at least two values.\");\n    this.#pos[0] = value[0];\n    this.#pos[1] = value[1];\n  }\n  /** @inheritdoc */\n  get boundingRect() {\n    const { radius } = Reroute;\n    const [x2, y] = this.#pos;\n    return [x2 - radius, y - radius, 2 * radius, 2 * radius];\n  }\n  /**\n   * Slightly over-sized rectangle, guaranteed to contain the entire surface area for hover detection.\n   * Eliminates most hover positions using an extremely cheap check.\n   */\n  get #hoverArea() {\n    const xOffset = 2 * Reroute.slotOffset;\n    const yOffset = 2 * Math.max(Reroute.radius, Reroute.slotRadius);\n    const [x2, y] = this.#pos;\n    return [x2 - xOffset, y - yOffset, 2 * xOffset, 2 * yOffset];\n  }\n  /** The total number of links & floating links using this reroute */\n  get totalLinks() {\n    return this.linkIds.size + this.floatingLinkIds.size;\n  }\n  /** @inheritdoc */\n  selected;\n  /** The ID ({@link LLink.id}) of every link using this reroute */\n  linkIds;\n  /** The ID ({@link LLink.id}) of every floating link using this reroute */\n  floatingLinkIds;\n  /** Cached cos */\n  cos = 0;\n  sin = 0;\n  /** Bezier curve control point for the \"target\" (input) side of the link */\n  controlPoint = this.#malloc.subarray(4, 6);\n  /** @inheritdoc */\n  path;\n  /** @inheritdoc */\n  _centreAngle;\n  /** @inheritdoc */\n  _pos = this.#malloc.subarray(6, 8);\n  /** @inheritdoc */\n  _dragging;\n  /** Colour of the first link that rendered this reroute */\n  _colour;\n  /** Colour of the first link that rendered this reroute */\n  get colour() {\n    return this._colour ?? \"#18184d\";\n  }\n  /**\n   * Used to ensure reroute angles are only executed once per frame.\n   * @todo Calculate on change instead.\n   */\n  #lastRenderTime = -Infinity;\n  #inputSlot = new RerouteSlot(this, true);\n  #outputSlot = new RerouteSlot(this, false);\n  get isSlotHovered() {\n    return this.isInputHovered || this.isOutputHovered;\n  }\n  get isInputHovered() {\n    return this.#inputSlot.hovering;\n  }\n  get isOutputHovered() {\n    return this.#outputSlot.hovering;\n  }\n  get firstLink() {\n    const linkId = this.linkIds.values().next().value;\n    return linkId === void 0 ? void 0 : this.#network.deref()?.links.get(linkId);\n  }\n  get firstFloatingLink() {\n    const linkId = this.floatingLinkIds.values().next().value;\n    return linkId === void 0 ? void 0 : this.#network.deref()?.floatingLinks.get(linkId);\n  }\n  /** @inheritdoc */\n  get origin_id() {\n    return this.firstLink?.origin_id;\n  }\n  /** @inheritdoc */\n  get origin_slot() {\n    return this.firstLink?.origin_slot;\n  }\n  /**\n   * Applies a new parentId to the reroute, and optinoally a new position and linkId.\n   * Primarily used for deserialisation.\n   * @param parentId The ID of the reroute prior to this reroute, or\n   * `undefined` if it is the first reroute connected to a nodes output\n   * @param pos The position of this reroute\n   * @param linkIds All link IDs that pass through this reroute\n   */\n  update(parentId, pos, linkIds, floating) {\n    this.parentId = parentId;\n    if (pos) this.pos = pos;\n    if (linkIds) this.linkIds = new Set(linkIds);\n    this.floating = floating;\n  }\n  /**\n   * Validates the linkIds this reroute has.  Removes broken links.\n   * @param links Collection of valid links\n   * @returns true if any links remain after validation\n   */\n  validateLinks(links, floatingLinks) {\n    const { linkIds, floatingLinkIds } = this;\n    for (const linkId of linkIds) {\n      if (!links.has(linkId)) linkIds.delete(linkId);\n    }\n    for (const linkId of floatingLinkIds) {\n      if (!floatingLinks.has(linkId)) floatingLinkIds.delete(linkId);\n    }\n    return linkIds.size > 0 || floatingLinkIds.size > 0;\n  }\n  /**\n   * Retrieves an ordered array of all reroutes from the node output.\n   * @param visited Internal.  A set of reroutes that this function\n   * has already visited whilst recursing up the chain.\n   * @returns An ordered array of all reroutes from the node output to this reroute, inclusive.\n   * `null` if an infinite loop is detected.\n   * `undefined` if the reroute chain or {@link LinkNetwork} are invalid.\n   */\n  getReroutes(visited = /* @__PURE__ */ new Set()) {\n    if (this.#parentId === void 0) return [this];\n    if (visited.has(this)) return null;\n    visited.add(this);\n    const parent = this.#network.deref()?.reroutes.get(this.#parentId);\n    if (!parent) {\n      this.#parentId = void 0;\n      return [this];\n    }\n    const reroutes = parent.getReroutes(visited);\n    reroutes?.push(this);\n    return reroutes;\n  }\n  /**\n   * Internal.  Called by {@link LLink.findNextReroute}.  Not intended for use by itself.\n   * @param withParentId The rerouteId to look for\n   * @param visited A set of reroutes that have already been visited\n   * @returns The reroute that was found, `undefined` if no reroute was found, or `null` if an infinite loop was detected.\n   */\n  findNextReroute(withParentId, visited = /* @__PURE__ */ new Set()) {\n    if (this.#parentId === withParentId) return this;\n    if (visited.has(this)) return null;\n    visited.add(this);\n    if (this.#parentId === void 0) return;\n    return this.#network.deref()?.reroutes.get(this.#parentId)?.findNextReroute(withParentId, visited);\n  }\n  /**\n   * Finds the output node and output slot of the first link passing through this reroute.\n   * @returns The output node and output slot of the first link passing through this reroute, or `undefined` if no link is found.\n   */\n  findSourceOutput() {\n    const link = this.firstLink ?? this.firstFloatingLink;\n    if (!link) return;\n    const node2 = this.#network.deref()?.getNodeById(link.origin_id);\n    if (!node2) return;\n    return {\n      node: node2,\n      output: node2.outputs[link.origin_slot]\n    };\n  }\n  /**\n   * Finds the inputs and nodes of (floating) links passing through this reroute.\n   * @returns An array of objects containing the node and input slot of each link passing through this reroute.\n   */\n  findTargetInputs() {\n    const network = this.#network.deref();\n    if (!network) return;\n    const results = [];\n    addAllResults(network, this.linkIds, network.links);\n    addAllResults(network, this.floatingLinkIds, network.floatingLinks);\n    return results;\n    function addAllResults(network2, linkIds, links) {\n      for (const linkId of linkIds) {\n        const link = links.get(linkId);\n        if (!link) continue;\n        const node2 = network2.getNodeById(link.target_id);\n        const input = node2?.inputs[link.target_slot];\n        if (!input) continue;\n        results.push({ node: node2, input, link });\n      }\n    }\n  }\n  /**\n   * Retrieves all floating links passing through this reroute.\n   * @param from Filters the links by the currently connected link side.\n   * @returns An array of floating links\n   */\n  getFloatingLinks(from) {\n    const floatingLinks = this.#network.deref()?.floatingLinks;\n    if (!floatingLinks) return;\n    const idProp = from === \"input\" ? \"origin_id\" : \"target_id\";\n    const out = [];\n    for (const linkId of this.floatingLinkIds) {\n      const link = floatingLinks.get(linkId);\n      if (link?.[idProp] === -1) out.push(link);\n    }\n    return out;\n  }\n  /**\n   * Changes the origin node/output of all floating links that pass through this reroute.\n   * @param node The new origin node\n   * @param output The new origin output slot\n   * @param index The slot index of {@link output}\n   */\n  setFloatingLinkOrigin(node2, output, index) {\n    const network = this.#network.deref();\n    const floatingOutLinks = this.getFloatingLinks(\"output\");\n    if (!floatingOutLinks) throw new Error(\"[setFloatingLinkOrigin]: Invalid network.\");\n    if (!floatingOutLinks.length) return;\n    output._floatingLinks ??= /* @__PURE__ */ new Set();\n    for (const link of floatingOutLinks) {\n      output._floatingLinks.add(link);\n      network?.getNodeById(link.origin_id)?.outputs[link.origin_slot]?._floatingLinks?.delete(link);\n      link.origin_id = node2.id;\n      link.origin_slot = index;\n    }\n  }\n  /** @inheritdoc */\n  move(deltaX, deltaY) {\n    this.#pos[0] += deltaX;\n    this.#pos[1] += deltaY;\n  }\n  /** @inheritdoc */\n  snapToGrid(snapTo) {\n    if (!snapTo) return false;\n    const { pos } = this;\n    pos[0] = snapTo * Math.round(pos[0] / snapTo);\n    pos[1] = snapTo * Math.round(pos[1] / snapTo);\n    return true;\n  }\n  removeAllFloatingLinks() {\n    for (const linkId of this.floatingLinkIds) {\n      this.removeFloatingLink(linkId);\n    }\n  }\n  removeFloatingLink(linkId) {\n    const network = this.#network.deref();\n    if (!network) return;\n    const floatingLink = network.floatingLinks.get(linkId);\n    if (!floatingLink) {\n      console.warn(`[Reroute.removeFloatingLink] Floating link not found: ${linkId}, ignoring and discarding ID.`);\n      this.floatingLinkIds.delete(linkId);\n      return;\n    }\n    network.removeFloatingLink(floatingLink);\n  }\n  /**\n   * Removes a link or floating link from this reroute, by matching link object instance equality.\n   * @param link The link to remove.\n   * @remarks Does not remove the link from the network.\n   */\n  removeLink(link) {\n    const network = this.#network.deref();\n    if (!network) return;\n    const floatingLink = network.floatingLinks.get(link.id);\n    if (link === floatingLink) {\n      this.floatingLinkIds.delete(link.id);\n    } else {\n      this.linkIds.delete(link.id);\n    }\n  }\n  remove() {\n    const network = this.#network.deref();\n    if (!network) return;\n    network.removeReroute(this.id);\n  }\n  calculateAngle(lastRenderTime, network, linkStart) {\n    if (!(lastRenderTime > this.#lastRenderTime)) return;\n    this.#lastRenderTime = lastRenderTime;\n    const { id, pos: thisPos } = this;\n    const angles = [];\n    let sum = 0;\n    calculateAngles(this.linkIds, network.links);\n    calculateAngles(this.floatingLinkIds, network.floatingLinks);\n    if (!angles.length) {\n      this.cos = 0;\n      this.sin = 0;\n      this.controlPoint[0] = 0;\n      this.controlPoint[1] = 0;\n      return;\n    }\n    sum /= angles.length;\n    const originToReroute = Math.atan2(\n      this.#pos[1] - linkStart[1],\n      this.#pos[0] - linkStart[0]\n    );\n    let diff = (originToReroute - sum) * 0.5;\n    if (Math.abs(diff) > Math.PI * 0.5) diff += Math.PI;\n    const dist = Math.min(Reroute.maxSplineOffset, distance(linkStart, this.#pos) * 0.25);\n    const originDiff = originToReroute - diff;\n    const cos = Math.cos(originDiff);\n    const sin = Math.sin(originDiff);\n    this.cos = cos;\n    this.sin = sin;\n    this.controlPoint[0] = dist * -cos;\n    this.controlPoint[1] = dist * -sin;\n    function calculateAngles(linkIds, links) {\n      for (const linkId of linkIds) {\n        const link = links.get(linkId);\n        const pos = getNextPos(network, link, id);\n        if (!pos) continue;\n        const angle = getDirection(thisPos, pos);\n        angles.push(angle);\n        sum += angle;\n      }\n    }\n  }\n  /**\n   * Renders the reroute on the canvas.\n   * @param ctx Canvas context to draw on\n   * @param backgroundPattern The canvas background pattern; used to make floating reroutes appear washed out.\n   * @remarks Leaves {@link ctx}.fillStyle, strokeStyle, and lineWidth dirty (perf.).\n   */\n  draw(ctx, backgroundPattern) {\n    const { globalAlpha } = ctx;\n    const { pos } = this;\n    ctx.beginPath();\n    ctx.arc(pos[0], pos[1], Reroute.radius, 0, 2 * Math.PI);\n    if (this.linkIds.size === 0) {\n      ctx.fillStyle = backgroundPattern ?? \"#797979\";\n      ctx.fill();\n      ctx.globalAlpha = globalAlpha * 0.33;\n    }\n    ctx.fillStyle = this.colour;\n    ctx.lineWidth = Reroute.radius * 0.1;\n    ctx.strokeStyle = \"rgb(0,0,0,0.5)\";\n    ctx.fill();\n    ctx.stroke();\n    ctx.fillStyle = \"#ffffff55\";\n    ctx.strokeStyle = \"rgb(0,0,0,0.3)\";\n    ctx.beginPath();\n    ctx.arc(pos[0], pos[1], Reroute.radius * 0.8, 0, 2 * Math.PI);\n    ctx.fill();\n    ctx.stroke();\n    if (this.selected) {\n      ctx.strokeStyle = \"#fff\";\n      ctx.beginPath();\n      ctx.arc(pos[0], pos[1], Reroute.radius * 1.2, 0, 2 * Math.PI);\n      ctx.stroke();\n    }\n    if (Reroute.drawIdBadge) {\n      const idBadge = new LGraphBadge({ text: this.id.toString() });\n      const x2 = pos[0] - idBadge.getWidth(ctx) * 0.5;\n      const y = pos[1] - idBadge.height - Reroute.radius - 2;\n      idBadge.draw(ctx, x2, y);\n    }\n    ctx.globalAlpha = globalAlpha;\n  }\n  /**\n   * Draws the input and output slots on the canvas, if the slots are visible.\n   * @param ctx The canvas context to draw on.\n   */\n  drawSlots(ctx) {\n    this.#inputSlot.draw(ctx);\n    this.#outputSlot.draw(ctx);\n  }\n  drawHighlight(ctx, colour) {\n    const { pos } = this;\n    const { strokeStyle, lineWidth } = ctx;\n    ctx.strokeStyle = colour;\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.arc(pos[0], pos[1], Reroute.radius * 1.5, 0, 2 * Math.PI);\n    ctx.stroke();\n    ctx.strokeStyle = strokeStyle;\n    ctx.lineWidth = lineWidth;\n  }\n  /**\n   * Updates visibility of the input and output slots, based on the position of the pointer.\n   * @param pos The position of the pointer.\n   * @returns `true` if any changes require a redraw.\n   */\n  updateVisibility(pos) {\n    const input = this.#inputSlot;\n    const output = this.#outputSlot;\n    input.dirty = false;\n    output.dirty = false;\n    const { firstFloatingLink } = this;\n    const hasLink = !!this.firstLink;\n    const showInput = hasLink || firstFloatingLink?.isFloatingOutput;\n    const showOutput = hasLink || firstFloatingLink?.isFloatingInput;\n    const showEither = showInput || showOutput;\n    if (showEither && isPointInRect(pos, this.#hoverArea)) {\n      const outlineOnly = this.#contains(pos);\n      if (showInput) input.update(pos, outlineOnly);\n      if (showOutput) output.update(pos, outlineOnly);\n    } else {\n      this.hideSlots();\n    }\n    return input.dirty || output.dirty;\n  }\n  /** Prevents rendering of the input and output slots. */\n  hideSlots() {\n    this.#inputSlot.hide();\n    this.#outputSlot.hide();\n  }\n  /**\n   * Precisely determines if {@link pos} is inside this reroute.\n   * @param pos The position to check (canvas space)\n   * @returns `true` if {@link pos} is within the reroute's radius.\n   */\n  containsPoint(pos) {\n    return isPointInRect(pos, this.#hoverArea) && this.#contains(pos);\n  }\n  #contains(pos) {\n    return distance(this.pos, pos) <= Reroute.radius;\n  }\n  /** @inheritdoc */\n  asSerialisable() {\n    const { id, parentId, pos, linkIds } = this;\n    return {\n      id,\n      parentId,\n      pos: [pos[0], pos[1]],\n      linkIds: [...linkIds],\n      floating: this.floating ? { slotType: this.floating.slotType } : void 0\n    };\n  }\n}\nclass RerouteSlot {\n  /** The reroute that the slot belongs to. */\n  #reroute;\n  #offsetMultiplier;\n  /** Centre point of this slot. */\n  get pos() {\n    const [x2, y] = this.#reroute.pos;\n    return [x2 + Reroute.slotOffset * this.#offsetMultiplier, y];\n  }\n  /** Whether any changes require a redraw. */\n  dirty = false;\n  #hovering = false;\n  /** Whether the pointer is hovering over the slot itself. */\n  get hovering() {\n    return this.#hovering;\n  }\n  set hovering(value) {\n    if (!Object.is(this.#hovering, value)) {\n      this.#hovering = value;\n      this.dirty = true;\n    }\n  }\n  #showOutline = false;\n  /** Whether the slot outline / faint background is visible. */\n  get showOutline() {\n    return this.#showOutline;\n  }\n  set showOutline(value) {\n    if (!Object.is(this.#showOutline, value)) {\n      this.#showOutline = value;\n      this.dirty = true;\n    }\n  }\n  constructor(reroute, isInput) {\n    this.#reroute = reroute;\n    this.#offsetMultiplier = isInput ? -1 : 1;\n  }\n  /**\n   * Updates the slot's visibility based on the position of the pointer.\n   * @param pos The position of the pointer.\n   * @param outlineOnly If `true`, slot will display with the faded outline only ({@link showOutline}).\n   */\n  update(pos, outlineOnly) {\n    if (outlineOnly) {\n      this.hovering = false;\n      this.showOutline = true;\n    } else {\n      const dist = distance(this.pos, pos);\n      this.hovering = dist <= 2 * Reroute.slotRadius;\n      this.showOutline = dist <= 5 * Reroute.slotRadius;\n    }\n  }\n  /** Hides the slot. */\n  hide() {\n    this.hovering = false;\n    this.showOutline = false;\n  }\n  /**\n   * Draws the slot on the canvas.\n   * @param ctx The canvas context to draw on.\n   */\n  draw(ctx) {\n    const { fillStyle, strokeStyle, lineWidth } = ctx;\n    const { showOutline, hovering, pos: [x2, y] } = this;\n    if (!showOutline) return;\n    try {\n      ctx.fillStyle = hovering ? this.#reroute.colour : \"rgba(127,127,127,0.3)\";\n      ctx.strokeStyle = \"rgb(0,0,0,0.5)\";\n      ctx.lineWidth = 1;\n      ctx.beginPath();\n      ctx.arc(x2, y, Reroute.slotRadius, 0, 2 * Math.PI);\n      ctx.fill();\n      ctx.stroke();\n    } finally {\n      ctx.fillStyle = fillStyle;\n      ctx.strokeStyle = strokeStyle;\n      ctx.lineWidth = lineWidth;\n    }\n  }\n}\nfunction getNextPos(network, link, id) {\n  if (!link) return;\n  const linkPos = LLink.findNextReroute(network, link, id)?.pos;\n  if (linkPos) return linkPos;\n  if (link.target_id === -1 || link.target_slot === -1) return;\n  return network.getNodeById(link.target_id)?.getInputPos(link.target_slot);\n}\nfunction getDirection(fromPos, toPos) {\n  return Math.atan2(toPos[1] - fromPos[1], toPos[0] - fromPos[0]);\n}\nfunction stringOrEmpty(value) {\n  return value == null ? \"\" : String(value);\n}\nfunction parseSlotTypes(type) {\n  return type == \"\" || type == \"0\" ? [\"*\"] : String(type).toLowerCase().split(\",\");\n}\nfunction nextUniqueName(name, existingNames = []) {\n  let i = 1;\n  const baseName = name;\n  while (existingNames.includes(name)) {\n    name = `${baseName}_${i++}`;\n  }\n  return name;\n}\nclass ConstrainedSize {\n  #width = 0;\n  #height = 0;\n  #desiredWidth = 0;\n  #desiredHeight = 0;\n  minWidth = 0;\n  minHeight = 0;\n  maxWidth = Infinity;\n  maxHeight = Infinity;\n  get width() {\n    return this.#width;\n  }\n  get height() {\n    return this.#height;\n  }\n  get desiredWidth() {\n    return this.#desiredWidth;\n  }\n  set desiredWidth(value) {\n    this.#desiredWidth = value;\n    this.#width = clamp(value, this.minWidth, this.maxWidth);\n  }\n  get desiredHeight() {\n    return this.#desiredHeight;\n  }\n  set desiredHeight(value) {\n    this.#desiredHeight = value;\n    this.#height = clamp(value, this.minHeight, this.maxHeight);\n  }\n  constructor(width2, height) {\n    this.desiredWidth = width2;\n    this.desiredHeight = height;\n  }\n  static fromSize(size) {\n    return new ConstrainedSize(size[0], size[1]);\n  }\n  static fromRect(rect) {\n    return new ConstrainedSize(rect[2], rect[3]);\n  }\n  setSize(size) {\n    this.desiredWidth = size[0];\n    this.desiredHeight = size[1];\n  }\n  setValues(width2, height) {\n    this.desiredWidth = width2;\n    this.desiredHeight = height;\n  }\n  toSize() {\n    return [this.#width, this.#height];\n  }\n}\nclass SubgraphSlot extends SlotBase {\n  static get defaultHeight() {\n    return LiteGraph.NODE_SLOT_HEIGHT;\n  }\n  #pos = new Float32Array(2);\n  measurement = new ConstrainedSize(SubgraphSlot.defaultHeight, SubgraphSlot.defaultHeight);\n  id;\n  parent;\n  type;\n  linkIds = [];\n  boundingRect = new Rectangle(0, 0, 0, SubgraphSlot.defaultHeight);\n  get pos() {\n    return this.#pos;\n  }\n  set pos(value) {\n    if (!value || value.length < 2) return;\n    this.#pos[0] = value[0];\n    this.#pos[1] = value[1];\n  }\n  /** Whether this slot is connected to another slot. */\n  get isConnected() {\n    return this.linkIds.length > 0;\n  }\n  /** The display name of this slot. */\n  get displayName() {\n    return this.label ?? this.localized_name ?? this.name;\n  }\n  constructor(slot, parent) {\n    super(slot.name, slot.type);\n    Object.assign(this, slot);\n    this.id = slot.id ?? createUuidv4();\n    this.type = slot.type;\n    this.parent = parent;\n  }\n  isPointerOver = false;\n  containsPoint(point) {\n    return this.boundingRect.containsPoint(point);\n  }\n  onPointerMove(e2) {\n    this.isPointerOver = this.boundingRect.containsXy(e2.canvasX, e2.canvasY);\n  }\n  getLinks() {\n    const links = [];\n    const { subgraph } = this.parent;\n    for (const id of this.linkIds) {\n      const link = subgraph.getLink(id);\n      if (link) links.push(link);\n    }\n    return links;\n  }\n  decrementSlots(inputsOrOutputs) {\n    const { links } = this.parent.subgraph;\n    const linkProperty = inputsOrOutputs === \"inputs\" ? \"origin_slot\" : \"target_slot\";\n    for (const linkId of this.linkIds) {\n      const link = links.get(linkId);\n      if (link) link[linkProperty]--;\n      else console.warn(\"decrementSlots: link ID not found\", linkId);\n    }\n  }\n  measure() {\n    const width2 = LGraphCanvas._measureText?.(this.displayName) ?? 0;\n    const { defaultHeight } = SubgraphSlot;\n    this.measurement.setValues(width2 + defaultHeight, defaultHeight);\n    return this.measurement.toSize();\n  }\n  /**\n   * Disconnects all links connected to this slot.\n   */\n  disconnect() {\n    const { subgraph } = this.parent;\n    for (const linkId of this.linkIds) {\n      subgraph.removeLink(linkId);\n    }\n    this.linkIds.length = 0;\n  }\n  /** @remarks Leaves the context dirty. */\n  draw({ ctx, colorContext, lowQuality, fromSlot, editorAlpha = 1 }) {\n    const shape = this.shape;\n    const { isPointerOver, pos: [x2, y] } = this;\n    const isValidTarget = fromSlot ? this.isValidTarget(fromSlot) : true;\n    const isValid = !fromSlot || isValidTarget;\n    const highlight = isValid && isPointerOver;\n    const previousAlpha = ctx.globalAlpha;\n    ctx.globalAlpha = isValid ? editorAlpha : 0.4 * editorAlpha;\n    ctx.beginPath();\n    const color = this.renderingColor(colorContext);\n    if (lowQuality) {\n      ctx.fillStyle = color;\n      ctx.rect(x2 - 4, y - 4, 8, 8);\n      ctx.fill();\n    } else if (shape === SlotShape.HollowCircle) {\n      ctx.lineWidth = 3;\n      ctx.strokeStyle = color;\n      const radius = highlight ? 4 : 3;\n      ctx.arc(x2, y, radius, 0, Math.PI * 2);\n      ctx.stroke();\n    } else {\n      ctx.fillStyle = color;\n      const radius = highlight ? 5 : 4;\n      ctx.arc(x2, y, radius, 0, Math.PI * 2);\n      ctx.fill();\n    }\n    if (this.displayName) {\n      const [labelX, labelY] = this.labelPos;\n      ctx.fillStyle = highlight ? \"white\" : LiteGraph.NODE_TEXT_COLOR || \"#AAA\";\n      ctx.fillText(this.displayName, labelX, labelY);\n    }\n    ctx.globalAlpha = previousAlpha;\n  }\n  asSerialisable() {\n    const { id, name, type, linkIds, localized_name, label, dir, shape, color_off, color_on, pos } = this;\n    return { id, name, type, linkIds, localized_name, label, dir, shape, color_off, color_on, pos };\n  }\n}\nclass SubgraphOutput extends SubgraphSlot {\n  connect(slot, node2, afterRerouteId) {\n    const { subgraph } = this.parent;\n    if (!LiteGraph.isValidConnection(slot.type, this.type)) return;\n    const outputIndex = node2.outputs.indexOf(slot);\n    if (outputIndex === -1) throw new Error(\"Slot is not an output of the given node\");\n    if (node2.onConnectOutput?.(outputIndex, this.type, this, this.parent, -1) === false) return;\n    const existingLink = this.getLinks().at(0);\n    if (existingLink != null) {\n      subgraph.beforeChange();\n      existingLink.disconnect(subgraph, \"input\");\n      const resolved = existingLink.resolve(subgraph);\n      const links = resolved.output?.links;\n      if (links) removeFromArray(links, existingLink.id);\n    }\n    const link = new LLink(\n      ++subgraph.state.lastLinkId,\n      slot.type,\n      node2.id,\n      outputIndex,\n      this.parent.id,\n      this.parent.slots.indexOf(this),\n      afterRerouteId\n    );\n    subgraph._links.set(link.id, link);\n    this.linkIds[0] = link.id;\n    slot.links ??= [];\n    slot.links.push(link.id);\n    const reroutes = LLink.getReroutes(subgraph, link);\n    for (const reroute of reroutes) {\n      reroute.linkIds.add(link.id);\n      if (reroute.floating) delete reroute.floating;\n      reroute._dragging = void 0;\n    }\n    const lastReroute = reroutes.at(-1);\n    if (lastReroute) {\n      for (const linkId of lastReroute.floatingLinkIds) {\n        const link2 = subgraph.floatingLinks.get(linkId);\n        if (link2?.parentId === lastReroute.id) {\n          subgraph.removeFloatingLink(link2);\n        }\n      }\n    }\n    subgraph._version++;\n    node2.onConnectionsChange?.(\n      NodeSlotType.OUTPUT,\n      outputIndex,\n      true,\n      link,\n      slot\n    );\n    subgraph.afterChange();\n    return link;\n  }\n  get labelPos() {\n    const [x2, y, , height] = this.boundingRect;\n    return [x2 + height, y + height * 0.5];\n  }\n  arrange(rect) {\n    const [left, top, width2, height] = rect;\n    const { boundingRect: b, pos } = this;\n    b[0] = left;\n    b[1] = top;\n    b[2] = width2;\n    b[3] = height;\n    pos[0] = left + height * 0.5;\n    pos[1] = top + height * 0.5;\n  }\n  /**\n   * Checks if this slot is a valid target for a connection from the given slot.\n   * For SubgraphOutput (which acts as an input inside the subgraph),\n   * the fromSlot should be an output slot.\n   */\n  isValidTarget(fromSlot) {\n    if (isNodeSlot(fromSlot)) {\n      return \"links\" in fromSlot && LiteGraph.isValidConnection(fromSlot.type, this.type);\n    }\n    if (isSubgraphInput(fromSlot)) {\n      return LiteGraph.isValidConnection(fromSlot.type, this.type);\n    }\n    return false;\n  }\n}\nclass EmptySubgraphOutput extends SubgraphOutput {\n  constructor(parent) {\n    super({\n      id: zeroUuid,\n      name: \"\",\n      type: \"\"\n    }, parent);\n  }\n  connect(slot, node2, afterRerouteId) {\n    const { subgraph } = this.parent;\n    const existingNames = subgraph.outputs.map((x2) => x2.name);\n    const name = nextUniqueName(slot.name, existingNames);\n    const output = subgraph.addOutput(name, String(slot.type));\n    return output.connect(slot, node2, afterRerouteId);\n  }\n  get labelPos() {\n    const [x2, y, , height] = this.boundingRect;\n    return [x2, y + height * 0.5];\n  }\n}\nclass SubgraphIONodeBase {\n  constructor(subgraph) {\n    this.subgraph = subgraph;\n  }\n  static margin = 10;\n  static minWidth = 100;\n  static roundedRadius = 10;\n  #boundingRect = new Rectangle();\n  get boundingRect() {\n    return this.#boundingRect;\n  }\n  selected = false;\n  pinned = false;\n  removable = false;\n  isPointerOver = false;\n  get pos() {\n    return this.boundingRect.pos;\n  }\n  set pos(value) {\n    this.boundingRect.pos = value;\n  }\n  get size() {\n    return this.boundingRect.size;\n  }\n  set size(value) {\n    this.boundingRect.size = value;\n  }\n  get sideLineWidth() {\n    return this.isPointerOver ? 2.5 : 2;\n  }\n  get sideStrokeStyle() {\n    return this.isPointerOver ? \"white\" : \"#efefef\";\n  }\n  move(deltaX, deltaY) {\n    this.pos[0] += deltaX;\n    this.pos[1] += deltaY;\n  }\n  /** @inheritdoc */\n  snapToGrid(snapTo) {\n    return this.pinned ? false : snapPoint(this.pos, snapTo);\n  }\n  // #region Hoverable\n  containsPoint(point) {\n    return this.boundingRect.containsPoint(point);\n  }\n  onPointerMove(e2) {\n    const containsPoint = this.boundingRect.containsXy(e2.canvasX, e2.canvasY);\n    let underPointer = containsPoint ? CanvasItem.SubgraphIoNode : CanvasItem.Nothing;\n    if (containsPoint) {\n      if (!this.isPointerOver) this.onPointerEnter();\n      for (const slot of this.allSlots) {\n        slot.onPointerMove(e2);\n        if (slot.isPointerOver) underPointer |= CanvasItem.SubgraphIoSlot;\n      }\n    } else if (this.isPointerOver) {\n      this.onPointerLeave();\n    }\n    return underPointer;\n  }\n  onPointerEnter() {\n    this.isPointerOver = true;\n  }\n  onPointerLeave() {\n    this.isPointerOver = false;\n    for (const slot of this.slots) {\n      slot.isPointerOver = false;\n    }\n  }\n  /**\n   * Gets the slot at a given position in canvas space.\n   * @param x The x coordinate of the position.\n   * @param y The y coordinate of the position.\n   * @returns The slot at the given position, otherwise `undefined`.\n   */\n  getSlotInPosition(x2, y) {\n    for (const slot of this.allSlots) {\n      if (slot.boundingRect.containsXy(x2, y)) {\n        return slot;\n      }\n    }\n  }\n  /**\n   * Shows the context menu for an IO slot.\n   * @param slot The slot to show the context menu for.\n   * @param event The event that triggered the context menu.\n   */\n  showSlotContextMenu(slot, event) {\n    const options = this.#getSlotMenuOptions(slot);\n    if (!(options.length > 0)) return;\n    new LiteGraph.ContextMenu(\n      options,\n      {\n        event,\n        title: slot.name || \"Subgraph Output\",\n        callback: (item) => {\n          this.#onSlotMenuAction(item, slot, event);\n        }\n      }\n    );\n  }\n  /**\n   * Gets the context menu options for an IO slot.\n   * @param slot The slot to get the context menu options for.\n   * @returns The context menu options.\n   */\n  #getSlotMenuOptions(slot) {\n    const options = [];\n    if (slot !== this.emptySlot && slot.linkIds.length > 0) {\n      options.push({ content: \"Disconnect Links\", value: \"disconnect\" });\n    }\n    if (slot !== this.emptySlot) {\n      options.push(\n        { content: \"Remove Slot\", value: \"remove\" },\n        { content: \"Rename Slot\", value: \"rename\" }\n      );\n    }\n    return options;\n  }\n  /**\n   * Handles the action for an IO slot context menu.\n   * @param selectedItem The item that was selected from the context menu.\n   * @param slot The slot\n   * @param event The event that triggered the context menu.\n   */\n  #onSlotMenuAction(selectedItem, slot, event) {\n    switch (selectedItem.value) {\n      // Disconnect all links from this output\n      case \"disconnect\":\n        slot.disconnect();\n        break;\n      // Remove the slot\n      case \"remove\":\n        if (slot !== this.emptySlot) {\n          this.removeSlot(slot);\n        }\n        break;\n      // Rename the slot\n      case \"rename\":\n        if (slot !== this.emptySlot) {\n          this.subgraph.canvasAction((c) => c.prompt(\n            \"Slot name\",\n            slot.name,\n            (newName) => {\n              if (newName) this.renameSlot(slot, newName);\n            },\n            event\n          ));\n        }\n        break;\n    }\n    this.subgraph.setDirtyCanvas(true);\n  }\n  /** Arrange the slots in this node. */\n  arrange() {\n    const { minWidth, roundedRadius } = SubgraphIONodeBase;\n    const [, y] = this.boundingRect;\n    const x2 = this.slotAnchorX;\n    const { size } = this;\n    let maxWidth = minWidth;\n    let currentY = y + roundedRadius;\n    for (const slot of this.allSlots) {\n      const [slotWidth, slotHeight] = slot.measure();\n      slot.arrange([x2, currentY, slotWidth, slotHeight]);\n      currentY += slotHeight;\n      if (slotWidth > maxWidth) maxWidth = slotWidth;\n    }\n    size[0] = maxWidth + 2 * roundedRadius;\n    size[1] = currentY - y + roundedRadius;\n  }\n  draw(ctx, colorContext, fromSlot, editorAlpha) {\n    const { lineWidth, strokeStyle, fillStyle, font, textBaseline } = ctx;\n    this.drawProtected(ctx, colorContext, fromSlot, editorAlpha);\n    Object.assign(ctx, { lineWidth, strokeStyle, fillStyle, font, textBaseline });\n  }\n  /** @internal Leaves {@link ctx} dirty. */\n  drawSlots(ctx, colorContext, fromSlot, editorAlpha) {\n    ctx.fillStyle = \"#AAA\";\n    ctx.font = \"12px Arial\";\n    ctx.textBaseline = \"middle\";\n    for (const slot of this.allSlots) {\n      slot.draw({ ctx, colorContext, fromSlot, editorAlpha });\n    }\n  }\n  configure(data) {\n    this.#boundingRect.set(data.bounding);\n    this.pinned = data.pinned ?? false;\n  }\n  asSerialisable() {\n    return {\n      id: this.id,\n      bounding: this.boundingRect.export(),\n      pinned: this.pinned ? true : void 0\n    };\n  }\n}\nclass SubgraphOutputNode extends SubgraphIONodeBase {\n  id = SUBGRAPH_OUTPUT_ID;\n  emptySlot = new EmptySubgraphOutput(this);\n  get slots() {\n    return this.subgraph.outputs;\n  }\n  get allSlots() {\n    return [...this.slots, this.emptySlot];\n  }\n  get slotAnchorX() {\n    const [x2] = this.boundingRect;\n    return x2 + SubgraphIONodeBase.roundedRadius;\n  }\n  onPointerDown(e2, pointer, linkConnector) {\n    if (e2.button === 0) {\n      for (const slot of this.allSlots) {\n        const slotBounds = Rectangle.fromCentre(slot.pos, slot.boundingRect.height);\n        if (slotBounds.containsXy(e2.canvasX, e2.canvasY)) {\n          pointer.onDragStart = () => {\n            linkConnector.dragNewFromSubgraphOutput(this.subgraph, this, slot);\n          };\n          pointer.onDragEnd = (eUp) => {\n            linkConnector.dropLinks(this.subgraph, eUp);\n          };\n          pointer.finally = () => {\n            linkConnector.reset(true);\n          };\n        }\n      }\n    } else if (e2.button === 2) {\n      const slot = this.getSlotInPosition(e2.canvasX, e2.canvasY);\n      if (slot) this.showSlotContextMenu(slot, e2);\n    }\n  }\n  /** @inheritdoc */\n  renameSlot(slot, name) {\n    this.subgraph.renameOutput(slot, name);\n  }\n  /** @inheritdoc */\n  removeSlot(slot) {\n    this.subgraph.removeOutput(slot);\n  }\n  canConnectTo(outputNode, fromSlot, output) {\n    return outputNode.canConnectTo(this, fromSlot, output);\n  }\n  connectByTypeOutput(slot, target_node, target_slotType, optsIn) {\n    const outputSlot = target_node.findOutputByType(target_slotType);\n    if (!outputSlot) return;\n    return this.slots[slot].connect(outputSlot.slot, target_node, optsIn?.afterRerouteId);\n  }\n  findInputByType(type) {\n    return findFreeSlotOfType(this.slots, type, (slot) => slot.linkIds.length > 0)?.slot;\n  }\n  drawProtected(ctx, colorContext, fromSlot, editorAlpha) {\n    const { roundedRadius } = SubgraphIONodeBase;\n    const transform = ctx.getTransform();\n    const [x2, y, , height] = this.boundingRect;\n    ctx.translate(x2, y);\n    ctx.strokeStyle = this.sideStrokeStyle;\n    ctx.lineWidth = this.sideLineWidth;\n    ctx.beginPath();\n    ctx.arc(roundedRadius, roundedRadius, roundedRadius, Math.PI, Math.PI * 1.5);\n    ctx.moveTo(0, roundedRadius);\n    ctx.lineTo(0, height - roundedRadius);\n    ctx.arc(roundedRadius, height - roundedRadius, roundedRadius, Math.PI, Math.PI * 0.5, true);\n    ctx.stroke();\n    ctx.setTransform(transform);\n    this.drawSlots(ctx, colorContext, fromSlot, editorAlpha);\n  }\n}\nfunction splitPositionables(items) {\n  const nodes = /* @__PURE__ */ new Set();\n  const reroutes = /* @__PURE__ */ new Set();\n  const groups = /* @__PURE__ */ new Set();\n  const subgraphInputNodes = /* @__PURE__ */ new Set();\n  const subgraphOutputNodes = /* @__PURE__ */ new Set();\n  const unknown = /* @__PURE__ */ new Set();\n  for (const item of items) {\n    switch (true) {\n      case item instanceof LGraphNode:\n        nodes.add(item);\n        break;\n      case item instanceof LGraphGroup:\n        groups.add(item);\n        break;\n      case item instanceof Reroute:\n        reroutes.add(item);\n        break;\n      case item instanceof SubgraphInputNode:\n        subgraphInputNodes.add(item);\n        break;\n      case item instanceof SubgraphOutputNode:\n        subgraphOutputNodes.add(item);\n        break;\n      default:\n        unknown.add(item);\n        break;\n    }\n  }\n  return {\n    nodes,\n    reroutes,\n    groups,\n    subgraphInputNodes,\n    subgraphOutputNodes,\n    unknown\n  };\n}\nfunction getBoundaryLinks(graph, items) {\n  const internalLinks = [];\n  const boundaryLinks = [];\n  const boundaryInputLinks = [];\n  const boundaryOutputLinks = [];\n  const boundaryFloatingLinks = [];\n  const visited = /* @__PURE__ */ new WeakSet();\n  for (const item of items) {\n    if (visited.has(item)) continue;\n    visited.add(item);\n    if (item instanceof LGraphNode) {\n      const node2 = item;\n      if (node2.inputs) {\n        for (const input of node2.inputs) {\n          addFloatingLinks(input._floatingLinks);\n          if (input.link == null) continue;\n          const resolved = LLink.resolve(input.link, graph);\n          if (!resolved) {\n            console.debug(`Failed to resolve link ID [${input.link}]`);\n            continue;\n          }\n          const { link, outputNode } = resolved;\n          if (outputNode) {\n            if (!items.has(outputNode)) {\n              boundaryInputLinks.push(link);\n            } else {\n              internalLinks.push(link);\n            }\n          } else if (link.origin_id === SUBGRAPH_INPUT_ID) {\n            boundaryInputLinks.push(link);\n          }\n        }\n      }\n      if (node2.outputs) {\n        for (const output of node2.outputs) {\n          addFloatingLinks(output._floatingLinks);\n          if (!output.links) continue;\n          const many = LLink.resolveMany(output.links, graph);\n          for (const { link, inputNode } of many) {\n            if (\n              // Subgraph output node\n              link.target_id === SUBGRAPH_OUTPUT_ID || // Input end of this link is outside the items set\n              inputNode && !items.has(inputNode)\n            ) {\n              boundaryOutputLinks.push(link);\n            }\n          }\n        }\n      }\n    } else if (item instanceof Reroute) {\n      const reroute = item;\n      const results = LLink.resolveMany(reroute.linkIds, graph);\n      for (const { link } of results) {\n        const reroutes = LLink.getReroutes(graph, link);\n        const reroutesOutside = reroutes.filter((reroute2) => !items.has(reroute2));\n        const { inputNode, outputNode } = link.resolve(graph);\n        if (reroutesOutside.length || inputNode && !items.has(inputNode) || outputNode && !items.has(outputNode)) {\n          boundaryLinks.push(link);\n        }\n      }\n    }\n  }\n  return { boundaryLinks, boundaryFloatingLinks, internalLinks, boundaryInputLinks, boundaryOutputLinks };\n  function addFloatingLinks(floatingLinks) {\n    if (!floatingLinks) return;\n    for (const link of floatingLinks) {\n      const crossesBoundary = LLink.getReroutes(graph, link).some((reroute) => !items.has(reroute));\n      if (crossesBoundary) boundaryFloatingLinks.push(link);\n    }\n  }\n}\nfunction multiClone(nodes) {\n  const clonedNodes = [];\n  for (const node2 of nodes) {\n    const newNode = LiteGraph.createNode(node2.type);\n    if (!newNode) {\n      console.warn(\"Failed to create node\", node2.type);\n      continue;\n    }\n    const data = LiteGraph.cloneObject(node2.serialize());\n    newNode.configure(data);\n    clonedNodes.push(newNode.serialize());\n  }\n  return clonedNodes;\n}\nfunction groupResolvedByOutput(resolvedConnections) {\n  const groupedByOutput = /* @__PURE__ */ new Map();\n  for (const resolved of resolvedConnections) {\n    const groupBy = resolved.subgraphInput ?? resolved.output ?? {};\n    const group = groupedByOutput.get(groupBy);\n    if (group) {\n      group.push(resolved);\n    } else {\n      groupedByOutput.set(groupBy, [resolved]);\n    }\n  }\n  return groupedByOutput;\n}\nfunction mapSubgraphInputsAndLinks(resolvedInputLinks, links) {\n  const groupedByOutput = groupResolvedByOutput(resolvedInputLinks);\n  const inputs = [];\n  for (const [, connections] of groupedByOutput) {\n    const inputLinks = [];\n    for (const resolved of connections) {\n      const { link, input: input2 } = resolved;\n      if (!input2) continue;\n      const linkData = link.asSerialisable();\n      linkData.origin_id = SUBGRAPH_INPUT_ID;\n      linkData.origin_slot = inputs.length;\n      links.push(linkData);\n      inputLinks.push(linkData);\n    }\n    const { input } = connections[0];\n    if (!input) continue;\n    const { color_off, color_on, dir, hasErrors, label, localized_name, name, shape, type } = input;\n    const uniqueName = nextUniqueName(name, inputs.map((input2) => input2.name));\n    const uniqueLocalizedName = localized_name ? nextUniqueName(localized_name, inputs.map((input2) => input2.localized_name ?? \"\")) : void 0;\n    const inputData = {\n      id: createUuidv4(),\n      type: String(type),\n      linkIds: inputLinks.map((link) => link.id),\n      name: uniqueName,\n      color_off,\n      color_on,\n      dir,\n      label,\n      localized_name: uniqueLocalizedName,\n      hasErrors,\n      shape\n    };\n    inputs.push(inputData);\n  }\n  return inputs;\n}\nfunction mapSubgraphOutputsAndLinks(resolvedOutputLinks, links) {\n  const groupedByOutput = groupResolvedByOutput(resolvedOutputLinks);\n  const outputs = [];\n  for (const [, connections] of groupedByOutput) {\n    const outputLinks = [];\n    for (const resolved of connections) {\n      const { link, output: output2 } = resolved;\n      if (!output2) continue;\n      const linkData = link.asSerialisable();\n      linkData.target_id = SUBGRAPH_OUTPUT_ID;\n      linkData.target_slot = outputs.length;\n      links.push(linkData);\n      outputLinks.push(linkData);\n    }\n    const { output } = connections[0];\n    if (!output) continue;\n    const { color_off, color_on, dir, hasErrors, label, localized_name, name, shape, type } = output;\n    const uniqueName = nextUniqueName(name, outputs.map((output2) => output2.name));\n    const uniqueLocalizedName = localized_name ? nextUniqueName(localized_name, outputs.map((output2) => output2.localized_name ?? \"\")) : void 0;\n    const outputData = {\n      id: createUuidv4(),\n      type: String(type),\n      linkIds: outputLinks.map((link) => link.id),\n      name: uniqueName,\n      color_off,\n      color_on,\n      dir,\n      label,\n      localized_name: uniqueLocalizedName,\n      hasErrors,\n      shape\n    };\n    outputs.push(structuredClone(outputData));\n  }\n  return outputs;\n}\nfunction getDirectSubgraphIds(graph) {\n  const subgraphIds = /* @__PURE__ */ new Set();\n  for (const node2 of graph._nodes) {\n    if (node2.isSubgraphNode()) {\n      subgraphIds.add(node2.type);\n    }\n  }\n  return subgraphIds;\n}\nfunction findUsedSubgraphIds(rootGraph, subgraphRegistry) {\n  const usedSubgraphIds = /* @__PURE__ */ new Set();\n  const toVisit = [rootGraph];\n  while (toVisit.length > 0) {\n    const graph = toVisit.shift();\n    const directIds = getDirectSubgraphIds(graph);\n    for (const id of directIds) {\n      if (!usedSubgraphIds.has(id)) {\n        usedSubgraphIds.add(id);\n        const subgraph = subgraphRegistry.get(id);\n        if (subgraph) {\n          toVisit.push(subgraph);\n        }\n      }\n    }\n  }\n  return usedSubgraphIds;\n}\nfunction isSubgraphInput(slot) {\n  return slot != null && typeof slot === \"object\" && \"parent\" in slot && slot.parent instanceof SubgraphInputNode;\n}\nfunction isSubgraphOutput(slot) {\n  return slot != null && typeof slot === \"object\" && \"parent\" in slot && slot.parent instanceof SubgraphOutputNode;\n}\nfunction isNodeSlot(slot) {\n  return slot != null && typeof slot === \"object\" && (\"link\" in slot || \"links\" in slot);\n}\nclass NodeInputSlot extends NodeSlot {\n  link;\n  get isWidgetInputSlot() {\n    return !!this.widget;\n  }\n  #widget;\n  /** Internal use only; API is not finalised and may change at any time. */\n  get _widget() {\n    return this.#widget?.deref();\n  }\n  set _widget(widget) {\n    this.#widget = widget ? new WeakRef(widget) : void 0;\n  }\n  get collapsedPos() {\n    return [0, LiteGraph.NODE_TITLE_HEIGHT * -0.5];\n  }\n  constructor(slot, node2) {\n    super(slot, node2);\n    this.link = slot.link;\n  }\n  get isConnected() {\n    return this.link != null;\n  }\n  isValidTarget(fromSlot) {\n    if (\"links\" in fromSlot) {\n      return LiteGraph.isValidConnection(fromSlot.type, this.type);\n    }\n    if (isSubgraphInput(fromSlot)) {\n      return LiteGraph.isValidConnection(fromSlot.type, this.type);\n    }\n    return false;\n  }\n  draw(ctx, options) {\n    const { textAlign } = ctx;\n    ctx.textAlign = \"left\";\n    super.draw(ctx, {\n      ...options,\n      labelPosition: LabelPosition.Right,\n      doStroke: false\n    });\n    ctx.textAlign = textAlign;\n  }\n}\nclass NodeOutputSlot extends NodeSlot {\n  #node;\n  links;\n  _data;\n  slot_index;\n  get isWidgetInputSlot() {\n    return false;\n  }\n  get collapsedPos() {\n    return [\n      this.#node._collapsed_width ?? LiteGraph.NODE_COLLAPSED_WIDTH,\n      LiteGraph.NODE_TITLE_HEIGHT * -0.5\n    ];\n  }\n  constructor(slot, node2) {\n    super(slot, node2);\n    this.links = slot.links;\n    this._data = slot._data;\n    this.slot_index = slot.slot_index;\n    this.#node = node2;\n  }\n  isValidTarget(fromSlot) {\n    if (\"link\" in fromSlot) {\n      return LiteGraph.isValidConnection(this.type, fromSlot.type);\n    }\n    if (isSubgraphOutput(fromSlot)) {\n      return LiteGraph.isValidConnection(this.type, fromSlot.type);\n    }\n    return false;\n  }\n  get isConnected() {\n    return this.links != null && this.links.length > 0;\n  }\n  draw(ctx, options) {\n    const { textAlign, strokeStyle } = ctx;\n    ctx.textAlign = \"right\";\n    ctx.strokeStyle = \"black\";\n    super.draw(ctx, {\n      ...options,\n      labelPosition: LabelPosition.Left,\n      doStroke: true\n    });\n    ctx.textAlign = textAlign;\n    ctx.strokeStyle = strokeStyle;\n  }\n}\nfunction shallowCloneCommonProps(slot) {\n  const { color_off, color_on, dir, label, localized_name, locked, name, nameLocked, removable, shape, type } = slot;\n  return { color_off, color_on, dir, label, localized_name, locked, name, nameLocked, removable, shape, type };\n}\nfunction inputAsSerialisable(slot) {\n  const { link } = slot;\n  const widgetOrPos = slot.widget ? { widget: { name: slot.widget.name } } : { pos: slot.pos };\n  return {\n    ...shallowCloneCommonProps(slot),\n    ...widgetOrPos,\n    link\n  };\n}\nfunction outputAsSerialisable(slot) {\n  const { pos, slot_index, links, widget } = slot;\n  const outputWidget = widget ? { widget: { name: widget.name } } : null;\n  return {\n    ...shallowCloneCommonProps(slot),\n    ...outputWidget,\n    pos,\n    slot_index,\n    links\n  };\n}\nfunction isINodeInputSlot(slot) {\n  return \"link\" in slot;\n}\nfunction isWidgetInputSlot(slot) {\n  return !!slot.widget;\n}\nconst UNIQUE_MESSAGE_LIMIT = 1e4;\nconst sentWarnings = /* @__PURE__ */ new Set();\nfunction warnDeprecated(message, source) {\n  if (!LiteGraph.alwaysRepeatWarnings) {\n    if (sentWarnings.has(message)) return;\n    if (sentWarnings.size > UNIQUE_MESSAGE_LIMIT) return;\n    sentWarnings.add(message);\n  }\n  for (const callback of LiteGraph.onDeprecationWarning) {\n    callback(message, source);\n  }\n}\nfunction distributeSpace(totalSpace, requests) {\n  if (requests.length === 0) return [];\n  const totalMinSize = requests.reduce((sum, req) => sum + req.minSize, 0);\n  if (totalSpace < totalMinSize) {\n    return requests.map((req) => req.minSize);\n  }\n  let allocations = requests.map((req) => ({\n    computedSize: req.minSize,\n    maxSize: req.maxSize ?? Infinity,\n    remaining: (req.maxSize ?? Infinity) - req.minSize\n  }));\n  let remainingSpace = totalSpace - totalMinSize;\n  while (remainingSpace > 0 && allocations.some((alloc) => alloc.remaining > 0)) {\n    const growableItems = allocations.filter(\n      (alloc) => alloc.remaining > 0\n    ).length;\n    if (growableItems === 0) break;\n    const sharePerItem = remainingSpace / growableItems;\n    let spaceUsedThisRound = 0;\n    allocations = allocations.map((alloc) => {\n      if (alloc.remaining <= 0) return alloc;\n      const growth = Math.min(sharePerItem, alloc.remaining);\n      spaceUsedThisRound += growth;\n      return {\n        ...alloc,\n        computedSize: alloc.computedSize + growth,\n        remaining: alloc.remaining - growth\n      };\n    });\n    remainingSpace -= spaceUsedThisRound;\n    if (spaceUsedThisRound === 0) break;\n  }\n  return allocations.map(({ computedSize }) => computedSize);\n}\nfunction truncateText(ctx, text, maxWidth, ellipsis = \"...\") {\n  const textWidth = ctx.measureText(text).width;\n  if (textWidth <= maxWidth || maxWidth <= 0) {\n    return text;\n  }\n  const ellipsisWidth = ctx.measureText(ellipsis).width;\n  const availableWidth = maxWidth - ellipsisWidth;\n  if (availableWidth <= 0) {\n    return ellipsis;\n  }\n  let low = 0;\n  let high = text.length;\n  let bestFit = 0;\n  while (low <= high) {\n    const mid = Math.floor((low + high) / 2);\n    const testText = text.substring(0, mid);\n    const testWidth = ctx.measureText(testText).width;\n    if (testWidth <= availableWidth) {\n      bestFit = mid;\n      low = mid + 1;\n    } else {\n      high = mid - 1;\n    }\n  }\n  return text.substring(0, bestFit) + ellipsis;\n}\nfunction toClass(cls, ...args) {\n  return args[0] instanceof cls ? args[0] : new cls(...args);\n}\nfunction isColorable(obj) {\n  return typeof obj === \"object\" && obj !== null && \"setColorOption\" in obj && \"getColorOption\" in obj;\n}\nclass BaseWidget {\n  /** From node edge to widget edge */\n  static margin = 15;\n  /** From widget edge to tip of arrow button */\n  static arrowMargin = 6;\n  /** Arrow button width */\n  static arrowWidth = 10;\n  /** Absolute minimum display width of widget values */\n  static minValueWidth = 42;\n  /** Minimum gap between label and value */\n  static labelValueGap = 5;\n  #node;\n  /** The node that this widget belongs to. */\n  get node() {\n    return this.#node;\n  }\n  linkedWidgets;\n  name;\n  options;\n  label;\n  type;\n  y = 0;\n  last_y;\n  width;\n  disabled;\n  computedDisabled;\n  hidden;\n  advanced;\n  tooltip;\n  element;\n  #value;\n  get value() {\n    return this.#value;\n  }\n  set value(value) {\n    this.#value = value;\n  }\n  constructor(widget, node2) {\n    this.#node = node2 ?? widget.node;\n    this.name = widget.name;\n    this.options = widget.options;\n    this.type = widget.type;\n    const { node: _, outline_color, background_color, height, text_color, secondary_text_color, disabledTextColor, displayName, displayValue, labelBaseline, ...safeValues } = widget;\n    Object.assign(this, safeValues);\n  }\n  get outline_color() {\n    return this.advanced ? LiteGraph.WIDGET_ADVANCED_OUTLINE_COLOR : LiteGraph.WIDGET_OUTLINE_COLOR;\n  }\n  get background_color() {\n    return LiteGraph.WIDGET_BGCOLOR;\n  }\n  get height() {\n    return LiteGraph.NODE_WIDGET_HEIGHT;\n  }\n  get text_color() {\n    return LiteGraph.WIDGET_TEXT_COLOR;\n  }\n  get secondary_text_color() {\n    return LiteGraph.WIDGET_SECONDARY_TEXT_COLOR;\n  }\n  get disabledTextColor() {\n    return LiteGraph.WIDGET_DISABLED_TEXT_COLOR;\n  }\n  get displayName() {\n    return this.label || this.name;\n  }\n  // TODO: Resolve this workaround. Ref: https://github.com/Comfy-Org/litegraph.js/issues/1022\n  get _displayValue() {\n    return this.computedDisabled ? \"\" : String(this.value);\n  }\n  get labelBaseline() {\n    return this.y + this.height * 0.7;\n  }\n  /**\n   * Draws the standard widget shape - elongated capsule. The path of the widget shape is not\n   * cleared, and may be used for further drawing.\n   * @param ctx The canvas context\n   * @param options The options for drawing the widget\n   * @remarks Leaves {@link ctx} dirty.\n   */\n  drawWidgetShape(ctx, { width: width2, showText }) {\n    const { height, y } = this;\n    const { margin } = BaseWidget;\n    ctx.textAlign = \"left\";\n    ctx.strokeStyle = this.outline_color;\n    ctx.fillStyle = this.background_color;\n    ctx.beginPath();\n    if (showText) {\n      ctx.roundRect(margin, y, width2 - margin * 2, height, [height * 0.5]);\n    } else {\n      ctx.rect(margin, y, width2 - margin * 2, height);\n    }\n    ctx.fill();\n    if (showText && !this.computedDisabled) ctx.stroke();\n  }\n  /**\n   * A shared routine for drawing a label and value as text, truncated\n   * if they exceed the available width.\n   */\n  drawTruncatingText({\n    ctx,\n    width: width2,\n    leftPadding = 5,\n    rightPadding = 20\n  }) {\n    const { height, y } = this;\n    const { margin } = BaseWidget;\n    const { displayName, _displayValue } = this;\n    const labelWidth = ctx.measureText(displayName).width;\n    const valueWidth = ctx.measureText(_displayValue).width;\n    const gap = BaseWidget.labelValueGap;\n    const x2 = margin * 2 + leftPadding;\n    const totalWidth = width2 - x2 - 2 * margin - rightPadding;\n    const requiredWidth = labelWidth + gap + valueWidth;\n    const area = new Rectangle(x2, y, totalWidth, height * 0.7);\n    ctx.fillStyle = this.secondary_text_color;\n    if (requiredWidth <= totalWidth) {\n      drawTextInArea({ ctx, text: displayName, area, align: \"left\" });\n    } else if (LiteGraph.truncateWidgetTextEvenly) {\n      const scale = (totalWidth - gap) / (requiredWidth - gap);\n      area.width = labelWidth * scale;\n      drawTextInArea({ ctx, text: displayName, area, align: \"left\" });\n      area.right = x2 + totalWidth;\n      area.setWidthRightAnchored(valueWidth * scale);\n    } else if (LiteGraph.truncateWidgetValuesFirst) {\n      const cappedLabelWidth = Math.min(labelWidth, totalWidth);\n      area.width = cappedLabelWidth;\n      drawTextInArea({ ctx, text: displayName, area, align: \"left\" });\n      area.right = x2 + totalWidth;\n      area.setWidthRightAnchored(Math.max(totalWidth - gap - cappedLabelWidth, 0));\n    } else {\n      const cappedValueWidth = Math.min(valueWidth, totalWidth);\n      area.width = Math.max(totalWidth - gap - cappedValueWidth, 0);\n      drawTextInArea({ ctx, text: displayName, area, align: \"left\" });\n      area.right = x2 + totalWidth;\n      area.setWidthRightAnchored(cappedValueWidth);\n    }\n    ctx.fillStyle = this.text_color;\n    drawTextInArea({ ctx, text: _displayValue, area, align: \"right\" });\n  }\n  /**\n   * Sets the value of the widget\n   * @param value The value to set\n   * @param options The options for setting the value\n   */\n  setValue(value, { e: e2, node: node2, canvas: canvas2 }) {\n    const oldValue = this.value;\n    if (value === this.value) return;\n    const v2 = this.type === \"number\" ? Number(value) : value;\n    this.value = v2;\n    if (this.options?.property && node2.properties[this.options.property] !== void 0) {\n      node2.setProperty(this.options.property, v2);\n    }\n    const pos = canvas2.graph_mouse;\n    this.callback?.(this.value, canvas2, node2, pos, e2);\n    node2.onWidgetChanged?.(this.name ?? \"\", v2, oldValue, this);\n    if (node2.graph) node2.graph._version++;\n  }\n  /**\n   * Clones the widget.\n   * @param node The node that will own the cloned widget.\n   * @returns A new widget with the same properties as the original\n   * @remarks Subclasses with custom constructors must override this method.\n   *\n   * Correctly and safely typing this is currently not possible (practical?) in TypeScript 5.8.\n   */\n  createCopyForNode(node2) {\n    const cloned = new this.constructor(this, node2);\n    cloned.value = this.value;\n    return cloned;\n  }\n}\nclass BooleanWidget extends BaseWidget {\n  type = \"toggle\";\n  drawWidget(ctx, {\n    width: width2,\n    showText = true\n  }) {\n    const { height, y } = this;\n    const { margin } = BaseWidget;\n    this.drawWidgetShape(ctx, { width: width2, showText });\n    ctx.fillStyle = this.value ? \"#89A\" : \"#333\";\n    ctx.beginPath();\n    ctx.arc(\n      width2 - margin * 2,\n      y + height * 0.5,\n      height * 0.36,\n      0,\n      Math.PI * 2\n    );\n    ctx.fill();\n    if (showText) {\n      this.drawLabel(ctx, margin * 2);\n      this.drawValue(ctx, width2 - 40);\n    }\n  }\n  drawLabel(ctx, x2) {\n    ctx.fillStyle = this.secondary_text_color;\n    const { displayName } = this;\n    if (displayName) ctx.fillText(displayName, x2, this.labelBaseline);\n  }\n  drawValue(ctx, x2) {\n    ctx.fillStyle = this.value ? this.text_color : this.secondary_text_color;\n    ctx.textAlign = \"right\";\n    const value = this.value ? this.options.on || \"true\" : this.options.off || \"false\";\n    ctx.fillText(value, x2, this.labelBaseline);\n  }\n  onClick(options) {\n    this.setValue(!this.value, options);\n  }\n}\nclass ButtonWidget extends BaseWidget {\n  type = \"button\";\n  clicked;\n  constructor(widget, node2) {\n    super(widget, node2);\n    this.clicked ??= false;\n  }\n  /**\n   * Draws the widget\n   * @param ctx The canvas context\n   * @param options The options for drawing the widget\n   */\n  drawWidget(ctx, {\n    width: width2,\n    showText = true\n  }) {\n    const { fillStyle, strokeStyle, textAlign } = ctx;\n    const { height, y } = this;\n    const { margin } = BaseWidget;\n    ctx.fillStyle = this.background_color;\n    if (this.clicked) {\n      ctx.fillStyle = \"#AAA\";\n      this.clicked = false;\n    }\n    ctx.fillRect(margin, y, width2 - margin * 2, height);\n    if (showText && !this.computedDisabled) {\n      ctx.strokeStyle = this.outline_color;\n      ctx.strokeRect(margin, y, width2 - margin * 2, height);\n    }\n    if (showText) this.drawLabel(ctx, width2 * 0.5);\n    Object.assign(ctx, { textAlign, strokeStyle, fillStyle });\n  }\n  drawLabel(ctx, x2) {\n    ctx.textAlign = \"center\";\n    ctx.fillStyle = this.text_color;\n    ctx.fillText(this.displayName, x2, this.y + this.height * 0.7);\n  }\n  onClick({ e: e2, node: node2, canvas: canvas2 }) {\n    const pos = canvas2.graph_mouse;\n    this.clicked = true;\n    canvas2.setDirty(true);\n    this.callback?.(this, canvas2, node2, pos, e2);\n  }\n}\nclass BaseSteppedWidget extends BaseWidget {\n  /**\n   * Draw the arrow buttons for the widget\n   * @param ctx The canvas rendering context\n   * @param width The width of the widget\n   */\n  drawArrowButtons(ctx, width2) {\n    const { height, text_color, disabledTextColor, y } = this;\n    const { arrowMargin, arrowWidth, margin } = BaseWidget;\n    const arrowTipX = margin + arrowMargin;\n    const arrowInnerX = arrowTipX + arrowWidth;\n    ctx.fillStyle = this.canDecrement() ? text_color : disabledTextColor;\n    ctx.beginPath();\n    ctx.moveTo(arrowInnerX, y + 5);\n    ctx.lineTo(arrowTipX, y + height * 0.5);\n    ctx.lineTo(arrowInnerX, y + height - 5);\n    ctx.fill();\n    ctx.fillStyle = this.canIncrement() ? text_color : disabledTextColor;\n    ctx.beginPath();\n    ctx.moveTo(width2 - arrowInnerX, y + 5);\n    ctx.lineTo(width2 - arrowTipX, y + height * 0.5);\n    ctx.lineTo(width2 - arrowInnerX, y + height - 5);\n    ctx.fill();\n  }\n  drawWidget(ctx, options) {\n    const { fillStyle, strokeStyle, textAlign } = ctx;\n    this.drawWidgetShape(ctx, options);\n    if (options.showText) {\n      if (!this.computedDisabled) this.drawArrowButtons(ctx, options.width);\n      this.drawTruncatingText({ ctx, width: options.width });\n    }\n    Object.assign(ctx, { textAlign, strokeStyle, fillStyle });\n  }\n}\nfunction toArray(values) {\n  return Array.isArray(values) ? values : Object.keys(values);\n}\nclass ComboWidget extends BaseSteppedWidget {\n  type = \"combo\";\n  get _displayValue() {\n    if (this.computedDisabled) return \"\";\n    const { values: rawValues } = this.options;\n    if (rawValues) {\n      const values = typeof rawValues === \"function\" ? rawValues() : rawValues;\n      if (values && !Array.isArray(values)) {\n        return values[this.value];\n      }\n    }\n    return typeof this.value === \"number\" ? String(this.value) : this.value;\n  }\n  #getValues(node2) {\n    const { values } = this.options;\n    if (values == null) throw new Error(\"[ComboWidget]: values is required\");\n    return typeof values === \"function\" ? values(this, node2) : values;\n  }\n  /**\n   * Checks if the value is {@link Array.at at} the given index in the combo list.\n   * @param increment `true` if checking the use of the increment button, `false` for decrement\n   * @returns `true` if the value is at the given index, otherwise `false`.\n   */\n  #canUseButton(increment) {\n    const { values } = this.options;\n    if (typeof values === \"function\") return false;\n    const valuesArray = toArray(values);\n    if (!(valuesArray.length > 1)) return false;\n    const firstValue = valuesArray.at(0);\n    const lastValue = valuesArray.at(-1);\n    if (firstValue === lastValue) return true;\n    return this.value !== (increment ? lastValue : firstValue);\n  }\n  /**\n   * Returns `true` if the current value is not the last value in the list.\n   * Handles edge case where the value is both the first and last item in the list.\n   */\n  canIncrement() {\n    return this.#canUseButton(true);\n  }\n  canDecrement() {\n    return this.#canUseButton(false);\n  }\n  incrementValue(options) {\n    this.#tryChangeValue(1, options);\n  }\n  decrementValue(options) {\n    this.#tryChangeValue(-1, options);\n  }\n  #tryChangeValue(delta2, options) {\n    const values = this.#getValues(options.node);\n    const indexedValues = toArray(values);\n    options.canvas.last_mouseclick = 0;\n    const foundIndex = typeof values === \"object\" ? indexedValues.indexOf(String(this.value)) + delta2 : indexedValues.indexOf(this.value) + delta2;\n    const index = clamp(foundIndex, 0, indexedValues.length - 1);\n    const value = Array.isArray(values) ? values[index] : index;\n    this.setValue(value, options);\n  }\n  onClick({ e: e2, node: node2, canvas: canvas2 }) {\n    const x2 = e2.canvasX - node2.pos[0];\n    const width2 = this.width || node2.size[0];\n    if (typeof this.options.values === \"function\") {\n      warnDeprecated(\"Using a function for values is deprecated. Use an array of unique values instead.\");\n    }\n    if (x2 < 40) return this.decrementValue({ e: e2, node: node2, canvas: canvas2 });\n    if (x2 > width2 - 40) return this.incrementValue({ e: e2, node: node2, canvas: canvas2 });\n    const values = this.#getValues(node2);\n    const values_list = toArray(values);\n    const text_values = values != values_list ? Object.values(values) : values;\n    new LiteGraph.ContextMenu(text_values, {\n      scale: Math.max(1, canvas2.ds.scale),\n      event: e2,\n      className: \"dark\",\n      callback: (value) => {\n        this.setValue(\n          values != values_list ? text_values.indexOf(value) : value,\n          { e: e2, node: node2, canvas: canvas2 }\n        );\n      }\n    });\n  }\n}\nfunction getWidgetStep(options) {\n  return options.step2 || (options.step || 10) * 0.1;\n}\nclass KnobWidget extends BaseWidget {\n  type = \"knob\";\n  /**\n   * Compute the layout size of the widget.\n   * @returns The layout size of the widget.\n   */\n  computeLayoutSize() {\n    return {\n      minHeight: 60,\n      minWidth: 20,\n      maxHeight: 1e6,\n      maxWidth: 1e6\n    };\n  }\n  get height() {\n    return this.computedHeight || super.height;\n  }\n  drawWidget(ctx, {\n    width: width2,\n    showText = true\n  }) {\n    const { fillStyle, strokeStyle, textAlign } = ctx;\n    const { y } = this;\n    const { margin } = BaseWidget;\n    const { gradient_stops = \"rgb(14, 182, 201); rgb(0, 216, 72)\" } = this.options;\n    const effective_height = this.computedHeight || this.height;\n    const size_modifier = Math.min(this.computedHeight || this.height, this.width || 20) / 20;\n    const arc_center = { x: width2 / 2, y: effective_height / 2 + y };\n    ctx.lineWidth = (Math.min(width2, effective_height) - margin * size_modifier) / 6;\n    const arc_size = (Math.min(width2, effective_height) - margin * size_modifier - ctx.lineWidth) / 2;\n    {\n      const gradient2 = ctx.createRadialGradient(\n        arc_center.x,\n        arc_center.y,\n        arc_size + ctx.lineWidth,\n        0,\n        0,\n        arc_size + ctx.lineWidth\n      );\n      gradient2.addColorStop(0, \"rgb(29, 29, 29)\");\n      gradient2.addColorStop(1, \"rgb(116, 116, 116)\");\n      ctx.fillStyle = gradient2;\n    }\n    ctx.beginPath();\n    {\n      ctx.arc(\n        arc_center.x,\n        arc_center.y,\n        arc_size + ctx.lineWidth / 2,\n        0,\n        Math.PI * 2,\n        false\n      );\n      ctx.fill();\n      ctx.closePath();\n    }\n    const arc = {\n      start_angle: Math.PI * 0.6,\n      end_angle: Math.PI * 2.4\n    };\n    ctx.beginPath();\n    {\n      const gradient2 = ctx.createRadialGradient(\n        arc_center.x,\n        arc_center.y,\n        arc_size + ctx.lineWidth,\n        0,\n        0,\n        arc_size + ctx.lineWidth\n      );\n      gradient2.addColorStop(0, \"rgb(99, 99, 99)\");\n      gradient2.addColorStop(1, \"rgb(36, 36, 36)\");\n      ctx.strokeStyle = gradient2;\n    }\n    ctx.arc(\n      arc_center.x,\n      arc_center.y,\n      arc_size,\n      arc.start_angle,\n      arc.end_angle,\n      false\n    );\n    ctx.stroke();\n    ctx.closePath();\n    const range = this.options.max - this.options.min;\n    let nvalue = (this.value - this.options.min) / range;\n    nvalue = clamp(nvalue, 0, 1);\n    ctx.beginPath();\n    const gradient = ctx.createConicGradient(\n      arc.start_angle,\n      arc_center.x,\n      arc_center.y\n    );\n    const gs = gradient_stops.split(\";\");\n    for (const [index, stop] of gs.entries()) {\n      gradient.addColorStop(index, stop.trim());\n    }\n    ctx.strokeStyle = gradient;\n    const value_end_angle = (arc.end_angle - arc.start_angle) * nvalue + arc.start_angle;\n    ctx.arc(\n      arc_center.x,\n      arc_center.y,\n      arc_size,\n      arc.start_angle,\n      value_end_angle,\n      false\n    );\n    ctx.stroke();\n    ctx.closePath();\n    if (showText && !this.computedDisabled) {\n      ctx.strokeStyle = this.outline_color;\n      ctx.beginPath();\n      ctx.strokeStyle = this.outline_color;\n      ctx.arc(\n        arc_center.x,\n        arc_center.y,\n        arc_size + ctx.lineWidth / 2,\n        0,\n        Math.PI * 2,\n        false\n      );\n      ctx.lineWidth = 1;\n      ctx.stroke();\n      ctx.closePath();\n    }\n    if (showText) {\n      ctx.textAlign = \"center\";\n      ctx.fillStyle = this.text_color;\n      const fixedValue = Number(this.value).toFixed(this.options.precision ?? 3);\n      ctx.fillText(\n        `${this.label || this.name}\n${fixedValue}`,\n        width2 * 0.5,\n        y + effective_height * 0.5\n      );\n    }\n    Object.assign(ctx, { textAlign, strokeStyle, fillStyle });\n  }\n  onClick() {\n    this.current_drag_offset = 0;\n  }\n  current_drag_offset = 0;\n  onDrag(options) {\n    if (this.options.read_only) return;\n    const { e: e2 } = options;\n    const step = getWidgetStep(this.options);\n    const range = this.options.max - this.options.min;\n    const range_10_percent = range / 10;\n    const range_1_percent = range / 100;\n    const step_for = {\n      shift: range_10_percent > step ? range_10_percent - range_10_percent % step : step,\n      delta_y: range_1_percent > step ? range_1_percent - range_1_percent % step : step\n      // 1% increments\n    };\n    const use_y = Math.abs(e2.movementY) > Math.abs(e2.movementX);\n    const delta2 = use_y ? -e2.movementY : e2.movementX;\n    const drag_threshold = 15;\n    this.current_drag_offset += delta2;\n    let adjustment = 0;\n    if (this.current_drag_offset > drag_threshold) {\n      adjustment += 1;\n      this.current_drag_offset -= drag_threshold;\n    } else if (this.current_drag_offset < -15) {\n      adjustment -= 1;\n      this.current_drag_offset += drag_threshold;\n    }\n    const step_with_shift_modifier = e2.shiftKey ? step_for.shift : use_y ? step_for.delta_y : step;\n    const deltaValue = adjustment * step_with_shift_modifier;\n    const newValue2 = clamp(\n      this.value + deltaValue,\n      this.options.min,\n      this.options.max\n    );\n    if (newValue2 !== this.value) {\n      this.setValue(newValue2, options);\n    }\n  }\n}\nclass LegacyWidget extends BaseWidget {\n  drawWidget(ctx, options) {\n    const H = LiteGraph.NODE_WIDGET_HEIGHT;\n    this.draw?.(ctx, this.node, options.width, this.y, H, !!options.showText);\n  }\n  onClick() {\n    console.warn(\"Custom widget wrapper onClick was just called. Handling for third party widgets is done via LGraphCanvas - the mouse callback.\");\n  }\n}\nclass NumberWidget extends BaseSteppedWidget {\n  type = \"number\";\n  get _displayValue() {\n    if (this.computedDisabled) return \"\";\n    return Number(this.value).toFixed(\n      this.options.precision !== void 0 ? this.options.precision : 3\n    );\n  }\n  canIncrement() {\n    const { max } = this.options;\n    return max == null || this.value < max;\n  }\n  canDecrement() {\n    const { min } = this.options;\n    return min == null || this.value > min;\n  }\n  incrementValue(options) {\n    this.setValue(this.value + getWidgetStep(this.options), options);\n  }\n  decrementValue(options) {\n    this.setValue(this.value - getWidgetStep(this.options), options);\n  }\n  setValue(value, options) {\n    let newValue2 = value;\n    if (this.options.min != null && newValue2 < this.options.min) {\n      newValue2 = this.options.min;\n    }\n    if (this.options.max != null && newValue2 > this.options.max) {\n      newValue2 = this.options.max;\n    }\n    super.setValue(newValue2, options);\n  }\n  onClick({ e, node, canvas }) {\n    const x = e.canvasX - node.pos[0];\n    const width = this.width || node.size[0];\n    const delta = x < 40 ? -1 : x > width - 40 ? 1 : 0;\n    if (delta) {\n      this.setValue(this.value + delta * getWidgetStep(this.options), { e, node, canvas });\n      return;\n    }\n    canvas.prompt(\"Value\", this.value, (v) => {\n      if (/^[\\d\\s()*+/-]+|\\d+\\.\\d+$/.test(v)) {\n        try {\n          v = eval(v);\n        } catch {\n        }\n      }\n      const newValue = Number(v);\n      if (!isNaN(newValue)) {\n        this.setValue(newValue, { e, node, canvas });\n      }\n    }, e);\n  }\n  /**\n   * Handles drag events for the number widget\n   * @param options The options for handling the drag event\n   */\n  onDrag({ e: e2, node: node2, canvas: canvas2 }) {\n    const width2 = this.width || node2.width;\n    const x2 = e2.canvasX - node2.pos[0];\n    const delta2 = x2 < 40 ? -1 : x2 > width2 - 40 ? 1 : 0;\n    if (delta2 && (x2 > -3 && x2 < width2 + 3)) return;\n    this.setValue(this.value + (e2.deltaX ?? 0) * getWidgetStep(this.options), { e: e2, node: node2, canvas: canvas2 });\n  }\n}\nclass SliderWidget extends BaseWidget {\n  type = \"slider\";\n  marker;\n  /**\n   * Draws the widget\n   * @param ctx The canvas context\n   * @param options The options for drawing the widget\n   */\n  drawWidget(ctx, {\n    width: width2,\n    showText = true\n  }) {\n    const { fillStyle, strokeStyle, textAlign } = ctx;\n    const { height, y } = this;\n    const { margin } = BaseWidget;\n    ctx.fillStyle = this.background_color;\n    ctx.fillRect(margin, y, width2 - margin * 2, height);\n    const range = this.options.max - this.options.min;\n    let nvalue = (this.value - this.options.min) / range;\n    nvalue = clamp(nvalue, 0, 1);\n    ctx.fillStyle = this.options.slider_color ?? \"#678\";\n    ctx.fillRect(margin, y, nvalue * (width2 - margin * 2), height);\n    if (showText && !this.computedDisabled) {\n      ctx.strokeStyle = this.outline_color;\n      ctx.strokeRect(margin, y, width2 - margin * 2, height);\n    }\n    if (this.marker != null) {\n      let marker_nvalue = (this.marker - this.options.min) / range;\n      marker_nvalue = clamp(marker_nvalue, 0, 1);\n      ctx.fillStyle = this.options.marker_color ?? \"#AA9\";\n      ctx.fillRect(\n        margin + marker_nvalue * (width2 - margin * 2),\n        y,\n        2,\n        height\n      );\n    }\n    if (showText) {\n      ctx.textAlign = \"center\";\n      ctx.fillStyle = this.text_color;\n      const fixedValue = Number(this.value).toFixed(this.options.precision ?? 3);\n      ctx.fillText(\n        `${this.label || this.name}  ${fixedValue}`,\n        width2 * 0.5,\n        y + height * 0.7\n      );\n    }\n    Object.assign(ctx, { textAlign, strokeStyle, fillStyle });\n  }\n  /**\n   * Handles click events for the slider widget\n   */\n  onClick(options) {\n    if (this.options.read_only) return;\n    const { e: e2, node: node2 } = options;\n    const width2 = this.width || node2.size[0];\n    const x2 = e2.canvasX - node2.pos[0];\n    const slideFactor = clamp((x2 - 15) / (width2 - 30), 0, 1);\n    const newValue2 = this.options.min + (this.options.max - this.options.min) * slideFactor;\n    if (newValue2 !== this.value) {\n      this.setValue(newValue2, options);\n    }\n  }\n  /**\n   * Handles drag events for the slider widget\n   */\n  onDrag(options) {\n    if (this.options.read_only) return false;\n    const { e: e2, node: node2 } = options;\n    const width2 = this.width || node2.size[0];\n    const x2 = e2.canvasX - node2.pos[0];\n    const slideFactor = clamp((x2 - 15) / (width2 - 30), 0, 1);\n    const newValue2 = this.options.min + (this.options.max - this.options.min) * slideFactor;\n    if (newValue2 !== this.value) {\n      this.setValue(newValue2, options);\n    }\n  }\n}\nclass TextWidget extends BaseWidget {\n  constructor(widget, node2) {\n    super(widget, node2);\n    this.type ??= \"string\";\n    this.value = widget.value?.toString() ?? \"\";\n  }\n  /**\n   * Draws the widget\n   * @param ctx The canvas context\n   * @param options The options for drawing the widget\n   */\n  drawWidget(ctx, {\n    width: width2,\n    showText = true\n  }) {\n    const { fillStyle, strokeStyle, textAlign } = ctx;\n    this.drawWidgetShape(ctx, { width: width2, showText });\n    if (showText) {\n      this.drawTruncatingText({ ctx, width: width2, leftPadding: 0, rightPadding: 0 });\n    }\n    Object.assign(ctx, { textAlign, strokeStyle, fillStyle });\n  }\n  onClick({ e: e2, node: node2, canvas: canvas2 }) {\n    canvas2.prompt(\n      \"Value\",\n      this.value,\n      (v2) => {\n        if (v2 !== null) {\n          this.setValue(v2, { e: e2, node: node2, canvas: canvas2 });\n        }\n      },\n      e2,\n      this.options?.multiline ?? false\n    );\n  }\n}\nfunction toConcreteWidget(widget, node2, wrapLegacyWidgets = true) {\n  if (widget instanceof BaseWidget) return widget;\n  const narrowedWidget = widget;\n  switch (narrowedWidget.type) {\n    case \"button\":\n      return toClass(ButtonWidget, narrowedWidget, node2);\n    case \"toggle\":\n      return toClass(BooleanWidget, narrowedWidget, node2);\n    case \"slider\":\n      return toClass(SliderWidget, narrowedWidget, node2);\n    case \"knob\":\n      return toClass(KnobWidget, narrowedWidget, node2);\n    case \"combo\":\n      return toClass(ComboWidget, narrowedWidget, node2);\n    case \"number\":\n      return toClass(NumberWidget, narrowedWidget, node2);\n    case \"string\":\n      return toClass(TextWidget, narrowedWidget, node2);\n    case \"text\":\n      return toClass(TextWidget, narrowedWidget, node2);\n    default: {\n      if (wrapLegacyWidgets) return toClass(LegacyWidget, widget, node2);\n    }\n  }\n}\nfunction isComboWidget(widget) {\n  return widget.type === \"combo\";\n}\nclass LGraphNode {\n  // Static properties used by dynamic child classes\n  static title;\n  static MAX_CONSOLE;\n  static type;\n  static category;\n  static filter;\n  static skip_list;\n  static resizeHandleSize = 15;\n  static resizeEdgeSize = 5;\n  /** Default setting for {@link LGraphNode.connectInputToOutput}. @see {@link INodeFlags.keepAllLinksOnBypass} */\n  static keepAllLinksOnBypass = false;\n  /** The title text of the node. */\n  title;\n  /**\n   * The font style used to render the node's title text.\n   */\n  get titleFontStyle() {\n    return `${LiteGraph.NODE_TEXT_SIZE}px ${LiteGraph.NODE_FONT}`;\n  }\n  get innerFontStyle() {\n    return `normal ${LiteGraph.NODE_SUBTEXT_SIZE}px ${LiteGraph.NODE_FONT}`;\n  }\n  get displayType() {\n    return this.type;\n  }\n  graph = null;\n  id;\n  type = \"\";\n  inputs = [];\n  outputs = [];\n  #concreteInputs = [];\n  #concreteOutputs = [];\n  properties = {};\n  properties_info = [];\n  flags = {};\n  widgets;\n  /**\n   * The amount of space available for widgets to grow into.\n   * @see {@link layoutWidgets}\n   */\n  freeWidgetSpace;\n  locked;\n  /** Execution order, automatically computed during run @see {@link LGraph.computeExecutionOrder} */\n  order = 0;\n  mode = LGraphEventMode.ALWAYS;\n  last_serialization;\n  serialize_widgets;\n  /**\n   * The overridden fg color used to render the node.\n   * @see {@link renderingColor}\n   */\n  color;\n  /**\n   * The overridden bg color used to render the node.\n   * @see {@link renderingBgColor}\n   */\n  bgcolor;\n  /**\n   * The overridden box color used to render the node.\n   * @see {@link renderingBoxColor}\n   */\n  boxcolor;\n  /** The fg color used to render the node. */\n  get renderingColor() {\n    return this.color || this.constructor.color || LiteGraph.NODE_DEFAULT_COLOR;\n  }\n  /** The bg color used to render the node. */\n  get renderingBgColor() {\n    return this.bgcolor || this.constructor.bgcolor || LiteGraph.NODE_DEFAULT_BGCOLOR;\n  }\n  /** The box color used to render the node. */\n  get renderingBoxColor() {\n    if (this.boxcolor) return this.boxcolor;\n    if (LiteGraph.node_box_coloured_when_on) {\n      if (this.action_triggered) return \"#FFF\";\n      if (this.execute_triggered) return \"#AAA\";\n    }\n    if (LiteGraph.node_box_coloured_by_mode) {\n      const modeColour = LiteGraph.NODE_MODES_COLORS[this.mode ?? LGraphEventMode.ALWAYS];\n      if (modeColour) return modeColour;\n    }\n    return LiteGraph.NODE_DEFAULT_BOXCOLOR;\n  }\n  /** @inheritdoc {@link IColorable.setColorOption} */\n  setColorOption(colorOption) {\n    if (colorOption == null) {\n      delete this.color;\n      delete this.bgcolor;\n    } else {\n      this.color = colorOption.color;\n      this.bgcolor = colorOption.bgcolor;\n    }\n  }\n  /** @inheritdoc {@link IColorable.getColorOption} */\n  getColorOption() {\n    return Object.values(LGraphCanvas.node_colors).find(\n      (colorOption) => colorOption.color === this.color && colorOption.bgcolor === this.bgcolor\n    ) ?? null;\n  }\n  /**\n   * The stroke styles that should be applied to the node.\n   */\n  strokeStyles;\n  /**\n   * The progress of node execution. Used to render a progress bar. Value between 0 and 1.\n   */\n  progress;\n  exec_version;\n  action_call;\n  execute_triggered;\n  action_triggered;\n  widgets_up;\n  widgets_start_y;\n  lostFocusAt;\n  gotFocusAt;\n  badges = [];\n  title_buttons = [];\n  badgePosition = BadgePosition.TopLeft;\n  /**\n   * The width of the node when collapsed.\n   * Updated by {@link LGraphCanvas.drawNode}\n   */\n  _collapsed_width;\n  console;\n  _level;\n  _shape;\n  mouseOver;\n  redraw_on_mouse;\n  resizable;\n  clonable;\n  _relative_id;\n  clip_area;\n  ignore_remove;\n  has_errors;\n  removable;\n  block_delete;\n  selected;\n  showAdvanced;\n  isSubgraphNode() {\n    return false;\n  }\n  /** @inheritdoc {@link renderArea} */\n  #renderArea = new Float32Array(4);\n  /**\n   * Rect describing the node area, including shadows and any protrusions.\n   * Determines if the node is visible.  Calculated once at the start of every frame.\n   */\n  get renderArea() {\n    return this.#renderArea;\n  }\n  /** @inheritdoc {@link boundingRect} */\n  #boundingRect = new Rectangle();\n  /**\n   * Cached node position & area as `x, y, width, height`.  Includes changes made by {@link onBounding}, if present.\n   *\n   * Determines the node hitbox and other rendering effects.  Calculated once at the start of every frame.\n   */\n  get boundingRect() {\n    return this.#boundingRect;\n  }\n  /** The offset from {@link pos} to the top-left of {@link boundingRect}. */\n  get boundingOffset() {\n    const { pos: [posX, posY], boundingRect: [bX, bY] } = this;\n    return [posX - bX, posY - bY];\n  }\n  /** {@link pos} and {@link size} values are backed by this {@link Rect}. */\n  _posSize = new Float32Array(4);\n  _pos = this._posSize.subarray(0, 2);\n  _size = this._posSize.subarray(2, 4);\n  get pos() {\n    return this._pos;\n  }\n  /** Node position does not necessarily correlate to the top-left corner. */\n  set pos(value) {\n    if (!value || value.length < 2) return;\n    this._pos[0] = value[0];\n    this._pos[1] = value[1];\n  }\n  get size() {\n    return this._size;\n  }\n  set size(value) {\n    if (!value || value.length < 2) return;\n    this._size[0] = value[0];\n    this._size[1] = value[1];\n  }\n  /**\n   * The size of the node used for rendering.\n   */\n  get renderingSize() {\n    return this.flags.collapsed ? [this._collapsed_width ?? 0, 0] : this._size;\n  }\n  get shape() {\n    return this._shape;\n  }\n  set shape(v2) {\n    switch (v2) {\n      case \"default\":\n        delete this._shape;\n        break;\n      case \"box\":\n        this._shape = RenderShape.BOX;\n        break;\n      case \"round\":\n        this._shape = RenderShape.ROUND;\n        break;\n      case \"circle\":\n        this._shape = RenderShape.CIRCLE;\n        break;\n      case \"card\":\n        this._shape = RenderShape.CARD;\n        break;\n      default:\n        this._shape = v2;\n    }\n  }\n  /**\n   * The shape of the node used for rendering. @see {@link RenderShape}\n   */\n  get renderingShape() {\n    return this._shape || this.constructor.shape || LiteGraph.NODE_DEFAULT_SHAPE;\n  }\n  get is_selected() {\n    return this.selected;\n  }\n  set is_selected(value) {\n    this.selected = value;\n  }\n  get title_mode() {\n    return this.constructor.title_mode ?? TitleMode.NORMAL_TITLE;\n  }\n  #getErrorStrokeStyle() {\n    if (this.has_errors) {\n      return {\n        padding: 12,\n        lineWidth: 10,\n        color: LiteGraph.NODE_ERROR_COLOUR\n      };\n    }\n  }\n  #getSelectedStrokeStyle() {\n    if (this.selected) {\n      return {\n        padding: this.has_errors ? 20 : void 0\n      };\n    }\n  }\n  constructor(title, type) {\n    this.id = LiteGraph.use_uuids ? LiteGraph.uuidv4() : -1;\n    this.title = title || \"Unnamed\";\n    this.type = type ?? \"\";\n    this.size = [LiteGraph.NODE_WIDTH, 60];\n    this.pos = [10, 10];\n    this.strokeStyles = {\n      error: this.#getErrorStrokeStyle,\n      selected: this.#getSelectedStrokeStyle\n    };\n    this.onMouseDown = (e2, pos, canvas2) => {\n      if (this.title_buttons?.length && !this.flags.collapsed) {\n        const nodeRelativeX = pos[0];\n        const nodeRelativeY = pos[1];\n        for (let i = 0; i < this.title_buttons.length; i++) {\n          const button = this.title_buttons[i];\n          if (button.visible && button.isPointInside(nodeRelativeX, nodeRelativeY)) {\n            this.onTitleButtonClick(button, canvas2);\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n  }\n  /**\n   * configure a node from an object containing the serialized info\n   */\n  configure(info) {\n    if (this.graph) {\n      this.graph._version++;\n    }\n    for (const j in info) {\n      if (j == \"properties\") {\n        for (const k in info.properties) {\n          this.properties[k] = info.properties[k];\n          this.onPropertyChanged?.(k, info.properties[k]);\n        }\n        continue;\n      }\n      if (info[j] == null) {\n        continue;\n      } else if (typeof info[j] == \"object\") {\n        if (this[j]?.configure) {\n          this[j]?.configure(info[j]);\n        } else {\n          this[j] = LiteGraph.cloneObject(info[j], this[j]);\n        }\n      } else {\n        this[j] = info[j];\n      }\n    }\n    if (!info.title) {\n      this.title = this.constructor.title;\n    }\n    this.inputs ??= [];\n    this.inputs = this.inputs.map((input) => toClass(NodeInputSlot, input, this));\n    for (const [i, input] of this.inputs.entries()) {\n      const link = this.graph && input.link != null ? this.graph._links.get(input.link) : null;\n      this.onConnectionsChange?.(NodeSlotType.INPUT, i, true, link, input);\n      this.onInputAdded?.(input);\n    }\n    this.outputs ??= [];\n    this.outputs = this.outputs.map((output) => toClass(NodeOutputSlot, output, this));\n    for (const [i, output] of this.outputs.entries()) {\n      if (!output.links) continue;\n      for (const linkId of output.links) {\n        const link = this.graph ? this.graph._links.get(linkId) : null;\n        this.onConnectionsChange?.(NodeSlotType.OUTPUT, i, true, link, output);\n      }\n      this.onOutputAdded?.(output);\n    }\n    this._internalConfigureAfterSlots?.();\n    if (this.widgets) {\n      for (const w of this.widgets) {\n        if (!w) continue;\n        if (w.options?.property && this.properties[w.options.property] != void 0)\n          w.value = JSON.parse(JSON.stringify(this.properties[w.options.property]));\n      }\n      if (info.widgets_values) {\n        const widgetsWithValue = this.widgets.filter((w) => w.serialize !== false);\n        for (let i = 0; i < info.widgets_values.length; ++i) {\n          const widget = widgetsWithValue[i];\n          if (widget) {\n            widget.value = info.widgets_values[i];\n          }\n        }\n      }\n    }\n    if (this.pinned) this.resizable = false;\n    this.onConfigure?.(info);\n  }\n  /**\n   * serialize the content\n   */\n  serialize() {\n    const o = {\n      id: this.id,\n      type: this.type,\n      pos: [this.pos[0], this.pos[1]],\n      size: [this.size[0], this.size[1]],\n      flags: LiteGraph.cloneObject(this.flags),\n      order: this.order,\n      mode: this.mode,\n      showAdvanced: this.showAdvanced\n    };\n    if (this.constructor === LGraphNode && this.last_serialization)\n      return this.last_serialization;\n    if (this.inputs) o.inputs = this.inputs.map((input) => inputAsSerialisable(input));\n    if (this.outputs) o.outputs = this.outputs.map((output) => outputAsSerialisable(output));\n    if (this.title && this.title != this.constructor.title) o.title = this.title;\n    if (this.properties) o.properties = LiteGraph.cloneObject(this.properties);\n    const { widgets } = this;\n    if (widgets && this.serialize_widgets) {\n      o.widgets_values = [];\n      for (const [i, widget] of widgets.entries()) {\n        if (widget.serialize === false) continue;\n        o.widgets_values[i] = widget ? widget.value : null;\n      }\n    }\n    if (!o.type) o.type = this.constructor.type;\n    if (this.color) o.color = this.color;\n    if (this.bgcolor) o.bgcolor = this.bgcolor;\n    if (this.boxcolor) o.boxcolor = this.boxcolor;\n    if (this.shape) o.shape = this.shape;\n    if (this.onSerialize?.(o)) console.warn(\"node onSerialize shouldnt return anything, data should be stored in the object pass in the first parameter\");\n    return o;\n  }\n  /* Creates a clone of this node */\n  clone() {\n    if (this.type == null) return null;\n    const node2 = LiteGraph.createNode(this.type);\n    if (!node2) return null;\n    const data = LiteGraph.cloneObject(this.serialize());\n    const { inputs, outputs } = data;\n    if (inputs) {\n      for (const input of inputs) {\n        input.link = null;\n      }\n    }\n    if (outputs) {\n      for (const { links } of outputs) {\n        if (links) links.length = 0;\n      }\n    }\n    delete data.id;\n    if (LiteGraph.use_uuids) data.id = LiteGraph.uuidv4();\n    node2.configure(data);\n    return node2;\n  }\n  /**\n   * serialize and stringify\n   */\n  toString() {\n    return JSON.stringify(this.serialize());\n  }\n  /**\n   * get the title string\n   */\n  getTitle() {\n    return this.title || this.constructor.title;\n  }\n  /**\n   * sets the value of a property\n   * @param name\n   * @param value\n   */\n  setProperty(name, value) {\n    this.properties ||= {};\n    if (value === this.properties[name]) return;\n    const prev_value = this.properties[name];\n    this.properties[name] = value;\n    if (this.onPropertyChanged?.(name, value, prev_value) === false)\n      this.properties[name] = prev_value;\n    if (this.widgets) {\n      for (const w of this.widgets) {\n        if (!w) continue;\n        if (w.options.property == name) {\n          w.value = value;\n          break;\n        }\n      }\n    }\n  }\n  /**\n   * sets the output data\n   * @param slot\n   * @param data\n   */\n  setOutputData(slot, data) {\n    const { outputs } = this;\n    if (!outputs) return;\n    if (slot == -1 || slot >= outputs.length) return;\n    const output_info = outputs[slot];\n    if (!output_info) return;\n    output_info._data = data;\n    if (!this.graph) throw new NullGraphError();\n    const { links } = outputs[slot];\n    if (links) {\n      for (const id of links) {\n        const link = this.graph._links.get(id);\n        if (link) link.data = data;\n      }\n    }\n  }\n  /**\n   * sets the output data type, useful when you want to be able to overwrite the data type\n   */\n  setOutputDataType(slot, type) {\n    const { outputs } = this;\n    if (!outputs || (slot == -1 || slot >= outputs.length)) return;\n    const output_info = outputs[slot];\n    if (!output_info) return;\n    output_info.type = type;\n    if (!this.graph) throw new NullGraphError();\n    const { links } = outputs[slot];\n    if (links) {\n      for (const id of links) {\n        const link = this.graph._links.get(id);\n        if (link) link.type = type;\n      }\n    }\n  }\n  /**\n   * Retrieves the input data (data traveling through the connection) from one slot\n   * @param slot\n   * @param force_update if set to true it will force the connected node of this slot to output data into this link\n   * @returns data or if it is not connected returns undefined\n   */\n  getInputData(slot, force_update) {\n    if (!this.inputs) return;\n    if (slot >= this.inputs.length || this.inputs[slot].link == null) return;\n    if (!this.graph) throw new NullGraphError();\n    const link_id = this.inputs[slot].link;\n    const link = this.graph._links.get(link_id);\n    if (!link) return null;\n    if (!force_update) return link.data;\n    const node2 = this.graph.getNodeById(link.origin_id);\n    if (!node2) return link.data;\n    if (node2.updateOutputData) {\n      node2.updateOutputData(link.origin_slot);\n    } else {\n      node2.onExecute?.();\n    }\n    return link.data;\n  }\n  /**\n   * Retrieves the input data type (in case this supports multiple input types)\n   * @param slot\n   * @returns datatype in string format\n   */\n  getInputDataType(slot) {\n    if (!this.inputs) return null;\n    if (slot >= this.inputs.length || this.inputs[slot].link == null) return null;\n    if (!this.graph) throw new NullGraphError();\n    const link_id = this.inputs[slot].link;\n    const link = this.graph._links.get(link_id);\n    if (!link) return null;\n    const node2 = this.graph.getNodeById(link.origin_id);\n    if (!node2) return link.type;\n    const output_info = node2.outputs[link.origin_slot];\n    return output_info ? output_info.type : null;\n  }\n  /**\n   * Retrieves the input data from one slot using its name instead of slot number\n   * @param slot_name\n   * @param force_update if set to true it will force the connected node of this slot to output data into this link\n   * @returns data or if it is not connected returns null\n   */\n  getInputDataByName(slot_name, force_update) {\n    const slot = this.findInputSlot(slot_name);\n    return slot == -1 ? null : this.getInputData(slot, force_update);\n  }\n  /**\n   * tells you if there is a connection in one input slot\n   * @param slot The 0-based index of the input to check\n   * @returns `true` if the input slot has a link ID (does not perform validation)\n   */\n  isInputConnected(slot) {\n    if (!this.inputs) return false;\n    return slot < this.inputs.length && this.inputs[slot].link != null;\n  }\n  /**\n   * tells you info about an input connection (which node, type, etc)\n   * @returns object or null { link: id, name: string, type: string or 0 }\n   */\n  getInputInfo(slot) {\n    return !this.inputs || !(slot < this.inputs.length) ? null : this.inputs[slot];\n  }\n  /**\n   * Returns the link info in the connection of an input slot\n   * @returns object or null\n   */\n  getInputLink(slot) {\n    if (!this.inputs) return null;\n    if (slot < this.inputs.length) {\n      if (!this.graph) throw new NullGraphError();\n      const input = this.inputs[slot];\n      if (input.link != null) {\n        return this.graph._links.get(input.link) ?? null;\n      }\n    }\n    return null;\n  }\n  /**\n   * returns the node connected in the input slot\n   * @returns node or null\n   */\n  getInputNode(slot) {\n    if (!this.inputs) return null;\n    if (slot >= this.inputs.length) return null;\n    const input = this.inputs[slot];\n    if (!input || input.link === null) return null;\n    if (!this.graph) throw new NullGraphError();\n    const link_info = this.graph._links.get(input.link);\n    if (!link_info) return null;\n    return this.graph.getNodeById(link_info.origin_id);\n  }\n  /**\n   * returns the value of an input with this name, otherwise checks if there is a property with that name\n   * @returns value\n   */\n  getInputOrProperty(name) {\n    const { inputs } = this;\n    if (!inputs?.length) {\n      return this.properties ? this.properties[name] : null;\n    }\n    if (!this.graph) throw new NullGraphError();\n    for (const input of inputs) {\n      if (name == input.name && input.link != null) {\n        const link = this.graph._links.get(input.link);\n        if (link) return link.data;\n      }\n    }\n    return this.properties[name];\n  }\n  /**\n   * tells you the last output data that went in that slot\n   * @returns object or null\n   */\n  getOutputData(slot) {\n    if (!this.outputs) return null;\n    if (slot >= this.outputs.length) return null;\n    const info = this.outputs[slot];\n    return info._data;\n  }\n  /**\n   * tells you info about an output connection (which node, type, etc)\n   * @returns object or null { name: string, type: string, links: [ ids of links in number ] }\n   */\n  getOutputInfo(slot) {\n    return !this.outputs || !(slot < this.outputs.length) ? null : this.outputs[slot];\n  }\n  /**\n   * tells you if there is a connection in one output slot\n   */\n  isOutputConnected(slot) {\n    if (!this.outputs) return false;\n    return slot < this.outputs.length && Number(this.outputs[slot].links?.length) > 0;\n  }\n  /**\n   * tells you if there is any connection in the output slots\n   */\n  isAnyOutputConnected() {\n    const { outputs } = this;\n    if (!outputs) return false;\n    for (const output of outputs) {\n      if (output.links?.length) return true;\n    }\n    return false;\n  }\n  /**\n   * retrieves all the nodes connected to this output slot\n   */\n  getOutputNodes(slot) {\n    const { outputs } = this;\n    if (!outputs || outputs.length == 0) return null;\n    if (slot >= outputs.length) return null;\n    const { links } = outputs[slot];\n    if (!links || links.length == 0) return null;\n    if (!this.graph) throw new NullGraphError();\n    const r = [];\n    for (const id of links) {\n      const link = this.graph._links.get(id);\n      if (link) {\n        const target_node = this.graph.getNodeById(link.target_id);\n        if (target_node) {\n          r.push(target_node);\n        }\n      }\n    }\n    return r;\n  }\n  addOnTriggerInput() {\n    const trigS = this.findInputSlot(\"onTrigger\");\n    if (trigS == -1) {\n      this.addInput(\"onTrigger\", LiteGraph.EVENT, {\n        nameLocked: true\n      });\n      return this.findInputSlot(\"onTrigger\");\n    }\n    return trigS;\n  }\n  addOnExecutedOutput() {\n    const trigS = this.findOutputSlot(\"onExecuted\");\n    if (trigS == -1) {\n      this.addOutput(\"onExecuted\", LiteGraph.ACTION, {\n        nameLocked: true\n      });\n      return this.findOutputSlot(\"onExecuted\");\n    }\n    return trigS;\n  }\n  onAfterExecuteNode(param, options) {\n    const trigS = this.findOutputSlot(\"onExecuted\");\n    if (trigS != -1) {\n      this.triggerSlot(trigS, param, null, options);\n    }\n  }\n  changeMode(modeTo) {\n    switch (modeTo) {\n      case LGraphEventMode.ON_EVENT:\n        break;\n      case LGraphEventMode.ON_TRIGGER:\n        this.addOnTriggerInput();\n        this.addOnExecutedOutput();\n        break;\n      case LGraphEventMode.NEVER:\n        break;\n      case LGraphEventMode.ALWAYS:\n        break;\n      // @ts-expect-error Not impl.\n      case LiteGraph.ON_REQUEST:\n        break;\n      default:\n        return false;\n    }\n    this.mode = modeTo;\n    return true;\n  }\n  /**\n   * Triggers the node code execution, place a boolean/counter to mark the node as being executed\n   */\n  doExecute(param, options) {\n    options = options || {};\n    if (this.onExecute) {\n      options.action_call ||= `${this.id}_exec_${Math.floor(Math.random() * 9999)}`;\n      if (!this.graph) throw new NullGraphError();\n      this.graph.nodes_executing[this.id] = true;\n      this.onExecute(param, options);\n      this.graph.nodes_executing[this.id] = false;\n      this.exec_version = this.graph.iteration;\n      if (options?.action_call) {\n        this.action_call = options.action_call;\n        this.graph.nodes_executedAction[this.id] = options.action_call;\n      }\n    }\n    this.execute_triggered = 2;\n    this.onAfterExecuteNode?.(param, options);\n  }\n  /**\n   * Triggers an action, wrapped by logics to control execution flow\n   * @param action name\n   */\n  actionDo(action, param, options) {\n    options = options || {};\n    if (this.onAction) {\n      options.action_call ||= `${this.id}_${action || \"action\"}_${Math.floor(Math.random() * 9999)}`;\n      if (!this.graph) throw new NullGraphError();\n      this.graph.nodes_actioning[this.id] = action || \"actioning\";\n      this.onAction(action, param, options);\n      this.graph.nodes_actioning[this.id] = false;\n      if (options?.action_call) {\n        this.action_call = options.action_call;\n        this.graph.nodes_executedAction[this.id] = options.action_call;\n      }\n    }\n    this.action_triggered = 2;\n    this.onAfterExecuteNode?.(param, options);\n  }\n  /**\n   * Triggers an event in this node, this will trigger any output with the same name\n   * @param action name ( \"on_play\", ... ) if action is equivalent to false then the event is send to all\n   */\n  trigger(action, param, options) {\n    const { outputs } = this;\n    if (!outputs || !outputs.length) {\n      return;\n    }\n    if (this.graph) this.graph._last_trigger_time = LiteGraph.getTime();\n    for (const [i, output] of outputs.entries()) {\n      if (!output || output.type !== LiteGraph.EVENT || action && output.name != action) {\n        continue;\n      }\n      this.triggerSlot(i, param, null, options);\n    }\n  }\n  /**\n   * Triggers a slot event in this node: cycle output slots and launch execute/action on connected nodes\n   * @param slot the index of the output slot\n   * @param link_id [optional] in case you want to trigger and specific output link in a slot\n   */\n  triggerSlot(slot, param, link_id, options) {\n    options = options || {};\n    if (!this.outputs) return;\n    if (slot == null) {\n      console.error(\"slot must be a number\");\n      return;\n    }\n    if (typeof slot !== \"number\")\n      console.warn(\"slot must be a number, use node.trigger('name') if you want to use a string\");\n    const output = this.outputs[slot];\n    if (!output) return;\n    const links = output.links;\n    if (!links || !links.length) return;\n    if (!this.graph) throw new NullGraphError();\n    this.graph._last_trigger_time = LiteGraph.getTime();\n    for (const id of links) {\n      if (link_id != null && link_id != id) continue;\n      const link_info = this.graph._links.get(id);\n      if (!link_info) continue;\n      link_info._last_time = LiteGraph.getTime();\n      const node2 = this.graph.getNodeById(link_info.target_id);\n      if (!node2) continue;\n      if (node2.mode === LGraphEventMode.ON_TRIGGER) {\n        if (!options.action_call)\n          options.action_call = `${this.id}_trigg_${Math.floor(Math.random() * 9999)}`;\n        node2.doExecute?.(param, options);\n      } else if (node2.onAction) {\n        if (!options.action_call)\n          options.action_call = `${this.id}_act_${Math.floor(Math.random() * 9999)}`;\n        const target_connection = node2.inputs[link_info.target_slot];\n        node2.actionDo(target_connection.name, param, options);\n      }\n    }\n  }\n  /**\n   * clears the trigger slot animation\n   * @param slot the index of the output slot\n   * @param link_id [optional] in case you want to trigger and specific output link in a slot\n   */\n  clearTriggeredSlot(slot, link_id) {\n    if (!this.outputs) return;\n    const output = this.outputs[slot];\n    if (!output) return;\n    const links = output.links;\n    if (!links || !links.length) return;\n    if (!this.graph) throw new NullGraphError();\n    for (const id of links) {\n      if (link_id != null && link_id != id) continue;\n      const link_info = this.graph._links.get(id);\n      if (!link_info) continue;\n      link_info._last_time = 0;\n    }\n  }\n  /**\n   * changes node size and triggers callback\n   */\n  setSize(size) {\n    this.size = size;\n    this.onResize?.(this.size);\n  }\n  /**\n   * Expands the node size to fit its content.\n   */\n  expandToFitContent() {\n    const newSize = this.computeSize();\n    this.setSize([\n      Math.max(this.size[0], newSize[0]),\n      Math.max(this.size[1], newSize[1])\n    ]);\n  }\n  /**\n   * add a new property to this node\n   * @param type string defining the output type (\"vec3\",\"number\",...)\n   * @param extra_info this can be used to have special properties of the property (like values, etc)\n   */\n  addProperty(name, default_value, type, extra_info) {\n    const o = { name, type, default_value };\n    if (extra_info) Object.assign(o, extra_info);\n    this.properties_info ||= [];\n    this.properties_info.push(o);\n    this.properties ||= {};\n    this.properties[name] = default_value;\n    return o;\n  }\n  /**\n   * add a new output slot to use in this node\n   * @param type string defining the output type (\"vec3\",\"number\",...)\n   * @param extra_info this can be used to have special properties of an output (label, special color, position, etc)\n   */\n  addOutput(name, type, extra_info) {\n    const output = Object.assign(\n      new NodeOutputSlot({ name, type, links: null }, this),\n      extra_info\n    );\n    this.outputs ||= [];\n    this.outputs.push(output);\n    this.onOutputAdded?.(output);\n    if (LiteGraph.auto_load_slot_types)\n      LiteGraph.registerNodeAndSlotType(this, type, true);\n    this.expandToFitContent();\n    this.setDirtyCanvas(true, true);\n    return output;\n  }\n  /**\n   * remove an existing output slot\n   */\n  removeOutput(slot) {\n    this.disconnectOutput(slot);\n    const { outputs } = this;\n    outputs.splice(slot, 1);\n    for (let i = slot; i < outputs.length; ++i) {\n      const output = outputs[i];\n      if (!output || !output.links) continue;\n      for (const linkId of output.links) {\n        if (!this.graph) throw new NullGraphError();\n        const link = this.graph._links.get(linkId);\n        if (link) link.origin_slot--;\n      }\n    }\n    this.onOutputRemoved?.(slot);\n    this.setDirtyCanvas(true, true);\n  }\n  /**\n   * add a new input slot to use in this node\n   * @param type string defining the input type (\"vec3\",\"number\",...), it its a generic one use 0\n   * @param extra_info this can be used to have special properties of an input (label, color, position, etc)\n   */\n  addInput(name, type, extra_info) {\n    type ||= 0;\n    const input = Object.assign(\n      new NodeInputSlot({ name, type, link: null }, this),\n      extra_info\n    );\n    this.inputs ||= [];\n    this.inputs.push(input);\n    this.expandToFitContent();\n    this.onInputAdded?.(input);\n    LiteGraph.registerNodeAndSlotType(this, type);\n    this.setDirtyCanvas(true, true);\n    return input;\n  }\n  /**\n   * remove an existing input slot\n   */\n  removeInput(slot) {\n    this.disconnectInput(slot, true);\n    const { inputs } = this;\n    const slot_info = inputs.splice(slot, 1);\n    for (let i = slot; i < inputs.length; ++i) {\n      const input = inputs[i];\n      if (!input?.link) continue;\n      if (!this.graph) throw new NullGraphError();\n      const link = this.graph._links.get(input.link);\n      if (link) link.target_slot--;\n    }\n    this.onInputRemoved?.(slot, slot_info[0]);\n    this.setDirtyCanvas(true, true);\n  }\n  /**\n   * computes the minimum size of a node according to its inputs and output slots\n   * @returns the total size\n   */\n  computeSize(out) {\n    const ctorSize = this.constructor.size;\n    if (ctorSize) return [ctorSize[0], ctorSize[1]];\n    const { inputs, outputs, widgets } = this;\n    let rows = Math.max(\n      inputs ? inputs.filter((input) => !isWidgetInputSlot(input)).length : 1,\n      outputs ? outputs.length : 1\n    );\n    const size = out || new Float32Array([0, 0]);\n    rows = Math.max(rows, 1);\n    const font_size = LiteGraph.NODE_TEXT_SIZE;\n    const padLeft = LiteGraph.NODE_TITLE_HEIGHT;\n    const padRight = padLeft * 0.33;\n    const title_width = padLeft + compute_text_size(this.title, this.titleFontStyle) + padRight;\n    let input_width = 0;\n    let widgetWidth = 0;\n    let output_width = 0;\n    if (inputs) {\n      for (const input of inputs) {\n        const text = input.label || input.localized_name || input.name || \"\";\n        const text_width = compute_text_size(text, this.innerFontStyle);\n        if (isWidgetInputSlot(input)) {\n          const widget = this.getWidgetFromSlot(input);\n          if (widget && !this.isWidgetVisible(widget)) continue;\n          if (text_width > widgetWidth) widgetWidth = text_width;\n        } else {\n          if (text_width > input_width) input_width = text_width;\n        }\n      }\n    }\n    if (outputs) {\n      for (const output of outputs) {\n        const text = output.label || output.localized_name || output.name || \"\";\n        const text_width = compute_text_size(text, this.innerFontStyle);\n        if (output_width < text_width)\n          output_width = text_width;\n      }\n    }\n    const minWidth = LiteGraph.NODE_WIDTH * (widgets?.length ? 1.5 : 1);\n    const centrePadding = input_width && output_width ? 5 : 0;\n    const slotsWidth = input_width + output_width + 2 * LiteGraph.NODE_SLOT_HEIGHT + centrePadding;\n    const widgetMargin = BaseWidget.margin + BaseWidget.arrowMargin + BaseWidget.arrowWidth;\n    const widgetPadding = BaseWidget.minValueWidth + 2 * widgetMargin;\n    if (widgetWidth) widgetWidth += widgetPadding;\n    size[0] = Math.max(slotsWidth, widgetWidth, title_width, minWidth);\n    size[1] = (this.constructor.slot_start_y || 0) + rows * LiteGraph.NODE_SLOT_HEIGHT;\n    let widgets_height = 0;\n    if (widgets?.length) {\n      for (const widget of widgets) {\n        if (!this.isWidgetVisible(widget)) continue;\n        let widget_height = 0;\n        if (widget.computeSize) {\n          widget_height += widget.computeSize(size[0])[1];\n        } else if (widget.computeLayoutSize) {\n          const { minHeight, minWidth: minWidth2 } = widget.computeLayoutSize(this);\n          const widgetWidth2 = minWidth2 + widgetPadding;\n          if (widgetWidth2 > size[0]) size[0] = widgetWidth2;\n          widget_height += minHeight;\n        } else {\n          widget_height += LiteGraph.NODE_WIDGET_HEIGHT;\n        }\n        widgets_height += widget_height + 4;\n      }\n      widgets_height += 8;\n    }\n    if (this.widgets_up)\n      size[1] = Math.max(size[1], widgets_height);\n    else if (this.widgets_start_y != null)\n      size[1] = Math.max(size[1], widgets_height + this.widgets_start_y);\n    else\n      size[1] += widgets_height;\n    function compute_text_size(text, fontStyle) {\n      return LGraphCanvas._measureText?.(text, fontStyle) ?? font_size * (text?.length ?? 0) * 0.6;\n    }\n    if (this.constructor.min_height && size[1] < this.constructor.min_height) {\n      size[1] = this.constructor.min_height;\n    }\n    size[1] += 6;\n    return size;\n  }\n  inResizeCorner(canvasX, canvasY) {\n    const rows = this.outputs ? this.outputs.length : 1;\n    const outputs_offset = (this.constructor.slot_start_y || 0) + rows * LiteGraph.NODE_SLOT_HEIGHT;\n    return isInRectangle(\n      canvasX,\n      canvasY,\n      this.pos[0] + this.size[0] - 15,\n      this.pos[1] + Math.max(this.size[1] - 15, outputs_offset),\n      20,\n      20\n    );\n  }\n  /**\n   * Returns which resize corner the point is over, if any.\n   * @param canvasX X position in canvas coordinates\n   * @param canvasY Y position in canvas coordinates\n   * @returns The compass corner the point is in, otherwise `undefined`.\n   */\n  findResizeDirection(canvasX, canvasY) {\n    if (this.resizable === false) return;\n    const { boundingRect } = this;\n    if (!boundingRect.containsXy(canvasX, canvasY)) return;\n    return boundingRect.findContainingCorner(canvasX, canvasY, LGraphNode.resizeHandleSize);\n  }\n  /**\n   * returns all the info available about a property of this node.\n   * @param property name of the property\n   * @returns the object with all the available info\n   */\n  getPropertyInfo(property) {\n    let info = null;\n    const { properties_info } = this;\n    if (properties_info) {\n      for (const propInfo of properties_info) {\n        if (propInfo.name == property) {\n          info = propInfo;\n          break;\n        }\n      }\n    }\n    if (this.constructor[`@${property}`]) info = this.constructor[`@${property}`];\n    if (this.constructor.widgets_info?.[property])\n      info = this.constructor.widgets_info[property];\n    if (!info && this.onGetPropertyInfo) {\n      info = this.onGetPropertyInfo(property);\n    }\n    info ||= {};\n    info.type ||= typeof this.properties[property];\n    if (info.widget == \"combo\") info.type = \"enum\";\n    return info;\n  }\n  /**\n   * Defines a widget inside the node, it will be rendered on top of the node, you can control lots of properties\n   * @param type the widget type\n   * @param name the text to show on the widget\n   * @param value the default value\n   * @param callback function to call when it changes (optionally, it can be the name of the property to modify)\n   * @param options the object that contains special properties of this widget\n   * @returns the created widget object\n   */\n  addWidget(type, name, value, callback, options) {\n    this.widgets ||= [];\n    if (!options && callback && typeof callback === \"object\") {\n      options = callback;\n      callback = null;\n    }\n    options ||= {};\n    if (typeof options === \"string\")\n      options = { property: options };\n    if (callback && typeof callback === \"string\") {\n      options.property = callback;\n      callback = null;\n    }\n    const w = {\n      // @ts-expect-error\n      type: type.toLowerCase(),\n      name,\n      value,\n      callback: typeof callback !== \"function\" ? void 0 : callback,\n      options,\n      y: 0\n    };\n    if (w.options.y !== void 0) {\n      w.y = w.options.y;\n    }\n    if (!callback && !w.options.callback && !w.options.property) {\n      console.warn(\"LiteGraph addWidget(...) without a callback or property assigned\");\n    }\n    if (type == \"combo\" && !w.options.values) {\n      throw \"LiteGraph addWidget('combo',...) requires to pass values in options: { values:['red','blue'] }\";\n    }\n    const widget = this.addCustomWidget(w);\n    this.expandToFitContent();\n    return widget;\n  }\n  addCustomWidget(custom_widget) {\n    this.widgets ||= [];\n    const widget = toConcreteWidget(custom_widget, this, false) ?? custom_widget;\n    this.widgets.push(widget);\n    return widget;\n  }\n  addTitleButton(options) {\n    this.title_buttons ||= [];\n    const button = new LGraphButton(options);\n    this.title_buttons.push(button);\n    return button;\n  }\n  onTitleButtonClick(button, canvas2) {\n    canvas2.dispatch(\"litegraph:node-title-button-clicked\", {\n      node: this,\n      button\n    });\n  }\n  removeWidgetByName(name) {\n    const widget = this.widgets?.find((x2) => x2.name === name);\n    if (widget) this.removeWidget(widget);\n  }\n  removeWidget(widget) {\n    if (!this.widgets) throw new Error(\"removeWidget called on node without widgets\");\n    const widgetIndex = this.widgets.indexOf(widget);\n    if (widgetIndex === -1) throw new Error(\"Widget not found on this node\");\n    if (this.inputs) {\n      for (const input of this.inputs) {\n        if (input._widget === widget) {\n          input._widget = void 0;\n          delete input.widget;\n        }\n      }\n    }\n    this.widgets.splice(widgetIndex, 1);\n  }\n  ensureWidgetRemoved(widget) {\n    try {\n      this.removeWidget(widget);\n    } catch (error) {\n      console.debug(\"Failed to remove widget\", error);\n    }\n  }\n  move(deltaX, deltaY) {\n    if (this.pinned) return;\n    this.pos[0] += deltaX;\n    this.pos[1] += deltaY;\n  }\n  /**\n   * Internal method to measure the node for rendering.  Prefer {@link boundingRect} where possible.\n   *\n   * Populates {@link out} with the results in graph space.\n   * Populates {@link _collapsed_width} with the collapsed width if the node is collapsed.\n   * Adjusts for title and collapsed status, but does not call {@link onBounding}.\n   * @param out `x, y, width, height` are written to this array.\n   * @param ctx The canvas context to use for measuring text.\n   */\n  measure(out, ctx) {\n    const titleMode = this.title_mode;\n    const renderTitle = titleMode != TitleMode.TRANSPARENT_TITLE && titleMode != TitleMode.NO_TITLE;\n    const titleHeight = renderTitle ? LiteGraph.NODE_TITLE_HEIGHT : 0;\n    out[0] = this.pos[0];\n    out[1] = this.pos[1] + -titleHeight;\n    if (!this.flags?.collapsed) {\n      out[2] = this.size[0];\n      out[3] = this.size[1] + titleHeight;\n    } else {\n      ctx.font = this.innerFontStyle;\n      this._collapsed_width = Math.min(\n        this.size[0],\n        ctx.measureText(this.getTitle() ?? \"\").width + LiteGraph.NODE_TITLE_HEIGHT * 2\n      );\n      out[2] = this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH;\n      out[3] = LiteGraph.NODE_TITLE_HEIGHT;\n    }\n  }\n  /**\n   * returns the bounding of the object, used for rendering purposes\n   * @param out {Float32Array[4]?} [optional] a place to store the output, to free garbage\n   * @param includeExternal {boolean?} [optional] set to true to\n   * include the shadow and connection points in the bounding calculation\n   * @returns the bounding box in format of [topleft_cornerx, topleft_cornery, width, height]\n   */\n  getBounding(out, includeExternal) {\n    out ||= new Float32Array(4);\n    const rect = includeExternal ? this.renderArea : this.boundingRect;\n    out[0] = rect[0];\n    out[1] = rect[1];\n    out[2] = rect[2];\n    out[3] = rect[3];\n    return out;\n  }\n  /**\n   * Calculates the render area of this node, populating both {@link boundingRect} and {@link renderArea}.\n   * Called automatically at the start of every frame.\n   */\n  updateArea(ctx) {\n    const bounds = this.#boundingRect;\n    this.measure(bounds, ctx);\n    this.onBounding?.(bounds);\n    const renderArea = this.#renderArea;\n    renderArea.set(bounds);\n    renderArea[0] -= 4;\n    renderArea[1] -= 4;\n    renderArea[2] += 6 + 4;\n    renderArea[3] += 5 + 4;\n  }\n  /**\n   * checks if a point is inside the shape of a node\n   */\n  isPointInside(x2, y) {\n    return isInRect(x2, y, this.boundingRect);\n  }\n  /**\n   * Checks if the provided point is inside this node's collapse button area.\n   * @param x X co-ordinate to check\n   * @param y Y co-ordinate to check\n   * @returns true if the x,y point is in the collapse button area, otherwise false\n   */\n  isPointInCollapse(x2, y) {\n    const squareLength = LiteGraph.NODE_TITLE_HEIGHT;\n    return isInRectangle(\n      x2,\n      y,\n      this.pos[0],\n      this.pos[1] - squareLength,\n      squareLength,\n      squareLength\n    );\n  }\n  /**\n   * Returns the input slot at the given position. Uses full 20 height, and approximates the label length.\n   * @param pos The graph co-ordinates to check\n   * @returns The input slot at the given position if found, otherwise `undefined`.\n   */\n  getInputOnPos(pos) {\n    return getNodeInputOnPos(this, pos[0], pos[1])?.input;\n  }\n  /**\n   * Returns the output slot at the given position. Uses full 20x20 box for the slot.\n   * @param pos The graph co-ordinates to check\n   * @returns The output slot at the given position if found, otherwise `undefined`.\n   */\n  getOutputOnPos(pos) {\n    return getNodeOutputOnPos(this, pos[0], pos[1])?.output;\n  }\n  /**\n   * Returns the input or output slot at the given position.\n   *\n   * Tries {@link getNodeInputOnPos} first, then {@link getNodeOutputOnPos}.\n   * @param pos The graph co-ordinates to check\n   * @returns The input or output slot at the given position if found, otherwise `undefined`.\n   */\n  getSlotOnPos(pos) {\n    if (!isPointInRect(pos, this.boundingRect)) return;\n    return this.getInputOnPos(pos) ?? this.getOutputOnPos(pos);\n  }\n  /**\n   * @deprecated Use {@link getSlotOnPos} instead.\n   * checks if a point is inside a node slot, and returns info about which slot\n   * @param x\n   * @param y\n   * @returns if found the object contains { input|output: slot object, slot: number, link_pos: [x,y] }\n   */\n  getSlotInPosition(x2, y) {\n    const { inputs, outputs } = this;\n    if (inputs) {\n      for (const [i, input] of inputs.entries()) {\n        const pos = this.getInputPos(i);\n        if (isInRectangle(x2, y, pos[0] - 10, pos[1] - 10, 20, 20)) {\n          return { input, slot: i, link_pos: pos };\n        }\n      }\n    }\n    if (outputs) {\n      for (const [i, output] of outputs.entries()) {\n        const pos = this.getOutputPos(i);\n        if (isInRectangle(x2, y, pos[0] - 10, pos[1] - 10, 20, 20)) {\n          return { output, slot: i, link_pos: pos };\n        }\n      }\n    }\n    return null;\n  }\n  /**\n   * Gets the widget on this node at the given co-ordinates.\n   * @param canvasX X co-ordinate in graph space\n   * @param canvasY Y co-ordinate in graph space\n   * @returns The widget found, otherwise `null`\n   */\n  getWidgetOnPos(canvasX, canvasY, includeDisabled = false) {\n    const { widgets, pos, size } = this;\n    if (!widgets?.length) return;\n    const x2 = canvasX - pos[0];\n    const y = canvasY - pos[1];\n    const nodeWidth = size[0];\n    for (const widget of widgets) {\n      if (widget.computedDisabled && !includeDisabled || !this.isWidgetVisible(widget)) {\n        continue;\n      }\n      const h = widget.computedHeight ?? widget.computeSize?.(nodeWidth)[1] ?? LiteGraph.NODE_WIDGET_HEIGHT;\n      const w = widget.width || nodeWidth;\n      if (widget.last_y !== void 0 && isInRectangle(x2, y, 6, widget.last_y, w - 12, h)) {\n        return widget;\n      }\n    }\n  }\n  findInputSlot(name, returnObj = false) {\n    const { inputs } = this;\n    if (!inputs) return -1;\n    for (const [i, input] of inputs.entries()) {\n      if (name == input.name) {\n        return !returnObj ? i : input;\n      }\n    }\n    return -1;\n  }\n  findOutputSlot(name, returnObj = false) {\n    const { outputs } = this;\n    if (!outputs) return -1;\n    for (const [i, output] of outputs.entries()) {\n      if (name == output.name) {\n        return !returnObj ? i : output;\n      }\n    }\n    return -1;\n  }\n  findInputSlotFree(optsIn) {\n    return this.#findFreeSlot(this.inputs, optsIn);\n  }\n  findOutputSlotFree(optsIn) {\n    return this.#findFreeSlot(this.outputs, optsIn);\n  }\n  /**\n   * Finds the next free slot\n   * @param slots The slots to search, i.e. this.inputs or this.outputs\n   */\n  #findFreeSlot(slots, options) {\n    const defaults = {\n      returnObj: false,\n      typesNotAccepted: []\n    };\n    const opts = Object.assign(defaults, options || {});\n    const length = slots?.length;\n    if (!(length > 0)) return -1;\n    for (let i = 0; i < length; ++i) {\n      const slot = slots[i];\n      if (!slot || slot.link || slot.links?.length) continue;\n      if (opts.typesNotAccepted?.includes?.(slot.type)) continue;\n      return !opts.returnObj ? i : slot;\n    }\n    return -1;\n  }\n  findInputSlotByType(type, returnObj, preferFreeSlot, doNotUseOccupied) {\n    return this.#findSlotByType(\n      this.inputs,\n      type,\n      returnObj,\n      preferFreeSlot,\n      doNotUseOccupied\n    );\n  }\n  findOutputSlotByType(type, returnObj, preferFreeSlot, doNotUseOccupied) {\n    return this.#findSlotByType(\n      this.outputs,\n      type,\n      returnObj,\n      preferFreeSlot,\n      doNotUseOccupied\n    );\n  }\n  findSlotByType(input, type, returnObj, preferFreeSlot, doNotUseOccupied) {\n    return input ? this.#findSlotByType(\n      this.inputs,\n      type,\n      returnObj,\n      preferFreeSlot,\n      doNotUseOccupied\n    ) : this.#findSlotByType(\n      this.outputs,\n      type,\n      returnObj,\n      preferFreeSlot,\n      doNotUseOccupied\n    );\n  }\n  /**\n   * Finds a matching slot from those provided, returning the slot itself or its index in {@link slots}.\n   * @param slots Slots to search (this.inputs or this.outputs)\n   * @param type Type of slot to look for\n   * @param returnObj If true, returns the slot itself.  Otherwise, the index.\n   * @param preferFreeSlot Prefer a free slot, but if none are found, fall back to an occupied slot.\n   * @param doNotUseOccupied Do not fall back to occupied slots.\n   * @see {findSlotByType}\n   * @see {findOutputSlotByType}\n   * @see {findInputSlotByType}\n   * @returns If a match is found, the slot if returnObj is true, otherwise the index.  If no matches are found, -1\n   */\n  #findSlotByType(slots, type, returnObj, preferFreeSlot, doNotUseOccupied) {\n    const length = slots?.length;\n    if (!length) return -1;\n    if (type == \"\" || type == \"*\") type = 0;\n    const sourceTypes = String(type).toLowerCase().split(\",\");\n    let occupiedSlot = null;\n    for (let i = 0; i < length; ++i) {\n      const slot = slots[i];\n      const destTypes = slot.type == \"0\" || slot.type == \"*\" ? [\"0\"] : String(slot.type).toLowerCase().split(\",\");\n      for (const sourceType of sourceTypes) {\n        const source = sourceType == \"_event_\" ? LiteGraph.EVENT : sourceType;\n        for (const destType of destTypes) {\n          const dest = destType == \"_event_\" ? LiteGraph.EVENT : destType;\n          if (source == dest || source === \"*\" || dest === \"*\") {\n            if (preferFreeSlot && (slot.links?.length || slot.link != null)) {\n              occupiedSlot ??= returnObj ? slot : i;\n              continue;\n            }\n            return returnObj ? slot : i;\n          }\n        }\n      }\n    }\n    return doNotUseOccupied ? -1 : occupiedSlot ?? -1;\n  }\n  /**\n   * Determines the slot index to connect to when attempting to connect by type.\n   * @param findInputs If true, searches for an input.  Otherwise, an output.\n   * @param node The node at the other end of the connection.\n   * @param slotType The type of slot at the other end of the connection.\n   * @param options Search restrictions to adhere to.\n   * @see {connectByType}\n   * @see {connectByTypeOutput}\n   */\n  findConnectByTypeSlot(findInputs, node2, slotType, options) {\n    if (options && typeof options === \"object\") {\n      if (\"firstFreeIfInputGeneralInCase\" in options) options.wildcardToTyped = !!options.firstFreeIfInputGeneralInCase;\n      if (\"firstFreeIfOutputGeneralInCase\" in options) options.wildcardToTyped = !!options.firstFreeIfOutputGeneralInCase;\n      if (\"generalTypeInCase\" in options) options.typedToWildcard = !!options.generalTypeInCase;\n    }\n    const optsDef = {\n      createEventInCase: true,\n      wildcardToTyped: true,\n      typedToWildcard: true\n    };\n    const opts = Object.assign(optsDef, options);\n    if (!this.graph) throw new NullGraphError();\n    if (node2 && typeof node2 === \"number\") {\n      const nodeById = this.graph.getNodeById(node2);\n      if (!nodeById) return;\n      node2 = nodeById;\n    }\n    const slot = node2.findSlotByType(findInputs, slotType, false, true);\n    if (slot >= 0 && slot !== null) return slot;\n    if (opts.createEventInCase && slotType == LiteGraph.EVENT) {\n      if (findInputs) return -1;\n      if (LiteGraph.do_add_triggers_slots) return node2.addOnExecutedOutput();\n    }\n    if (opts.typedToWildcard) {\n      const generalSlot = node2.findSlotByType(findInputs, 0, false, true, true);\n      if (generalSlot >= 0) return generalSlot;\n    }\n    if (opts.wildcardToTyped && (slotType == 0 || slotType == \"*\" || slotType == \"\")) {\n      const opt = { typesNotAccepted: [LiteGraph.EVENT] };\n      const nonEventSlot = findInputs ? node2.findInputSlotFree(opt) : node2.findOutputSlotFree(opt);\n      if (nonEventSlot >= 0) return nonEventSlot;\n    }\n  }\n  /**\n   * Finds the first free output slot with any of the comma-delimited types in {@link type}.\n   *\n   * If no slots are free, falls back in order to:\n   * - The first free wildcard slot\n   * - The first occupied slot\n   * - The first occupied wildcard slot\n   * @param type The {@link ISlotType type} of slot to find\n   * @returns The index and slot if found, otherwise `undefined`.\n   */\n  findOutputByType(type) {\n    return findFreeSlotOfType(this.outputs, type, (output) => !output.links?.length);\n  }\n  /**\n   * Finds the first free input slot with any of the comma-delimited types in {@link type}.\n   *\n   * If no slots are free, falls back in order to:\n   * - The first free wildcard slot\n   * - The first occupied slot\n   * - The first occupied wildcard slot\n   * @param type The {@link ISlotType type} of slot to find\n   * @returns The index and slot if found, otherwise `undefined`.\n   */\n  findInputByType(type) {\n    return findFreeSlotOfType(this.inputs, type, (input) => input.link == null);\n  }\n  /**\n   * connect this node output to the input of another node BY TYPE\n   * @param slot (could be the number of the slot or the string with the name of the slot)\n   * @param target_node the target node\n   * @param target_slotType the input slot type of the target node\n   * @returns the link_info is created, otherwise null\n   */\n  connectByType(slot, target_node, target_slotType, optsIn) {\n    const slotIndex = this.findConnectByTypeSlot(\n      true,\n      target_node,\n      target_slotType,\n      optsIn\n    );\n    if (slotIndex !== void 0)\n      return this.connect(slot, target_node, slotIndex, optsIn?.afterRerouteId);\n    console.debug(\"[connectByType]: no way to connect type:\", target_slotType, \"to node:\", target_node);\n    return null;\n  }\n  /**\n   * connect this node input to the output of another node BY TYPE\n   * @param slot (could be the number of the slot or the string with the name of the slot)\n   * @param source_node the target node\n   * @param source_slotType the output slot type of the target node\n   * @returns the link_info is created, otherwise null\n   */\n  connectByTypeOutput(slot, source_node, source_slotType, optsIn) {\n    if (typeof optsIn === \"object\") {\n      if (\"firstFreeIfInputGeneralInCase\" in optsIn) optsIn.wildcardToTyped = !!optsIn.firstFreeIfInputGeneralInCase;\n      if (\"generalTypeInCase\" in optsIn) optsIn.typedToWildcard = !!optsIn.generalTypeInCase;\n    }\n    const slotIndex = this.findConnectByTypeSlot(\n      false,\n      source_node,\n      source_slotType,\n      optsIn\n    );\n    if (slotIndex !== void 0)\n      return source_node.connect(slotIndex, this, slot, optsIn?.afterRerouteId);\n    console.debug(\"[connectByType]: no way to connect type:\", source_slotType, \"to node:\", source_node);\n    return null;\n  }\n  canConnectTo(node2, toSlot, fromSlot) {\n    return this.id !== node2.id && LiteGraph.isValidConnection(fromSlot.type, toSlot.type);\n  }\n  /**\n   * Connect an output of this node to an input of another node\n   * @param slot (could be the number of the slot or the string with the name of the slot)\n   * @param target_node the target node\n   * @param target_slot the input slot of the target node (could be the number of the slot or the string with the name of the slot, or -1 to connect a trigger)\n   * @returns the link_info is created, otherwise null\n   */\n  connect(slot, target_node, target_slot, afterRerouteId) {\n    let targetIndex;\n    const { graph, outputs } = this;\n    if (!graph) {\n      console.log(\"Connect: Error, node doesn't belong to any graph. Nodes must be added first to a graph before connecting them.\");\n      return null;\n    }\n    if (typeof slot === \"string\") {\n      slot = this.findOutputSlot(slot);\n      if (slot == -1) {\n        if (LiteGraph.debug) console.log(`Connect: Error, no slot of name ${slot}`);\n        return null;\n      }\n    } else if (!outputs || slot >= outputs.length) {\n      if (LiteGraph.debug) console.log(\"Connect: Error, slot number not found\");\n      return null;\n    }\n    if (target_node && typeof target_node === \"number\") {\n      const nodeById = graph.getNodeById(target_node);\n      if (!nodeById) throw \"target node is null\";\n      target_node = nodeById;\n    }\n    if (!target_node) throw \"target node is null\";\n    if (target_node == this) return null;\n    if (typeof target_slot === \"string\") {\n      targetIndex = target_node.findInputSlot(target_slot);\n      if (targetIndex == -1) {\n        if (LiteGraph.debug) console.log(`Connect: Error, no slot of name ${targetIndex}`);\n        return null;\n      }\n    } else if (target_slot === LiteGraph.EVENT) {\n      if (LiteGraph.do_add_triggers_slots) {\n        target_node.changeMode(LGraphEventMode.ON_TRIGGER);\n        targetIndex = target_node.findInputSlot(\"onTrigger\");\n      } else {\n        return null;\n      }\n    } else if (typeof target_slot === \"number\") {\n      targetIndex = target_slot;\n    } else {\n      targetIndex = 0;\n    }\n    if (target_node.onBeforeConnectInput) {\n      const requestedIndex = target_node.onBeforeConnectInput(targetIndex, target_slot);\n      targetIndex = typeof requestedIndex === \"number\" ? requestedIndex : null;\n    }\n    if (targetIndex === null || !target_node.inputs || targetIndex >= target_node.inputs.length) {\n      if (LiteGraph.debug) console.log(\"Connect: Error, slot number not found\");\n      return null;\n    }\n    const input = target_node.inputs[targetIndex];\n    const output = outputs[slot];\n    if (!output) return null;\n    if (output.links?.length) {\n      if (output.type === LiteGraph.EVENT && !LiteGraph.allow_multi_output_for_events) {\n        graph.beforeChange();\n        this.disconnectOutput(slot, false, { doProcessChange: false });\n      }\n    }\n    const link = this.connectSlots(output, target_node, input, afterRerouteId);\n    return link ?? null;\n  }\n  /**\n   * Connect two slots between two nodes\n   * @param output The output slot to connect\n   * @param inputNode The node that the input slot is on\n   * @param input The input slot to connect\n   * @param afterRerouteId The reroute ID to use for the link\n   * @returns The link that was created, or null if the connection was blocked\n   */\n  connectSlots(output, inputNode, input, afterRerouteId) {\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    const outputIndex = this.outputs.indexOf(output);\n    if (outputIndex === -1) {\n      console.warn(\"connectSlots: output not found\");\n      return;\n    }\n    const inputIndex = inputNode.inputs.indexOf(input);\n    if (inputIndex === -1) {\n      console.warn(\"connectSlots: input not found\");\n      return;\n    }\n    if (!LiteGraph.isValidConnection(output.type, input.type)) {\n      this.setDirtyCanvas(false, true);\n      return null;\n    }\n    if (inputNode.onConnectInput?.(inputIndex, output.type, output, this, outputIndex) === false)\n      return null;\n    if (this.onConnectOutput?.(outputIndex, input.type, input, inputNode, inputIndex) === false)\n      return null;\n    if (inputNode.inputs[inputIndex]?.link != null) {\n      graph.beforeChange();\n      inputNode.disconnectInput(inputIndex, true);\n    }\n    const link = new LLink(\n      ++graph.state.lastLinkId,\n      input.type || output.type,\n      this.id,\n      outputIndex,\n      inputNode.id,\n      inputIndex,\n      afterRerouteId\n    );\n    graph._links.set(link.id, link);\n    output.links ??= [];\n    output.links.push(link.id);\n    inputNode.inputs[inputIndex].link = link.id;\n    const reroutes = LLink.getReroutes(graph, link);\n    for (const reroute of reroutes) {\n      reroute.linkIds.add(link.id);\n      if (reroute.floating) delete reroute.floating;\n      reroute._dragging = void 0;\n    }\n    const lastReroute = reroutes.at(-1);\n    if (lastReroute) {\n      for (const linkId of lastReroute.floatingLinkIds) {\n        const link2 = graph.floatingLinks.get(linkId);\n        if (link2?.parentId === lastReroute.id) {\n          graph.removeFloatingLink(link2);\n        }\n      }\n    }\n    graph._version++;\n    this.onConnectionsChange?.(\n      NodeSlotType.OUTPUT,\n      outputIndex,\n      true,\n      link,\n      output\n    );\n    inputNode.onConnectionsChange?.(\n      NodeSlotType.INPUT,\n      inputIndex,\n      true,\n      link,\n      input\n    );\n    this.setDirtyCanvas(false, true);\n    graph.afterChange();\n    return link;\n  }\n  connectFloatingReroute(pos, slot, afterRerouteId) {\n    const { graph, id } = this;\n    if (!graph) throw new NullGraphError();\n    const inputIndex = this.inputs.indexOf(slot);\n    const outputIndex = this.outputs.indexOf(slot);\n    if (inputIndex === -1 && outputIndex === -1) throw new Error(\"Invalid slot\");\n    const slotType = outputIndex === -1 ? \"input\" : \"output\";\n    const reroute = graph.setReroute({\n      pos,\n      parentId: afterRerouteId,\n      linkIds: [],\n      floating: { slotType }\n    });\n    const parentReroute = graph.getReroute(afterRerouteId);\n    const fromLastFloatingReroute = parentReroute?.floating?.slotType === \"output\";\n    if (afterRerouteId == null || !fromLastFloatingReroute) {\n      const link2 = new LLink(\n        -1,\n        slot.type,\n        outputIndex === -1 ? -1 : id,\n        outputIndex,\n        inputIndex === -1 ? -1 : id,\n        inputIndex\n      );\n      link2.parentId = reroute.id;\n      graph.addFloatingLink(link2);\n      return reroute;\n    }\n    if (!parentReroute) throw new Error(\"[connectFloatingReroute] Parent reroute not found\");\n    const link = parentReroute.getFloatingLinks(\"output\")?.[0];\n    if (!link) throw new Error(\"[connectFloatingReroute] Floating link not found\");\n    reroute.floatingLinkIds.add(link.id);\n    link.parentId = reroute.id;\n    delete parentReroute.floating;\n    return reroute;\n  }\n  /**\n   * disconnect one output to an specific node\n   * @param slot (could be the number of the slot or the string with the name of the slot)\n   * @param target_node the target node to which this slot is connected [Optional,\n   * if not target_node is specified all nodes will be disconnected]\n   * @returns if it was disconnected successfully\n   */\n  disconnectOutput(slot, target_node) {\n    if (typeof slot === \"string\") {\n      slot = this.findOutputSlot(slot);\n      if (slot == -1) {\n        if (LiteGraph.debug) console.log(`Connect: Error, no slot of name ${slot}`);\n        return false;\n      }\n    } else if (!this.outputs || slot >= this.outputs.length) {\n      if (LiteGraph.debug) console.log(\"Connect: Error, slot number not found\");\n      return false;\n    }\n    const output = this.outputs[slot];\n    if (!output) return false;\n    if (output._floatingLinks) {\n      for (const link of output._floatingLinks) {\n        if (link.hasOrigin(this.id, slot)) {\n          this.graph?.removeFloatingLink(link);\n        }\n      }\n    }\n    if (!output.links || output.links.length == 0) return false;\n    const { links } = output;\n    const graph = this.graph;\n    if (!graph) throw new NullGraphError();\n    if (target_node) {\n      const target = typeof target_node === \"number\" ? graph.getNodeById(target_node) : target_node;\n      if (!target) throw \"Target Node not found\";\n      for (const [i, link_id] of links.entries()) {\n        const link_info = graph._links.get(link_id);\n        if (link_info?.target_id != target.id) continue;\n        links.splice(i, 1);\n        const input = target.inputs[link_info.target_slot];\n        input.link = null;\n        link_info.disconnect(graph, \"input\");\n        graph._version++;\n        target.onConnectionsChange?.(\n          NodeSlotType.INPUT,\n          link_info.target_slot,\n          false,\n          link_info,\n          input\n        );\n        this.onConnectionsChange?.(\n          NodeSlotType.OUTPUT,\n          slot,\n          false,\n          link_info,\n          output\n        );\n        break;\n      }\n    } else {\n      for (const link_id of links) {\n        const link_info = graph._links.get(link_id);\n        if (!link_info) continue;\n        const target = graph.getNodeById(link_info.target_id);\n        graph._version++;\n        if (target) {\n          const input = target.inputs[link_info.target_slot];\n          input.link = null;\n          target.onConnectionsChange?.(\n            NodeSlotType.INPUT,\n            link_info.target_slot,\n            false,\n            link_info,\n            input\n          );\n        }\n        link_info.disconnect(graph, \"input\");\n        this.onConnectionsChange?.(\n          NodeSlotType.OUTPUT,\n          slot,\n          false,\n          link_info,\n          output\n        );\n      }\n      output.links = null;\n    }\n    this.setDirtyCanvas(false, true);\n    return true;\n  }\n  /**\n   * Disconnect one input\n   * @param slot Input slot index, or the name of the slot\n   * @param keepReroutes If `true`, reroutes will not be garbage collected.\n   * @returns true if disconnected successfully or already disconnected, otherwise false\n   */\n  disconnectInput(slot, keepReroutes) {\n    if (typeof slot === \"string\") {\n      slot = this.findInputSlot(slot);\n      if (slot == -1) {\n        if (LiteGraph.debug) console.log(`Connect: Error, no slot of name ${slot}`);\n        return false;\n      }\n    } else if (!this.inputs || slot >= this.inputs.length) {\n      if (LiteGraph.debug) {\n        console.log(\"Connect: Error, slot number not found\");\n      }\n      return false;\n    }\n    const input = this.inputs[slot];\n    if (!input) {\n      console.debug(\"disconnectInput: input not found\", slot, this.inputs);\n      return false;\n    }\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    if (input._floatingLinks?.size) {\n      for (const link of input._floatingLinks) {\n        graph.removeFloatingLink(link);\n      }\n    }\n    const link_id = this.inputs[slot].link;\n    if (link_id != null) {\n      this.inputs[slot].link = null;\n      const link_info = graph._links.get(link_id);\n      if (link_info) {\n        if (link_info.origin_id === -10 && \"inputNode\" in graph) {\n          graph.inputNode._disconnectNodeInput(this, input, link_info);\n          return true;\n        }\n        const target_node = graph.getNodeById(link_info.origin_id);\n        if (!target_node) {\n          console.debug(\"disconnectInput: target node not found\", link_info.origin_id);\n          return false;\n        }\n        const output = target_node.outputs[link_info.origin_slot];\n        if (!output?.links?.length) {\n          console.debug(\"disconnectInput: output not found\", link_info.origin_slot);\n          return false;\n        }\n        let i = 0;\n        for (const l = output.links.length; i < l; i++) {\n          if (output.links[i] == link_id) {\n            output.links.splice(i, 1);\n            break;\n          }\n        }\n        link_info.disconnect(graph, keepReroutes ? \"output\" : void 0);\n        if (graph) graph._version++;\n        this.onConnectionsChange?.(\n          NodeSlotType.INPUT,\n          slot,\n          false,\n          link_info,\n          input\n        );\n        target_node.onConnectionsChange?.(\n          NodeSlotType.OUTPUT,\n          i,\n          false,\n          link_info,\n          output\n        );\n      }\n    }\n    this.setDirtyCanvas(false, true);\n    return true;\n  }\n  /**\n   * @deprecated Use {@link getInputPos} or {@link getOutputPos} instead.\n   * returns the center of a connection point in canvas coords\n   * @param is_input true if if a input slot, false if it is an output\n   * @param slot_number (could be the number of the slot or the string with the name of the slot)\n   * @param out [optional] a place to store the output, to free garbage\n   * @returns the position\n   */\n  getConnectionPos(is_input, slot_number, out) {\n    out ||= new Float32Array(2);\n    const { pos: [nodeX, nodeY], inputs, outputs } = this;\n    if (this.flags.collapsed) {\n      const w = this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH;\n      out[0] = is_input ? nodeX : nodeX + w;\n      out[1] = nodeY - LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n      return out;\n    }\n    if (is_input && slot_number == -1) {\n      out[0] = nodeX + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n      out[1] = nodeY + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n      return out;\n    }\n    const inputPos = inputs?.[slot_number]?.pos;\n    const outputPos = outputs?.[slot_number]?.pos;\n    if (is_input && inputPos) {\n      out[0] = nodeX + inputPos[0];\n      out[1] = nodeY + inputPos[1];\n      return out;\n    } else if (!is_input && outputPos) {\n      out[0] = nodeX + outputPos[0];\n      out[1] = nodeY + outputPos[1];\n      return out;\n    }\n    const offset = LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n    const slotIndex = is_input ? this.#defaultVerticalInputs.indexOf(this.inputs[slot_number]) : this.#defaultVerticalOutputs.indexOf(this.outputs[slot_number]);\n    out[0] = is_input ? nodeX + offset : nodeX + this.size[0] + 1 - offset;\n    out[1] = nodeY + (slotIndex + 0.7) * LiteGraph.NODE_SLOT_HEIGHT + (this.constructor.slot_start_y || 0);\n    return out;\n  }\n  /**\n   * @internal The inputs that are not positioned with absolute coordinates.\n   */\n  get #defaultVerticalInputs() {\n    return this.inputs.filter(\n      (slot) => !slot.pos && !(this.widgets?.length && isWidgetInputSlot(slot))\n    );\n  }\n  /**\n   * @internal The outputs that are not positioned with absolute coordinates.\n   */\n  get #defaultVerticalOutputs() {\n    return this.outputs.filter((slot) => !slot.pos);\n  }\n  /**\n   * Gets the position of an input slot, in graph co-ordinates.\n   *\n   * This method is preferred over the legacy {@link getConnectionPos} method.\n   * @param slot Input slot index\n   * @returns Position of the input slot\n   */\n  getInputPos(slot) {\n    return this.getInputSlotPos(this.inputs[slot]);\n  }\n  /**\n   * Gets the position of an input slot, in graph co-ordinates.\n   * @param input The actual node input object\n   * @returns Position of the centre of the input slot in graph co-ordinates.\n   */\n  getInputSlotPos(input) {\n    const { pos: [nodeX, nodeY] } = this;\n    if (this.flags.collapsed) {\n      const halfTitle = LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n      return [nodeX, nodeY - halfTitle];\n    }\n    const { pos } = input;\n    if (pos) return [nodeX + pos[0], nodeY + pos[1]];\n    const offsetX = LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n    const nodeOffsetY = this.constructor.slot_start_y || 0;\n    const slotIndex = this.#defaultVerticalInputs.indexOf(input);\n    const slotY = (slotIndex + 0.7) * LiteGraph.NODE_SLOT_HEIGHT;\n    return [nodeX + offsetX, nodeY + slotY + nodeOffsetY];\n  }\n  /**\n   * Gets the position of an output slot, in graph co-ordinates.\n   *\n   * This method is preferred over the legacy {@link getConnectionPos} method.\n   * @param slot Output slot index\n   * @returns Position of the output slot\n   */\n  getOutputPos(slot) {\n    const { pos: [nodeX, nodeY], outputs, size: [width2] } = this;\n    if (this.flags.collapsed) {\n      const width22 = this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH;\n      const halfTitle = LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n      return [nodeX + width22, nodeY - halfTitle];\n    }\n    const outputPos = outputs?.[slot]?.pos;\n    if (outputPos) return [nodeX + outputPos[0], nodeY + outputPos[1]];\n    const offsetX = LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n    const nodeOffsetY = this.constructor.slot_start_y || 0;\n    const slotIndex = this.#defaultVerticalOutputs.indexOf(this.outputs[slot]);\n    const slotY = (slotIndex + 0.7) * LiteGraph.NODE_SLOT_HEIGHT;\n    return [nodeX + width2 + 1 - offsetX, nodeY + slotY + nodeOffsetY];\n  }\n  /** @inheritdoc */\n  snapToGrid(snapTo) {\n    return this.pinned ? false : snapPoint(this.pos, snapTo);\n  }\n  /** @see {@link snapToGrid} */\n  alignToGrid() {\n    this.snapToGrid(LiteGraph.CANVAS_GRID_SIZE);\n  }\n  /* Console output */\n  trace(msg) {\n    this.console ||= [];\n    this.console.push(msg);\n    if (this.console.length > LGraphNode.MAX_CONSOLE)\n      this.console.shift();\n  }\n  /* Forces to redraw or the main canvas (LGraphNode) or the bg canvas (links) */\n  setDirtyCanvas(dirty_foreground, dirty_background) {\n    this.graph?.canvasAction((c) => c.setDirty(dirty_foreground, dirty_background));\n  }\n  loadImage(url) {\n    const img = new Image();\n    img.src = LiteGraph.node_images_path + url;\n    img.ready = false;\n    const dirty = () => this.setDirtyCanvas(true);\n    img.addEventListener(\"load\", function() {\n      this.ready = true;\n      dirty();\n    });\n    return img;\n  }\n  /**\n   * Allows to get onMouseMove and onMouseUp events even if the mouse is out of focus\n   * @deprecated Use {@link LGraphCanvas.pointer} instead.\n   */\n  captureInput(v2) {\n    warnDeprecated(\"[DEPRECATED] captureInput will be removed in a future version. Please use LGraphCanvas.pointer (CanvasPointer) instead.\");\n    if (!this.graph || !this.graph.list_of_graphcanvas) return;\n    const list = this.graph.list_of_graphcanvas;\n    for (const c of list) {\n      if (!v2 && c.node_capturing_input != this) continue;\n      c.node_capturing_input = v2 ? this : null;\n    }\n  }\n  get collapsed() {\n    return !!this.flags.collapsed;\n  }\n  get collapsible() {\n    return !this.pinned && this.constructor.collapsable !== false;\n  }\n  /**\n   * Toggle node collapse (makes it smaller on the canvas)\n   */\n  collapse(force) {\n    if (!this.collapsible && !force) return;\n    if (!this.graph) throw new NullGraphError();\n    this.graph._version++;\n    this.flags.collapsed = !this.flags.collapsed;\n    this.setDirtyCanvas(true, true);\n  }\n  /**\n   * Toggles advanced mode of the node, showing advanced widgets\n   */\n  toggleAdvanced() {\n    if (!this.widgets?.some((w) => w.advanced)) return;\n    if (!this.graph) throw new NullGraphError();\n    this.graph._version++;\n    this.showAdvanced = !this.showAdvanced;\n    this.expandToFitContent();\n    this.setDirtyCanvas(true, true);\n  }\n  get pinned() {\n    return !!this.flags.pinned;\n  }\n  /**\n   * Prevents the node being accidentally moved or resized by mouse interaction.\n   * Toggles pinned state if no value is provided.\n   */\n  pin(v2) {\n    if (!this.graph) throw new NullGraphError();\n    this.graph._version++;\n    this.flags.pinned = v2 ?? !this.flags.pinned;\n    this.resizable = !this.pinned;\n    if (!this.pinned) delete this.flags.pinned;\n  }\n  unpin() {\n    this.pin(false);\n  }\n  localToScreen(x2, y, dragAndScale) {\n    return [\n      (x2 + this.pos[0]) * dragAndScale.scale + dragAndScale.offset[0],\n      (y + this.pos[1]) * dragAndScale.scale + dragAndScale.offset[1]\n    ];\n  }\n  get width() {\n    return this.collapsed ? this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH : this.size[0];\n  }\n  /**\n   * Returns the height of the node, including the title bar.\n   */\n  get height() {\n    return LiteGraph.NODE_TITLE_HEIGHT + this.bodyHeight;\n  }\n  /**\n   * Returns the height of the node, excluding the title bar.\n   */\n  get bodyHeight() {\n    return this.collapsed ? 0 : this.size[1];\n  }\n  drawBadges(ctx, { gap = 2 } = {}) {\n    const badgeInstances = this.badges.map((badge) => badge instanceof LGraphBadge ? badge : badge());\n    const isLeftAligned = this.badgePosition === BadgePosition.TopLeft;\n    let currentX = isLeftAligned ? 0 : this.width - badgeInstances.reduce((acc, badge) => acc + badge.getWidth(ctx) + gap, 0);\n    const y = -(LiteGraph.NODE_TITLE_HEIGHT + gap);\n    for (const badge of badgeInstances) {\n      badge.draw(ctx, currentX, y - badge.height);\n      currentX += badge.getWidth(ctx) + gap;\n    }\n  }\n  /**\n   * Renders the node's title bar background\n   */\n  drawTitleBarBackground(ctx, {\n    scale,\n    title_height = LiteGraph.NODE_TITLE_HEIGHT,\n    low_quality = false\n  }) {\n    const fgcolor = this.renderingColor;\n    const shape = this.renderingShape;\n    const size = this.renderingSize;\n    if (this.onDrawTitleBar) {\n      this.onDrawTitleBar(ctx, title_height, size, scale, fgcolor);\n      return;\n    }\n    if (this.title_mode === TitleMode.TRANSPARENT_TITLE) {\n      return;\n    }\n    if (this.collapsed) {\n      ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n    }\n    ctx.fillStyle = this.constructor.title_color || fgcolor;\n    ctx.beginPath();\n    if (shape == RenderShape.BOX || low_quality) {\n      ctx.rect(0, -title_height, size[0], title_height);\n    } else if (shape == RenderShape.ROUND || shape == RenderShape.CARD) {\n      ctx.roundRect(\n        0,\n        -title_height,\n        size[0],\n        title_height,\n        this.collapsed ? [LiteGraph.ROUND_RADIUS] : [LiteGraph.ROUND_RADIUS, LiteGraph.ROUND_RADIUS, 0, 0]\n      );\n    }\n    ctx.fill();\n    ctx.shadowColor = \"transparent\";\n  }\n  /**\n   * Renders the node's title box, i.e. the dot in front of the title text that\n   * when clicked toggles the node's collapsed state. The term `title box` comes\n   * from the original LiteGraph implementation.\n   */\n  drawTitleBox(ctx, {\n    scale,\n    low_quality = false,\n    title_height = LiteGraph.NODE_TITLE_HEIGHT,\n    box_size = 10\n  }) {\n    const size = this.renderingSize;\n    const shape = this.renderingShape;\n    if (this.onDrawTitleBox) {\n      this.onDrawTitleBox(ctx, title_height, size, scale);\n      return;\n    }\n    if ([RenderShape.ROUND, RenderShape.CIRCLE, RenderShape.CARD].includes(shape)) {\n      if (low_quality) {\n        ctx.fillStyle = \"black\";\n        ctx.beginPath();\n        ctx.arc(\n          title_height * 0.5,\n          title_height * -0.5,\n          box_size * 0.5 + 1,\n          0,\n          Math.PI * 2\n        );\n        ctx.fill();\n      }\n      ctx.fillStyle = this.renderingBoxColor;\n      if (low_quality) {\n        ctx.fillRect(\n          title_height * 0.5 - box_size * 0.5,\n          title_height * -0.5 - box_size * 0.5,\n          box_size,\n          box_size\n        );\n      } else {\n        ctx.beginPath();\n        ctx.arc(\n          title_height * 0.5,\n          title_height * -0.5,\n          box_size * 0.5,\n          0,\n          Math.PI * 2\n        );\n        ctx.fill();\n      }\n    } else {\n      if (low_quality) {\n        ctx.fillStyle = \"black\";\n        ctx.fillRect(\n          (title_height - box_size) * 0.5 - 1,\n          (title_height + box_size) * -0.5 - 1,\n          box_size + 2,\n          box_size + 2\n        );\n      }\n      ctx.fillStyle = this.renderingBoxColor;\n      ctx.fillRect(\n        (title_height - box_size) * 0.5,\n        (title_height + box_size) * -0.5,\n        box_size,\n        box_size\n      );\n    }\n  }\n  /**\n   * Renders the node's title text.\n   */\n  drawTitleText(ctx, {\n    scale,\n    default_title_color,\n    low_quality = false,\n    title_height = LiteGraph.NODE_TITLE_HEIGHT\n  }) {\n    const size = this.renderingSize;\n    const selected = this.selected;\n    if (this.onDrawTitleText) {\n      this.onDrawTitleText(\n        ctx,\n        title_height,\n        size,\n        scale,\n        this.titleFontStyle,\n        selected\n      );\n      return;\n    }\n    if (low_quality) {\n      return;\n    }\n    ctx.font = this.titleFontStyle;\n    const rawTitle = this.getTitle() ?? `❌ ${this.type}`;\n    const title = String(rawTitle) + (this.pinned ? \"📌\" : \"\");\n    if (title) {\n      if (selected) {\n        ctx.fillStyle = LiteGraph.NODE_SELECTED_TITLE_COLOR;\n      } else {\n        ctx.fillStyle = this.constructor.title_text_color || default_title_color;\n      }\n      let availableWidth = size[0] - title_height * 2;\n      if (this.title_buttons?.length > 0) {\n        let buttonsWidth = 0;\n        const savedFont = ctx.font;\n        for (const button of this.title_buttons) {\n          if (button.visible) {\n            buttonsWidth += button.getWidth(ctx) + 2;\n          }\n        }\n        ctx.font = savedFont;\n        if (buttonsWidth > 0) {\n          buttonsWidth += 10;\n          availableWidth -= buttonsWidth;\n        }\n      }\n      let displayTitle = title;\n      if (this.collapsed) {\n        displayTitle = title.substr(0, 20);\n      } else if (availableWidth > 0) {\n        displayTitle = truncateText(ctx, title, availableWidth);\n      }\n      ctx.textAlign = \"left\";\n      ctx.fillText(\n        displayTitle,\n        title_height,\n        LiteGraph.NODE_TITLE_TEXT_Y - title_height\n      );\n    }\n  }\n  /**\n   * Attempts to gracefully bypass this node in all of its connections by reconnecting all links.\n   *\n   * Each input is checked against each output.  This is done on a matching index basis, i.e. input 3 -> output 3.\n   * If there are any input links remaining,\n   * and {@link flags}.{@link INodeFlags.keepAllLinksOnBypass keepAllLinksOnBypass} is `true`,\n   * each input will check for outputs that match, and take the first one that matches\n   * `true`: Try the index matching first, then every input to every output.\n   * `false`: Only matches indexes, e.g. input 3 to output 3.\n   *\n   * If {@link flags}.{@link INodeFlags.keepAllLinksOnBypass keepAllLinksOnBypass} is `undefined`, it will fall back to\n   * the static {@link keepAllLinksOnBypass}.\n   * @returns `true` if any new links were established, otherwise `false`.\n   * @todo Decision: Change API to return array of new links instead?\n   */\n  connectInputToOutput() {\n    const { inputs, outputs, graph } = this;\n    if (!inputs || !outputs) return;\n    if (!graph) throw new NullGraphError();\n    const { _links } = graph;\n    let madeAnyConnections = false;\n    for (const [index, input] of inputs.entries()) {\n      if (input.link == null) continue;\n      const output = outputs[index];\n      if (!output || !LiteGraph.isValidConnection(input.type, output.type)) continue;\n      const inLink = _links.get(input.link);\n      if (!inLink) continue;\n      const inNode = graph.getNodeById(inLink?.origin_id);\n      if (!inNode) continue;\n      bypassAllLinks(output, inNode, inLink, graph);\n    }\n    if (!(this.flags.keepAllLinksOnBypass ?? LGraphNode.keepAllLinksOnBypass))\n      return madeAnyConnections;\n    for (const input of inputs) {\n      if (input.link == null) continue;\n      const inLink = _links.get(input.link);\n      if (!inLink) continue;\n      const inNode = graph.getNodeById(inLink?.origin_id);\n      if (!inNode) continue;\n      for (const output of outputs) {\n        if (!LiteGraph.isValidConnection(input.type, output.type)) continue;\n        bypassAllLinks(output, inNode, inLink, graph);\n        break;\n      }\n    }\n    return madeAnyConnections;\n    function bypassAllLinks(output, inNode, inLink, graph2) {\n      const outLinks = output.links?.map((x2) => _links.get(x2)).filter((x2) => !!x2);\n      if (!outLinks?.length) return;\n      for (const outLink of outLinks) {\n        const outNode = graph2.getNodeById(outLink.target_id);\n        if (!outNode) continue;\n        const result = inNode.connect(\n          inLink.origin_slot,\n          outNode,\n          outLink.target_slot,\n          inLink.parentId\n        );\n        madeAnyConnections ||= !!result;\n      }\n    }\n  }\n  /**\n   * Returns `true` if the widget is visible, otherwise `false`.\n   */\n  isWidgetVisible(widget) {\n    const isHidden = this.collapsed || widget.hidden || widget.advanced && !this.showAdvanced;\n    return !isHidden;\n  }\n  drawWidgets(ctx, {\n    lowQuality = false,\n    editorAlpha = 1\n  }) {\n    if (!this.widgets) return;\n    const nodeWidth = this.size[0];\n    const { widgets } = this;\n    const H = LiteGraph.NODE_WIDGET_HEIGHT;\n    const showText = !lowQuality;\n    ctx.save();\n    ctx.globalAlpha = editorAlpha;\n    for (const widget of widgets) {\n      if (!this.isWidgetVisible(widget)) continue;\n      const { y } = widget;\n      const outlineColour = widget.advanced ? LiteGraph.WIDGET_ADVANCED_OUTLINE_COLOR : LiteGraph.WIDGET_OUTLINE_COLOR;\n      widget.last_y = y;\n      widget.computedDisabled = widget.disabled || this.getSlotFromWidget(widget)?.link != null;\n      ctx.strokeStyle = outlineColour;\n      ctx.fillStyle = \"#222\";\n      ctx.textAlign = \"left\";\n      if (widget.computedDisabled) ctx.globalAlpha *= 0.5;\n      const width2 = widget.width || nodeWidth;\n      if (typeof widget.draw === \"function\") {\n        widget.draw(ctx, this, width2, y, H, lowQuality);\n      } else {\n        toConcreteWidget(widget, this, false)?.drawWidget(ctx, { width: width2, showText });\n      }\n      ctx.globalAlpha = editorAlpha;\n    }\n    ctx.restore();\n  }\n  /**\n   * When {@link LGraphNode.collapsed} is `true`, this method draws the node's collapsed slots.\n   */\n  drawCollapsedSlots(ctx) {\n    for (const slot of this.#concreteInputs) {\n      if (slot.link != null) {\n        slot.drawCollapsed(ctx);\n        break;\n      }\n    }\n    for (const slot of this.#concreteOutputs) {\n      if (slot.links?.length) {\n        slot.drawCollapsed(ctx);\n        break;\n      }\n    }\n  }\n  get slots() {\n    return [...this.inputs, ...this.outputs];\n  }\n  #measureSlot(slot, slotIndex, isInput) {\n    const pos = isInput ? this.getInputPos(slotIndex) : this.getOutputPos(slotIndex);\n    slot.boundingRect[0] = pos[0] - LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n    slot.boundingRect[1] = pos[1] - LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n    slot.boundingRect[2] = slot.isWidgetInputSlot ? BaseWidget.margin : LiteGraph.NODE_SLOT_HEIGHT;\n    slot.boundingRect[3] = LiteGraph.NODE_SLOT_HEIGHT;\n  }\n  #measureSlots() {\n    const slots = [];\n    for (const [slotIndex, slot] of this.#concreteInputs.entries()) {\n      if (this.widgets?.length && isWidgetInputSlot(slot)) continue;\n      this.#measureSlot(slot, slotIndex, true);\n      slots.push(slot);\n    }\n    for (const [slotIndex, slot] of this.#concreteOutputs.entries()) {\n      this.#measureSlot(slot, slotIndex, false);\n      slots.push(slot);\n    }\n    return slots.length ? createBounds(slots, 0) : null;\n  }\n  #getMouseOverSlot(slot) {\n    const isInput = isINodeInputSlot(slot);\n    const mouseOverId = this.mouseOver?.[isInput ? \"inputId\" : \"outputId\"] ?? -1;\n    if (mouseOverId === -1) {\n      return null;\n    }\n    return isInput ? this.inputs[mouseOverId] : this.outputs[mouseOverId];\n  }\n  #isMouseOverSlot(slot) {\n    return this.#getMouseOverSlot(slot) === slot;\n  }\n  #isMouseOverWidget(widget) {\n    if (!widget) return false;\n    return this.mouseOver?.overWidget === widget;\n  }\n  /**\n   * Returns the input slot that is associated with the given widget.\n   */\n  getSlotFromWidget(widget) {\n    if (widget) return this.inputs.find((slot) => isWidgetInputSlot(slot) && slot.widget.name === widget.name);\n  }\n  /**\n   * Returns the widget that is associated with the given input slot.\n   */\n  getWidgetFromSlot(slot) {\n    if (!isWidgetInputSlot(slot)) return;\n    return this.widgets?.find((w) => w.name === slot.widget.name);\n  }\n  /**\n   * Draws the node's input and output slots.\n   */\n  drawSlots(ctx, {\n    fromSlot,\n    colorContext,\n    editorAlpha,\n    lowQuality\n  }) {\n    for (const slot of [...this.#concreteInputs, ...this.#concreteOutputs]) {\n      const isValidTarget = fromSlot && slot.isValidTarget(fromSlot);\n      const isMouseOverSlot = this.#isMouseOverSlot(slot);\n      const isValid = !fromSlot || isValidTarget;\n      const highlight = isValid && isMouseOverSlot;\n      if (isMouseOverSlot || isValidTarget || !slot.isWidgetInputSlot || this.#isMouseOverWidget(this.getWidgetFromSlot(slot)) || slot.isConnected) {\n        ctx.globalAlpha = isValid ? editorAlpha : 0.4 * editorAlpha;\n        slot.draw(ctx, {\n          colorContext,\n          lowQuality,\n          highlight\n        });\n      }\n    }\n  }\n  /**\n   * Arranges the node's widgets vertically.\n   * Sets following properties on each widget:\n   * -  {@link IBaseWidget.computedHeight}\n   * -  {@link IBaseWidget.y}\n   * @param widgetStartY The y-coordinate of the first widget\n   */\n  #arrangeWidgets(widgetStartY) {\n    if (!this.widgets || !this.widgets.length) return;\n    const bodyHeight = this.bodyHeight;\n    const startY = this.widgets_start_y ?? (this.widgets_up ? 0 : widgetStartY) + 2;\n    let freeSpace = bodyHeight - startY;\n    let fixedWidgetHeight = 0;\n    const growableWidgets = [];\n    for (const w of this.widgets) {\n      if (w.computeSize) {\n        const height = w.computeSize()[1] + 4;\n        w.computedHeight = height;\n        fixedWidgetHeight += height;\n      } else if (w.computeLayoutSize) {\n        const { minHeight, maxHeight } = w.computeLayoutSize(this);\n        growableWidgets.push({\n          minHeight,\n          prefHeight: maxHeight,\n          w\n        });\n      } else {\n        const height = LiteGraph.NODE_WIDGET_HEIGHT + 4;\n        w.computedHeight = height;\n        fixedWidgetHeight += height;\n      }\n    }\n    freeSpace -= fixedWidgetHeight;\n    this.freeWidgetSpace = freeSpace;\n    const spaceRequests = growableWidgets.map((d) => ({\n      minSize: d.minHeight,\n      maxSize: d.prefHeight\n    }));\n    const allocations = distributeSpace(Math.max(0, freeSpace), spaceRequests);\n    for (const [i, d] of growableWidgets.entries()) {\n      d.w.computedHeight = allocations[i];\n    }\n    let y = startY;\n    for (const w of this.widgets) {\n      w.y = y;\n      y += w.computedHeight ?? 0;\n    }\n    if (!this.graph) throw new NullGraphError();\n    if (y > bodyHeight) {\n      this.setSize([this.size[0], y]);\n      this.graph.setDirtyCanvas(false, true);\n    }\n  }\n  /**\n   * Arranges the layout of the node's widget input slots.\n   */\n  #arrangeWidgetInputSlots() {\n    if (!this.widgets) return;\n    const slotByWidgetName = /* @__PURE__ */ new Map();\n    for (const [i, slot] of this.inputs.entries()) {\n      if (!isWidgetInputSlot(slot)) continue;\n      slotByWidgetName.set(slot.widget.name, { ...slot, index: i });\n    }\n    if (!slotByWidgetName.size) return;\n    for (const widget of this.widgets) {\n      const slot = slotByWidgetName.get(widget.name);\n      if (!slot) continue;\n      const actualSlot = this.#concreteInputs[slot.index];\n      const offset = LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n      actualSlot.pos = [offset, widget.y + offset];\n      this.#measureSlot(actualSlot, slot.index, true);\n    }\n  }\n  /**\n   * @internal Sets the internal concrete slot arrays, ensuring they are instances of\n   * {@link NodeInputSlot} or {@link NodeOutputSlot}.\n   *\n   * A temporary workaround until duck-typed inputs and outputs\n   * have been removed from the ecosystem.\n   */\n  _setConcreteSlots() {\n    this.#concreteInputs = this.inputs.map((slot) => toClass(NodeInputSlot, slot, this));\n    this.#concreteOutputs = this.outputs.map((slot) => toClass(NodeOutputSlot, slot, this));\n  }\n  /**\n   * Arranges node elements in preparation for rendering (slots & widgets).\n   */\n  arrange() {\n    const slotsBounds = this.#measureSlots();\n    const widgetStartY = slotsBounds ? slotsBounds[1] + slotsBounds[3] - this.pos[1] : 0;\n    this.#arrangeWidgets(widgetStartY);\n    this.#arrangeWidgetInputSlots();\n  }\n  /**\n   * Draws a progress bar on the node.\n   * @param ctx The canvas context to draw on\n   */\n  drawProgressBar(ctx) {\n    if (!this.progress) return;\n    const originalFillStyle = ctx.fillStyle;\n    ctx.fillStyle = \"green\";\n    ctx.fillRect(\n      0,\n      0,\n      this.width * this.progress,\n      6\n    );\n    ctx.fillStyle = originalFillStyle;\n  }\n}\nfunction getAllNestedItems(items) {\n  const allItems = /* @__PURE__ */ new Set();\n  if (items) {\n    for (const item of items) addRecursively(item, allItems);\n  }\n  return allItems;\n  function addRecursively(item, flatSet) {\n    if (flatSet.has(item) || item.pinned) return;\n    flatSet.add(item);\n    if (item.children) {\n      for (const child of item.children) addRecursively(child, flatSet);\n    }\n  }\n}\nfunction findFirstNode(items) {\n  for (const item of items) {\n    if (item instanceof LGraphNode) return item;\n  }\n}\nfunction findFreeSlotOfType(slots, type, hasNoLinks) {\n  if (!slots?.length) return;\n  let occupiedSlot;\n  let wildSlot;\n  let occupiedWildSlot;\n  const validTypes = parseSlotTypes(type);\n  for (const [index, slot] of slots.entries()) {\n    const slotTypes = parseSlotTypes(slot.type);\n    for (const validType of validTypes) {\n      for (const slotType of slotTypes) {\n        if (slotType === validType) {\n          if (hasNoLinks(slot)) {\n            return { index, slot };\n          }\n          occupiedSlot ??= { index, slot };\n        } else if (!wildSlot && (validType === \"*\" || slotType === \"*\")) {\n          if (hasNoLinks(slot)) {\n            wildSlot = { index, slot };\n          } else {\n            occupiedWildSlot ??= { index, slot };\n          }\n        }\n      }\n    }\n  }\n  return wildSlot ?? occupiedSlot ?? occupiedWildSlot;\n}\nfunction removeFromArray(array, value) {\n  const index = array.indexOf(value);\n  const found = index !== -1;\n  if (found) array.splice(index, 1);\n  return found;\n}\nclass SubgraphInput extends SubgraphSlot {\n  events = new CustomEventTarget();\n  /** The linked widget that this slot is connected to. */\n  #widgetRef;\n  get _widget() {\n    return this.#widgetRef?.deref();\n  }\n  set _widget(widget) {\n    this.#widgetRef = widget ? new WeakRef(widget) : void 0;\n  }\n  connect(slot, node2, afterRerouteId) {\n    const { subgraph } = this.parent;\n    const inputIndex = node2.inputs.indexOf(slot);\n    if (node2.onConnectInput?.(inputIndex, this.type, this, this.parent, -1) === false) return;\n    if (slot.link != null) {\n      subgraph.beforeChange();\n      const link2 = subgraph.getLink(slot.link);\n      this.parent._disconnectNodeInput(node2, slot, link2);\n    }\n    const inputWidget = node2.getWidgetFromSlot(slot);\n    if (inputWidget) {\n      if (!this.matchesWidget(inputWidget)) {\n        console.warn(\"Target input has invalid widget.\", slot, node2);\n        return;\n      }\n      this._widget ??= inputWidget;\n      this.events.dispatch(\"input-connected\", { input: slot, widget: inputWidget });\n    }\n    const link = new LLink(\n      ++subgraph.state.lastLinkId,\n      slot.type,\n      this.parent.id,\n      this.parent.slots.indexOf(this),\n      node2.id,\n      inputIndex,\n      afterRerouteId\n    );\n    subgraph._links.set(link.id, link);\n    this.linkIds.push(link.id);\n    slot.link = link.id;\n    const reroutes = LLink.getReroutes(subgraph, link);\n    for (const reroute of reroutes) {\n      reroute.linkIds.add(link.id);\n      if (reroute.floating) delete reroute.floating;\n      reroute._dragging = void 0;\n    }\n    const lastReroute = reroutes.at(-1);\n    if (lastReroute) {\n      for (const linkId of lastReroute.floatingLinkIds) {\n        const link2 = subgraph.floatingLinks.get(linkId);\n        if (link2?.parentId === lastReroute.id) {\n          subgraph.removeFloatingLink(link2);\n        }\n      }\n    }\n    subgraph._version++;\n    node2.onConnectionsChange?.(\n      NodeSlotType.INPUT,\n      inputIndex,\n      true,\n      link,\n      slot\n    );\n    subgraph.afterChange();\n    return link;\n  }\n  get labelPos() {\n    const [x2, y, , height] = this.boundingRect;\n    return [x2, y + height * 0.5];\n  }\n  getConnectedWidgets() {\n    const { subgraph } = this.parent;\n    const widgets = [];\n    for (const linkId of this.linkIds) {\n      const link = subgraph.getLink(linkId);\n      if (!link) {\n        console.error(\"Link not found\", linkId);\n        continue;\n      }\n      const resolved = link.resolve(subgraph);\n      if (resolved.input && resolved.inputNode?.widgets) {\n        const widgetNamePojo = resolved.input.widget;\n        if (!widgetNamePojo) continue;\n        if (!widgetNamePojo.name) {\n          console.warn(\"Invalid widget name\", widgetNamePojo);\n          continue;\n        }\n        const widget = resolved.inputNode.widgets.find((w) => w.name === widgetNamePojo.name);\n        if (!widget) {\n          console.warn(\"Widget not found\", widgetNamePojo);\n          continue;\n        }\n        widgets.push(widget);\n      } else {\n        console.debug(\"No input found on link id\", linkId, link);\n      }\n    }\n    return widgets;\n  }\n  /**\n   * Validates that the connection between the new slot and the existing widget is valid.\n   * Used to prevent connections between widgets that are not of the same type.\n   * @param otherWidget The widget to compare to.\n   * @returns `true` if the connection is valid, otherwise `false`.\n   */\n  matchesWidget(otherWidget) {\n    const widget = this.#widgetRef?.deref();\n    if (!widget) return true;\n    if (otherWidget.type !== widget.type || otherWidget.options.min !== widget.options.min || otherWidget.options.max !== widget.options.max || otherWidget.options.step !== widget.options.step || otherWidget.options.step2 !== widget.options.step2 || otherWidget.options.precision !== widget.options.precision) {\n      return false;\n    }\n    return true;\n  }\n  disconnect() {\n    super.disconnect();\n    this.events.dispatch(\"input-disconnected\", { input: this });\n  }\n  /** For inputs, x is the right edge of the input node. */\n  arrange(rect) {\n    const [right, top, width2, height] = rect;\n    const { boundingRect: b, pos } = this;\n    b[0] = right - width2;\n    b[1] = top;\n    b[2] = width2;\n    b[3] = height;\n    pos[0] = right - height * 0.5;\n    pos[1] = top + height * 0.5;\n  }\n  /**\n   * Checks if this slot is a valid target for a connection from the given slot.\n   * For SubgraphInput (which acts as an output inside the subgraph),\n   * the fromSlot should be an input slot.\n   */\n  isValidTarget(fromSlot) {\n    if (isNodeSlot(fromSlot)) {\n      return \"link\" in fromSlot && LiteGraph.isValidConnection(this.type, fromSlot.type);\n    }\n    if (isSubgraphOutput(fromSlot)) {\n      return LiteGraph.isValidConnection(this.type, fromSlot.type);\n    }\n    return false;\n  }\n}\nclass EmptySubgraphInput extends SubgraphInput {\n  constructor(parent) {\n    super({\n      id: zeroUuid,\n      name: \"\",\n      type: \"\"\n    }, parent);\n  }\n  connect(slot, node2, afterRerouteId) {\n    const { subgraph } = this.parent;\n    const existingNames = subgraph.inputs.map((x2) => x2.name);\n    const name = nextUniqueName(slot.name, existingNames);\n    const input = subgraph.addInput(name, String(slot.type));\n    return input.connect(slot, node2, afterRerouteId);\n  }\n  get labelPos() {\n    const [x2, y, , height] = this.boundingRect;\n    return [x2, y + height * 0.5];\n  }\n}\nclass SubgraphInputNode extends SubgraphIONodeBase {\n  id = SUBGRAPH_INPUT_ID;\n  emptySlot = new EmptySubgraphInput(this);\n  get slots() {\n    return this.subgraph.inputs;\n  }\n  get allSlots() {\n    return [...this.slots, this.emptySlot];\n  }\n  get slotAnchorX() {\n    const [x2, , width2] = this.boundingRect;\n    return x2 + width2 - SubgraphIONodeBase.roundedRadius;\n  }\n  onPointerDown(e2, pointer, linkConnector) {\n    if (e2.button === 0) {\n      for (const slot of this.allSlots) {\n        const slotBounds = Rectangle.fromCentre(slot.pos, slot.boundingRect.height);\n        if (slotBounds.containsXy(e2.canvasX, e2.canvasY)) {\n          pointer.onDragStart = () => {\n            linkConnector.dragNewFromSubgraphInput(this.subgraph, this, slot);\n          };\n          pointer.onDragEnd = (eUp) => {\n            linkConnector.dropLinks(this.subgraph, eUp);\n          };\n          pointer.finally = () => {\n            linkConnector.reset(true);\n          };\n        }\n      }\n    } else if (e2.button === 2) {\n      const slot = this.getSlotInPosition(e2.canvasX, e2.canvasY);\n      if (slot) this.showSlotContextMenu(slot, e2);\n    }\n  }\n  /** @inheritdoc */\n  renameSlot(slot, name) {\n    this.subgraph.renameInput(slot, name);\n  }\n  /** @inheritdoc */\n  removeSlot(slot) {\n    this.subgraph.removeInput(slot);\n  }\n  canConnectTo(inputNode, input, fromSlot) {\n    return inputNode.canConnectTo(this, input, fromSlot);\n  }\n  connectSlots(fromSlot, inputNode, input, afterRerouteId) {\n    const { subgraph } = this;\n    const outputIndex = this.slots.indexOf(fromSlot);\n    const inputIndex = inputNode.inputs.indexOf(input);\n    if (outputIndex === -1 || inputIndex === -1) throw new Error(\"Invalid slot indices.\");\n    return new LLink(\n      ++subgraph.state.lastLinkId,\n      input.type || fromSlot.type,\n      this.id,\n      outputIndex,\n      inputNode.id,\n      inputIndex,\n      afterRerouteId\n    );\n  }\n  // #region Legacy LGraphNode compatibility\n  connectByType(slot, target_node, target_slotType, optsIn) {\n    const inputSlot = target_node.findInputByType(target_slotType);\n    if (!inputSlot) return;\n    if (slot === -1) {\n      const newSubgraphInput = this.subgraph.addInput(inputSlot.slot.name, String(inputSlot.slot.type ?? \"\"));\n      const newSlotIndex = this.slots.indexOf(newSubgraphInput);\n      if (newSlotIndex === -1) {\n        console.error(\"Could not find newly created subgraph input slot.\");\n        return;\n      }\n      slot = newSlotIndex;\n    }\n    return this.slots[slot].connect(inputSlot.slot, target_node, optsIn?.afterRerouteId);\n  }\n  findOutputSlot(name) {\n    return this.slots.find((output) => output.name === name);\n  }\n  findOutputByType(type) {\n    return findFreeSlotOfType(this.slots, type, (slot) => slot.linkIds.length > 0)?.slot;\n  }\n  // #endregion Legacy LGraphNode compatibility\n  _disconnectNodeInput(node2, input, link) {\n    const { subgraph } = this;\n    if (input._floatingLinks?.size) {\n      for (const link2 of input._floatingLinks) {\n        subgraph.removeFloatingLink(link2);\n      }\n    }\n    input.link = null;\n    subgraph.setDirtyCanvas(false, true);\n    if (!link) return;\n    const subgraphInputIndex = link.origin_slot;\n    link.disconnect(subgraph, \"output\");\n    subgraph._version++;\n    const subgraphInput = this.slots.at(subgraphInputIndex);\n    if (!subgraphInput) {\n      console.debug(\"disconnectNodeInput: subgraphInput not found\", this, subgraphInputIndex);\n      return;\n    }\n    const index = subgraphInput.linkIds.indexOf(link.id);\n    if (index !== -1) {\n      subgraphInput.linkIds.splice(index, 1);\n    } else {\n      console.debug(\"disconnectNodeInput: link ID not found in subgraphInput linkIds\", link.id);\n    }\n    node2.onConnectionsChange?.(\n      NodeSlotType.OUTPUT,\n      index,\n      false,\n      link,\n      subgraphInput\n    );\n  }\n  drawProtected(ctx, colorContext, fromSlot, editorAlpha) {\n    const { roundedRadius } = SubgraphIONodeBase;\n    const transform = ctx.getTransform();\n    const [x2, y, width2, height] = this.boundingRect;\n    ctx.translate(x2, y);\n    ctx.strokeStyle = this.sideStrokeStyle;\n    ctx.lineWidth = this.sideLineWidth;\n    ctx.beginPath();\n    ctx.arc(width2 - roundedRadius, roundedRadius, roundedRadius, Math.PI * 1.5, 0);\n    ctx.moveTo(width2, roundedRadius);\n    ctx.lineTo(width2, height - roundedRadius);\n    ctx.arc(width2 - roundedRadius, height - roundedRadius, roundedRadius, 0, Math.PI * 0.5);\n    ctx.stroke();\n    ctx.setTransform(transform);\n    this.drawSlots(ctx, colorContext, fromSlot, editorAlpha);\n  }\n}\nclass FloatingRenderLink {\n  constructor(network, link, toType, fromReroute, dragDirection = LinkDirection.CENTER) {\n    this.network = network;\n    this.link = link;\n    this.toType = toType;\n    this.fromReroute = fromReroute;\n    this.dragDirection = dragDirection;\n    const {\n      origin_id: outputNodeId,\n      target_id: inputNodeId,\n      origin_slot: outputIndex,\n      target_slot: inputIndex\n    } = link;\n    if (outputNodeId !== -1) {\n      const outputNode = network.getNodeById(outputNodeId) ?? void 0;\n      if (!outputNode) throw new Error(`Creating DraggingRenderLink for link [${link.id}] failed: Output node [${outputNodeId}] not found.`);\n      const outputSlot = outputNode?.outputs.at(outputIndex);\n      if (!outputSlot) throw new Error(`Creating DraggingRenderLink for link [${link.id}] failed: Output slot [${outputIndex}] not found.`);\n      this.outputNodeId = outputNodeId;\n      this.outputNode = outputNode;\n      this.outputSlot = outputSlot;\n      this.outputIndex = outputIndex;\n      this.outputPos = outputNode.getOutputPos(outputIndex);\n      this.node = outputNode;\n      this.fromSlot = outputSlot;\n      this.fromPos = fromReroute?.pos ?? this.outputPos;\n      this.fromDirection = LinkDirection.LEFT;\n      this.dragDirection = LinkDirection.RIGHT;\n      this.fromSlotIndex = outputIndex;\n    } else {\n      const inputNode = network.getNodeById(inputNodeId) ?? void 0;\n      if (!inputNode) throw new Error(`Creating DraggingRenderLink for link [${link.id}] failed: Input node [${inputNodeId}] not found.`);\n      const inputSlot = inputNode?.inputs.at(inputIndex);\n      if (!inputSlot) throw new Error(`Creating DraggingRenderLink for link [${link.id}] failed: Input slot [${inputIndex}] not found.`);\n      this.inputNodeId = inputNodeId;\n      this.inputNode = inputNode;\n      this.inputSlot = inputSlot;\n      this.inputIndex = inputIndex;\n      this.inputPos = inputNode.getInputPos(inputIndex);\n      this.node = inputNode;\n      this.fromSlot = inputSlot;\n      this.fromDirection = LinkDirection.RIGHT;\n      this.fromSlotIndex = inputIndex;\n    }\n    this.fromPos = fromReroute.pos;\n  }\n  node;\n  fromSlot;\n  fromPos;\n  fromDirection;\n  fromSlotIndex;\n  outputNodeId = -1;\n  outputNode;\n  outputSlot;\n  outputIndex = -1;\n  outputPos;\n  inputNodeId = -1;\n  inputNode;\n  inputSlot;\n  inputIndex = -1;\n  inputPos;\n  canConnectToInput() {\n    return this.toType === \"input\";\n  }\n  canConnectToOutput() {\n    return this.toType === \"output\";\n  }\n  canConnectToReroute(reroute) {\n    if (this.toType === \"input\") {\n      if (reroute.origin_id === this.inputNode?.id) return false;\n    } else {\n      if (reroute.origin_id === this.outputNode?.id) return false;\n    }\n    return true;\n  }\n  connectToInput(node2, input, _events) {\n    const floatingLink = this.link;\n    floatingLink.target_id = node2.id;\n    floatingLink.target_slot = node2.inputs.indexOf(input);\n    node2.disconnectInput(node2.inputs.indexOf(input));\n    this.fromSlot._floatingLinks?.delete(floatingLink);\n    input._floatingLinks ??= /* @__PURE__ */ new Set();\n    input._floatingLinks.add(floatingLink);\n  }\n  connectToOutput(node2, output, _events) {\n    const floatingLink = this.link;\n    floatingLink.origin_id = node2.id;\n    floatingLink.origin_slot = node2.outputs.indexOf(output);\n    this.fromSlot._floatingLinks?.delete(floatingLink);\n    output._floatingLinks ??= /* @__PURE__ */ new Set();\n    output._floatingLinks.add(floatingLink);\n  }\n  connectToSubgraphInput(input, _events) {\n    const floatingLink = this.link;\n    floatingLink.origin_id = SUBGRAPH_INPUT_ID;\n    floatingLink.origin_slot = input.parent.slots.indexOf(input);\n    this.fromSlot._floatingLinks?.delete(floatingLink);\n    input._floatingLinks ??= /* @__PURE__ */ new Set();\n    input._floatingLinks.add(floatingLink);\n  }\n  connectToSubgraphOutput(output, _events) {\n    const floatingLink = this.link;\n    floatingLink.origin_id = SUBGRAPH_OUTPUT_ID;\n    floatingLink.origin_slot = output.parent.slots.indexOf(output);\n    this.fromSlot._floatingLinks?.delete(floatingLink);\n    output._floatingLinks ??= /* @__PURE__ */ new Set();\n    output._floatingLinks.add(floatingLink);\n  }\n  connectToRerouteInput(reroute, { node: inputNode, input }, events) {\n    const floatingLink = this.link;\n    floatingLink.target_id = inputNode.id;\n    floatingLink.target_slot = inputNode.inputs.indexOf(input);\n    this.fromSlot._floatingLinks?.delete(floatingLink);\n    input._floatingLinks ??= /* @__PURE__ */ new Set();\n    input._floatingLinks.add(floatingLink);\n    events.dispatch(\"input-moved\", this);\n  }\n  connectToRerouteOutput(reroute, outputNode, output, events) {\n    const floatingLink = this.link;\n    floatingLink.origin_id = outputNode.id;\n    floatingLink.origin_slot = outputNode.outputs.indexOf(output);\n    this.fromSlot._floatingLinks?.delete(floatingLink);\n    output._floatingLinks ??= /* @__PURE__ */ new Set();\n    output._floatingLinks.add(floatingLink);\n    events.dispatch(\"output-moved\", this);\n  }\n}\nclass MovingLinkBase {\n  constructor(network, link, toType, fromReroute, dragDirection = LinkDirection.CENTER) {\n    this.network = network;\n    this.link = link;\n    this.toType = toType;\n    this.fromReroute = fromReroute;\n    this.dragDirection = dragDirection;\n    const {\n      origin_id: outputNodeId,\n      target_id: inputNodeId,\n      origin_slot: outputIndex,\n      target_slot: inputIndex\n    } = link;\n    const outputNode = network.getNodeById(outputNodeId) ?? void 0;\n    if (!outputNode) throw new Error(`Creating MovingRenderLink for link [${link.id}] failed: Output node [${outputNodeId}] not found.`);\n    const outputSlot = outputNode.outputs.at(outputIndex);\n    if (!outputSlot) throw new Error(`Creating MovingRenderLink for link [${link.id}] failed: Output slot [${outputIndex}] not found.`);\n    this.outputNodeId = outputNodeId;\n    this.outputNode = outputNode;\n    this.outputSlot = outputSlot;\n    this.outputIndex = outputIndex;\n    this.outputPos = outputNode.getOutputPos(outputIndex);\n    const inputNode = network.getNodeById(inputNodeId) ?? void 0;\n    if (!inputNode) throw new Error(`Creating DraggingRenderLink for link [${link.id}] failed: Input node [${inputNodeId}] not found.`);\n    const inputSlot = inputNode.inputs.at(inputIndex);\n    if (!inputSlot) throw new Error(`Creating DraggingRenderLink for link [${link.id}] failed: Input slot [${inputIndex}] not found.`);\n    this.inputNodeId = inputNodeId;\n    this.inputNode = inputNode;\n    this.inputSlot = inputSlot;\n    this.inputIndex = inputIndex;\n    this.inputPos = inputNode.getInputPos(inputIndex);\n  }\n  outputNodeId;\n  outputNode;\n  outputSlot;\n  outputIndex;\n  outputPos;\n  inputNodeId;\n  inputNode;\n  inputSlot;\n  inputIndex;\n  inputPos;\n}\nclass MovingInputLink extends MovingLinkBase {\n  toType = \"input\";\n  node;\n  fromSlot;\n  fromPos;\n  fromDirection;\n  fromSlotIndex;\n  constructor(network, link, fromReroute, dragDirection = LinkDirection.CENTER) {\n    super(network, link, \"input\", fromReroute, dragDirection);\n    this.node = this.outputNode;\n    this.fromSlot = this.outputSlot;\n    this.fromPos = fromReroute?.pos ?? this.outputPos;\n    this.fromDirection = LinkDirection.NONE;\n    this.fromSlotIndex = this.outputIndex;\n  }\n  canConnectToInput(inputNode, input) {\n    return this.node.canConnectTo(inputNode, input, this.outputSlot);\n  }\n  canConnectToOutput() {\n    return false;\n  }\n  canConnectToReroute(reroute) {\n    return reroute.origin_id !== this.inputNode.id;\n  }\n  connectToInput(inputNode, input, events) {\n    if (input === this.inputSlot) return;\n    this.inputNode.disconnectInput(this.inputIndex, true);\n    const link = this.outputNode.connectSlots(this.outputSlot, inputNode, input, this.fromReroute?.id);\n    if (link) events.dispatch(\"input-moved\", this);\n    return link;\n  }\n  connectToOutput() {\n    throw new Error(\"MovingInputLink cannot connect to an output.\");\n  }\n  connectToSubgraphInput() {\n    throw new Error(\"MovingInputLink cannot connect to a subgraph input.\");\n  }\n  connectToSubgraphOutput(output, events) {\n    const newLink = output.connect(this.fromSlot, this.node, this.fromReroute?.id);\n    events?.dispatch(\"link-created\", newLink);\n  }\n  connectToRerouteInput(reroute, { node: inputNode, input, link: existingLink }, events, originalReroutes) {\n    const { outputNode, outputSlot, fromReroute } = this;\n    for (const reroute2 of originalReroutes) {\n      if (reroute2.id === this.link.parentId) break;\n      if (reroute2.totalLinks === 1) reroute2.remove();\n    }\n    reroute.parentId = fromReroute?.id;\n    const newLink = outputNode.connectSlots(outputSlot, inputNode, input, existingLink.parentId);\n    if (newLink) events.dispatch(\"input-moved\", this);\n  }\n  connectToRerouteOutput() {\n    throw new Error(\"MovingInputLink cannot connect to an output.\");\n  }\n  disconnect() {\n    return this.inputNode.disconnectInput(this.inputIndex, true);\n  }\n}\nclass MovingOutputLink extends MovingLinkBase {\n  toType = \"output\";\n  node;\n  fromSlot;\n  fromPos;\n  fromDirection;\n  fromSlotIndex;\n  constructor(network, link, fromReroute, dragDirection = LinkDirection.CENTER) {\n    super(network, link, \"output\", fromReroute, dragDirection);\n    this.node = this.inputNode;\n    this.fromSlot = this.inputSlot;\n    this.fromPos = fromReroute?.pos ?? this.inputPos;\n    this.fromDirection = LinkDirection.LEFT;\n    this.fromSlotIndex = this.inputIndex;\n  }\n  canConnectToInput() {\n    return false;\n  }\n  canConnectToOutput(outputNode, output) {\n    return outputNode.canConnectTo(this.node, this.inputSlot, output);\n  }\n  canConnectToReroute(reroute) {\n    return reroute.origin_id !== this.outputNode.id;\n  }\n  connectToInput() {\n    throw new Error(\"MovingOutputLink cannot connect to an input.\");\n  }\n  connectToOutput(outputNode, output, events) {\n    if (output === this.outputSlot) return;\n    const link = outputNode.connectSlots(output, this.inputNode, this.inputSlot, this.link.parentId);\n    if (link) events.dispatch(\"output-moved\", this);\n    return link;\n  }\n  connectToSubgraphInput(input, events) {\n    const newLink = input.connect(this.fromSlot, this.node, this.fromReroute?.id);\n    events?.dispatch(\"link-created\", newLink);\n  }\n  connectToSubgraphOutput() {\n    throw new Error(\"MovingOutputLink cannot connect to a subgraph output.\");\n  }\n  connectToRerouteInput() {\n    throw new Error(\"MovingOutputLink cannot connect to an input.\");\n  }\n  connectToRerouteOutput(reroute, outputNode, output, events) {\n    const { inputNode, inputSlot, fromReroute } = this;\n    const floatingTerminus = reroute?.floating?.slotType === \"output\";\n    if (fromReroute) {\n      fromReroute.parentId = reroute.id;\n    } else {\n      this.link.parentId = reroute.id;\n    }\n    outputNode.connectSlots(output, inputNode, inputSlot, this.link.parentId);\n    if (floatingTerminus) reroute.removeAllFloatingLinks();\n    events.dispatch(\"output-moved\", this);\n  }\n  disconnect() {\n    return this.outputNode.disconnectOutput(this.outputIndex, this.inputNode);\n  }\n}\nclass ToInputFromIoNodeLink {\n  constructor(network, node2, fromSlot, fromReroute, dragDirection = LinkDirection.CENTER, existingLink) {\n    this.network = network;\n    this.node = node2;\n    this.fromSlot = fromSlot;\n    this.fromReroute = fromReroute;\n    this.dragDirection = dragDirection;\n    const outputIndex = node2.slots.indexOf(fromSlot);\n    if (outputIndex === -1 && fromSlot !== node2.emptySlot) {\n      throw new Error(`Creating render link for node [${this.node.id}] failed: Slot index not found.`);\n    }\n    this.fromSlotIndex = outputIndex;\n    this.fromPos = fromReroute ? fromReroute.pos : fromSlot.pos;\n    this.existingLink = existingLink;\n  }\n  toType = \"input\";\n  fromSlotIndex;\n  fromPos;\n  fromDirection = LinkDirection.RIGHT;\n  existingLink;\n  canConnectToInput(inputNode, input) {\n    return this.node.canConnectTo(inputNode, input, this.fromSlot);\n  }\n  canConnectToOutput() {\n    return false;\n  }\n  connectToInput(node2, input, events) {\n    const { fromSlot, fromReroute, existingLink } = this;\n    const newLink = fromSlot.connect(input, node2, fromReroute?.id);\n    if (existingLink) {\n      events.dispatch(\"input-moved\", this);\n    } else {\n      events.dispatch(\"link-created\", newLink);\n    }\n  }\n  connectToSubgraphOutput() {\n    throw new Error(\"Not implemented\");\n  }\n  connectToRerouteInput(reroute, {\n    node: inputNode,\n    input,\n    link\n  }, events, originalReroutes) {\n    const { fromSlot, fromReroute } = this;\n    const floatingTerminus = fromReroute?.floating?.slotType === \"output\";\n    reroute.parentId = fromReroute?.id;\n    const newLink = fromSlot.connect(input, inputNode, link.parentId);\n    if (floatingTerminus) fromReroute.removeAllFloatingLinks();\n    for (const reroute2 of originalReroutes) {\n      if (reroute2.id === fromReroute?.id) break;\n      reroute2.removeLink(link);\n      if (reroute2.totalLinks === 0) {\n        if (link.isFloating) {\n          reroute2.remove();\n        } else {\n          const cl = link.toFloating(\"output\", reroute2.id);\n          this.network.addFloatingLink(cl);\n          reroute2.floating = { slotType: \"output\" };\n        }\n      }\n    }\n    if (this.existingLink) {\n      events.dispatch(\"input-moved\", this);\n    } else {\n      events.dispatch(\"link-created\", newLink);\n    }\n  }\n  connectToOutput() {\n    throw new Error(\"ToInputRenderLink cannot connect to an output.\");\n  }\n  connectToSubgraphInput() {\n    throw new Error(\"ToInputRenderLink cannot connect to a subgraph input.\");\n  }\n  connectToRerouteOutput() {\n    throw new Error(\"ToInputRenderLink cannot connect to an output.\");\n  }\n}\nclass ToInputRenderLink {\n  constructor(network, node2, fromSlot, fromReroute, dragDirection = LinkDirection.CENTER) {\n    this.network = network;\n    this.node = node2;\n    this.fromSlot = fromSlot;\n    this.fromReroute = fromReroute;\n    this.dragDirection = dragDirection;\n    const outputIndex = node2.outputs.indexOf(fromSlot);\n    if (outputIndex === -1) throw new Error(`Creating render link for node [${this.node.id}] failed: Slot index not found.`);\n    this.fromSlotIndex = outputIndex;\n    this.fromPos = fromReroute ? fromReroute.pos : this.node.getOutputPos(outputIndex);\n  }\n  toType = \"input\";\n  fromPos;\n  fromSlotIndex;\n  fromDirection = LinkDirection.RIGHT;\n  canConnectToInput(inputNode, input) {\n    return this.node.canConnectTo(inputNode, input, this.fromSlot);\n  }\n  canConnectToOutput() {\n    return false;\n  }\n  connectToInput(node2, input, events) {\n    const { node: outputNode, fromSlot, fromReroute } = this;\n    if (node2 === outputNode) return;\n    const newLink = outputNode.connectSlots(fromSlot, node2, input, fromReroute?.id);\n    events.dispatch(\"link-created\", newLink);\n  }\n  connectToSubgraphOutput(output, events) {\n    const newLink = output.connect(this.fromSlot, this.node, this.fromReroute?.id);\n    events.dispatch(\"link-created\", newLink);\n  }\n  connectToRerouteInput(reroute, {\n    node: inputNode,\n    input,\n    link\n  }, events, originalReroutes) {\n    const { node: outputNode, fromSlot, fromReroute } = this;\n    const floatingTerminus = fromReroute?.floating?.slotType === \"output\";\n    reroute.parentId = fromReroute?.id;\n    const newLink = outputNode.connectSlots(fromSlot, inputNode, input, link.parentId);\n    if (floatingTerminus) fromReroute.removeAllFloatingLinks();\n    for (const reroute2 of originalReroutes) {\n      if (reroute2.id === fromReroute?.id) break;\n      reroute2.removeLink(link);\n      if (reroute2.totalLinks === 0) {\n        if (link.isFloating) {\n          reroute2.remove();\n        } else {\n          const cl = link.toFloating(\"output\", reroute2.id);\n          this.network.addFloatingLink(cl);\n          reroute2.floating = { slotType: \"output\" };\n        }\n      }\n    }\n    events.dispatch(\"link-created\", newLink);\n  }\n  connectToOutput() {\n    throw new Error(\"ToInputRenderLink cannot connect to an output.\");\n  }\n  connectToSubgraphInput() {\n    throw new Error(\"ToInputRenderLink cannot connect to a subgraph input.\");\n  }\n  connectToRerouteOutput() {\n    throw new Error(\"ToInputRenderLink cannot connect to an output.\");\n  }\n}\nclass ToOutputFromIoNodeLink {\n  constructor(network, node2, fromSlot, fromReroute, dragDirection = LinkDirection.CENTER) {\n    this.network = network;\n    this.node = node2;\n    this.fromSlot = fromSlot;\n    this.fromReroute = fromReroute;\n    this.dragDirection = dragDirection;\n    const inputIndex = node2.slots.indexOf(fromSlot);\n    if (inputIndex === -1 && fromSlot !== node2.emptySlot) {\n      throw new Error(`Creating render link for node [${this.node.id}] failed: Slot index not found.`);\n    }\n    this.fromSlotIndex = inputIndex;\n    this.fromPos = fromReroute ? fromReroute.pos : fromSlot.pos;\n  }\n  toType = \"output\";\n  fromPos;\n  fromSlotIndex;\n  fromDirection = LinkDirection.LEFT;\n  canConnectToInput() {\n    return false;\n  }\n  canConnectToOutput(outputNode, output) {\n    return this.node.canConnectTo(outputNode, this.fromSlot, output);\n  }\n  canConnectToReroute(reroute) {\n    if (reroute.origin_id === this.node.id) return false;\n    return true;\n  }\n  connectToOutput(node2, output, events) {\n    const { fromSlot, fromReroute } = this;\n    const newLink = fromSlot.connect(output, node2, fromReroute?.id);\n    events.dispatch(\"link-created\", newLink);\n  }\n  connectToSubgraphInput() {\n    throw new Error(\"Not implemented\");\n  }\n  connectToRerouteOutput(reroute, outputNode, output, events) {\n    const { fromSlot } = this;\n    const newLink = fromSlot.connect(output, outputNode, reroute?.id);\n    events.dispatch(\"link-created\", newLink);\n  }\n  connectToInput() {\n    throw new Error(\"ToOutputRenderLink cannot connect to an input.\");\n  }\n  connectToSubgraphOutput() {\n    throw new Error(\"ToOutputRenderLink cannot connect to a subgraph output.\");\n  }\n  connectToRerouteInput() {\n    throw new Error(\"ToOutputRenderLink cannot connect to an input.\");\n  }\n}\nclass ToOutputRenderLink {\n  constructor(network, node2, fromSlot, fromReroute, dragDirection = LinkDirection.CENTER) {\n    this.network = network;\n    this.node = node2;\n    this.fromSlot = fromSlot;\n    this.fromReroute = fromReroute;\n    this.dragDirection = dragDirection;\n    const inputIndex = node2.inputs.indexOf(fromSlot);\n    if (inputIndex === -1) throw new Error(`Creating render link for node [${this.node.id}] failed: Slot index not found.`);\n    this.fromSlotIndex = inputIndex;\n    this.fromPos = fromReroute ? fromReroute.pos : this.node.getInputPos(inputIndex);\n  }\n  toType = \"output\";\n  fromPos;\n  fromSlotIndex;\n  fromDirection = LinkDirection.LEFT;\n  canConnectToInput() {\n    return false;\n  }\n  canConnectToOutput(outputNode, output) {\n    return this.node.canConnectTo(outputNode, this.fromSlot, output);\n  }\n  canConnectToReroute(reroute) {\n    if (reroute.origin_id === this.node.id) return false;\n    return true;\n  }\n  connectToOutput(node2, output, events) {\n    const { node: inputNode, fromSlot, fromReroute } = this;\n    if (!inputNode) return;\n    const newLink = node2.connectSlots(output, inputNode, fromSlot, fromReroute?.id);\n    events.dispatch(\"link-created\", newLink);\n  }\n  connectToSubgraphInput(input, events) {\n    const newLink = input.connect(this.fromSlot, this.node, this.fromReroute?.id);\n    events?.dispatch(\"link-created\", newLink);\n  }\n  connectToRerouteOutput(reroute, outputNode, output, events) {\n    const { node: inputNode, fromSlot } = this;\n    const newLink = outputNode.connectSlots(output, inputNode, fromSlot, reroute?.id);\n    events.dispatch(\"link-created\", newLink);\n  }\n  connectToInput() {\n    throw new Error(\"ToOutputRenderLink cannot connect to an input.\");\n  }\n  connectToSubgraphOutput() {\n    throw new Error(\"ToOutputRenderLink cannot connect to a subgraph output.\");\n  }\n  connectToRerouteInput() {\n    throw new Error(\"ToOutputRenderLink cannot connect to an input.\");\n  }\n}\nclass ToOutputFromRerouteLink extends ToOutputRenderLink {\n  constructor(network, node2, fromSlot, fromReroute, linkConnector) {\n    super(network, node2, fromSlot, fromReroute);\n    this.fromReroute = fromReroute;\n    this.linkConnector = linkConnector;\n  }\n  canConnectToReroute() {\n    return false;\n  }\n  connectToOutput(node2, output) {\n    const nuRenderLink = new ToInputRenderLink(this.network, node2, output);\n    this.linkConnector._connectOutputToReroute(this.fromReroute, nuRenderLink);\n  }\n}\nclass LinkConnector {\n  /**\n   * Link connection state POJO. Source of truth for state of link drag operations.\n   *\n   * Can be replaced or proxied to allow notifications.\n   * Is always dereferenced at the start of an operation.\n   */\n  state = {\n    connectingTo: void 0,\n    multi: false,\n    draggingExistingLinks: false,\n    snapLinksPos: void 0\n  };\n  events = new CustomEventTarget();\n  /** Contains information for rendering purposes only. */\n  renderLinks = [];\n  /** Existing links that are being moved **to** a new input slot. */\n  inputLinks = [];\n  /** Existing links that are being moved **to** a new output slot. */\n  outputLinks = [];\n  /** Existing floating links that are being moved to a new slot. */\n  floatingLinks = [];\n  hiddenReroutes = /* @__PURE__ */ new Set();\n  /** The widget beneath the pointer, if it is a valid connection target. */\n  overWidget;\n  /** The type (returned by downstream callback) for {@link overWidget} */\n  overWidgetType;\n  /** The reroute beneath the pointer, if it is a valid connection target. */\n  overReroute;\n  #setConnectingLinks;\n  constructor(setConnectingLinks) {\n    this.#setConnectingLinks = setConnectingLinks;\n  }\n  get isConnecting() {\n    return this.state.connectingTo !== void 0;\n  }\n  get draggingExistingLinks() {\n    return this.state.draggingExistingLinks;\n  }\n  /** Drag an existing link to a different input. */\n  moveInputLink(network, input) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const { state, inputLinks, renderLinks } = this;\n    const linkId = input.link;\n    if (linkId == null) {\n      const floatingLink = input._floatingLinks?.values().next().value;\n      if (floatingLink?.parentId == null) return;\n      try {\n        const reroute = network.reroutes.get(floatingLink.parentId);\n        if (!reroute) throw new Error(`Invalid reroute id: [${floatingLink.parentId}] for floating link id: [${floatingLink.id}].`);\n        const renderLink = new FloatingRenderLink(network, floatingLink, \"input\", reroute);\n        const mayContinue = this.events.dispatch(\"before-move-input\", renderLink);\n        if (mayContinue === false) return;\n        renderLinks.push(renderLink);\n      } catch (error) {\n        console.warn(`Could not create render link for link id: [${floatingLink.id}].`, floatingLink, error);\n      }\n      floatingLink._dragging = true;\n      this.floatingLinks.push(floatingLink);\n    } else {\n      const link = network.links.get(linkId);\n      if (!link) return;\n      if (link.origin_id === SUBGRAPH_INPUT_ID) {\n        const subgraphInput = network.inputNode?.slots[link.origin_slot];\n        if (!subgraphInput) {\n          console.warn(`Could not find subgraph input for slot [${link.origin_slot}]`);\n          return;\n        }\n        try {\n          const reroute = network.getReroute(link.parentId);\n          const renderLink = new ToInputFromIoNodeLink(network, network.inputNode, subgraphInput, reroute, LinkDirection.CENTER, link);\n          renderLinks.push(renderLink);\n          this.listenUntilReset(\"input-moved\", () => {\n            link.disconnect(network, \"input\");\n          });\n        } catch (error) {\n          console.warn(`Could not create render link for subgraph input link id: [${link.id}].`, link, error);\n          return;\n        }\n        link._dragging = true;\n        inputLinks.push(link);\n      } else {\n        try {\n          const reroute = network.getReroute(link.parentId);\n          const renderLink = new MovingInputLink(network, link, reroute);\n          const mayContinue = this.events.dispatch(\"before-move-input\", renderLink);\n          if (mayContinue === false) return;\n          renderLinks.push(renderLink);\n          this.listenUntilReset(\"input-moved\", (e2) => {\n            if (\"link\" in e2.detail && e2.detail.link) {\n              e2.detail.link.disconnect(network, \"output\");\n            }\n          });\n        } catch (error) {\n          console.warn(`Could not create render link for link id: [${link.id}].`, link, error);\n          return;\n        }\n        link._dragging = true;\n        inputLinks.push(link);\n      }\n    }\n    state.connectingTo = \"input\";\n    state.draggingExistingLinks = true;\n    this.#setLegacyLinks(false);\n  }\n  /** Drag all links from an output to a new output. */\n  moveOutputLink(network, output) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const { state, renderLinks } = this;\n    if (output._floatingLinks?.size) {\n      for (const floatingLink of output._floatingLinks.values()) {\n        try {\n          const reroute = LLink.getFirstReroute(network, floatingLink);\n          if (!reroute) throw new Error(`Invalid reroute id: [${floatingLink.parentId}] for floating link id: [${floatingLink.id}].`);\n          const renderLink = new FloatingRenderLink(network, floatingLink, \"output\", reroute);\n          const mayContinue = this.events.dispatch(\"before-move-output\", renderLink);\n          if (mayContinue === false) continue;\n          renderLinks.push(renderLink);\n          this.floatingLinks.push(floatingLink);\n        } catch (error) {\n          console.warn(`Could not create render link for link id: [${floatingLink.id}].`, floatingLink, error);\n        }\n      }\n    }\n    if (output.links?.length) {\n      for (const linkId of output.links) {\n        const link = network.links.get(linkId);\n        if (!link) continue;\n        const firstReroute = LLink.getFirstReroute(network, link);\n        if (firstReroute) {\n          firstReroute._dragging = true;\n          this.hiddenReroutes.add(firstReroute);\n        } else {\n          link._dragging = true;\n        }\n        this.outputLinks.push(link);\n        try {\n          const renderLink = new MovingOutputLink(network, link, firstReroute, LinkDirection.RIGHT);\n          const mayContinue = this.events.dispatch(\"before-move-output\", renderLink);\n          if (mayContinue === false) continue;\n          renderLinks.push(renderLink);\n        } catch (error) {\n          console.warn(`Could not create render link for link id: [${link.id}].`, link, error);\n          continue;\n        }\n      }\n    }\n    if (renderLinks.length === 0) return;\n    state.draggingExistingLinks = true;\n    state.multi = true;\n    state.connectingTo = \"output\";\n    this.#setLegacyLinks(true);\n  }\n  /**\n   * Drags a new link from an output slot to an input slot.\n   * @param network The network that the link being connected belongs to\n   * @param node The node the link is being dragged from\n   * @param output The output slot that the link is being dragged from\n   */\n  dragNewFromOutput(network, node2, output, fromReroute) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const { state } = this;\n    const renderLink = new ToInputRenderLink(network, node2, output, fromReroute);\n    this.renderLinks.push(renderLink);\n    state.connectingTo = \"input\";\n    this.#setLegacyLinks(false);\n  }\n  /**\n   * Drags a new link from an input slot to an output slot.\n   * @param network The network that the link being connected belongs to\n   * @param node The node the link is being dragged from\n   * @param input The input slot that the link is being dragged from\n   */\n  dragNewFromInput(network, node2, input, fromReroute) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const { state } = this;\n    const renderLink = new ToOutputRenderLink(network, node2, input, fromReroute);\n    this.renderLinks.push(renderLink);\n    state.connectingTo = \"output\";\n    this.#setLegacyLinks(true);\n  }\n  dragNewFromSubgraphInput(network, inputNode, input, fromReroute) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const renderLink = new ToInputFromIoNodeLink(network, inputNode, input, fromReroute);\n    this.renderLinks.push(renderLink);\n    this.state.connectingTo = \"input\";\n    this.#setLegacyLinks(false);\n  }\n  dragNewFromSubgraphOutput(network, outputNode, output, fromReroute) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const renderLink = new ToOutputFromIoNodeLink(network, outputNode, output, fromReroute);\n    this.renderLinks.push(renderLink);\n    this.state.connectingTo = \"output\";\n    this.#setLegacyLinks(true);\n  }\n  /**\n   * Drags a new link from a reroute to an input slot.\n   * @param network The network that the link being connected belongs to\n   * @param reroute The reroute that the link is being dragged from\n   */\n  dragFromReroute(network, reroute) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const link = reroute.firstLink ?? reroute.firstFloatingLink;\n    if (!link) {\n      console.warn(\"No link found for reroute.\");\n      return;\n    }\n    if (link.origin_id === SUBGRAPH_INPUT_ID) {\n      if (!(network instanceof Subgraph)) {\n        console.warn(\"Subgraph input link found in non-subgraph network.\");\n        return;\n      }\n      const input = network.inputs.at(link.origin_slot);\n      if (!input) throw new Error(\"No subgraph input found for link.\");\n      const renderLink2 = new ToInputFromIoNodeLink(network, network.inputNode, input, reroute);\n      renderLink2.fromDirection = LinkDirection.NONE;\n      this.renderLinks.push(renderLink2);\n      this.state.connectingTo = \"input\";\n      this.#setLegacyLinks(false);\n      return;\n    }\n    const outputNode = network.getNodeById(link.origin_id);\n    if (!outputNode) {\n      console.warn(\"No output node found for link.\", link);\n      return;\n    }\n    const outputSlot = outputNode.outputs.at(link.origin_slot);\n    if (!outputSlot) {\n      console.warn(\"No output slot found for link.\", link);\n      return;\n    }\n    const renderLink = new ToInputRenderLink(network, outputNode, outputSlot, reroute);\n    renderLink.fromDirection = LinkDirection.NONE;\n    this.renderLinks.push(renderLink);\n    this.state.connectingTo = \"input\";\n    this.#setLegacyLinks(false);\n  }\n  /**\n   * Drags a new link from a reroute to an output slot.\n   * @param network The network that the link being connected belongs to\n   * @param reroute The reroute that the link is being dragged from\n   */\n  dragFromRerouteToOutput(network, reroute) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const link = reroute.firstLink ?? reroute.firstFloatingLink;\n    if (!link) {\n      console.warn(\"No link found for reroute.\");\n      return;\n    }\n    if (link.target_id === SUBGRAPH_OUTPUT_ID) {\n      if (!(network instanceof Subgraph)) {\n        console.warn(\"Subgraph output link found in non-subgraph network.\");\n        return;\n      }\n      const output = network.outputs.at(link.target_slot);\n      if (!output) throw new Error(\"No subgraph output found for link.\");\n      const renderLink2 = new ToOutputFromIoNodeLink(network, network.outputNode, output, reroute);\n      renderLink2.fromDirection = LinkDirection.NONE;\n      this.renderLinks.push(renderLink2);\n      this.state.connectingTo = \"output\";\n      this.#setLegacyLinks(false);\n      return;\n    }\n    const inputNode = network.getNodeById(link.target_id);\n    if (!inputNode) {\n      console.warn(\"No input node found for link.\", link);\n      return;\n    }\n    const inputSlot = inputNode.inputs.at(link.target_slot);\n    if (!inputSlot) {\n      console.warn(\"No input slot found for link.\", link);\n      return;\n    }\n    const renderLink = new ToOutputFromRerouteLink(network, inputNode, inputSlot, reroute, this);\n    renderLink.fromDirection = LinkDirection.LEFT;\n    this.renderLinks.push(renderLink);\n    this.state.connectingTo = \"output\";\n    this.#setLegacyLinks(true);\n  }\n  dragFromLinkSegment(network, linkSegment) {\n    if (this.isConnecting) throw new Error(\"Already dragging links.\");\n    const { state } = this;\n    if (linkSegment.origin_id == null || linkSegment.origin_slot == null) return;\n    const node2 = network.getNodeById(linkSegment.origin_id);\n    if (!node2) return;\n    const slot = node2.outputs.at(linkSegment.origin_slot);\n    if (!slot) return;\n    const reroute = network.getReroute(linkSegment.parentId);\n    const renderLink = new ToInputRenderLink(network, node2, slot, reroute);\n    renderLink.fromDirection = LinkDirection.NONE;\n    this.renderLinks.push(renderLink);\n    state.connectingTo = \"input\";\n    this.#setLegacyLinks(false);\n  }\n  /**\n   * Connects the links being dropped\n   * @param event Contains the drop location, in canvas space\n   */\n  dropLinks(locator, event) {\n    if (!this.isConnecting) {\n      const mayContinue = this.events.dispatch(\"before-drop-links\", { renderLinks: this.renderLinks, event });\n      if (mayContinue === false) return;\n    }\n    try {\n      const { canvasX, canvasY } = event;\n      const ioNode = locator.getIoNodeOnPos?.(canvasX, canvasY);\n      if (ioNode) {\n        this.dropOnIoNode(ioNode, event);\n        return;\n      }\n      const node2 = locator.getNodeOnPos(canvasX, canvasY) ?? void 0;\n      if (node2) {\n        this.dropOnNode(node2, event);\n      } else {\n        const reroute = locator.getRerouteOnPos(canvasX, canvasY);\n        if (reroute && this.isRerouteValidDrop(reroute)) {\n          this.dropOnReroute(reroute, event);\n        } else {\n          this.dropOnNothing(event);\n        }\n      }\n    } finally {\n      this.events.dispatch(\"after-drop-links\", { renderLinks: this.renderLinks, event });\n    }\n  }\n  dropOnIoNode(ioNode, event) {\n    const { renderLinks, state } = this;\n    const { connectingTo } = state;\n    const { canvasX, canvasY } = event;\n    if (connectingTo === \"input\" && ioNode instanceof SubgraphOutputNode) {\n      const output = ioNode.getSlotInPosition(canvasX, canvasY);\n      if (!output) throw new Error(\"No output slot found for link.\");\n      for (const link of renderLinks) {\n        link.connectToSubgraphOutput(output, this.events);\n      }\n    } else if (connectingTo === \"output\" && ioNode instanceof SubgraphInputNode) {\n      const input = ioNode.getSlotInPosition(canvasX, canvasY);\n      if (!input) throw new Error(\"No input slot found for link.\");\n      for (const link of renderLinks) {\n        link.connectToSubgraphInput(input, this.events);\n      }\n    } else {\n      console.error(\"Invalid connectingTo state &/ ioNode\", connectingTo, ioNode);\n    }\n  }\n  dropOnNode(node2, event) {\n    const { renderLinks, state } = this;\n    const { connectingTo } = state;\n    const { canvasX, canvasY } = event;\n    if (renderLinks.every((link) => link.node === node2)) return;\n    if (connectingTo === \"output\") {\n      const output = node2.getOutputOnPos([canvasX, canvasY]);\n      if (output) {\n        this.#dropOnOutput(node2, output);\n      } else {\n        this.connectToNode(node2, event);\n      }\n    } else if (connectingTo === \"input\") {\n      const input = node2.getInputOnPos([canvasX, canvasY]);\n      const inputOrSocket = input ?? node2.getSlotFromWidget(this.overWidget);\n      if (inputOrSocket) {\n        this.#dropOnInput(node2, inputOrSocket);\n      } else {\n        this.connectToNode(node2, event);\n      }\n    }\n  }\n  dropOnReroute(reroute, event) {\n    const mayContinue = this.events.dispatch(\"dropped-on-reroute\", { reroute, event });\n    if (mayContinue === false) return;\n    if (this.state.connectingTo === \"input\") {\n      if (this.renderLinks.length !== 1) throw new Error(`Attempted to connect ${this.renderLinks.length} input links to a reroute.`);\n      const renderLink = this.renderLinks[0];\n      this._connectOutputToReroute(reroute, renderLink);\n      return;\n    }\n    for (const link of this.renderLinks) {\n      if (link.toType !== \"output\") continue;\n      const result = reroute.findSourceOutput();\n      if (!result) continue;\n      const { node: node2, output } = result;\n      if (!link.canConnectToOutput(node2, output)) continue;\n      link.connectToRerouteOutput(reroute, node2, output, this.events);\n    }\n  }\n  /** @internal Temporary workaround - requires refactor. */\n  _connectOutputToReroute(reroute, renderLink) {\n    const results = reroute.findTargetInputs();\n    if (!results?.length) return;\n    const maybeReroutes = reroute.getReroutes();\n    if (maybeReroutes === null) throw new Error(\"Reroute loop detected.\");\n    const originalReroutes = maybeReroutes.slice(0, -1).reverse();\n    if (renderLink instanceof ToInputRenderLink) {\n      const { node: node2, fromSlot, fromSlotIndex, fromReroute } = renderLink;\n      reroute.setFloatingLinkOrigin(node2, fromSlot, fromSlotIndex);\n      if (fromReroute != null) {\n        for (const originalReroute of originalReroutes) {\n          if (originalReroute.id === fromReroute.id) break;\n          for (const linkId of reroute.floatingLinkIds) {\n            originalReroute.floatingLinkIds.delete(linkId);\n          }\n        }\n      }\n    }\n    const filtered = results.filter((result) => renderLink.toType === \"input\" && canConnectInputLinkToReroute(renderLink, result.node, result.input, reroute));\n    for (const result of filtered) {\n      renderLink.connectToRerouteInput(reroute, result, this.events, originalReroutes);\n    }\n    return;\n  }\n  dropOnNothing(event) {\n    const mayContinue = this.events.dispatch(\"dropped-on-canvas\", event);\n    if (mayContinue === false) return;\n    this.disconnectLinks();\n  }\n  /**\n   * Disconnects all moving links.\n   * @remarks This is called when the links are dropped on the canvas.\n   * May be called by consumers to e.g. drag links into a bin / void.\n   */\n  disconnectLinks() {\n    for (const link of this.renderLinks) {\n      if (link instanceof MovingLinkBase) {\n        link.disconnect();\n      }\n    }\n  }\n  /**\n   * Connects the links being dropped onto a node to the first matching slot.\n   * @param node The node that the links are being dropped on\n   * @param event Contains the drop location, in canvas space\n   */\n  connectToNode(node2, event) {\n    const { state: { connectingTo } } = this;\n    const mayContinue = this.events.dispatch(\"dropped-on-node\", { node: node2, event });\n    if (mayContinue === false) return;\n    const firstLink = this.renderLinks[0];\n    if (!firstLink) return;\n    if (connectingTo === \"output\") {\n      const output = node2.findOutputByType(firstLink.fromSlot.type)?.slot;\n      console.debug(\"out\", node2, output, firstLink.fromSlot);\n      if (output === void 0) {\n        console.warn(`Could not find slot for link type: [${firstLink.fromSlot.type}].`);\n        return;\n      }\n      this.#dropOnOutput(node2, output);\n    } else if (connectingTo === \"input\") {\n      const input = node2.findInputByType(firstLink.fromSlot.type)?.slot;\n      console.debug(\"in\", node2, input, firstLink.fromSlot);\n      if (input === void 0) {\n        console.warn(`Could not find slot for link type: [${firstLink.fromSlot.type}].`);\n        return;\n      }\n      this.#dropOnInput(node2, input);\n    }\n  }\n  #dropOnInput(node2, input) {\n    for (const link of this.renderLinks) {\n      if (!link.canConnectToInput(node2, input)) continue;\n      link.connectToInput(node2, input, this.events);\n    }\n  }\n  #dropOnOutput(node2, output) {\n    for (const link of this.renderLinks) {\n      if (!link.canConnectToOutput(node2, output)) {\n        if (link instanceof MovingOutputLink && link.link.parentId !== void 0) {\n          link.outputNode.connectSlots(link.outputSlot, link.inputNode, link.inputSlot, void 0);\n        }\n        continue;\n      }\n      link.connectToOutput(node2, output, this.events);\n    }\n  }\n  isInputValidDrop(node2, input) {\n    return this.renderLinks.some((link) => link.canConnectToInput(node2, input));\n  }\n  isNodeValidDrop(node2) {\n    if (this.state.connectingTo === \"output\") {\n      return node2.outputs.some((output) => this.renderLinks.some((link) => link.canConnectToOutput(node2, output)));\n    }\n    return node2.inputs.some((input) => this.renderLinks.some((link) => link.canConnectToInput(node2, input)));\n  }\n  /**\n   * Checks if a reroute is a valid drop target for any of the links being connected.\n   * @param reroute The reroute that would be dropped on.\n   * @returns `true` if any of the current links being connected are valid for the given reroute.\n   */\n  isRerouteValidDrop(reroute) {\n    if (this.state.connectingTo === \"input\") {\n      const results = reroute.findTargetInputs();\n      if (!results?.length) return false;\n      for (const { node: node2, input } of results) {\n        for (const renderLink of this.renderLinks) {\n          if (renderLink.toType !== \"input\") continue;\n          if (canConnectInputLinkToReroute(renderLink, node2, input, reroute)) return true;\n        }\n      }\n    } else {\n      const result = reroute.findSourceOutput();\n      if (!result) return false;\n      const { node: node2, output } = result;\n      for (const renderLink of this.renderLinks) {\n        if (renderLink.toType !== \"output\") continue;\n        if (!renderLink.canConnectToReroute(reroute)) continue;\n        if (renderLink.canConnectToOutput(node2, output)) return true;\n      }\n    }\n    return false;\n  }\n  /** Sets connecting_links, used by some extensions still. */\n  #setLegacyLinks(fromSlotIsInput) {\n    const links = this.renderLinks.map((link) => {\n      const input = fromSlotIsInput ? link.fromSlot : null;\n      const output = fromSlotIsInput ? null : link.fromSlot;\n      const afterRerouteId = link instanceof MovingLinkBase ? link.link?.parentId : link.fromReroute?.id;\n      return {\n        node: link.node,\n        slot: link.fromSlotIndex,\n        input,\n        output,\n        pos: link.fromPos,\n        afterRerouteId\n      };\n    });\n    this.#setConnectingLinks(links);\n  }\n  /**\n   * Exports the current state of the link connector.\n   * @param network The network that the links being connected belong to.\n   * @returns A POJO with the state of the link connector, links being connected, and their network.\n   * @remarks Other than {@link network}, all properties are shallow cloned.\n   */\n  export(network) {\n    return {\n      renderLinks: [...this.renderLinks],\n      inputLinks: [...this.inputLinks],\n      outputLinks: [...this.outputLinks],\n      floatingLinks: [...this.floatingLinks],\n      state: { ...this.state },\n      network\n    };\n  }\n  /**\n   * Adds an event listener that will be automatically removed when the reset event is fired.\n   * @param eventName The event to listen for.\n   * @param listener The listener to call when the event is fired.\n   */\n  listenUntilReset(eventName, listener, options) {\n    this.events.addEventListener(eventName, listener, options);\n    this.events.addEventListener(\"reset\", () => this.events.removeEventListener(eventName, listener), { once: true });\n  }\n  /**\n   * Resets everything to its initial state.\n   *\n   * Effectively cancels moving or connecting links.\n   */\n  reset(force = false) {\n    const mayContinue = this.events.dispatch(\"reset\", force);\n    if (mayContinue === false) return;\n    const { state, outputLinks, inputLinks, hiddenReroutes, renderLinks, floatingLinks } = this;\n    if (!force && state.connectingTo === void 0) return;\n    state.connectingTo = void 0;\n    for (const link of outputLinks) delete link._dragging;\n    for (const link of inputLinks) delete link._dragging;\n    for (const link of floatingLinks) delete link._dragging;\n    for (const reroute of hiddenReroutes) delete reroute._dragging;\n    renderLinks.length = 0;\n    inputLinks.length = 0;\n    outputLinks.length = 0;\n    floatingLinks.length = 0;\n    hiddenReroutes.clear();\n    state.multi = false;\n    state.draggingExistingLinks = false;\n    state.snapLinksPos = void 0;\n  }\n}\nfunction canConnectInputLinkToReroute(link, inputNode, input, reroute) {\n  const { fromReroute } = link;\n  if (!link.canConnectToInput(inputNode, input) || // Would result in no change\n  fromReroute?.id === reroute.id || // Cannot connect from child to parent reroute\n  fromReroute?.getReroutes()?.includes(reroute)) {\n    return false;\n  }\n  if (link instanceof ToInputRenderLink) {\n    if (reroute.parentId == null) {\n      if (reroute.firstLink?.hasOrigin(link.node.id, link.fromSlotIndex)) return false;\n    } else if (link.fromReroute?.id === reroute.parentId) {\n      return false;\n    }\n  }\n  return true;\n}\nclass CanvasPointer {\n  /** Maximum time in milliseconds to ignore click drift */\n  static bufferTime = 150;\n  /** Maximum gap between pointerup and pointerdown events to be considered as a double click */\n  static doubleClickTime = 300;\n  /** Maximum offset from click location */\n  static get maxClickDrift() {\n    return this.#maxClickDrift;\n  }\n  static set maxClickDrift(value) {\n    this.#maxClickDrift = value;\n    this.#maxClickDrift2 = value * value;\n  }\n  static #maxClickDrift = 6;\n  /** {@link maxClickDrift} squared.  Used to calculate click drift without `sqrt`. */\n  static #maxClickDrift2 = this.#maxClickDrift ** 2;\n  /** The element this PointerState should capture input against when dragging. */\n  element;\n  /** Pointer ID used by drag capture. */\n  pointerId;\n  /** Set to true when if the pointer moves far enough after a down event, before the corresponding up event is fired. */\n  dragStarted = false;\n  /** The {@link eUp} from the last successful click */\n  eLastDown;\n  /** Used downstream for touch event support. */\n  isDouble = false;\n  /** Used downstream for touch event support. */\n  isDown = false;\n  /** The resize handle currently being hovered or dragged */\n  resizeDirection;\n  /**\n   * If `true`, {@link eDown}, {@link eMove}, and {@link eUp} will be set to\n   * `undefined` when {@link reset} is called.\n   *\n   * Default: `true`\n   */\n  clearEventsOnReset = true;\n  /** The last pointerdown event for the primary button */\n  eDown;\n  /** The last pointermove event for the primary button */\n  eMove;\n  /** The last pointerup event for the primary button */\n  eUp;\n  /**\n   * Run-once callback, called at the end of any click or drag, whether or not it was successful in any way.\n   *\n   * The setter of this callback will call the existing value before replacing it.\n   * Therefore, simply setting this value twice will execute the first callback.\n   */\n  get finally() {\n    return this.#finally;\n  }\n  set finally(value) {\n    try {\n      this.#finally?.();\n    } finally {\n      this.#finally = value;\n    }\n  }\n  #finally;\n  constructor(element) {\n    this.element = element;\n  }\n  /**\n   * Callback for `pointerdown` events.  To be used as the event handler (or called by it).\n   * @param e The `pointerdown` event\n   */\n  down(e2) {\n    this.reset();\n    this.eDown = e2;\n    this.pointerId = e2.pointerId;\n    this.element.setPointerCapture(e2.pointerId);\n  }\n  /**\n   * Callback for `pointermove` events.  To be used as the event handler (or called by it).\n   * @param e The `pointermove` event\n   */\n  move(e2) {\n    const { eDown } = this;\n    if (!eDown) return;\n    if (!e2.buttons) {\n      this.reset();\n      return;\n    }\n    if (!(e2.buttons & eDown.buttons)) {\n      this.#completeClick(e2);\n      this.reset();\n      return;\n    }\n    this.eMove = e2;\n    this.onDrag?.(e2);\n    if (this.dragStarted) return;\n    const longerThanBufferTime = e2.timeStamp - eDown.timeStamp > CanvasPointer.bufferTime;\n    if (longerThanBufferTime || !this.#hasSamePosition(e2, eDown)) {\n      this.#setDragStarted(e2);\n    }\n  }\n  /**\n   * Callback for `pointerup` events.  To be used as the event handler (or called by it).\n   * @param e The `pointerup` event\n   */\n  up(e2) {\n    if (e2.button !== this.eDown?.button) return false;\n    this.#completeClick(e2);\n    const { dragStarted } = this;\n    this.reset();\n    return !dragStarted;\n  }\n  #completeClick(e2) {\n    const { eDown } = this;\n    if (!eDown) return;\n    this.eUp = e2;\n    if (this.dragStarted) {\n      this.onDragEnd?.(e2);\n    } else if (!this.#hasSamePosition(e2, eDown)) {\n      this.#setDragStarted();\n      this.onDragEnd?.(e2);\n    } else if (this.onDoubleClick && this.#isDoubleClick()) {\n      this.onDoubleClick(e2);\n      this.eLastDown = void 0;\n    } else {\n      this.onClick?.(e2);\n      this.eLastDown = eDown;\n    }\n  }\n  /**\n   * Checks if two events occurred near each other - not further apart than the maximum click drift.\n   * @param a The first event to compare\n   * @param b The second event to compare\n   * @param tolerance2 The maximum distance (squared) before the positions are considered different\n   * @returns `true` if the two events were no more than {@link maxClickDrift} apart, otherwise `false`\n   */\n  #hasSamePosition(a, b, tolerance2 = CanvasPointer.#maxClickDrift2) {\n    const drift = dist2(a.clientX, a.clientY, b.clientX, b.clientY);\n    return drift <= tolerance2;\n  }\n  /**\n   * Checks whether the pointer is currently past the max click drift threshold.\n   * @returns `true` if the latest pointer event is past the the click drift threshold\n   */\n  #isDoubleClick() {\n    const { eDown, eLastDown } = this;\n    if (!eDown || !eLastDown) return false;\n    const tolerance2 = (3 * CanvasPointer.#maxClickDrift) ** 2;\n    const diff = eDown.timeStamp - eLastDown.timeStamp;\n    return diff > 0 && diff < CanvasPointer.doubleClickTime && this.#hasSamePosition(eDown, eLastDown, tolerance2);\n  }\n  #setDragStarted(eMove) {\n    this.dragStarted = true;\n    this.onDragStart?.(this, eMove);\n    delete this.onDragStart;\n  }\n  /**\n   * Resets the state of this {@link CanvasPointer} instance.\n   *\n   * The {@link finally} callback is first executed, then all callbacks and intra-click\n   * state is cleared.\n   */\n  reset() {\n    this.finally = void 0;\n    delete this.onClick;\n    delete this.onDoubleClick;\n    delete this.onDragStart;\n    delete this.onDrag;\n    delete this.onDragEnd;\n    this.isDown = false;\n    this.isDouble = false;\n    this.dragStarted = false;\n    this.resizeDirection = void 0;\n    if (this.clearEventsOnReset) {\n      this.eDown = void 0;\n      this.eMove = void 0;\n      this.eUp = void 0;\n    }\n    const { element, pointerId } = this;\n    this.pointerId = void 0;\n    if (typeof pointerId === \"number\" && element.hasPointerCapture(pointerId)) {\n      element.releasePointerCapture(pointerId);\n    }\n  }\n}\nclass DragAndScale {\n  /**\n   * The state of this DragAndScale instance.\n   *\n   * Implemented as a POCO that can be proxied without side-effects.\n   */\n  state;\n  lastState = {\n    offset: [0, 0],\n    scale: 0\n  };\n  /** Maximum scale (zoom in) */\n  max_scale;\n  /** Minimum scale (zoom out) */\n  min_scale;\n  enabled;\n  last_mouse;\n  element;\n  visible_area;\n  dragging;\n  viewport;\n  get offset() {\n    return this.state.offset;\n  }\n  set offset(value) {\n    this.state.offset[0] = value[0];\n    this.state.offset[1] = value[1];\n  }\n  get scale() {\n    return this.state.scale;\n  }\n  set scale(value) {\n    this.state.scale = value;\n  }\n  constructor(element) {\n    this.state = {\n      offset: [0, 0],\n      scale: 1\n    };\n    this.max_scale = 10;\n    this.min_scale = 0.1;\n    this.enabled = true;\n    this.last_mouse = [0, 0];\n    this.visible_area = new Rectangle();\n    this.element = element;\n  }\n  /**\n   * Returns `true` if the current state has changed from the previous state.\n   * @returns `true` if the current state has changed from the previous state, otherwise `false`.\n   */\n  #stateHasChanged() {\n    const current = this.state;\n    const previous = this.lastState;\n    return current.scale !== previous.scale || current.offset[0] !== previous.offset[0] || current.offset[1] !== previous.offset[1];\n  }\n  computeVisibleArea(viewport) {\n    const { scale, offset, visible_area } = this;\n    if (this.#stateHasChanged()) {\n      this.onChanged?.(scale, offset);\n      copyState(this.state, this.lastState);\n    }\n    if (!this.element) {\n      visible_area[0] = visible_area[1] = visible_area[2] = visible_area[3] = 0;\n      return;\n    }\n    let { width: width2, height } = this.element;\n    let startx = -offset[0];\n    let starty = -offset[1];\n    if (viewport) {\n      startx += viewport[0] / scale;\n      starty += viewport[1] / scale;\n      width2 = viewport[2];\n      height = viewport[3];\n    }\n    const endx = startx + width2 / scale;\n    const endy = starty + height / scale;\n    visible_area[0] = startx;\n    visible_area[1] = starty;\n    visible_area.resizeBottomRight(endx, endy);\n  }\n  toCanvasContext(ctx) {\n    ctx.scale(this.scale, this.scale);\n    ctx.translate(this.offset[0], this.offset[1]);\n  }\n  convertOffsetToCanvas(pos) {\n    return [\n      (pos[0] + this.offset[0]) * this.scale,\n      (pos[1] + this.offset[1]) * this.scale\n    ];\n  }\n  convertCanvasToOffset(pos, out) {\n    out = out || [0, 0];\n    out[0] = pos[0] / this.scale - this.offset[0];\n    out[1] = pos[1] / this.scale - this.offset[1];\n    return out;\n  }\n  /** @deprecated Has not been kept up to date */\n  mouseDrag(x2, y) {\n    this.offset[0] += x2 / this.scale;\n    this.offset[1] += y / this.scale;\n    this.onredraw?.(this);\n  }\n  changeScale(value, zooming_center, roundToScaleOne = true) {\n    if (value < this.min_scale) {\n      value = this.min_scale;\n    } else if (value > this.max_scale) {\n      value = this.max_scale;\n    }\n    if (value == this.scale) return;\n    const rect = this.element.getBoundingClientRect();\n    if (!rect) return;\n    zooming_center = zooming_center ?? [rect.width * 0.5, rect.height * 0.5];\n    const normalizedCenter = [\n      zooming_center[0] - rect.x,\n      zooming_center[1] - rect.y\n    ];\n    const center = this.convertCanvasToOffset(normalizedCenter);\n    this.scale = value;\n    if (roundToScaleOne && Math.abs(this.scale - 1) < 0.01) this.scale = 1;\n    const new_center = this.convertCanvasToOffset(normalizedCenter);\n    const delta_offset = [\n      new_center[0] - center[0],\n      new_center[1] - center[1]\n    ];\n    this.offset[0] += delta_offset[0];\n    this.offset[1] += delta_offset[1];\n    this.onredraw?.(this);\n  }\n  changeDeltaScale(value, zooming_center) {\n    this.changeScale(this.scale * value, zooming_center);\n  }\n  /**\n   * Fits the view to the specified bounds.\n   * @param bounds The bounds to fit the view to, defined by a rectangle.\n   */\n  fitToBounds(bounds, { zoom = 0.75 } = {}) {\n    const cw = this.element.width / window.devicePixelRatio;\n    const ch = this.element.height / window.devicePixelRatio;\n    let targetScale = this.scale;\n    if (zoom > 0) {\n      const targetScaleX = zoom * cw / Math.max(bounds[2], 300);\n      const targetScaleY = zoom * ch / Math.max(bounds[3], 300);\n      targetScale = Math.min(targetScaleX, targetScaleY, this.max_scale);\n    }\n    const scaledWidth = cw / targetScale;\n    const scaledHeight = ch / targetScale;\n    const targetX = -bounds[0] - bounds[2] * 0.5 + scaledWidth * 0.5;\n    const targetY = -bounds[1] - bounds[3] * 0.5 + scaledHeight * 0.5;\n    this.offset[0] = targetX;\n    this.offset[1] = targetY;\n    this.scale = targetScale;\n  }\n  /**\n   * Starts an animation to fit the view around the specified selection of nodes.\n   * @param bounds The bounds to animate the view to, defined by a rectangle.\n   */\n  animateToBounds(bounds, setDirty, {\n    duration = 350,\n    zoom = 0.75,\n    easing = EaseFunction.EASE_IN_OUT_QUAD\n  } = {}) {\n    if (!(duration > 0)) throw new RangeError(\"Duration must be greater than 0\");\n    const easeFunctions = {\n      linear: (t) => t,\n      easeInQuad: (t) => t * t,\n      easeOutQuad: (t) => t * (2 - t),\n      easeInOutQuad: (t) => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t\n    };\n    const easeFunction = easeFunctions[easing] ?? easeFunctions.linear;\n    const startTimestamp = performance.now();\n    const cw = this.element.width / window.devicePixelRatio;\n    const ch = this.element.height / window.devicePixelRatio;\n    const startX = this.offset[0];\n    const startY = this.offset[1];\n    const startX2 = startX - cw / this.scale;\n    const startY2 = startY - ch / this.scale;\n    const startScale = this.scale;\n    let targetScale = startScale;\n    if (zoom > 0) {\n      const targetScaleX = zoom * cw / Math.max(bounds[2], 300);\n      const targetScaleY = zoom * ch / Math.max(bounds[3], 300);\n      targetScale = Math.min(targetScaleX, targetScaleY, this.max_scale);\n    }\n    const scaledWidth = cw / targetScale;\n    const scaledHeight = ch / targetScale;\n    const targetX = -bounds[0] - bounds[2] * 0.5 + scaledWidth * 0.5;\n    const targetY = -bounds[1] - bounds[3] * 0.5 + scaledHeight * 0.5;\n    const targetX2 = targetX - scaledWidth;\n    const targetY2 = targetY - scaledHeight;\n    const animate = (timestamp) => {\n      const elapsed = timestamp - startTimestamp;\n      const progress = Math.min(elapsed / duration, 1);\n      const easedProgress = easeFunction(progress);\n      const currentX = startX + (targetX - startX) * easedProgress;\n      const currentY = startY + (targetY - startY) * easedProgress;\n      this.offset[0] = currentX;\n      this.offset[1] = currentY;\n      if (zoom > 0) {\n        const currentX2 = startX2 + (targetX2 - startX2) * easedProgress;\n        const currentY2 = startY2 + (targetY2 - startY2) * easedProgress;\n        const currentWidth = Math.abs(currentX2 - currentX);\n        const currentHeight = Math.abs(currentY2 - currentY);\n        this.scale = Math.min(cw / currentWidth, ch / currentHeight);\n      }\n      setDirty();\n      if (progress < 1) {\n        animationId = requestAnimationFrame(animate);\n      } else {\n        cancelAnimationFrame(animationId);\n      }\n    };\n    let animationId = requestAnimationFrame(animate);\n  }\n  reset() {\n    this.scale = 1;\n    this.offset[0] = 0;\n    this.offset[1] = 0;\n  }\n}\nfunction copyState(from, to) {\n  to.scale = from.scale;\n  to.offset[0] = from.offset[0];\n  to.offset[1] = from.offset[1];\n}\nfunction getBoundaryNodes(nodes) {\n  const valid = nodes?.find((x2) => x2);\n  if (!valid) return null;\n  let top = valid;\n  let right = valid;\n  let bottom = valid;\n  let left = valid;\n  for (const node2 of nodes) {\n    if (!node2) continue;\n    const [x2, y] = node2.pos;\n    const [width2, height] = node2.size;\n    if (y < top.pos[1]) top = node2;\n    if (x2 + width2 > right.pos[0] + right.size[0]) right = node2;\n    if (y + height > bottom.pos[1] + bottom.size[1]) bottom = node2;\n    if (x2 < left.pos[0]) left = node2;\n  }\n  return {\n    top,\n    right,\n    bottom,\n    left\n  };\n}\nfunction distributeNodes(nodes, horizontal) {\n  const nodeCount = nodes?.length;\n  if (!(nodeCount > 1)) return;\n  const index = horizontal ? 0 : 1;\n  let total = 0;\n  let highest = -Infinity;\n  for (const node2 of nodes) {\n    total += node2.size[index];\n    const high = node2.pos[index] + node2.size[index];\n    if (high > highest) highest = high;\n  }\n  const sorted = [...nodes].sort((a, b) => a.pos[index] - b.pos[index]);\n  const lowest = sorted[0].pos[index];\n  const gap = (highest - lowest - total) / (nodeCount - 1);\n  let startAt = lowest;\n  for (let i = 0; i < nodeCount; i++) {\n    const node2 = sorted[i];\n    node2.pos[index] = startAt + gap * i;\n    startAt += node2.size[index];\n  }\n}\nfunction alignNodes(nodes, direction, align_to) {\n  if (!nodes) return;\n  const boundary = align_to === void 0 ? getBoundaryNodes(nodes) : { top: align_to, right: align_to, bottom: align_to, left: align_to };\n  if (boundary === null) return;\n  for (const node2 of nodes) {\n    switch (direction) {\n      case \"right\":\n        node2.pos[0] = boundary.right.pos[0] + boundary.right.size[0] - node2.size[0];\n        break;\n      case \"left\":\n        node2.pos[0] = boundary.left.pos[0];\n        break;\n      case \"top\":\n        node2.pos[1] = boundary.top.pos[1];\n        break;\n      case \"bottom\":\n        node2.pos[1] = boundary.bottom.pos[1] + boundary.bottom.size[1] - node2.size[1];\n        break;\n    }\n  }\n}\nconst cursors = {\n  NE: \"nesw-resize\",\n  SE: \"nwse-resize\",\n  SW: \"nesw-resize\",\n  NW: \"nwse-resize\"\n};\nclass LGraphCanvas {\n  // Optimised buffers used during rendering\n  static #temp = new Float32Array(4);\n  static #temp_vec2 = new Float32Array(2);\n  static #tmp_area = new Float32Array(4);\n  static #margin_area = new Float32Array(4);\n  static #link_bounding = new Float32Array(4);\n  static #lTempA = new Float32Array(2);\n  static #lTempB = new Float32Array(2);\n  static #lTempC = new Float32Array(2);\n  static DEFAULT_BACKGROUND_IMAGE = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQBJREFUeNrs1rEKwjAUhlETUkj3vP9rdmr1Ysammk2w5wdxuLgcMHyptfawuZX4pJSWZTnfnu/lnIe/jNNxHHGNn//HNbbv+4dr6V+11uF527arU7+u63qfa/bnmh8sWLBgwYJlqRf8MEptXPBXJXa37BSl3ixYsGDBMliwFLyCV/DeLIMFCxYsWLBMwSt4Be/NggXLYMGCBUvBK3iNruC9WbBgwYJlsGApeAWv4L1ZBgsWLFiwYJmCV/AK3psFC5bBggULloJX8BpdwXuzYMGCBctgwVLwCl7Be7MMFixYsGDBsu8FH1FaSmExVfAxBa/gvVmwYMGCZbBg/W4vAQYA5tRF9QYlv/QAAAAASUVORK5CYII=\";\n  static DEFAULT_EVENT_LINK_COLOR = \"#A86\";\n  /** Link type to colour dictionary. */\n  static link_type_colors = {\n    \"-1\": LGraphCanvas.DEFAULT_EVENT_LINK_COLOR,\n    \"number\": \"#AAA\",\n    \"node\": \"#DCA\"\n  };\n  static gradients = {};\n  static search_limit = -1;\n  static node_colors = {\n    red: { color: \"#322\", bgcolor: \"#533\", groupcolor: \"#A88\" },\n    brown: { color: \"#332922\", bgcolor: \"#593930\", groupcolor: \"#b06634\" },\n    green: { color: \"#232\", bgcolor: \"#353\", groupcolor: \"#8A8\" },\n    blue: { color: \"#223\", bgcolor: \"#335\", groupcolor: \"#88A\" },\n    pale_blue: {\n      color: \"#2a363b\",\n      bgcolor: \"#3f5159\",\n      groupcolor: \"#3f789e\"\n    },\n    cyan: { color: \"#233\", bgcolor: \"#355\", groupcolor: \"#8AA\" },\n    purple: { color: \"#323\", bgcolor: \"#535\", groupcolor: \"#a1309b\" },\n    yellow: { color: \"#432\", bgcolor: \"#653\", groupcolor: \"#b58b2a\" },\n    black: { color: \"#222\", bgcolor: \"#000\", groupcolor: \"#444\" }\n  };\n  /**\n   * @internal Exclusively a workaround for design limitation in {@link LGraphNode.computeSize}.\n   */\n  static _measureText;\n  /**\n   * The state of this canvas, e.g. whether it is being dragged, or read-only.\n   *\n   * Implemented as a POCO that can be proxied without side-effects.\n   */\n  state = {\n    draggingItems: false,\n    draggingCanvas: false,\n    readOnly: false,\n    hoveringOver: CanvasItem.Nothing,\n    shouldSetCursor: true,\n    selectionChanged: false\n  };\n  #subgraph;\n  get subgraph() {\n    return this.#subgraph;\n  }\n  set subgraph(value) {\n    if (value !== this.#subgraph) {\n      this.#subgraph = value;\n      if (value) this.dispatch(\"litegraph:set-graph\", { oldGraph: this.#subgraph, newGraph: value });\n    }\n  }\n  dispatch(type, detail) {\n    const event = new CustomEvent(type, { detail, bubbles: true });\n    return this.canvas.dispatchEvent(event);\n  }\n  dispatchEvent(type, detail) {\n    this.canvas.dispatchEvent(new CustomEvent(type, { detail }));\n  }\n  #updateCursorStyle() {\n    if (!this.state.shouldSetCursor) return;\n    const crosshairItems = CanvasItem.Node | CanvasItem.RerouteSlot | CanvasItem.SubgraphIoNode | CanvasItem.SubgraphIoSlot;\n    let cursor = \"default\";\n    if (this.state.draggingCanvas) {\n      cursor = \"grabbing\";\n    } else if (this.state.readOnly) {\n      cursor = \"grab\";\n    } else if (this.pointer.resizeDirection) {\n      cursor = cursors[this.pointer.resizeDirection] ?? cursors.SE;\n    } else if (this.state.hoveringOver & crosshairItems) {\n      cursor = \"crosshair\";\n    } else if (this.state.hoveringOver & CanvasItem.Reroute) {\n      cursor = \"grab\";\n    }\n    this.canvas.style.cursor = cursor;\n  }\n  // Whether the canvas was previously being dragged prior to pressing space key.\n  // null if space key is not pressed.\n  _previously_dragging_canvas = null;\n  // #region Legacy accessors\n  /** @deprecated @inheritdoc {@link LGraphCanvasState.readOnly} */\n  get read_only() {\n    return this.state.readOnly;\n  }\n  set read_only(value) {\n    this.state.readOnly = value;\n    this.#updateCursorStyle();\n  }\n  get isDragging() {\n    return this.state.draggingItems;\n  }\n  set isDragging(value) {\n    this.state.draggingItems = value;\n  }\n  get hoveringOver() {\n    return this.state.hoveringOver;\n  }\n  set hoveringOver(value) {\n    this.state.hoveringOver = value;\n    this.#updateCursorStyle();\n  }\n  /** @deprecated Replace all references with {@link pointer}.{@link CanvasPointer.isDown isDown}. */\n  get pointer_is_down() {\n    return this.pointer.isDown;\n  }\n  /** @deprecated Replace all references with {@link pointer}.{@link CanvasPointer.isDouble isDouble}. */\n  get pointer_is_double() {\n    return this.pointer.isDouble;\n  }\n  /** @deprecated @inheritdoc {@link LGraphCanvasState.draggingCanvas} */\n  get dragging_canvas() {\n    return this.state.draggingCanvas;\n  }\n  set dragging_canvas(value) {\n    this.state.draggingCanvas = value;\n    this.#updateCursorStyle();\n  }\n  /**\n   * @deprecated Use {@link LGraphNode.titleFontStyle} instead.\n   */\n  get title_text_font() {\n    return `${LiteGraph.NODE_TEXT_SIZE}px ${LiteGraph.NODE_FONT}`;\n  }\n  // #endregion Legacy accessors\n  get inner_text_font() {\n    return `normal ${LiteGraph.NODE_SUBTEXT_SIZE}px ${LiteGraph.NODE_FONT}`;\n  }\n  #maximumFrameGap = 0;\n  /** Maximum frames per second to render. 0: unlimited. Default: 0 */\n  get maximumFps() {\n    return this.#maximumFrameGap > Number.EPSILON ? this.#maximumFrameGap / 1e3 : 0;\n  }\n  set maximumFps(value) {\n    this.#maximumFrameGap = value > Number.EPSILON ? 1e3 / value : 0;\n  }\n  /**\n   * @deprecated Use {@link LiteGraphGlobal.ROUND_RADIUS} instead.\n   */\n  get round_radius() {\n    return LiteGraph.ROUND_RADIUS;\n  }\n  /**\n   * @deprecated Use {@link LiteGraphGlobal.ROUND_RADIUS} instead.\n   */\n  set round_radius(value) {\n    LiteGraph.ROUND_RADIUS = value;\n  }\n  /**\n   * Render low quality when zoomed out.\n   */\n  get low_quality() {\n    return this.ds.scale < this.low_quality_zoom_threshold;\n  }\n  options;\n  background_image;\n  ds;\n  pointer;\n  zoom_modify_alpha;\n  zoom_speed;\n  node_title_color;\n  default_link_color;\n  default_connection_color;\n  default_connection_color_byType;\n  default_connection_color_byTypeOff;\n  /** Gets link colours. Extremely basic impl. until the legacy object dictionaries are removed. */\n  colourGetter = {\n    getConnectedColor: (type) => this.default_connection_color_byType[type] || this.default_connection_color.output_on,\n    getDisconnectedColor: (type) => this.default_connection_color_byTypeOff[type] || this.default_connection_color_byType[type] || this.default_connection_color.output_off\n  };\n  highquality_render;\n  use_gradients;\n  editor_alpha;\n  pause_rendering;\n  clear_background;\n  clear_background_color;\n  render_only_selected;\n  show_info;\n  allow_dragcanvas;\n  allow_dragnodes;\n  allow_interaction;\n  multi_select;\n  allow_searchbox;\n  allow_reconnect_links;\n  align_to_grid;\n  drag_mode;\n  dragging_rectangle;\n  filter;\n  set_canvas_dirty_on_mouse_event;\n  always_render_background;\n  render_shadows;\n  render_canvas_border;\n  render_connections_shadows;\n  render_connections_border;\n  render_curved_connections;\n  render_connection_arrows;\n  render_collapsed_slots;\n  render_execution_order;\n  render_link_tooltip;\n  /** Shape of the markers shown at the midpoint of links.  Default: Circle */\n  linkMarkerShape = LinkMarkerShape.Circle;\n  links_render_mode;\n  /** Zoom threshold for low quality rendering. Zoom below this threshold will render low quality. */\n  low_quality_zoom_threshold = 0.6;\n  /** mouse in canvas coordinates, where 0,0 is the top-left corner of the blue rectangle */\n  mouse;\n  /** mouse in graph coordinates, where 0,0 is the top-left corner of the blue rectangle */\n  graph_mouse;\n  /** @deprecated LEGACY: REMOVE THIS, USE {@link graph_mouse} INSTEAD */\n  canvas_mouse;\n  /** to personalize the search box */\n  onSearchBox;\n  onSearchBoxSelection;\n  onMouse;\n  /** to render background objects (behind nodes and connections) in the canvas affected by transform */\n  onDrawBackground;\n  /** to render foreground objects (above nodes and connections) in the canvas affected by transform */\n  onDrawForeground;\n  connections_width;\n  /** The current node being drawn by {@link drawNode}.  This should NOT be used to determine the currently selected node.  See {@link selectedItems} */\n  current_node;\n  /** used for widgets */\n  node_widget;\n  /** The link to draw a tooltip for. */\n  over_link_center;\n  last_mouse_position;\n  /** The visible area of this canvas.  Tightly coupled with {@link ds}. */\n  visible_area;\n  /** Contains all links and reroutes that were rendered.  Repopulated every render cycle. */\n  renderedPaths = /* @__PURE__ */ new Set();\n  /** @deprecated Replaced by {@link renderedPaths}, but length is set to 0 by some extensions. */\n  visible_links = [];\n  /** @deprecated This array is populated and cleared to support legacy extensions. The contents are ignored by Litegraph. */\n  connecting_links;\n  linkConnector = new LinkConnector((links) => this.connecting_links = links);\n  /** The viewport of this canvas.  Tightly coupled with {@link ds}. */\n  viewport;\n  autoresize;\n  static active_canvas;\n  frame = 0;\n  last_draw_time = 0;\n  render_time = 0;\n  fps = 0;\n  /** @deprecated See {@link LGraphCanvas.selectedItems} */\n  selected_nodes = {};\n  /** All selected nodes, groups, and reroutes */\n  selectedItems = /* @__PURE__ */ new Set();\n  /** The group currently being resized. */\n  resizingGroup = null;\n  /** @deprecated See {@link LGraphCanvas.selectedItems} */\n  selected_group = null;\n  /** The nodes that are currently visible on the canvas. */\n  visible_nodes = [];\n  /**\n   * The IDs of the nodes that are currently visible on the canvas. More\n   * performant than {@link visible_nodes} for visibility checks.\n   */\n  #visible_node_ids = /* @__PURE__ */ new Set();\n  node_over;\n  node_capturing_input;\n  highlighted_links = {};\n  #visibleReroutes = /* @__PURE__ */ new Set();\n  dirty_canvas = true;\n  dirty_bgcanvas = true;\n  /** A map of nodes that require selective-redraw */\n  dirty_nodes = /* @__PURE__ */ new Map();\n  dirty_area;\n  /** @deprecated Unused */\n  node_in_panel;\n  last_mouse = [0, 0];\n  last_mouseclick = 0;\n  graph;\n  get _graph() {\n    if (!this.graph) throw new NullGraphError();\n    return this.graph;\n  }\n  canvas;\n  bgcanvas;\n  ctx;\n  _events_binded;\n  bgctx;\n  is_rendering;\n  /** @deprecated Panels */\n  block_click;\n  /** @deprecated Panels */\n  last_click_position;\n  resizing_node;\n  /** @deprecated See {@link LGraphCanvas.resizingGroup} */\n  selected_group_resizing;\n  /** @deprecated See {@link pointer}.{@link CanvasPointer.dragStarted dragStarted} */\n  last_mouse_dragging;\n  onMouseDown;\n  _highlight_pos;\n  _highlight_input;\n  // TODO: Check if panels are used\n  /** @deprecated Panels */\n  node_panel;\n  /** @deprecated Panels */\n  options_panel;\n  _bg_img;\n  _pattern;\n  _pattern_img;\n  // TODO: This looks like another panel thing\n  prompt_box;\n  search_box;\n  /** @deprecated Panels */\n  SELECTED_NODE;\n  /** @deprecated Panels */\n  NODEPANEL_IS_OPEN;\n  /** Once per frame check of snap to grid value.  @todo Update on change. */\n  #snapToGrid;\n  /** Set on keydown, keyup. @todo */\n  #shiftDown = false;\n  /** If true, enable drag zoom. Ctrl+Shift+Drag Up/Down: zoom canvas. */\n  dragZoomEnabled = false;\n  /** The start position of the drag zoom. */\n  #dragZoomStart = null;\n  static active_node;\n  onClear;\n  /** called after moving a node @deprecated Does not handle multi-node move, and can return the wrong node. */\n  onNodeMoved;\n  /** @deprecated Called with the deprecated {@link selected_nodes} when the selection changes. Replacement not yet impl. */\n  onSelectionChange;\n  /** called when rendering a tooltip */\n  onDrawLinkTooltip;\n  /** to render foreground objects not affected by transform (for GUIs) */\n  onDrawOverlay;\n  onRenderBackground;\n  onNodeDblClicked;\n  onShowNodePanel;\n  onNodeSelected;\n  onNodeDeselected;\n  onRender;\n  /**\n   * Creates a new instance of LGraphCanvas.\n   * @param canvas The canvas HTML element (or its id) to use, or null / undefined to leave blank.\n   * @param graph The graph that owns this canvas.\n   * @param options\n   */\n  constructor(canvas2, graph, options) {\n    options ||= {};\n    this.options = options;\n    this.background_image = LGraphCanvas.DEFAULT_BACKGROUND_IMAGE;\n    this.ds = new DragAndScale(canvas2);\n    this.pointer = new CanvasPointer(canvas2);\n    this.linkConnector.events.addEventListener(\"link-created\", () => this.#dirty());\n    this.linkConnector.events.addEventListener(\"reset\", () => {\n      this.connecting_links = null;\n      this.dirty_bgcanvas = true;\n    });\n    this.linkConnector.events.addEventListener(\"dropped-on-canvas\", (customEvent) => {\n      if (!this.connecting_links) return;\n      const e2 = customEvent.detail;\n      this.emitEvent({\n        subType: \"empty-release\",\n        originalEvent: e2,\n        linkReleaseContext: { links: this.connecting_links }\n      });\n      const firstLink = this.linkConnector.renderLinks[0];\n      if (LiteGraph.release_link_on_empty_shows_menu) {\n        const linkReleaseContext = this.linkConnector.state.connectingTo === \"input\" ? {\n          node_from: firstLink.node,\n          slot_from: firstLink.fromSlot,\n          type_filter_in: firstLink.fromSlot.type\n        } : {\n          node_to: firstLink.node,\n          slot_to: firstLink.fromSlot,\n          type_filter_out: firstLink.fromSlot.type\n        };\n        const afterRerouteId = firstLink.fromReroute?.id;\n        if (\"shiftKey\" in e2 && e2.shiftKey) {\n          if (this.allow_searchbox) {\n            this.showSearchBox(e2, linkReleaseContext);\n          }\n        } else if (this.linkConnector.state.connectingTo === \"input\") {\n          this.showConnectionMenu({ nodeFrom: firstLink.node, slotFrom: firstLink.fromSlot, e: e2, afterRerouteId });\n        } else {\n          this.showConnectionMenu({ nodeTo: firstLink.node, slotTo: firstLink.fromSlot, e: e2, afterRerouteId });\n        }\n      }\n    });\n    this.zoom_modify_alpha = true;\n    this.zoom_speed = 1.1;\n    this.node_title_color = LiteGraph.NODE_TITLE_COLOR;\n    this.default_link_color = LiteGraph.LINK_COLOR;\n    this.default_connection_color = {\n      input_off: \"#778\",\n      input_on: \"#7F7\",\n      output_off: \"#778\",\n      output_on: \"#7F7\"\n    };\n    this.default_connection_color_byType = {\n      /* number: \"#7F7\",\n            string: \"#77F\",\n            boolean: \"#F77\", */\n    };\n    this.default_connection_color_byTypeOff = {\n      /* number: \"#474\",\n            string: \"#447\",\n            boolean: \"#744\", */\n    };\n    this.highquality_render = true;\n    this.use_gradients = false;\n    this.editor_alpha = 1;\n    this.pause_rendering = false;\n    this.clear_background = true;\n    this.clear_background_color = \"#222\";\n    this.render_only_selected = true;\n    this.show_info = true;\n    this.allow_dragcanvas = true;\n    this.allow_dragnodes = true;\n    this.allow_interaction = true;\n    this.multi_select = false;\n    this.allow_searchbox = true;\n    this.allow_reconnect_links = true;\n    this.align_to_grid = false;\n    this.drag_mode = false;\n    this.dragging_rectangle = null;\n    this.filter = null;\n    this.set_canvas_dirty_on_mouse_event = true;\n    this.always_render_background = false;\n    this.render_shadows = true;\n    this.render_canvas_border = true;\n    this.render_connections_shadows = false;\n    this.render_connections_border = true;\n    this.render_curved_connections = false;\n    this.render_connection_arrows = false;\n    this.render_collapsed_slots = true;\n    this.render_execution_order = false;\n    this.render_link_tooltip = true;\n    this.links_render_mode = LinkRenderType.SPLINE_LINK;\n    this.mouse = [0, 0];\n    this.graph_mouse = [0, 0];\n    this.canvas_mouse = this.graph_mouse;\n    this.connections_width = 3;\n    this.current_node = null;\n    this.node_widget = null;\n    this.last_mouse_position = [0, 0];\n    this.visible_area = this.ds.visible_area;\n    this.connecting_links = null;\n    this.viewport = options.viewport || null;\n    this.graph = graph;\n    graph?.attachCanvas(this);\n    this.canvas = void 0;\n    this.bgcanvas = void 0;\n    this.ctx = void 0;\n    this.setCanvas(canvas2, options.skip_events);\n    this.clear();\n    LGraphCanvas._measureText = (text, fontStyle = this.inner_text_font) => {\n      const { ctx } = this;\n      const { font } = ctx;\n      try {\n        ctx.font = fontStyle;\n        return ctx.measureText(text).width;\n      } finally {\n        ctx.font = font;\n      }\n    };\n    if (!options.skip_render) {\n      this.startRendering();\n    }\n    this.autoresize = options.autoresize;\n  }\n  static onGroupAdd(info, entry, mouse_event) {\n    const canvas2 = LGraphCanvas.active_canvas;\n    const group = new LiteGraph.LGraphGroup();\n    group.pos = canvas2.convertEventToCanvasOffset(mouse_event);\n    if (!canvas2.graph) throw new NullGraphError();\n    canvas2.graph.add(group);\n  }\n  /**\n   * @deprecated Functionality moved to {@link getBoundaryNodes}.  The new function returns null on failure, instead of an object with all null properties.\n   * Determines the furthest nodes in each direction\n   * @param nodes the nodes to from which boundary nodes will be extracted\n   * @returns\n   */\n  static getBoundaryNodes(nodes) {\n    const _nodes = Array.isArray(nodes) ? nodes : Object.values(nodes);\n    return getBoundaryNodes(_nodes) ?? {\n      top: null,\n      right: null,\n      bottom: null,\n      left: null\n    };\n  }\n  /**\n   * @deprecated Functionality moved to {@link alignNodes}.  The new function does not set dirty canvas.\n   * @param nodes a list of nodes\n   * @param direction Direction to align the nodes\n   * @param align_to Node to align to (if null, align to the furthest node in the given direction)\n   */\n  static alignNodes(nodes, direction, align_to) {\n    alignNodes(Object.values(nodes), direction, align_to);\n    LGraphCanvas.active_canvas.setDirty(true, true);\n  }\n  static onNodeAlign(value, options, event, prev_menu, node2) {\n    new LiteGraph.ContextMenu([\"Top\", \"Bottom\", \"Left\", \"Right\"], {\n      event,\n      callback: inner_clicked,\n      parentMenu: prev_menu\n    });\n    function inner_clicked(value2) {\n      alignNodes(\n        Object.values(LGraphCanvas.active_canvas.selected_nodes),\n        value2.toLowerCase(),\n        node2\n      );\n      LGraphCanvas.active_canvas.setDirty(true, true);\n    }\n  }\n  static onGroupAlign(value, options, event, prev_menu) {\n    new LiteGraph.ContextMenu([\"Top\", \"Bottom\", \"Left\", \"Right\"], {\n      event,\n      callback: inner_clicked,\n      parentMenu: prev_menu\n    });\n    function inner_clicked(value2) {\n      alignNodes(\n        Object.values(LGraphCanvas.active_canvas.selected_nodes),\n        value2.toLowerCase()\n      );\n      LGraphCanvas.active_canvas.setDirty(true, true);\n    }\n  }\n  static createDistributeMenu(value, options, event, prev_menu) {\n    new LiteGraph.ContextMenu([\"Vertically\", \"Horizontally\"], {\n      event,\n      callback: inner_clicked,\n      parentMenu: prev_menu\n    });\n    function inner_clicked(value2) {\n      const canvas2 = LGraphCanvas.active_canvas;\n      distributeNodes(Object.values(canvas2.selected_nodes), value2 === \"Horizontally\");\n      canvas2.setDirty(true, true);\n    }\n  }\n  static onMenuAdd(value, options, e2, prev_menu, callback) {\n    const canvas2 = LGraphCanvas.active_canvas;\n    const ref_window = canvas2.getCanvasWindow();\n    const { graph } = canvas2;\n    if (!graph) return;\n    inner_onMenuAdded(\"\", prev_menu);\n    return false;\n    function inner_onMenuAdded(base_category, prev_menu2) {\n      if (!graph) return;\n      const categories = LiteGraph.getNodeTypesCategories(canvas2.filter || graph.filter).filter((category) => category.startsWith(base_category));\n      const entries = [];\n      for (const category of categories) {\n        if (!category) continue;\n        const base_category_regex = new RegExp(`^(${base_category})`);\n        const category_name = category.replace(base_category_regex, \"\").split(\"/\", 1)[0];\n        const category_path = base_category === \"\" ? `${category_name}/` : `${base_category}${category_name}/`;\n        let name = category_name;\n        if (name.includes(\"::\")) name = name.split(\"::\", 2)[1];\n        const index = entries.findIndex((entry) => entry.value === category_path);\n        if (index === -1) {\n          entries.push({\n            value: category_path,\n            content: name,\n            has_submenu: true,\n            callback: function(value2, event, mouseEvent, contextMenu) {\n              inner_onMenuAdded(value2.value, contextMenu);\n            }\n          });\n        }\n      }\n      const nodes = LiteGraph.getNodeTypesInCategory(\n        base_category.slice(0, -1),\n        canvas2.filter || graph.filter\n      );\n      for (const node2 of nodes) {\n        if (node2.skip_list) continue;\n        const entry = {\n          value: node2.type,\n          content: node2.title,\n          has_submenu: false,\n          callback: function(value2, event, mouseEvent, contextMenu) {\n            if (!canvas2.graph) throw new NullGraphError();\n            const first_event = contextMenu.getFirstEvent();\n            canvas2.graph.beforeChange();\n            const node22 = LiteGraph.createNode(value2.value);\n            if (node22) {\n              if (!first_event) throw new TypeError(\"Context menu event was null. This should not occur in normal usage.\");\n              node22.pos = canvas2.convertEventToCanvasOffset(first_event);\n              canvas2.graph.add(node22);\n            } else {\n              console.warn(\"Failed to create node of type:\", value2.value);\n            }\n            callback?.(node22);\n            canvas2.graph.afterChange();\n          }\n        };\n        entries.push(entry);\n      }\n      new LiteGraph.ContextMenu(entries, { event: e2, parentMenu: prev_menu2 }, ref_window);\n    }\n  }\n  static onMenuCollapseAll() {\n  }\n  static onMenuNodeEdit() {\n  }\n  /** @param _options Parameter is never used */\n  static showMenuNodeOptionalOutputs(v2, _options, e2, prev_menu, node2) {\n    if (!node2) return;\n    const canvas2 = LGraphCanvas.active_canvas;\n    let entries = [];\n    if (LiteGraph.do_add_triggers_slots && node2.findOutputSlot(\"onExecuted\") == -1) {\n      entries.push({ content: \"On Executed\", value: [\"onExecuted\", LiteGraph.EVENT, { nameLocked: true }], className: \"event\" });\n    }\n    const retEntries = node2.onMenuNodeOutputs?.(entries);\n    if (retEntries) entries = retEntries;\n    if (!entries.length) return;\n    new LiteGraph.ContextMenu(\n      entries,\n      {\n        event: e2,\n        callback: inner_clicked,\n        parentMenu: prev_menu,\n        node: node2\n      }\n    );\n    function inner_clicked(v22, e22, prev) {\n      if (!node2) return;\n      if (v22.callback) v22.callback.call(this, node2, v22, e22, prev);\n      if (!v22.value) return;\n      const value = v22.value[1];\n      if (value && (typeof value === \"object\" || Array.isArray(value))) {\n        const entries2 = [];\n        for (const i in value) {\n          entries2.push({ content: i, value: value[i] });\n        }\n        new LiteGraph.ContextMenu(entries2, {\n          event: e22,\n          callback: inner_clicked,\n          parentMenu: prev_menu,\n          node: node2\n        });\n        return false;\n      }\n      const { graph } = node2;\n      if (!graph) throw new NullGraphError();\n      graph.beforeChange();\n      node2.addOutput(v22.value[0], v22.value[1], v22.value[2]);\n      node2.onNodeOutputAdd?.(v22.value);\n      canvas2.setDirty(true, true);\n      graph.afterChange();\n    }\n    return false;\n  }\n  /** @param value Parameter is never used */\n  static onShowMenuNodeProperties(value, options, e2, prev_menu, node2) {\n    if (!node2 || !node2.properties) return;\n    const canvas2 = LGraphCanvas.active_canvas;\n    const ref_window = canvas2.getCanvasWindow();\n    const entries = [];\n    for (const i in node2.properties) {\n      value = node2.properties[i] !== void 0 ? node2.properties[i] : \" \";\n      if (typeof value == \"object\")\n        value = JSON.stringify(value);\n      const info = node2.getPropertyInfo(i);\n      if (info.type == \"enum\" || info.type == \"combo\")\n        value = LGraphCanvas.getPropertyPrintableValue(value, info.values);\n      value = LGraphCanvas.decodeHTML(stringOrEmpty(value));\n      entries.push({\n        content: `<span class='property_name'>${info.label || i}</span><span class='property_value'>${value}</span>`,\n        value: i\n      });\n    }\n    if (!entries.length) {\n      return;\n    }\n    new LiteGraph.ContextMenu(\n      entries,\n      {\n        event: e2,\n        callback: inner_clicked,\n        parentMenu: prev_menu,\n        allow_html: true,\n        node: node2\n      },\n      // @ts-expect-error Unused\n      ref_window\n    );\n    function inner_clicked(v2) {\n      if (!node2) return;\n      const rect = this.getBoundingClientRect();\n      canvas2.showEditPropertyValue(node2, v2.value, {\n        position: [rect.left, rect.top]\n      });\n    }\n    return false;\n  }\n  /** @deprecated */\n  static decodeHTML(str) {\n    const e2 = document.createElement(\"div\");\n    e2.textContent = str;\n    return e2.innerHTML;\n  }\n  static onMenuResizeNode(value, options, e2, menu, node2) {\n    if (!node2) return;\n    const fApplyMultiNode = function(node22) {\n      node22.setSize(node22.computeSize());\n    };\n    const canvas2 = LGraphCanvas.active_canvas;\n    if (!canvas2.selected_nodes || Object.keys(canvas2.selected_nodes).length <= 1) {\n      fApplyMultiNode(node2);\n    } else {\n      for (const i in canvas2.selected_nodes) {\n        fApplyMultiNode(canvas2.selected_nodes[i]);\n      }\n    }\n    canvas2.setDirty(true, true);\n  }\n  // TODO refactor :: this is used fot title but not for properties!\n  static onShowPropertyEditor(item, options, e2, menu, node2) {\n    const property = item.property || \"title\";\n    const value = node2[property];\n    const title = document.createElement(\"span\");\n    title.className = \"name\";\n    title.textContent = property;\n    const input = document.createElement(\"input\");\n    Object.assign(input, { type: \"text\", className: \"value\", autofocus: true });\n    const button = document.createElement(\"button\");\n    button.textContent = \"OK\";\n    const dialog = Object.assign(document.createElement(\"div\"), {\n      is_modified: false,\n      className: \"graphdialog\",\n      close: () => dialog.remove()\n    });\n    dialog.append(title, input, button);\n    input.value = String(value);\n    input.addEventListener(\"blur\", function() {\n      this.focus();\n    });\n    input.addEventListener(\"keydown\", (e22) => {\n      dialog.is_modified = true;\n      if (e22.key == \"Escape\") {\n        dialog.close();\n      } else if (e22.key == \"Enter\") {\n        inner();\n      } else if (!e22.target || !(\"localName\" in e22.target) || e22.target.localName != \"textarea\") {\n        return;\n      }\n      e22.preventDefault();\n      e22.stopPropagation();\n    });\n    const canvas2 = LGraphCanvas.active_canvas;\n    const canvasEl = canvas2.canvas;\n    const rect = canvasEl.getBoundingClientRect();\n    const offsetx = rect ? -20 - rect.left : -20;\n    const offsety = rect ? -20 - rect.top : -20;\n    if (e2) {\n      dialog.style.left = `${e2.clientX + offsetx}px`;\n      dialog.style.top = `${e2.clientY + offsety}px`;\n    } else {\n      dialog.style.left = `${canvasEl.width * 0.5 + offsetx}px`;\n      dialog.style.top = `${canvasEl.height * 0.5 + offsety}px`;\n    }\n    button.addEventListener(\"click\", inner);\n    if (canvasEl.parentNode == null) throw new TypeError(\"canvasEl.parentNode was null\");\n    canvasEl.parentNode.append(dialog);\n    input.focus();\n    let dialogCloseTimer;\n    dialog.addEventListener(\"mouseleave\", function() {\n      if (LiteGraph.dialog_close_on_mouse_leave) {\n        if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave) {\n          dialogCloseTimer = setTimeout(\n            dialog.close,\n            LiteGraph.dialog_close_on_mouse_leave_delay\n          );\n        }\n      }\n    });\n    dialog.addEventListener(\"mouseenter\", function() {\n      if (LiteGraph.dialog_close_on_mouse_leave) {\n        if (dialogCloseTimer) clearTimeout(dialogCloseTimer);\n      }\n    });\n    function inner() {\n      if (input) setValue(input.value);\n    }\n    function setValue(value2) {\n      if (item.type == \"Number\") {\n        value2 = Number(value2);\n      } else if (item.type == \"Boolean\") {\n        value2 = Boolean(value2);\n      }\n      node2[property] = value2;\n      dialog.remove();\n      canvas2.setDirty(true, true);\n    }\n  }\n  static getPropertyPrintableValue(value, values) {\n    if (!values) return String(value);\n    if (Array.isArray(values)) {\n      return String(value);\n    }\n    if (typeof values === \"object\") {\n      let desc_value = \"\";\n      for (const k in values) {\n        if (values[k] != value) continue;\n        desc_value = k;\n        break;\n      }\n      return `${String(value)} (${desc_value})`;\n    }\n  }\n  static onMenuNodeCollapse(value, options, e2, menu, node2) {\n    if (!node2.graph) throw new NullGraphError();\n    node2.graph.beforeChange();\n    const fApplyMultiNode = function(node22) {\n      node22.collapse();\n    };\n    const graphcanvas = LGraphCanvas.active_canvas;\n    if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1) {\n      fApplyMultiNode(node2);\n    } else {\n      for (const i in graphcanvas.selected_nodes) {\n        fApplyMultiNode(graphcanvas.selected_nodes[i]);\n      }\n    }\n    node2.graph.afterChange();\n  }\n  static onMenuToggleAdvanced(value, options, e2, menu, node2) {\n    if (!node2.graph) throw new NullGraphError();\n    node2.graph.beforeChange();\n    const fApplyMultiNode = function(node22) {\n      node22.toggleAdvanced();\n    };\n    const graphcanvas = LGraphCanvas.active_canvas;\n    if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1) {\n      fApplyMultiNode(node2);\n    } else {\n      for (const i in graphcanvas.selected_nodes) {\n        fApplyMultiNode(graphcanvas.selected_nodes[i]);\n      }\n    }\n    node2.graph.afterChange();\n  }\n  static onMenuNodeMode(value, options, e2, menu, node2) {\n    new LiteGraph.ContextMenu(\n      LiteGraph.NODE_MODES,\n      { event: e2, callback: inner_clicked, parentMenu: menu, node: node2 }\n    );\n    function inner_clicked(v2) {\n      if (!node2) return;\n      const kV = Object.values(LiteGraph.NODE_MODES).indexOf(v2);\n      const fApplyMultiNode = function(node22) {\n        if (kV !== -1 && LiteGraph.NODE_MODES[kV]) {\n          node22.changeMode(kV);\n        } else {\n          console.warn(`unexpected mode: ${v2}`);\n          node22.changeMode(LGraphEventMode.ALWAYS);\n        }\n      };\n      const graphcanvas = LGraphCanvas.active_canvas;\n      if (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1) {\n        fApplyMultiNode(node2);\n      } else {\n        for (const i in graphcanvas.selected_nodes) {\n          fApplyMultiNode(graphcanvas.selected_nodes[i]);\n        }\n      }\n    }\n    return false;\n  }\n  /** @param value Parameter is never used */\n  static onMenuNodeColors(value, options, e2, menu, node2) {\n    if (!node2) throw \"no node for color\";\n    const values = [];\n    values.push({\n      value: null,\n      content: \"<span style='display: block; padding-left: 4px;'>No color</span>\"\n    });\n    for (const i in LGraphCanvas.node_colors) {\n      const color = LGraphCanvas.node_colors[i];\n      value = {\n        value: i,\n        content: `<span style='display: block; color: #999; padding-left: 4px; border-left: 8px solid ${color.color}; background-color:${color.bgcolor}'>${i}</span>`\n      };\n      values.push(value);\n    }\n    new LiteGraph.ContextMenu(values, {\n      event: e2,\n      callback: inner_clicked,\n      parentMenu: menu,\n      node: node2\n    });\n    function inner_clicked(v2) {\n      if (!node2) return;\n      const fApplyColor = function(item) {\n        const colorOption = v2.value ? LGraphCanvas.node_colors[v2.value] : null;\n        item.setColorOption(colorOption);\n      };\n      const canvas2 = LGraphCanvas.active_canvas;\n      if (!canvas2.selected_nodes || Object.keys(canvas2.selected_nodes).length <= 1) {\n        fApplyColor(node2);\n      } else {\n        for (const i in canvas2.selected_nodes) {\n          fApplyColor(canvas2.selected_nodes[i]);\n        }\n      }\n      canvas2.setDirty(true, true);\n    }\n    return false;\n  }\n  static onMenuNodeShapes(value, options, e2, menu, node2) {\n    if (!node2) throw \"no node passed\";\n    new LiteGraph.ContextMenu(LiteGraph.VALID_SHAPES, {\n      event: e2,\n      callback: inner_clicked,\n      parentMenu: menu,\n      node: node2\n    });\n    function inner_clicked(v2) {\n      if (!node2) return;\n      if (!node2.graph) throw new NullGraphError();\n      node2.graph.beforeChange();\n      const fApplyMultiNode = function(node22) {\n        node22.shape = v2;\n      };\n      const canvas2 = LGraphCanvas.active_canvas;\n      if (!canvas2.selected_nodes || Object.keys(canvas2.selected_nodes).length <= 1) {\n        fApplyMultiNode(node2);\n      } else {\n        for (const i in canvas2.selected_nodes) {\n          fApplyMultiNode(canvas2.selected_nodes[i]);\n        }\n      }\n      node2.graph.afterChange();\n      canvas2.setDirty(true);\n    }\n    return false;\n  }\n  static onMenuNodeRemove() {\n    LGraphCanvas.active_canvas.deleteSelected();\n  }\n  static onMenuNodeClone(value, options, e2, menu, node2) {\n    const { graph } = node2;\n    if (!graph) throw new NullGraphError();\n    graph.beforeChange();\n    const newSelected = /* @__PURE__ */ new Set();\n    const fApplyMultiNode = function(node22, newNodes) {\n      if (node22.clonable === false) return;\n      const newnode = node22.clone();\n      if (!newnode) return;\n      newnode.pos = [node22.pos[0] + 5, node22.pos[1] + 5];\n      if (!node22.graph) throw new NullGraphError();\n      node22.graph.add(newnode);\n      newNodes.add(newnode);\n    };\n    const canvas2 = LGraphCanvas.active_canvas;\n    if (!canvas2.selected_nodes || Object.keys(canvas2.selected_nodes).length <= 1) {\n      fApplyMultiNode(node2, newSelected);\n    } else {\n      for (const i in canvas2.selected_nodes) {\n        fApplyMultiNode(canvas2.selected_nodes[i], newSelected);\n      }\n    }\n    if (newSelected.size) {\n      canvas2.selectNodes([...newSelected]);\n    }\n    graph.afterChange();\n    canvas2.setDirty(true, true);\n  }\n  /**\n   * clears all the data inside\n   *\n   */\n  clear() {\n    this.frame = 0;\n    this.last_draw_time = 0;\n    this.render_time = 0;\n    this.fps = 0;\n    this.dragging_rectangle = null;\n    this.selected_nodes = {};\n    this.selected_group = null;\n    this.selectedItems.clear();\n    this.state.selectionChanged = true;\n    this.onSelectionChange?.(this.selected_nodes);\n    this.visible_nodes = [];\n    this.node_over = void 0;\n    this.node_capturing_input = null;\n    this.connecting_links = null;\n    this.highlighted_links = {};\n    this.dragging_canvas = false;\n    this.#dirty();\n    this.dirty_area = null;\n    this.node_in_panel = null;\n    this.node_widget = null;\n    this.last_mouse = [0, 0];\n    this.last_mouseclick = 0;\n    this.pointer.reset();\n    this.visible_area.set([0, 0, 0, 0]);\n    this.onClear?.();\n  }\n  /**\n   * Assigns a new graph to this canvas.\n   */\n  setGraph(newGraph) {\n    const { graph } = this;\n    if (newGraph === graph) return;\n    this.clear();\n    newGraph.attachCanvas(this);\n    this.dispatch(\"litegraph:set-graph\", { newGraph, oldGraph: graph });\n    this.#dirty();\n  }\n  openSubgraph(subgraph) {\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    const options = { bubbles: true, detail: { subgraph, closingGraph: graph }, cancelable: true };\n    const mayContinue = this.canvas.dispatchEvent(new CustomEvent(\"subgraph-opening\", options));\n    if (!mayContinue) return;\n    this.clear();\n    this.subgraph = subgraph;\n    this.setGraph(subgraph);\n    this.canvas.dispatchEvent(new CustomEvent(\"subgraph-opened\", options));\n  }\n  /**\n   * @returns the visually active graph (in case there are more in the stack)\n   */\n  getCurrentGraph() {\n    return this.graph;\n  }\n  /**\n   * Finds the canvas if required, throwing on failure.\n   * @param canvas Canvas element, or its element ID\n   * @returns The canvas element\n   * @throws If {@link canvas} is an element ID that does not belong to a valid HTML canvas element\n   */\n  #validateCanvas(canvas2) {\n    if (typeof canvas2 === \"string\") {\n      const el = document.getElementById(canvas2);\n      if (!(el instanceof HTMLCanvasElement)) throw \"Error validating LiteGraph canvas: Canvas element not found\";\n      return el;\n    }\n    return canvas2;\n  }\n  /**\n   * Sets the current HTML canvas element.\n   * Calls bindEvents to add input event listeners, and (re)creates the background canvas.\n   * @param canvas The canvas element to assign, or its HTML element ID.  If null or undefined, the current reference is cleared.\n   * @param skip_events If true, events on the previous canvas will not be removed.  Has no effect on the first invocation.\n   */\n  setCanvas(canvas2, skip_events) {\n    const element = this.#validateCanvas(canvas2);\n    if (element === this.canvas) return;\n    if (!element && this.canvas && !skip_events) this.unbindEvents();\n    this.canvas = element;\n    this.ds.element = element;\n    this.pointer.element = element;\n    if (!element) return;\n    element.className += \" lgraphcanvas\";\n    element.data = this;\n    this.bgcanvas = document.createElement(\"canvas\");\n    this.bgcanvas.width = this.canvas.width;\n    this.bgcanvas.height = this.canvas.height;\n    const ctx = element.getContext?.(\"2d\");\n    if (ctx == null) {\n      if (element.localName != \"canvas\") {\n        throw `Element supplied for LGraphCanvas must be a <canvas> element, you passed a ${element.localName}`;\n      }\n      throw \"This browser doesn't support Canvas\";\n    }\n    this.ctx = ctx;\n    if (!skip_events) this.bindEvents();\n  }\n  /** Captures an event and prevents default - returns false. */\n  _doNothing(e2) {\n    e2.preventDefault();\n    return false;\n  }\n  /** Captures an event and prevents default - returns true. */\n  _doReturnTrue(e2) {\n    e2.preventDefault();\n    return true;\n  }\n  /**\n   * binds mouse, keyboard, touch and drag events to the canvas\n   */\n  bindEvents() {\n    if (this._events_binded) {\n      console.warn(\"LGraphCanvas: events already bound\");\n      return;\n    }\n    const { canvas: canvas2 } = this;\n    const { document: document2 } = this.getCanvasWindow();\n    this._mousedown_callback = this.processMouseDown.bind(this);\n    this._mousewheel_callback = this.processMouseWheel.bind(this);\n    this._mousemove_callback = this.processMouseMove.bind(this);\n    this._mouseup_callback = this.processMouseUp.bind(this);\n    this._mouseout_callback = this.processMouseOut.bind(this);\n    this._mousecancel_callback = this.processMouseCancel.bind(this);\n    canvas2.addEventListener(\"pointerdown\", this._mousedown_callback, true);\n    canvas2.addEventListener(\"wheel\", this._mousewheel_callback, false);\n    canvas2.addEventListener(\"pointerup\", this._mouseup_callback, true);\n    canvas2.addEventListener(\"pointermove\", this._mousemove_callback);\n    canvas2.addEventListener(\"pointerout\", this._mouseout_callback);\n    canvas2.addEventListener(\"pointercancel\", this._mousecancel_callback, true);\n    canvas2.addEventListener(\"contextmenu\", this._doNothing);\n    this._key_callback = this.processKey.bind(this);\n    canvas2.addEventListener(\"keydown\", this._key_callback, true);\n    document2.addEventListener(\"keyup\", this._key_callback, true);\n    canvas2.addEventListener(\"dragover\", this._doNothing, false);\n    canvas2.addEventListener(\"dragend\", this._doNothing, false);\n    canvas2.addEventListener(\"dragenter\", this._doReturnTrue, false);\n    this._events_binded = true;\n  }\n  /**\n   * unbinds mouse events from the canvas\n   */\n  unbindEvents() {\n    if (!this._events_binded) {\n      console.warn(\"LGraphCanvas: no events bound\");\n      return;\n    }\n    const { document: document2 } = this.getCanvasWindow();\n    const { canvas: canvas2 } = this;\n    canvas2.removeEventListener(\"pointercancel\", this._mousecancel_callback);\n    canvas2.removeEventListener(\"pointerout\", this._mouseout_callback);\n    canvas2.removeEventListener(\"pointermove\", this._mousemove_callback);\n    canvas2.removeEventListener(\"pointerup\", this._mouseup_callback);\n    canvas2.removeEventListener(\"pointerdown\", this._mousedown_callback);\n    canvas2.removeEventListener(\"wheel\", this._mousewheel_callback);\n    canvas2.removeEventListener(\"keydown\", this._key_callback);\n    document2.removeEventListener(\"keyup\", this._key_callback);\n    canvas2.removeEventListener(\"contextmenu\", this._doNothing);\n    canvas2.removeEventListener(\"dragenter\", this._doReturnTrue);\n    this._mousedown_callback = void 0;\n    this._mousewheel_callback = void 0;\n    this._key_callback = void 0;\n    this._events_binded = false;\n  }\n  /**\n   * Ensures the canvas will be redrawn on the next frame by setting the dirty flag(s).\n   * Without parameters, this function does nothing.\n   * @todo Impl. `setDirty()` or similar as shorthand to redraw everything.\n   * @param fgcanvas If true, marks the foreground canvas as dirty (nodes and anything drawn on top of them).  Default: false\n   * @param bgcanvas If true, mark the background canvas as dirty (background, groups, links).  Default: false\n   */\n  setDirty(fgcanvas, bgcanvas) {\n    if (fgcanvas) this.dirty_canvas = true;\n    if (bgcanvas) this.dirty_bgcanvas = true;\n  }\n  /** Marks the entire canvas as dirty. */\n  #dirty() {\n    this.dirty_canvas = true;\n    this.dirty_bgcanvas = true;\n  }\n  #linkConnectorDrop() {\n    const { graph, linkConnector, pointer } = this;\n    if (!graph) throw new NullGraphError();\n    pointer.onDragEnd = (upEvent) => linkConnector.dropLinks(graph, upEvent);\n    pointer.finally = () => this.linkConnector.reset(true);\n  }\n  /**\n   * Used to attach the canvas in a popup\n   * @returns returns the window where the canvas is attached (the DOM root node)\n   */\n  getCanvasWindow() {\n    if (!this.canvas) return window;\n    const doc = this.canvas.ownerDocument;\n    return doc.defaultView || doc.parentWindow;\n  }\n  /**\n   * starts rendering the content of the canvas when needed\n   *\n   */\n  startRendering() {\n    if (this.is_rendering) return;\n    this.is_rendering = true;\n    renderFrame.call(this);\n    function renderFrame() {\n      if (!this.pause_rendering) {\n        this.draw();\n      }\n      const window2 = this.getCanvasWindow();\n      if (this.is_rendering) {\n        if (this.#maximumFrameGap > 0) {\n          const gap = this.#maximumFrameGap - (LiteGraph.getTime() - this.last_draw_time);\n          setTimeout(renderFrame.bind(this), Math.max(1, gap));\n        } else {\n          window2.requestAnimationFrame(renderFrame.bind(this));\n        }\n      }\n    }\n  }\n  /**\n   * stops rendering the content of the canvas (to save resources)\n   *\n   */\n  stopRendering() {\n    this.is_rendering = false;\n  }\n  /* LiteGraphCanvas input */\n  // used to block future mouse events (because of im gui)\n  blockClick() {\n    this.block_click = true;\n    this.last_mouseclick = 0;\n  }\n  /**\n   * Gets the widget at the current cursor position.\n   * @param node Optional node to check for widgets under cursor\n   * @returns The widget located at the current cursor position, if any is found.\n   * @deprecated Use {@link LGraphNode.getWidgetOnPos} instead.\n   * ```ts\n   * const [x, y] = canvas.graph_mouse\n   * const widget = canvas.node_over?.getWidgetOnPos(x, y, true)\n   * ```\n   */\n  getWidgetAtCursor(node2) {\n    node2 ??= this.node_over;\n    return node2?.getWidgetOnPos(this.graph_mouse[0], this.graph_mouse[1], true);\n  }\n  /**\n   * Clears highlight and mouse-over information from nodes that should not have it.\n   *\n   * Intended to be called when the pointer moves away from a node.\n   * @param node The node that the mouse is now over\n   * @param e MouseEvent that is triggering this\n   */\n  updateMouseOverNodes(node2, e2) {\n    if (!this.graph) throw new NullGraphError();\n    const { pointer } = this;\n    const nodes = this.graph._nodes;\n    for (const otherNode of nodes) {\n      if (otherNode.mouseOver && node2 != otherNode) {\n        if (!pointer.eDown) pointer.resizeDirection = void 0;\n        otherNode.mouseOver = void 0;\n        this._highlight_input = void 0;\n        this._highlight_pos = void 0;\n        this.linkConnector.overWidget = void 0;\n        otherNode.lostFocusAt = LiteGraph.getTime();\n        this.node_over?.onMouseLeave?.(e2);\n        this.node_over = void 0;\n        this.dirty_canvas = true;\n      }\n    }\n  }\n  processMouseDown(e2) {\n    if (this.dragZoomEnabled && e2.ctrlKey && e2.shiftKey && !e2.altKey && e2.buttons) {\n      this.#dragZoomStart = { pos: [e2.x, e2.y], scale: this.ds.scale };\n      return;\n    }\n    const { graph, pointer } = this;\n    this.adjustMouseEvent(e2);\n    if (e2.isPrimary) pointer.down(e2);\n    if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n    if (!graph) return;\n    const ref_window = this.getCanvasWindow();\n    LGraphCanvas.active_canvas = this;\n    const x2 = e2.clientX;\n    const y = e2.clientY;\n    this.ds.viewport = this.viewport;\n    const is_inside = !this.viewport || isInRect(x2, y, this.viewport);\n    if (!is_inside) return;\n    const node2 = graph.getNodeOnPos(e2.canvasX, e2.canvasY, this.visible_nodes) ?? void 0;\n    this.mouse[0] = x2;\n    this.mouse[1] = y;\n    this.graph_mouse[0] = e2.canvasX;\n    this.graph_mouse[1] = e2.canvasY;\n    this.last_click_position = [this.mouse[0], this.mouse[1]];\n    pointer.isDouble = pointer.isDown && e2.isPrimary;\n    pointer.isDown = true;\n    this.canvas.focus();\n    LiteGraph.closeAllContextMenus(ref_window);\n    if (this.onMouse?.(e2) == true) return;\n    if (e2.button === 0 && !pointer.isDouble) {\n      this.#processPrimaryButton(e2, node2);\n    } else if (e2.button === 1) {\n      this.#processMiddleButton(e2, node2);\n    } else if ((e2.button === 2 || pointer.isDouble) && this.allow_interaction && !this.read_only) {\n      const { linkConnector, subgraph } = this;\n      if (subgraph?.inputNode.containsPoint(this.graph_mouse)) {\n        this.processSelect(subgraph.inputNode, e2, true);\n        subgraph.inputNode.onPointerDown(e2, pointer, linkConnector);\n      } else if (subgraph?.outputNode.containsPoint(this.graph_mouse)) {\n        this.processSelect(subgraph.outputNode, e2, true);\n        subgraph.outputNode.onPointerDown(e2, pointer, linkConnector);\n      } else {\n        if (node2) {\n          this.processSelect(node2, e2, true);\n        } else if (this.links_render_mode !== LinkRenderType.HIDDEN_LINK) {\n          const reroute = graph.getRerouteOnPos(e2.canvasX, e2.canvasY, this.#visibleReroutes);\n          if (reroute) {\n            if (e2.altKey) {\n              pointer.onClick = (upEvent) => {\n                if (upEvent.altKey) {\n                  if (reroute.selected) {\n                    this.deselect(reroute);\n                    this.onSelectionChange?.(this.selected_nodes);\n                  }\n                  reroute.remove();\n                }\n              };\n            } else {\n              this.processSelect(reroute, e2, true);\n            }\n          }\n        }\n        pointer.onClick ??= () => this.processContextMenu(node2, e2);\n      }\n    }\n    this.last_mouse = [x2, y];\n    this.last_mouseclick = LiteGraph.getTime();\n    this.last_mouse_dragging = true;\n    graph.change();\n    if (!ref_window.document.activeElement || ref_window.document.activeElement.nodeName.toLowerCase() != \"input\" && ref_window.document.activeElement.nodeName.toLowerCase() != \"textarea\") {\n      e2.preventDefault();\n    }\n    e2.stopPropagation();\n    this.onMouseDown?.(e2);\n  }\n  /**\n   * Returns the first matching positionable item at the given co-ordinates.\n   *\n   * Order of preference:\n   * - Subgraph IO Nodes\n   * - Reroutes\n   * - Group titlebars\n   * @param x The x coordinate in canvas space\n   * @param y The y coordinate in canvas space\n   * @returns The positionable item or undefined\n   */\n  #getPositionableOnPos(x2, y) {\n    const ioNode = this.subgraph?.getIoNodeOnPos(x2, y);\n    if (ioNode) return ioNode;\n    for (const reroute of this.#visibleReroutes) {\n      if (reroute.containsPoint([x2, y])) return reroute;\n    }\n    return this.graph?.getGroupTitlebarOnPos(x2, y);\n  }\n  #processPrimaryButton(e2, node2) {\n    const { pointer, graph, linkConnector, subgraph } = this;\n    if (!graph) throw new NullGraphError();\n    const x2 = e2.canvasX;\n    const y = e2.canvasY;\n    const ctrlOrMeta = e2.ctrlKey || e2.metaKey;\n    if (ctrlOrMeta && !e2.altKey && LiteGraph.canvasNavigationMode === \"legacy\") {\n      this.#setupNodeSelectionDrag(e2, pointer, node2);\n      return;\n    }\n    if (this.read_only) {\n      pointer.finally = () => this.dragging_canvas = false;\n      this.dragging_canvas = true;\n      return;\n    }\n    if (LiteGraph.alt_drag_do_clone_nodes && e2.altKey && !e2.ctrlKey && node2 && this.allow_interaction) {\n      let newType = node2.type;\n      if (node2 instanceof SubgraphNode) {\n        const cloned = node2.subgraph.clone().asSerialisable();\n        const subgraph2 = graph.createSubgraph(cloned);\n        subgraph2.configure(cloned);\n        newType = subgraph2.id;\n      }\n      const node_data = node2.clone()?.serialize();\n      if (node_data?.type != null) {\n        const cloned = LiteGraph.createNode(newType);\n        if (cloned) {\n          cloned.configure(node_data);\n          cloned.pos[0] += 5;\n          cloned.pos[1] += 5;\n          if (this.allow_dragnodes) {\n            pointer.onDragStart = (pointer2) => {\n              graph.add(cloned, false);\n              this.#startDraggingItems(cloned, pointer2);\n            };\n            pointer.onDragEnd = (e22) => this.#processDraggedItems(e22);\n          } else {\n            graph.beforeChange();\n            graph.add(cloned, false);\n            graph.afterChange();\n          }\n          return;\n        }\n      }\n    }\n    if (node2 && (this.allow_interaction || node2.flags.allow_interaction)) {\n      this.#processNodeClick(e2, ctrlOrMeta, node2);\n    } else {\n      if (subgraph) {\n        let processSubgraphIONode = function(canvas2, ioNode) {\n          if (!ioNode.containsPoint([x2, y])) return false;\n          ioNode.onPointerDown(e2, pointer, linkConnector);\n          pointer.onClick ??= () => canvas2.processSelect(ioNode, e2);\n          pointer.onDragStart ??= () => canvas2.#startDraggingItems(ioNode, pointer, true);\n          pointer.onDragEnd ??= (eUp) => canvas2.#processDraggedItems(eUp);\n          return true;\n        };\n        const { inputNode, outputNode } = subgraph;\n        if (processSubgraphIONode(this, inputNode)) return;\n        if (processSubgraphIONode(this, outputNode)) return;\n      }\n      if (this.links_render_mode !== LinkRenderType.HIDDEN_LINK) {\n        for (const reroute of this.#visibleReroutes) {\n          const overReroute = reroute.containsPoint([x2, y]);\n          if (!reroute.isSlotHovered && !overReroute) continue;\n          if (overReroute) {\n            pointer.onClick = () => this.processSelect(reroute, e2);\n            if (!e2.shiftKey) {\n              pointer.onDragStart = (pointer2) => this.#startDraggingItems(reroute, pointer2, true);\n              pointer.onDragEnd = (e22) => this.#processDraggedItems(e22);\n            }\n          }\n          if (reroute.isOutputHovered || overReroute && e2.shiftKey) {\n            linkConnector.dragFromReroute(graph, reroute);\n            this.#linkConnectorDrop();\n          }\n          if (reroute.isInputHovered) {\n            linkConnector.dragFromRerouteToOutput(graph, reroute);\n            this.#linkConnectorDrop();\n          }\n          reroute.hideSlots();\n          this.dirty_bgcanvas = true;\n          return;\n        }\n      }\n      const { lineWidth } = this.ctx;\n      this.ctx.lineWidth = this.connections_width + 7;\n      const dpi = window?.devicePixelRatio || 1;\n      for (const linkSegment of this.renderedPaths) {\n        const centre = linkSegment._pos;\n        if (!centre) continue;\n        if ((e2.shiftKey || e2.altKey) && linkSegment.path && this.ctx.isPointInStroke(linkSegment.path, x2 * dpi, y * dpi)) {\n          this.ctx.lineWidth = lineWidth;\n          if (e2.shiftKey && !e2.altKey) {\n            linkConnector.dragFromLinkSegment(graph, linkSegment);\n            this.#linkConnectorDrop();\n            return;\n          } else if (e2.altKey && !e2.shiftKey) {\n            const newReroute = graph.createReroute([x2, y], linkSegment);\n            pointer.onDragStart = (pointer2) => this.#startDraggingItems(newReroute, pointer2);\n            pointer.onDragEnd = (e22) => this.#processDraggedItems(e22);\n            return;\n          }\n        } else if (isInRectangle(x2, y, centre[0] - 4, centre[1] - 4, 8, 8)) {\n          this.ctx.lineWidth = lineWidth;\n          pointer.onClick = () => this.showLinkMenu(linkSegment, e2);\n          pointer.onDragStart = () => this.dragging_canvas = true;\n          pointer.finally = () => this.dragging_canvas = false;\n          this.over_link_center = void 0;\n          return;\n        }\n      }\n      this.ctx.lineWidth = lineWidth;\n      const group = graph.getGroupOnPos(x2, y);\n      this.selected_group = group ?? null;\n      if (group) {\n        if (group.isInResize(x2, y)) {\n          const b = group.boundingRect;\n          const offsetX = x2 - (b[0] + b[2]);\n          const offsetY = y - (b[1] + b[3]);\n          pointer.onDragStart = () => this.resizingGroup = group;\n          pointer.onDrag = (eMove) => {\n            if (this.read_only) return;\n            const pos = [\n              eMove.canvasX - group.pos[0] - offsetX,\n              eMove.canvasY - group.pos[1] - offsetY\n            ];\n            if (this.#snapToGrid) snapPoint(pos, this.#snapToGrid);\n            const resized = group.resize(pos[0], pos[1]);\n            if (resized) this.dirty_bgcanvas = true;\n          };\n          pointer.finally = () => this.resizingGroup = null;\n        } else {\n          const f = group.font_size || LiteGraph.DEFAULT_GROUP_FONT_SIZE;\n          const headerHeight = f * 1.4;\n          if (isInRectangle(\n            x2,\n            y,\n            group.pos[0],\n            group.pos[1],\n            group.size[0],\n            headerHeight\n          )) {\n            pointer.onClick = () => this.processSelect(group, e2);\n            pointer.onDragStart = (pointer2) => {\n              group.recomputeInsideNodes();\n              this.#startDraggingItems(group, pointer2, true);\n            };\n            pointer.onDragEnd = (e22) => this.#processDraggedItems(e22);\n          }\n        }\n        pointer.onDoubleClick = () => {\n          this.emitEvent({\n            subType: \"group-double-click\",\n            originalEvent: e2,\n            group\n          });\n        };\n      } else {\n        pointer.onDoubleClick = () => {\n          if (this.allow_searchbox) {\n            this.showSearchBox(e2);\n            e2.preventDefault();\n          }\n          this.emitEvent({\n            subType: \"empty-double-click\",\n            originalEvent: e2\n          });\n        };\n      }\n    }\n    if (!pointer.onDragStart && !pointer.onClick && !pointer.onDrag && this.allow_dragcanvas) {\n      if (LiteGraph.canvasNavigationMode !== \"standard\" || this.read_only) {\n        pointer.onClick = () => this.processSelect(null, e2);\n        pointer.finally = () => this.dragging_canvas = false;\n        this.dragging_canvas = true;\n      } else {\n        this.#setupNodeSelectionDrag(e2, pointer);\n      }\n    }\n  }\n  #setupNodeSelectionDrag(e2, pointer, node2) {\n    const dragRect = new Float32Array(4);\n    dragRect[0] = e2.canvasX;\n    dragRect[1] = e2.canvasY;\n    dragRect[2] = 1;\n    dragRect[3] = 1;\n    pointer.onClick = (eUp) => {\n      const clickedItem = node2 ?? this.#getPositionableOnPos(eUp.canvasX, eUp.canvasY);\n      this.processSelect(clickedItem, eUp);\n    };\n    pointer.onDragStart = () => this.dragging_rectangle = dragRect;\n    pointer.onDragEnd = (upEvent) => this.#handleMultiSelect(upEvent, dragRect);\n    pointer.finally = () => this.dragging_rectangle = null;\n  }\n  /**\n   * Processes a pointerdown event inside the bounds of a node.  Part of {@link processMouseDown}.\n   * @param e The pointerdown event\n   * @param ctrlOrMeta Ctrl or meta key is pressed\n   * @param node The node to process a click event for\n   */\n  #processNodeClick(e2, ctrlOrMeta, node2) {\n    const { pointer, graph, linkConnector } = this;\n    if (!graph) throw new NullGraphError();\n    const x2 = e2.canvasX;\n    const y = e2.canvasY;\n    pointer.onClick = () => this.processSelect(node2, e2);\n    if (!node2.flags.pinned) {\n      this.bringToFront(node2);\n    }\n    const inCollapse = node2.isPointInCollapse(x2, y);\n    if (inCollapse) {\n      pointer.onClick = () => {\n        node2.collapse();\n        this.setDirty(true, true);\n      };\n    } else if (!node2.flags.collapsed) {\n      const { inputs, outputs } = node2;\n      if (outputs) {\n        for (const [i, output] of outputs.entries()) {\n          const link_pos = node2.getOutputPos(i);\n          if (isInRectangle(x2, y, link_pos[0] - 15, link_pos[1] - 10, 30, 20)) {\n            if (e2.shiftKey && (output.links?.length || output._floatingLinks?.size)) {\n              linkConnector.moveOutputLink(graph, output);\n              this.#linkConnectorDrop();\n              return;\n            }\n            linkConnector.dragNewFromOutput(graph, node2, output);\n            this.#linkConnectorDrop();\n            if (LiteGraph.shift_click_do_break_link_from) {\n              if (e2.shiftKey) {\n                node2.disconnectOutput(i);\n              }\n            } else if (LiteGraph.ctrl_alt_click_do_break_link) {\n              if (ctrlOrMeta && e2.altKey && !e2.shiftKey) {\n                node2.disconnectOutput(i);\n              }\n            }\n            pointer.onDoubleClick = () => node2.onOutputDblClick?.(i, e2);\n            pointer.onClick = () => node2.onOutputClick?.(i, e2);\n            return;\n          }\n        }\n      }\n      if (inputs) {\n        for (const [i, input] of inputs.entries()) {\n          const link_pos = node2.getInputPos(i);\n          const isInSlot = input instanceof NodeInputSlot ? isInRect(x2, y, input.boundingRect) : isInRectangle(x2, y, link_pos[0] - 15, link_pos[1] - 10, 30, 20);\n          if (isInSlot) {\n            pointer.onDoubleClick = () => node2.onInputDblClick?.(i, e2);\n            pointer.onClick = () => node2.onInputClick?.(i, e2);\n            const shouldBreakLink = LiteGraph.ctrl_alt_click_do_break_link && ctrlOrMeta && e2.altKey && !e2.shiftKey;\n            if (input.link !== null || input._floatingLinks?.size) {\n              if (shouldBreakLink || LiteGraph.click_do_break_link_to) {\n                node2.disconnectInput(i, true);\n              } else if (e2.shiftKey || this.allow_reconnect_links) {\n                linkConnector.moveInputLink(graph, input);\n              }\n            }\n            if (!linkConnector.isConnecting) {\n              linkConnector.dragNewFromInput(graph, node2, input);\n            }\n            this.#linkConnectorDrop();\n            this.dirty_bgcanvas = true;\n            return;\n          }\n        }\n      }\n    }\n    const pos = [x2 - node2.pos[0], y - node2.pos[1]];\n    const widget = node2.getWidgetOnPos(x2, y);\n    if (widget) {\n      this.#processWidgetClick(e2, node2, widget);\n      this.node_widget = [node2, widget];\n    } else {\n      pointer.onDoubleClick = () => {\n        if (pos[1] < 0 && !inCollapse) {\n          node2.onNodeTitleDblClick?.(e2, pos, this);\n        } else if (node2 instanceof SubgraphNode) {\n          this.openSubgraph(node2.subgraph);\n        }\n        node2.onDblClick?.(e2, pos, this);\n        this.emitEvent({\n          subType: \"node-double-click\",\n          originalEvent: e2,\n          node: node2\n        });\n        this.processNodeDblClicked(node2);\n      };\n      if (node2.onMouseDown?.(e2, pos, this)) {\n        pointer.onClick = () => {\n        };\n        return;\n      }\n      if (!this.allow_dragnodes) return;\n      if (!node2.flags.collapsed) {\n        const resizeDirection = node2.findResizeDirection(x2, y);\n        if (resizeDirection) {\n          pointer.resizeDirection = resizeDirection;\n          const startBounds = new Rectangle(node2.pos[0], node2.pos[1], node2.size[0], node2.size[1]);\n          pointer.onDragStart = () => {\n            graph.beforeChange();\n            this.resizing_node = node2;\n          };\n          pointer.onDrag = (eMove) => {\n            if (this.read_only) return;\n            const deltaX = eMove.canvasX - x2;\n            const deltaY = eMove.canvasY - y;\n            const newBounds = new Rectangle(startBounds.x, startBounds.y, startBounds.width, startBounds.height);\n            switch (resizeDirection) {\n              case \"NE\":\n                newBounds.y = startBounds.y + deltaY;\n                newBounds.width = startBounds.width + deltaX;\n                newBounds.height = startBounds.height - deltaY;\n                break;\n              case \"SE\":\n                newBounds.width = startBounds.width + deltaX;\n                newBounds.height = startBounds.height + deltaY;\n                break;\n              case \"SW\":\n                newBounds.x = startBounds.x + deltaX;\n                newBounds.width = startBounds.width - deltaX;\n                newBounds.height = startBounds.height + deltaY;\n                break;\n              case \"NW\":\n                newBounds.x = startBounds.x + deltaX;\n                newBounds.y = startBounds.y + deltaY;\n                newBounds.width = startBounds.width - deltaX;\n                newBounds.height = startBounds.height - deltaY;\n                break;\n            }\n            if (this.#snapToGrid) {\n              if (resizeDirection.includes(\"N\") || resizeDirection.includes(\"W\")) {\n                const originalX = newBounds.x;\n                const originalY = newBounds.y;\n                snapPoint(newBounds.pos, this.#snapToGrid);\n                if (resizeDirection.includes(\"N\")) {\n                  newBounds.height += originalY - newBounds.y;\n                }\n                if (resizeDirection.includes(\"W\")) {\n                  newBounds.width += originalX - newBounds.x;\n                }\n              }\n              snapPoint(newBounds.size, this.#snapToGrid);\n            }\n            const min = node2.computeSize();\n            if (newBounds.width < min[0]) {\n              if (resizeDirection.includes(\"W\")) {\n                newBounds.x = startBounds.x + startBounds.width - min[0];\n              }\n              newBounds.width = min[0];\n            }\n            if (newBounds.height < min[1]) {\n              if (resizeDirection.includes(\"N\")) {\n                newBounds.y = startBounds.y + startBounds.height - min[1];\n              }\n              newBounds.height = min[1];\n            }\n            node2.pos = newBounds.pos;\n            node2.setSize(newBounds.size);\n            this.#dirty();\n          };\n          pointer.onDragEnd = () => {\n            this.#dirty();\n            graph.afterChange(node2);\n          };\n          pointer.finally = () => {\n            this.resizing_node = null;\n            pointer.resizeDirection = void 0;\n          };\n          this.canvas.style.cursor = cursors[resizeDirection];\n          return;\n        }\n      }\n      pointer.onDragStart = (pointer2) => this.#startDraggingItems(node2, pointer2, true);\n      pointer.onDragEnd = (e22) => this.#processDraggedItems(e22);\n    }\n    this.dirty_canvas = true;\n  }\n  #processWidgetClick(e2, node2, widget) {\n    const { pointer } = this;\n    if (typeof widget.onPointerDown === \"function\") {\n      const handled = widget.onPointerDown(pointer, node2, this);\n      if (handled) return;\n    }\n    const oldValue = widget.value;\n    const pos = this.graph_mouse;\n    const x2 = pos[0] - node2.pos[0];\n    const y = pos[1] - node2.pos[1];\n    const widgetInstance = toConcreteWidget(widget, node2, false);\n    if (widgetInstance) {\n      pointer.onClick = () => widgetInstance.onClick({\n        e: e2,\n        node: node2,\n        canvas: this\n      });\n      pointer.onDrag = (eMove) => widgetInstance.onDrag?.({\n        e: eMove,\n        node: node2,\n        canvas: this\n      });\n    } else if (widget.mouse) {\n      const result = widget.mouse(e2, [x2, y], node2);\n      if (result != null) this.dirty_canvas = result;\n    }\n    if (oldValue != widget.value) {\n      node2.onWidgetChanged?.(widget.name, widget.value, oldValue, widget);\n      if (!node2.graph) throw new NullGraphError();\n      node2.graph._version++;\n    }\n    pointer.finally = () => {\n      if (widget.mouse) {\n        const { eUp } = pointer;\n        if (!eUp) return;\n        const { canvasX, canvasY } = eUp;\n        widget.mouse(eUp, [canvasX - node2.pos[0], canvasY - node2.pos[1]], node2);\n      }\n      this.node_widget = null;\n    };\n  }\n  /**\n   * Pointer middle button click processing.  Part of {@link processMouseDown}.\n   * @param e The pointerdown event\n   * @param node The node to process a click event for\n   */\n  #processMiddleButton(e2, node2) {\n    const { pointer } = this;\n    if (LiteGraph.middle_click_slot_add_default_node && node2 && this.allow_interaction && !this.read_only && !this.connecting_links && !node2.flags.collapsed) {\n      let mClikSlot = false;\n      let mClikSlot_index = false;\n      let mClikSlot_isOut = false;\n      const { inputs, outputs } = node2;\n      if (outputs) {\n        for (const [i, output] of outputs.entries()) {\n          const link_pos = node2.getOutputPos(i);\n          if (isInRectangle(e2.canvasX, e2.canvasY, link_pos[0] - 15, link_pos[1] - 10, 30, 20)) {\n            mClikSlot = output;\n            mClikSlot_index = i;\n            mClikSlot_isOut = true;\n            break;\n          }\n        }\n      }\n      if (inputs) {\n        for (const [i, input] of inputs.entries()) {\n          const link_pos = node2.getInputPos(i);\n          if (isInRectangle(e2.canvasX, e2.canvasY, link_pos[0] - 15, link_pos[1] - 10, 30, 20)) {\n            mClikSlot = input;\n            mClikSlot_index = i;\n            mClikSlot_isOut = false;\n            break;\n          }\n        }\n      }\n      if (mClikSlot && mClikSlot_index !== false) {\n        const alphaPosY = 0.5 - (mClikSlot_index + 1) / (mClikSlot_isOut ? outputs.length : inputs.length);\n        const node_bounding = node2.getBounding();\n        const posRef = [\n          !mClikSlot_isOut ? node_bounding[0] : node_bounding[0] + node_bounding[2],\n          e2.canvasY - 80\n        ];\n        pointer.onClick = () => this.createDefaultNodeForSlot({\n          nodeFrom: !mClikSlot_isOut ? null : node2,\n          slotFrom: !mClikSlot_isOut ? null : mClikSlot_index,\n          nodeTo: !mClikSlot_isOut ? node2 : null,\n          slotTo: !mClikSlot_isOut ? mClikSlot_index : null,\n          position: posRef,\n          nodeType: \"AUTO\",\n          posAdd: [!mClikSlot_isOut ? -30 : 30, -alphaPosY * 130],\n          posSizeFix: [!mClikSlot_isOut ? -1 : 0, 0]\n        });\n      }\n    }\n    if (this.allow_dragcanvas) {\n      pointer.onDragStart = () => this.dragging_canvas = true;\n      pointer.finally = () => this.dragging_canvas = false;\n    }\n  }\n  #processDragZoom(e2) {\n    if (!e2.buttons) {\n      this.#dragZoomStart = null;\n      return;\n    }\n    const start = this.#dragZoomStart;\n    if (!start) throw new TypeError(\"Drag-zoom state object was null\");\n    if (!this.graph) throw new NullGraphError();\n    const deltaY = e2.y - start.pos[1];\n    const startScale = start.scale;\n    const scale = startScale - deltaY / 100;\n    this.ds.changeScale(scale, start.pos);\n    this.graph.change();\n  }\n  /**\n   * Called when a mouse move event has to be processed\n   */\n  processMouseMove(e2) {\n    if (this.dragZoomEnabled && e2.ctrlKey && e2.shiftKey && this.#dragZoomStart) {\n      this.#processDragZoom(e2);\n      return;\n    }\n    if (this.autoresize) this.resize();\n    if (this.set_canvas_dirty_on_mouse_event) this.dirty_canvas = true;\n    const { graph, resizingGroup, linkConnector, pointer, subgraph } = this;\n    if (!graph) return;\n    LGraphCanvas.active_canvas = this;\n    this.adjustMouseEvent(e2);\n    const mouse = [e2.clientX, e2.clientY];\n    this.mouse[0] = mouse[0];\n    this.mouse[1] = mouse[1];\n    const delta2 = [\n      mouse[0] - this.last_mouse[0],\n      mouse[1] - this.last_mouse[1]\n    ];\n    this.last_mouse = mouse;\n    const { canvasX: x2, canvasY: y } = e2;\n    this.graph_mouse[0] = x2;\n    this.graph_mouse[1] = y;\n    if (e2.isPrimary) pointer.move(e2);\n    let underPointer = CanvasItem.Nothing;\n    if (subgraph) {\n      underPointer |= subgraph.inputNode.onPointerMove(e2);\n      underPointer |= subgraph.outputNode.onPointerMove(e2);\n    }\n    if (this.block_click) {\n      e2.preventDefault();\n      return;\n    }\n    e2.dragging = this.last_mouse_dragging;\n    if (this.node_widget) {\n      const [node22, widget] = this.node_widget;\n      if (widget?.mouse) {\n        const relativeX = x2 - node22.pos[0];\n        const relativeY = y - node22.pos[1];\n        const result = widget.mouse(e2, [relativeX, relativeY], node22);\n        if (result != null) this.dirty_canvas = result;\n      }\n    }\n    const node2 = graph.getNodeOnPos(\n      x2,\n      y,\n      this.visible_nodes\n    );\n    const dragRect = this.dragging_rectangle;\n    if (dragRect) {\n      dragRect[2] = x2 - dragRect[0];\n      dragRect[3] = y - dragRect[1];\n      this.dirty_canvas = true;\n    } else if (resizingGroup) {\n      underPointer |= CanvasItem.Group;\n      pointer.resizeDirection = \"SE\";\n    } else if (this.dragging_canvas) {\n      this.ds.offset[0] += delta2[0] / this.ds.scale;\n      this.ds.offset[1] += delta2[1] / this.ds.scale;\n      this.#dirty();\n    } else if ((this.allow_interaction || node2?.flags.allow_interaction) && !this.read_only) {\n      if (linkConnector.isConnecting) this.dirty_canvas = true;\n      this.updateMouseOverNodes(node2, e2);\n      if (node2) {\n        underPointer |= CanvasItem.Node;\n        if (node2.redraw_on_mouse) this.dirty_canvas = true;\n        const pos = [0, 0];\n        const inputId = isOverNodeInput(node2, x2, y, pos);\n        const outputId = isOverNodeOutput(node2, x2, y, pos);\n        const overWidget = node2.getWidgetOnPos(x2, y, true) ?? void 0;\n        if (!node2.mouseOver) {\n          node2.mouseOver = {};\n          this.node_over = node2;\n          this.dirty_canvas = true;\n          for (const reroute of this.#visibleReroutes) {\n            reroute.hideSlots();\n            this.dirty_bgcanvas = true;\n          }\n          node2.onMouseEnter?.(e2);\n        }\n        node2.onMouseMove?.(e2, [x2 - node2.pos[0], y - node2.pos[1]], this);\n        const { mouseOver } = node2;\n        if (mouseOver.inputId !== inputId || mouseOver.outputId !== outputId || mouseOver.overWidget !== overWidget) {\n          mouseOver.inputId = inputId;\n          mouseOver.outputId = outputId;\n          mouseOver.overWidget = overWidget;\n          linkConnector.overWidget = void 0;\n          if (linkConnector.isConnecting) {\n            const firstLink = linkConnector.renderLinks.at(0);\n            let highlightPos;\n            let highlightInput;\n            if (!firstLink || !linkConnector.isNodeValidDrop(node2)) ;\n            else if (linkConnector.state.connectingTo === \"input\") {\n              if (overWidget) {\n                const slot = node2.getSlotFromWidget(overWidget);\n                if (slot && linkConnector.isInputValidDrop(node2, slot)) {\n                  highlightInput = slot;\n                  highlightPos = node2.getInputSlotPos(slot);\n                  linkConnector.overWidget = overWidget;\n                }\n              }\n              if (!linkConnector.overWidget) {\n                if (inputId === -1 && outputId === -1) {\n                  const result = node2.findInputByType(firstLink.fromSlot.type);\n                  if (result) {\n                    highlightInput = result.slot;\n                    highlightPos = node2.getInputSlotPos(result.slot);\n                  }\n                } else if (inputId != -1 && node2.inputs[inputId] && LiteGraph.isValidConnection(firstLink.fromSlot.type, node2.inputs[inputId].type)) {\n                  highlightPos = pos;\n                  highlightInput = node2.inputs[inputId];\n                }\n                if (highlightInput) {\n                  const widget = node2.getWidgetFromSlot(highlightInput);\n                  if (widget) linkConnector.overWidget = widget;\n                }\n              }\n            } else if (linkConnector.state.connectingTo === \"output\") {\n              if (inputId === -1 && outputId === -1) {\n                const result = node2.findOutputByType(firstLink.fromSlot.type);\n                if (result) {\n                  highlightPos = node2.getOutputPos(result.index);\n                }\n              } else {\n                if (outputId != -1 && node2.outputs[outputId] && LiteGraph.isValidConnection(firstLink.fromSlot.type, node2.outputs[outputId].type)) {\n                  highlightPos = pos;\n                }\n              }\n            }\n            this._highlight_pos = highlightPos;\n            this._highlight_input = highlightInput;\n          }\n          this.dirty_canvas = true;\n        }\n        if (!pointer.eDown) {\n          if (inputId === -1 && outputId === -1 && !overWidget) {\n            pointer.resizeDirection = node2.findResizeDirection(x2, y);\n          } else {\n            pointer.resizeDirection &&= void 0;\n          }\n        }\n      } else {\n        underPointer = this.#updateReroutes(underPointer);\n        const segment = this.#getLinkCentreOnPos(e2);\n        if (this.over_link_center !== segment) {\n          underPointer |= CanvasItem.Link;\n          this.over_link_center = segment;\n          this.dirty_bgcanvas = true;\n        }\n        if (this.canvas) {\n          const group = graph.getGroupOnPos(x2, y);\n          if (group && !e2.ctrlKey && !this.read_only && group.isInResize(x2, y)) {\n            pointer.resizeDirection = \"SE\";\n          } else {\n            pointer.resizeDirection &&= void 0;\n          }\n        }\n      }\n      if (this.node_capturing_input && this.node_capturing_input != node2) {\n        this.node_capturing_input.onMouseMove?.(\n          e2,\n          [\n            x2 - this.node_capturing_input.pos[0],\n            y - this.node_capturing_input.pos[1]\n          ],\n          this\n        );\n      }\n      if (this.isDragging) {\n        const selected = this.selectedItems;\n        const allItems = e2.ctrlKey ? selected : getAllNestedItems(selected);\n        const deltaX = delta2[0] / this.ds.scale;\n        const deltaY = delta2[1] / this.ds.scale;\n        for (const item of allItems) {\n          item.move(deltaX, deltaY, true);\n        }\n        this.#dirty();\n      }\n    }\n    this.hoveringOver = underPointer;\n    e2.preventDefault();\n    return;\n  }\n  /**\n   * Updates the hover / snap state of all visible reroutes.\n   * @returns The original value of {@link underPointer}, with any found reroute items added.\n   */\n  #updateReroutes(underPointer) {\n    const { graph, pointer, linkConnector } = this;\n    if (!graph) throw new NullGraphError();\n    if (!pointer.isDown) {\n      let anyChanges = false;\n      for (const reroute of this.#visibleReroutes) {\n        anyChanges ||= reroute.updateVisibility(this.graph_mouse);\n        if (reroute.isSlotHovered) underPointer |= CanvasItem.RerouteSlot;\n      }\n      if (anyChanges) this.dirty_bgcanvas = true;\n    } else if (linkConnector.isConnecting) {\n      for (const reroute of this.#visibleReroutes) {\n        if (reroute.containsPoint(this.graph_mouse)) {\n          if (linkConnector.isRerouteValidDrop(reroute)) {\n            linkConnector.overReroute = reroute;\n            this._highlight_pos = reroute.pos;\n          }\n          return underPointer |= CanvasItem.RerouteSlot;\n        }\n      }\n    }\n    this._highlight_pos &&= void 0;\n    linkConnector.overReroute &&= void 0;\n    return underPointer;\n  }\n  /**\n   * Start dragging an item, optionally including all other selected items.\n   *\n   * ** This function sets the {@link CanvasPointer.finally}() callback. **\n   * @param item The item that the drag event started on\n   * @param pointer The pointer event that initiated the drag, e.g. pointerdown\n   * @param sticky If `true`, the item is added to the selection - see {@link processSelect}\n   */\n  #startDraggingItems(item, pointer, sticky = false) {\n    this.emitBeforeChange();\n    this.graph?.beforeChange();\n    pointer.finally = () => {\n      this.isDragging = false;\n      this.graph?.afterChange();\n      this.emitAfterChange();\n    };\n    this.processSelect(item, pointer.eDown, sticky);\n    this.isDragging = true;\n  }\n  /**\n   * Handles shared clean up and placement after items have been dragged.\n   * @param e The event that completed the drag, e.g. pointerup, pointermove\n   */\n  #processDraggedItems(e2) {\n    const { graph } = this;\n    if (e2.shiftKey || LiteGraph.alwaysSnapToGrid)\n      graph?.snapToGrid(this.selectedItems);\n    this.dirty_canvas = true;\n    this.dirty_bgcanvas = true;\n    this.onNodeMoved?.(findFirstNode(this.selectedItems));\n  }\n  /**\n   * Called when a mouse up event has to be processed\n   */\n  processMouseUp(e2) {\n    if (e2.isPrimary === false) return;\n    const { graph, pointer } = this;\n    if (!graph) return;\n    LGraphCanvas.active_canvas = this;\n    this.adjustMouseEvent(e2);\n    const now = LiteGraph.getTime();\n    e2.click_time = now - this.last_mouseclick;\n    const isClick = pointer.up(e2);\n    if (isClick === true) {\n      pointer.isDown = false;\n      pointer.isDouble = false;\n      this.connecting_links = null;\n      this.dragging_canvas = false;\n      graph.change();\n      e2.stopPropagation();\n      e2.preventDefault();\n      return;\n    }\n    this.last_mouse_dragging = false;\n    this.last_click_position = null;\n    this.block_click &&= false;\n    if (e2.button === 0) {\n      this.selected_group = null;\n      this.isDragging = false;\n      const x2 = e2.canvasX;\n      const y = e2.canvasY;\n      if (!this.linkConnector.isConnecting) {\n        this.dirty_canvas = true;\n        this.node_over?.onMouseUp?.(e2, [x2 - this.node_over.pos[0], y - this.node_over.pos[1]], this);\n        this.node_capturing_input?.onMouseUp?.(e2, [\n          x2 - this.node_capturing_input.pos[0],\n          y - this.node_capturing_input.pos[1]\n        ]);\n      }\n    } else if (e2.button === 1) {\n      this.dirty_canvas = true;\n      this.dragging_canvas = false;\n    } else if (e2.button === 2) {\n      this.dirty_canvas = true;\n    }\n    pointer.isDown = false;\n    pointer.isDouble = false;\n    graph.change();\n    e2.stopPropagation();\n    e2.preventDefault();\n    return;\n  }\n  /**\n   * Called when the mouse moves off the canvas.  Clears all node hover states.\n   * @param e\n   */\n  processMouseOut(e2) {\n    this.adjustMouseEvent(e2);\n    this.updateMouseOverNodes(null, e2);\n  }\n  processMouseCancel() {\n    console.warn(\"Pointer cancel!\");\n    this.pointer.reset();\n  }\n  /**\n   * Called when a mouse wheel event has to be processed\n   */\n  processMouseWheel(e2) {\n    if (!this.graph || !this.allow_dragcanvas) return;\n    const delta2 = e2.wheelDeltaY ?? e2.detail * -60;\n    this.adjustMouseEvent(e2);\n    const pos = [e2.clientX, e2.clientY];\n    if (this.viewport && !isPointInRect(pos, this.viewport)) return;\n    let { scale } = this.ds;\n    if (LiteGraph.canvasNavigationMode === \"legacy\" || LiteGraph.canvasNavigationMode === \"standard\" && e2.ctrlKey) {\n      if (delta2 > 0) {\n        scale *= this.zoom_speed;\n      } else if (delta2 < 0) {\n        scale *= 1 / this.zoom_speed;\n      }\n      this.ds.changeScale(scale, [e2.clientX, e2.clientY]);\n    } else if (LiteGraph.macTrackpadGestures && (!LiteGraph.macGesturesRequireMac || navigator.userAgent.includes(\"Mac\"))) {\n      if (e2.metaKey && !e2.ctrlKey && !e2.shiftKey && !e2.altKey) {\n        if (e2.deltaY > 0) {\n          scale *= 1 / this.zoom_speed;\n        } else if (e2.deltaY < 0) {\n          scale *= this.zoom_speed;\n        }\n        this.ds.changeScale(scale, [e2.clientX, e2.clientY]);\n      } else if (e2.ctrlKey) {\n        scale *= 1 + e2.deltaY * (1 - this.zoom_speed) * 0.18;\n        this.ds.changeScale(scale, [e2.clientX, e2.clientY], false);\n      } else if (e2.shiftKey) {\n        this.ds.offset[0] -= e2.deltaY * 1.18 * (1 / scale);\n      } else {\n        this.ds.offset[0] -= e2.deltaX * 1.18 * (1 / scale);\n        this.ds.offset[1] -= e2.deltaY * 1.18 * (1 / scale);\n      }\n    }\n    this.graph.change();\n    e2.preventDefault();\n    return;\n  }\n  #noItemsSelected() {\n    const event = new CustomEvent(\"litegraph:no-items-selected\", { bubbles: true });\n    this.canvas.dispatchEvent(event);\n  }\n  /**\n   * process a key event\n   */\n  processKey(e2) {\n    this.#shiftDown = e2.shiftKey;\n    const { graph } = this;\n    if (!graph) return;\n    let block_default = false;\n    if (e2.target.localName == \"input\") return;\n    if (e2.type == \"keydown\") {\n      if (e2.key === \" \") {\n        this.read_only = true;\n        if (this._previously_dragging_canvas === null) {\n          this._previously_dragging_canvas = this.dragging_canvas;\n        }\n        this.dragging_canvas = this.pointer.isDown;\n        block_default = true;\n      } else if (e2.key === \"Escape\") {\n        if (this.linkConnector.isConnecting) {\n          this.linkConnector.reset();\n          e2.preventDefault();\n          return;\n        }\n        this.node_panel?.close();\n        this.options_panel?.close();\n        if (this.node_panel || this.options_panel) block_default = true;\n      } else if (e2.keyCode === 65 && e2.ctrlKey) {\n        this.selectItems();\n        block_default = true;\n      } else if (e2.keyCode === 67 && (e2.metaKey || e2.ctrlKey) && !e2.shiftKey) {\n        if (this.selected_nodes) {\n          this.copyToClipboard();\n          block_default = true;\n        }\n      } else if (e2.keyCode === 86 && (e2.metaKey || e2.ctrlKey)) {\n        this.pasteFromClipboard({ connectInputs: e2.shiftKey });\n      } else if (e2.key === \"Delete\" || e2.key === \"Backspace\") {\n        if (e2.target.localName != \"input\" && e2.target.localName != \"textarea\") {\n          if (this.selectedItems.size === 0) {\n            this.#noItemsSelected();\n            return;\n          }\n          this.deleteSelected();\n          block_default = true;\n        }\n      }\n      for (const node2 of Object.values(this.selected_nodes)) {\n        node2.onKeyDown?.(e2);\n      }\n    } else if (e2.type == \"keyup\") {\n      if (e2.key === \" \") {\n        this.read_only = false;\n        this.dragging_canvas = (this._previously_dragging_canvas ?? false) && this.pointer.isDown;\n        this._previously_dragging_canvas = null;\n      }\n      for (const node2 of Object.values(this.selected_nodes)) {\n        node2.onKeyUp?.(e2);\n      }\n    }\n    graph.change();\n    if (block_default) {\n      e2.preventDefault();\n      e2.stopImmediatePropagation();\n    }\n  }\n  /**\n   * Copies canvas items to an internal, app-specific clipboard backed by local storage.\n   * When called without parameters, it copies {@link selectedItems}.\n   * @param items The items to copy.  If nullish, all selected items are copied.\n   */\n  copyToClipboard(items) {\n    const serialisable = {\n      nodes: [],\n      groups: [],\n      reroutes: [],\n      links: [],\n      subgraphs: []\n    };\n    const subgraphs = /* @__PURE__ */ new Set();\n    for (const item of items ?? this.selectedItems) {\n      if (item instanceof LGraphNode) {\n        if (item.clonable === false) continue;\n        const cloned = item.clone()?.serialize();\n        if (!cloned) continue;\n        cloned.id = item.id;\n        serialisable.nodes.push(cloned);\n        if (item.inputs) {\n          for (const { link: linkId } of item.inputs) {\n            if (linkId == null) continue;\n            const link = this.graph?._links.get(linkId)?.asSerialisable();\n            if (link) serialisable.links.push(link);\n          }\n        }\n        if (item instanceof SubgraphNode) {\n          subgraphs.add(item.subgraph);\n        }\n      } else if (item instanceof LGraphGroup) {\n        serialisable.groups.push(item.serialize());\n      } else if (item instanceof Reroute) {\n        serialisable.reroutes.push(item.asSerialisable());\n      }\n    }\n    for (const subgraph of subgraphs) {\n      const cloned = subgraph.clone(true).asSerialisable();\n      serialisable.subgraphs.push(cloned);\n    }\n    localStorage.setItem(\n      \"litegrapheditor_clipboard\",\n      JSON.stringify(serialisable)\n    );\n  }\n  emitEvent(detail) {\n    this.canvas.dispatchEvent(\n      new CustomEvent(\"litegraph:canvas\", {\n        bubbles: true,\n        detail\n      })\n    );\n  }\n  /** @todo Refactor to where it belongs - e.g. Deleting / creating nodes is not actually canvas event. */\n  emitBeforeChange() {\n    this.emitEvent({\n      subType: \"before-change\"\n    });\n  }\n  /** @todo See {@link emitBeforeChange} */\n  emitAfterChange() {\n    this.emitEvent({\n      subType: \"after-change\"\n    });\n  }\n  /**\n   * Pastes the items from the canvas \"clipbaord\" - a local storage variable.\n   */\n  _pasteFromClipboard(options = {}) {\n    const {\n      connectInputs = false,\n      position = this.graph_mouse\n    } = options;\n    if (!LiteGraph.ctrl_shift_v_paste_connect_unselected_outputs && connectInputs) return;\n    const data = localStorage.getItem(\"litegrapheditor_clipboard\");\n    if (!data) return;\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    graph.beforeChange();\n    const parsed = JSON.parse(data);\n    parsed.nodes ??= [];\n    parsed.groups ??= [];\n    parsed.reroutes ??= [];\n    parsed.links ??= [];\n    parsed.subgraphs ??= [];\n    let offsetX = Infinity;\n    let offsetY = Infinity;\n    for (const item of [...parsed.nodes, ...parsed.reroutes]) {\n      if (item.pos == null) throw new TypeError(\"Invalid node encounterd on paste.  `pos` was null.\");\n      if (item.pos[0] < offsetX) offsetX = item.pos[0];\n      if (item.pos[1] < offsetY) offsetY = item.pos[1];\n    }\n    if (parsed.groups) {\n      for (const group of parsed.groups) {\n        if (group.bounding[0] < offsetX) offsetX = group.bounding[0];\n        if (group.bounding[1] < offsetY) offsetY = group.bounding[1];\n      }\n    }\n    const results = {\n      created: [],\n      nodes: /* @__PURE__ */ new Map(),\n      links: /* @__PURE__ */ new Map(),\n      reroutes: /* @__PURE__ */ new Map(),\n      subgraphs: /* @__PURE__ */ new Map()\n    };\n    const { created, nodes, links, reroutes } = results;\n    for (const info of parsed.subgraphs) {\n      const originalId = info.id;\n      info.id = createUuidv4();\n      const subgraph = graph.createSubgraph(info);\n      subgraph.configure(info);\n      results.subgraphs.set(originalId, subgraph);\n    }\n    for (const info of parsed.groups) {\n      info.id = -1;\n      const group = new LGraphGroup();\n      group.configure(info);\n      graph.add(group);\n      created.push(group);\n    }\n    for (const info of parsed.nodes) {\n      const subgraph = results.subgraphs.get(info.type);\n      if (subgraph) info.type = subgraph.id;\n      const node2 = info.type == null ? null : LiteGraph.createNode(info.type);\n      if (!node2) {\n        continue;\n      }\n      nodes.set(info.id, node2);\n      info.id = -1;\n      node2.configure(info);\n      graph.add(node2);\n      created.push(node2);\n    }\n    for (const info of parsed.reroutes) {\n      const { id, ...rerouteInfo } = info;\n      const reroute = graph.setReroute(rerouteInfo);\n      created.push(reroute);\n      reroutes.set(id, reroute);\n    }\n    for (const reroute of reroutes.values()) {\n      if (reroute.parentId == null) continue;\n      const mapped = reroutes.get(reroute.parentId);\n      if (mapped) reroute.parentId = mapped.id;\n    }\n    for (const info of parsed.links) {\n      let outNode = nodes.get(info.origin_id);\n      let afterRerouteId;\n      if (info.parentId != null) afterRerouteId = reroutes.get(info.parentId)?.id;\n      if (connectInputs && LiteGraph.ctrl_shift_v_paste_connect_unselected_outputs) {\n        outNode ??= graph.getNodeById(info.origin_id);\n        afterRerouteId ??= info.parentId;\n      }\n      const inNode = nodes.get(info.target_id);\n      if (inNode) {\n        const link = outNode?.connect(\n          info.origin_slot,\n          inNode,\n          info.target_slot,\n          afterRerouteId\n        );\n        if (link) links.set(info.id, link);\n      }\n    }\n    for (const reroute of reroutes.values()) {\n      const ids = [...reroute.linkIds].map((x2) => links.get(x2)?.id ?? x2);\n      reroute.update(reroute.parentId, void 0, ids, reroute.floating);\n      if (!reroute.validateLinks(graph.links, graph.floatingLinks)) {\n        graph.removeReroute(reroute.id);\n      }\n    }\n    for (const item of created) {\n      item.pos[0] += position[0] - offsetX;\n      item.pos[1] += position[1] - offsetY;\n    }\n    this.selectItems(created);\n    graph.afterChange();\n    return results;\n  }\n  pasteFromClipboard(options = {}) {\n    this.emitBeforeChange();\n    try {\n      this._pasteFromClipboard(options);\n    } finally {\n      this.emitAfterChange();\n    }\n  }\n  processNodeDblClicked(n) {\n    this.onShowNodePanel?.(n);\n    this.onNodeDblClicked?.(n);\n    this.setDirty(true);\n  }\n  #handleMultiSelect(e2, dragRect) {\n    const { graph, selectedItems, subgraph } = this;\n    if (!graph) throw new NullGraphError();\n    const w = Math.abs(dragRect[2]);\n    const h = Math.abs(dragRect[3]);\n    if (dragRect[2] < 0) dragRect[0] -= w;\n    if (dragRect[3] < 0) dragRect[1] -= h;\n    dragRect[2] = w;\n    dragRect[3] = h;\n    const isSelected = /* @__PURE__ */ new Set();\n    const notSelected = [];\n    if (subgraph) {\n      const { inputNode, outputNode } = subgraph;\n      if (overlapBounding(dragRect, inputNode.boundingRect)) {\n        addPositionable(inputNode);\n      }\n      if (overlapBounding(dragRect, outputNode.boundingRect)) {\n        addPositionable(outputNode);\n      }\n    }\n    for (const nodeX of graph._nodes) {\n      if (overlapBounding(dragRect, nodeX.boundingRect)) {\n        addPositionable(nodeX);\n      }\n    }\n    for (const group of graph.groups) {\n      if (!containsRect(dragRect, group._bounding)) continue;\n      group.recomputeInsideNodes();\n      addPositionable(group);\n    }\n    for (const reroute of graph.reroutes.values()) {\n      if (!isPointInRect(reroute.pos, dragRect)) continue;\n      selectedItems.add(reroute);\n      reroute.selected = true;\n      addPositionable(reroute);\n    }\n    if (e2.shiftKey) {\n      for (const item of notSelected) this.select(item);\n    } else if (e2.altKey) {\n      for (const item of isSelected) this.deselect(item);\n    } else {\n      for (const item of selectedItems.values()) {\n        if (!isSelected.has(item)) this.deselect(item);\n      }\n      for (const item of notSelected) this.select(item);\n    }\n    this.onSelectionChange?.(this.selected_nodes);\n    function addPositionable(item) {\n      if (!item.selected || !selectedItems.has(item)) notSelected.push(item);\n      else isSelected.add(item);\n    }\n  }\n  /**\n   * Determines whether to select or deselect an item that has received a pointer event.  Will deselect other nodes if\n   * @param item Canvas item to select/deselect\n   * @param e The MouseEvent to handle\n   * @param sticky Prevents deselecting individual nodes (as used by aux/right-click)\n   * @remarks\n   * Accessibility: anyone using {@link mutli_select} always deselects when clicking empty space.\n   */\n  processSelect(item, e2, sticky = false) {\n    const addModifier = e2?.shiftKey;\n    const subtractModifier = e2 != null && (e2.metaKey || e2.ctrlKey);\n    const eitherModifier = addModifier || subtractModifier;\n    const modifySelection = eitherModifier || this.multi_select;\n    if (!item) {\n      if (!eitherModifier || this.multi_select) this.deselectAll();\n    } else if (!item.selected || !this.selectedItems.has(item)) {\n      if (!modifySelection) this.deselectAll(item);\n      this.select(item);\n    } else if (modifySelection && !sticky) {\n      this.deselect(item);\n    } else if (!sticky) {\n      this.deselectAll(item);\n    } else {\n      return;\n    }\n    this.onSelectionChange?.(this.selected_nodes);\n    this.setDirty(true);\n  }\n  /**\n   * Selects a {@link Positionable} item.\n   * @param item The canvas item to add to the selection.\n   */\n  select(item) {\n    if (item.selected && this.selectedItems.has(item)) return;\n    item.selected = true;\n    this.selectedItems.add(item);\n    this.state.selectionChanged = true;\n    if (!(item instanceof LGraphNode)) return;\n    item.onSelected?.();\n    this.selected_nodes[item.id] = item;\n    this.onNodeSelected?.(item);\n    if (item.inputs) {\n      for (const input of item.inputs) {\n        if (input.link == null) continue;\n        this.highlighted_links[input.link] = true;\n      }\n    }\n    if (item.outputs) {\n      for (const id of item.outputs.flatMap((x2) => x2.links)) {\n        if (id == null) continue;\n        this.highlighted_links[id] = true;\n      }\n    }\n  }\n  /**\n   * Deselects a {@link Positionable} item.\n   * @param item The canvas item to remove from the selection.\n   */\n  deselect(item) {\n    if (!item.selected && !this.selectedItems.has(item)) return;\n    item.selected = false;\n    this.selectedItems.delete(item);\n    this.state.selectionChanged = true;\n    if (!(item instanceof LGraphNode)) return;\n    item.onDeselected?.();\n    delete this.selected_nodes[item.id];\n    this.onNodeDeselected?.(item);\n    const { graph } = this;\n    if (!graph) return;\n    if (item.inputs) {\n      for (const input of item.inputs) {\n        if (input.link == null) continue;\n        const node2 = LLink.getOriginNode(graph, input.link);\n        if (node2 && this.selectedItems.has(node2)) continue;\n        delete this.highlighted_links[input.link];\n      }\n    }\n    if (item.outputs) {\n      for (const id of item.outputs.flatMap((x2) => x2.links)) {\n        if (id == null) continue;\n        const node2 = LLink.getTargetNode(graph, id);\n        if (node2 && this.selectedItems.has(node2)) continue;\n        delete this.highlighted_links[id];\n      }\n    }\n  }\n  /** @deprecated See {@link LGraphCanvas.processSelect} */\n  processNodeSelected(item, e2) {\n    this.processSelect(\n      item,\n      e2,\n      e2 && (e2.shiftKey || e2.metaKey || e2.ctrlKey || this.multi_select)\n    );\n  }\n  /** @deprecated See {@link LGraphCanvas.select} */\n  selectNode(node2, add_to_current_selection) {\n    if (node2 == null) {\n      this.deselectAll();\n    } else {\n      this.selectNodes([node2], add_to_current_selection);\n    }\n  }\n  get empty() {\n    if (!this.graph) throw new NullGraphError();\n    return this.graph.empty;\n  }\n  get positionableItems() {\n    if (!this.graph) throw new NullGraphError();\n    return this.graph.positionableItems();\n  }\n  /**\n   * Selects several items.\n   * @param items Items to select - if falsy, all items on the canvas will be selected\n   * @param add_to_current_selection If set, the items will be added to the current selection instead of replacing it\n   */\n  selectItems(items, add_to_current_selection) {\n    const itemsToSelect = items ?? this.positionableItems;\n    if (!add_to_current_selection) this.deselectAll();\n    for (const item of itemsToSelect) this.select(item);\n    this.onSelectionChange?.(this.selected_nodes);\n    this.setDirty(true);\n  }\n  /**\n   * selects several nodes (or adds them to the current selection)\n   * @deprecated See {@link LGraphCanvas.selectItems}\n   */\n  selectNodes(nodes, add_to_current_selection) {\n    this.selectItems(nodes, add_to_current_selection);\n  }\n  /** @deprecated See {@link LGraphCanvas.deselect} */\n  deselectNode(node2) {\n    this.deselect(node2);\n  }\n  /**\n   * Deselects all items on the canvas.\n   * @param keepSelected If set, this item will not be removed from the selection.\n   */\n  deselectAll(keepSelected) {\n    if (!this.graph) return;\n    const selected = this.selectedItems;\n    if (!selected.size) return;\n    let wasSelected;\n    for (const sel of selected) {\n      if (sel === keepSelected) {\n        wasSelected = sel;\n        continue;\n      }\n      sel.onDeselected?.();\n      sel.selected = false;\n    }\n    selected.clear();\n    if (wasSelected) selected.add(wasSelected);\n    this.setDirty(true);\n    const oldNode = keepSelected?.id == null ? null : this.selected_nodes[keepSelected.id];\n    this.selected_nodes = {};\n    this.current_node = null;\n    this.highlighted_links = {};\n    if (keepSelected instanceof LGraphNode) {\n      if (oldNode) this.selected_nodes[oldNode.id] = oldNode;\n      if (keepSelected.inputs) {\n        for (const input of keepSelected.inputs) {\n          if (input.link == null) continue;\n          this.highlighted_links[input.link] = true;\n        }\n      }\n      if (keepSelected.outputs) {\n        for (const id of keepSelected.outputs.flatMap((x2) => x2.links)) {\n          if (id == null) continue;\n          this.highlighted_links[id] = true;\n        }\n      }\n    }\n    this.state.selectionChanged = true;\n    this.onSelectionChange?.(this.selected_nodes);\n  }\n  /** @deprecated See {@link LGraphCanvas.deselectAll} */\n  deselectAllNodes() {\n    this.deselectAll();\n  }\n  /**\n   * Deletes all selected items from the graph.\n   * @todo Refactor deletion task to LGraph.  Selection is a canvas property, delete is a graph action.\n   */\n  deleteSelected() {\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    this.emitBeforeChange();\n    graph.beforeChange();\n    for (const item of this.selectedItems) {\n      if (item instanceof LGraphNode) {\n        const node2 = item;\n        if (node2.block_delete) continue;\n        node2.connectInputToOutput();\n        graph.remove(node2);\n        this.onNodeDeselected?.(node2);\n      } else if (item instanceof LGraphGroup) {\n        graph.remove(item);\n      } else if (item instanceof Reroute) {\n        graph.removeReroute(item.id);\n      }\n    }\n    this.selected_nodes = {};\n    this.selectedItems.clear();\n    this.current_node = null;\n    this.highlighted_links = {};\n    this.state.selectionChanged = true;\n    this.onSelectionChange?.(this.selected_nodes);\n    this.setDirty(true);\n    graph.afterChange();\n    this.emitAfterChange();\n  }\n  /**\n   * deletes all nodes in the current selection from the graph\n   * @deprecated See {@link LGraphCanvas.deleteSelected}\n   */\n  deleteSelectedNodes() {\n    this.deleteSelected();\n  }\n  /**\n   * centers the camera on a given node\n   */\n  centerOnNode(node2) {\n    const dpi = window?.devicePixelRatio || 1;\n    this.ds.offset[0] = -node2.pos[0] - node2.size[0] * 0.5 + this.canvas.width * 0.5 / (this.ds.scale * dpi);\n    this.ds.offset[1] = -node2.pos[1] - node2.size[1] * 0.5 + this.canvas.height * 0.5 / (this.ds.scale * dpi);\n    this.setDirty(true, true);\n  }\n  /**\n   * adds some useful properties to a mouse event, like the position in graph coordinates\n   */\n  adjustMouseEvent(e2) {\n    let clientX_rel = e2.clientX;\n    let clientY_rel = e2.clientY;\n    if (this.canvas) {\n      const b = this.canvas.getBoundingClientRect();\n      clientX_rel -= b.left;\n      clientY_rel -= b.top;\n    }\n    e2.safeOffsetX = clientX_rel;\n    e2.safeOffsetY = clientY_rel;\n    if (e2.deltaX === void 0)\n      e2.deltaX = clientX_rel - this.last_mouse_position[0];\n    if (e2.deltaY === void 0)\n      e2.deltaY = clientY_rel - this.last_mouse_position[1];\n    this.last_mouse_position[0] = clientX_rel;\n    this.last_mouse_position[1] = clientY_rel;\n    e2.canvasX = clientX_rel / this.ds.scale - this.ds.offset[0];\n    e2.canvasY = clientY_rel / this.ds.scale - this.ds.offset[1];\n  }\n  /**\n   * changes the zoom level of the graph (default is 1), you can pass also a place used to pivot the zoom\n   */\n  setZoom(value, zooming_center) {\n    this.ds.changeScale(value, zooming_center);\n    this.#dirty();\n  }\n  /**\n   * converts a coordinate from graph coordinates to canvas2D coordinates\n   */\n  convertOffsetToCanvas(pos, out) {\n    return this.ds.convertOffsetToCanvas(pos, out);\n  }\n  /**\n   * converts a coordinate from Canvas2D coordinates to graph space\n   */\n  convertCanvasToOffset(pos, out) {\n    return this.ds.convertCanvasToOffset(pos, out);\n  }\n  // converts event coordinates from canvas2D to graph coordinates\n  convertEventToCanvasOffset(e2) {\n    const rect = this.canvas.getBoundingClientRect();\n    return this.convertCanvasToOffset([\n      e2.clientX - rect.left,\n      e2.clientY - rect.top\n    ]);\n  }\n  /**\n   * brings a node to front (above all other nodes)\n   */\n  bringToFront(node2) {\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    const i = graph._nodes.indexOf(node2);\n    if (i == -1) return;\n    graph._nodes.splice(i, 1);\n    graph._nodes.push(node2);\n  }\n  /**\n   * sends a node to the back (below all other nodes)\n   */\n  sendToBack(node2) {\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    const i = graph._nodes.indexOf(node2);\n    if (i == -1) return;\n    graph._nodes.splice(i, 1);\n    graph._nodes.unshift(node2);\n  }\n  /**\n   * Determines which nodes are visible and populates {@link out} with the results.\n   * @param nodes The list of nodes to check - if falsy, all nodes in the graph will be checked\n   * @param out Array to write visible nodes into - if falsy, a new array is created instead\n   * @returns Array passed ({@link out}), or a new array containing all visible nodes\n   */\n  computeVisibleNodes(nodes, out) {\n    const visible_nodes = out || [];\n    visible_nodes.length = 0;\n    if (!this.graph) throw new NullGraphError();\n    const _nodes = nodes || this.graph._nodes;\n    for (const node2 of _nodes) {\n      node2.updateArea(this.ctx);\n      if (!overlapBounding(this.visible_area, node2.renderArea)) continue;\n      visible_nodes.push(node2);\n    }\n    return visible_nodes;\n  }\n  /**\n   * Checks if a node is visible on the canvas.\n   * @param node The node to check\n   * @returns `true` if the node is visible, otherwise `false`\n   */\n  isNodeVisible(node2) {\n    return this.#visible_node_ids.has(node2.id);\n  }\n  /**\n   * renders the whole canvas content, by rendering in two separated canvas, one containing the background grid and the connections, and one containing the nodes)\n   */\n  draw(force_canvas, force_bgcanvas) {\n    if (!this.canvas || this.canvas.width == 0 || this.canvas.height == 0) return;\n    const now = LiteGraph.getTime();\n    this.render_time = (now - this.last_draw_time) * 1e-3;\n    this.last_draw_time = now;\n    if (this.graph) this.ds.computeVisibleArea(this.viewport);\n    if (this.dirty_canvas || force_canvas) {\n      this.computeVisibleNodes(void 0, this.visible_nodes);\n      this.#visible_node_ids = new Set(this.visible_nodes.map((node2) => node2.id));\n      const { subgraph } = this;\n      if (subgraph) {\n        subgraph.inputNode.arrange();\n        subgraph.outputNode.arrange();\n      }\n    }\n    if (this.dirty_bgcanvas || force_bgcanvas || this.always_render_background || this.graph?._last_trigger_time && now - this.graph._last_trigger_time < 1e3) {\n      this.drawBackCanvas();\n    }\n    if (this.dirty_canvas || force_canvas) this.drawFrontCanvas();\n    this.fps = this.render_time ? 1 / this.render_time : 0;\n    this.frame++;\n  }\n  /**\n   * draws the front canvas (the one containing all the nodes)\n   */\n  drawFrontCanvas() {\n    this.dirty_canvas = false;\n    const { ctx, canvas: canvas2, graph, linkConnector } = this;\n    if (ctx.start2D && !this.viewport) {\n      ctx.start2D();\n      ctx.restore();\n      ctx.setTransform(1, 0, 0, 1, 0, 0);\n    }\n    const area = this.viewport || this.dirty_area;\n    if (area) {\n      ctx.save();\n      ctx.beginPath();\n      ctx.rect(area[0], area[1], area[2], area[3]);\n      ctx.clip();\n    }\n    this.#snapToGrid = this.#shiftDown || LiteGraph.alwaysSnapToGrid ? this.graph?.getSnapToGridSize() : void 0;\n    if (this.clear_background) {\n      if (area) ctx.clearRect(area[0], area[1], area[2], area[3]);\n      else ctx.clearRect(0, 0, canvas2.width, canvas2.height);\n    }\n    if (this.bgcanvas == this.canvas) {\n      this.drawBackCanvas();\n    } else {\n      const scale = window.devicePixelRatio;\n      ctx.drawImage(\n        this.bgcanvas,\n        0,\n        0,\n        this.bgcanvas.width / scale,\n        this.bgcanvas.height / scale\n      );\n    }\n    this.onRender?.(canvas2, ctx);\n    if (this.show_info) {\n      this.renderInfo(ctx, area ? area[0] : 0, area ? area[1] : 0);\n    }\n    if (graph) {\n      ctx.save();\n      this.ds.toCanvasContext(ctx);\n      const { visible_nodes } = this;\n      const drawSnapGuides = this.#snapToGrid && this.isDragging;\n      for (const node2 of visible_nodes) {\n        ctx.save();\n        if (drawSnapGuides && this.selectedItems.has(node2))\n          this.drawSnapGuide(ctx, node2);\n        ctx.translate(node2.pos[0], node2.pos[1]);\n        this.drawNode(node2, ctx);\n        ctx.restore();\n      }\n      this.subgraph?.draw(ctx, this.colourGetter, this.linkConnector.renderLinks[0]?.fromSlot, this.editor_alpha);\n      if (this.render_execution_order) {\n        this.drawExecutionOrder(ctx);\n      }\n      if (graph.config.links_ontop) {\n        this.drawConnections(ctx);\n      }\n      if (linkConnector.isConnecting) {\n        const { renderLinks } = linkConnector;\n        const highlightPos = this.#getHighlightPosition();\n        ctx.lineWidth = this.connections_width;\n        for (const renderLink of renderLinks) {\n          const { fromSlot, fromPos: pos, fromDirection, dragDirection } = renderLink;\n          const connShape = fromSlot.shape;\n          const connType = fromSlot.type;\n          const colour = connType === LiteGraph.EVENT ? LiteGraph.EVENT_LINK_COLOR : LiteGraph.CONNECTING_LINK_COLOR;\n          this.renderLink(\n            ctx,\n            pos,\n            highlightPos,\n            null,\n            false,\n            null,\n            colour,\n            fromDirection,\n            dragDirection\n          );\n          ctx.beginPath();\n          if (connType === LiteGraph.EVENT || connShape === RenderShape.BOX) {\n            ctx.rect(pos[0] - 6 + 0.5, pos[1] - 5 + 0.5, 14, 10);\n            ctx.rect(\n              highlightPos[0] - 6 + 0.5,\n              highlightPos[1] - 5 + 0.5,\n              14,\n              10\n            );\n          } else if (connShape === RenderShape.ARROW) {\n            ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n            ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n            ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n            ctx.closePath();\n          } else {\n            ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n            ctx.arc(highlightPos[0], highlightPos[1], 4, 0, Math.PI * 2);\n          }\n          ctx.fill();\n        }\n        this.#renderSnapHighlight(ctx, highlightPos);\n      }\n      if (this.dragging_rectangle) {\n        const { eDown, eMove } = this.pointer;\n        ctx.strokeStyle = \"#FFF\";\n        if (eDown && eMove) {\n          const transform = ctx.getTransform();\n          const ratio = Math.max(1, window.devicePixelRatio);\n          ctx.setTransform(ratio, 0, 0, ratio, 0, 0);\n          const x2 = eDown.safeOffsetX;\n          const y = eDown.safeOffsetY;\n          ctx.strokeRect(x2, y, eMove.safeOffsetX - x2, eMove.safeOffsetY - y);\n          ctx.setTransform(transform);\n        } else {\n          const [x2, y, w, h] = this.dragging_rectangle;\n          ctx.strokeRect(x2, y, w, h);\n        }\n      }\n      if (!this.isDragging && this.over_link_center && this.render_link_tooltip) {\n        this.drawLinkTooltip(ctx, this.over_link_center);\n      } else {\n        this.onDrawLinkTooltip?.(ctx, null);\n      }\n      this.onDrawForeground?.(ctx, this.visible_area);\n      ctx.restore();\n    }\n    this.onDrawOverlay?.(ctx);\n    if (area) ctx.restore();\n  }\n  /** @returns If the pointer is over a link centre marker, the link segment it belongs to.  Otherwise, `undefined`.  */\n  #getLinkCentreOnPos(e2) {\n    for (const linkSegment of this.renderedPaths) {\n      const centre = linkSegment._pos;\n      if (!centre) continue;\n      if (isInRectangle(e2.canvasX, e2.canvasY, centre[0] - 4, centre[1] - 4, 8, 8)) {\n        return linkSegment;\n      }\n    }\n  }\n  /** Get the target snap / highlight point in graph space */\n  #getHighlightPosition() {\n    return LiteGraph.snaps_for_comfy ? this.linkConnector.state.snapLinksPos ?? this._highlight_pos ?? this.graph_mouse : this.graph_mouse;\n  }\n  /**\n   * Renders indicators showing where a link will connect if released.\n   * Partial border over target node and a highlight over the slot itself.\n   * @param ctx Canvas 2D context\n   */\n  #renderSnapHighlight(ctx, highlightPos) {\n    const linkConnectorSnap = !!this.linkConnector.state.snapLinksPos;\n    if (!this._highlight_pos && !linkConnectorSnap) return;\n    ctx.fillStyle = \"#ffcc00\";\n    ctx.beginPath();\n    const shape = this._highlight_input?.shape;\n    if (shape === RenderShape.ARROW) {\n      ctx.moveTo(highlightPos[0] + 8, highlightPos[1] + 0.5);\n      ctx.lineTo(highlightPos[0] - 4, highlightPos[1] + 6 + 0.5);\n      ctx.lineTo(highlightPos[0] - 4, highlightPos[1] - 6 + 0.5);\n      ctx.closePath();\n    } else {\n      ctx.arc(highlightPos[0], highlightPos[1], 6, 0, Math.PI * 2);\n    }\n    ctx.fill();\n    const { linkConnector } = this;\n    const { overReroute, overWidget } = linkConnector;\n    if (!LiteGraph.snap_highlights_node || !linkConnector.isConnecting || linkConnectorSnap) return;\n    overReroute?.drawHighlight(ctx, \"#ffcc00aa\");\n    const node2 = this.node_over;\n    if (!node2) return;\n    const { strokeStyle, lineWidth } = ctx;\n    const area = node2.boundingRect;\n    const gap = 3;\n    const radius = LiteGraph.ROUND_RADIUS + gap;\n    const x2 = area[0] - gap;\n    const y = area[1] - gap;\n    const width2 = area[2] + gap * 2;\n    const height = area[3] + gap * 2;\n    ctx.beginPath();\n    ctx.roundRect(x2, y, width2, height, radius);\n    const start = linkConnector.state.connectingTo === \"output\" ? 0 : 1;\n    const inverter = start ? -1 : 1;\n    const hx = highlightPos[0];\n    const hy = highlightPos[1];\n    const gRadius = width2 < height ? width2 : width2 * Math.max(height / width2, 0.5);\n    const gradient = ctx.createRadialGradient(hx, hy, 0, hx, hy, gRadius);\n    gradient.addColorStop(1, \"#00000000\");\n    gradient.addColorStop(0, \"#ffcc00aa\");\n    const linearGradient = ctx.createLinearGradient(x2, y, x2 + width2, y);\n    linearGradient.addColorStop(0.5, \"#00000000\");\n    linearGradient.addColorStop(start + 0.67 * inverter, \"#ddeeff33\");\n    linearGradient.addColorStop(start + inverter, \"#ffcc0055\");\n    ctx.setLineDash([radius, radius * 1e-3]);\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = linearGradient;\n    ctx.stroke();\n    if (overWidget) {\n      const { computedHeight } = overWidget;\n      ctx.beginPath();\n      const { pos: [nodeX, nodeY] } = node2;\n      const height2 = LiteGraph.NODE_WIDGET_HEIGHT;\n      if (overWidget.type.startsWith(\"custom\") && computedHeight != null && computedHeight > height2 * 2) {\n        ctx.rect(\n          nodeX + 9,\n          nodeY + overWidget.y + 9,\n          (overWidget.width ?? area[2]) - 18,\n          computedHeight - 18\n        );\n      } else {\n        ctx.roundRect(\n          nodeX + BaseWidget.margin,\n          nodeY + overWidget.y,\n          overWidget.width ?? area[2],\n          height2,\n          height2 * 0.5\n        );\n      }\n      ctx.stroke();\n    }\n    ctx.strokeStyle = gradient;\n    ctx.stroke();\n    ctx.setLineDash([]);\n    ctx.lineWidth = lineWidth;\n    ctx.strokeStyle = strokeStyle;\n  }\n  /**\n   * draws some useful stats in the corner of the canvas\n   */\n  renderInfo(ctx, x2, y) {\n    x2 = x2 || 10;\n    y = y || this.canvas.offsetHeight - 80;\n    ctx.save();\n    ctx.translate(x2, y);\n    ctx.font = `10px ${LiteGraph.DEFAULT_FONT}`;\n    ctx.fillStyle = \"#888\";\n    ctx.textAlign = \"left\";\n    if (this.graph) {\n      ctx.fillText(`T: ${this.graph.globaltime.toFixed(2)}s`, 5, 13 * 1);\n      ctx.fillText(`I: ${this.graph.iteration}`, 5, 13 * 2);\n      ctx.fillText(`N: ${this.graph._nodes.length} [${this.visible_nodes.length}]`, 5, 13 * 3);\n      ctx.fillText(`V: ${this.graph._version}`, 5, 13 * 4);\n      ctx.fillText(`FPS:${this.fps.toFixed(2)}`, 5, 13 * 5);\n    } else {\n      ctx.fillText(\"No graph selected\", 5, 13 * 1);\n    }\n    ctx.restore();\n  }\n  /**\n   * draws the back canvas (the one containing the background and the connections)\n   */\n  drawBackCanvas() {\n    const canvas2 = this.bgcanvas;\n    if (canvas2.width != this.canvas.width || canvas2.height != this.canvas.height) {\n      canvas2.width = this.canvas.width;\n      canvas2.height = this.canvas.height;\n    }\n    if (!this.bgctx) {\n      this.bgctx = this.bgcanvas.getContext(\"2d\");\n    }\n    const ctx = this.bgctx;\n    if (!ctx) throw new TypeError(\"Background canvas context was null.\");\n    const viewport = this.viewport || [0, 0, ctx.canvas.width, ctx.canvas.height];\n    if (this.clear_background) {\n      ctx.clearRect(viewport[0], viewport[1], viewport[2], viewport[3]);\n    }\n    const bg_already_painted = this.onRenderBackground ? this.onRenderBackground(canvas2, ctx) : false;\n    if (!this.viewport) {\n      const scale = window.devicePixelRatio;\n      ctx.restore();\n      ctx.setTransform(scale, 0, 0, scale, 0, 0);\n    }\n    if (this.graph) {\n      ctx.save();\n      this.ds.toCanvasContext(ctx);\n      if (this.ds.scale < 1.5 && !bg_already_painted && this.clear_background_color) {\n        ctx.fillStyle = this.clear_background_color;\n        ctx.fillRect(\n          this.visible_area[0],\n          this.visible_area[1],\n          this.visible_area[2],\n          this.visible_area[3]\n        );\n      }\n      if (this.background_image && this.ds.scale > 0.5 && !bg_already_painted) {\n        if (this.zoom_modify_alpha) {\n          ctx.globalAlpha = (1 - 0.5 / this.ds.scale) * this.editor_alpha;\n        } else {\n          ctx.globalAlpha = this.editor_alpha;\n        }\n        ctx.imageSmoothingEnabled = false;\n        if (!this._bg_img || this._bg_img.name != this.background_image) {\n          this._bg_img = new Image();\n          this._bg_img.name = this.background_image;\n          this._bg_img.src = this.background_image;\n          const that = this;\n          this._bg_img.addEventListener(\"load\", function() {\n            that.draw(true, true);\n          });\n        }\n        let pattern = this._pattern;\n        if (pattern == null && this._bg_img.width > 0) {\n          pattern = ctx.createPattern(this._bg_img, \"repeat\") ?? void 0;\n          this._pattern_img = this._bg_img;\n          this._pattern = pattern;\n        }\n        if (pattern) {\n          ctx.fillStyle = pattern;\n          ctx.fillRect(\n            this.visible_area[0],\n            this.visible_area[1],\n            this.visible_area[2],\n            this.visible_area[3]\n          );\n          ctx.fillStyle = \"transparent\";\n        }\n        ctx.globalAlpha = 1;\n        ctx.imageSmoothingEnabled = true;\n      }\n      if (this.graph._groups.length) {\n        this.drawGroups(canvas2, ctx);\n      }\n      this.onDrawBackground?.(ctx, this.visible_area);\n      if (this.render_canvas_border) {\n        ctx.strokeStyle = \"#235\";\n        ctx.strokeRect(0, 0, canvas2.width, canvas2.height);\n      }\n      if (this.render_connections_shadows) {\n        ctx.shadowColor = \"#000\";\n        ctx.shadowOffsetX = 0;\n        ctx.shadowOffsetY = 0;\n        ctx.shadowBlur = 6;\n      } else {\n        ctx.shadowColor = \"rgba(0,0,0,0)\";\n      }\n      this.drawConnections(ctx);\n      ctx.shadowColor = \"rgba(0,0,0,0)\";\n      ctx.restore();\n    }\n    this.dirty_bgcanvas = false;\n    this.dirty_canvas = true;\n  }\n  /**\n   * draws the given node inside the canvas\n   */\n  drawNode(node2, ctx) {\n    this.current_node = node2;\n    const color = node2.renderingColor;\n    const bgcolor = node2.renderingBgColor;\n    const { low_quality, editor_alpha } = this;\n    ctx.globalAlpha = editor_alpha;\n    if (this.render_shadows && !low_quality) {\n      ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n      ctx.shadowOffsetX = 2 * this.ds.scale;\n      ctx.shadowOffsetY = 2 * this.ds.scale;\n      ctx.shadowBlur = 3 * this.ds.scale;\n    } else {\n      ctx.shadowColor = \"transparent\";\n    }\n    if (node2.flags.collapsed && node2.onDrawCollapsed?.(ctx, this) == true)\n      return;\n    const shape = node2._shape || RenderShape.BOX;\n    const size = LGraphCanvas.#temp_vec2;\n    size.set(node2.renderingSize);\n    if (node2.collapsed) {\n      ctx.font = this.inner_text_font;\n    }\n    if (node2.clip_area) {\n      ctx.save();\n      ctx.beginPath();\n      if (shape == RenderShape.BOX) {\n        ctx.rect(0, 0, size[0], size[1]);\n      } else if (shape == RenderShape.ROUND) {\n        ctx.roundRect(0, 0, size[0], size[1], [10]);\n      } else if (shape == RenderShape.CIRCLE) {\n        ctx.arc(size[0] * 0.5, size[1] * 0.5, size[0] * 0.5, 0, Math.PI * 2);\n      }\n      ctx.clip();\n    }\n    this.drawNodeShape(\n      node2,\n      ctx,\n      size,\n      color,\n      bgcolor,\n      !!node2.selected\n    );\n    if (node2.title_buttons && !node2.flags.collapsed) {\n      const title_height = LiteGraph.NODE_TITLE_HEIGHT;\n      let current_x = size[0];\n      for (let i = 0; i < node2.title_buttons.length; i++) {\n        const button = node2.title_buttons[i];\n        if (!button.visible) {\n          continue;\n        }\n        const button_width = button.getWidth(ctx);\n        current_x -= button_width;\n        const button_y = -title_height + (title_height - button.height) / 2;\n        button.draw(ctx, current_x, button_y);\n        current_x -= 2;\n      }\n    }\n    if (!low_quality) {\n      node2.drawBadges(ctx);\n    }\n    ctx.shadowColor = \"transparent\";\n    ctx.strokeStyle = LiteGraph.NODE_BOX_OUTLINE_COLOR;\n    node2.onDrawForeground?.(ctx, this, this.canvas);\n    ctx.font = this.inner_text_font;\n    node2._setConcreteSlots();\n    if (!node2.collapsed) {\n      node2.arrange();\n      node2.drawSlots(ctx, {\n        fromSlot: this.linkConnector.renderLinks[0]?.fromSlot,\n        colorContext: this.colourGetter,\n        editorAlpha: this.editor_alpha,\n        lowQuality: this.low_quality\n      });\n      ctx.textAlign = \"left\";\n      ctx.globalAlpha = 1;\n      this.drawNodeWidgets(node2, null, ctx);\n    } else if (this.render_collapsed_slots) {\n      node2.drawCollapsedSlots(ctx);\n    }\n    if (node2.clip_area) {\n      ctx.restore();\n    }\n    ctx.globalAlpha = 1;\n  }\n  /**\n   * Draws the link mouseover effect and tooltip.\n   * @param ctx Canvas 2D context to draw on\n   * @param link The link to render the mouseover effect for\n   * @remarks\n   * Called against {@link LGraphCanvas.over_link_center}.\n   * @todo Split tooltip from hover, so it can be drawn / eased separately\n   */\n  drawLinkTooltip(ctx, link) {\n    const pos = link._pos;\n    ctx.fillStyle = \"black\";\n    ctx.beginPath();\n    if (this.linkMarkerShape === LinkMarkerShape.Arrow) {\n      const transform = ctx.getTransform();\n      ctx.translate(pos[0], pos[1]);\n      if (Number.isFinite(link._centreAngle)) ctx.rotate(link._centreAngle);\n      ctx.moveTo(-2, -3);\n      ctx.lineTo(4, 0);\n      ctx.lineTo(-2, 3);\n      ctx.setTransform(transform);\n    } else if (this.linkMarkerShape == null || this.linkMarkerShape === LinkMarkerShape.Circle) {\n      ctx.arc(pos[0], pos[1], 3, 0, Math.PI * 2);\n    }\n    ctx.fill();\n    const { data } = link;\n    if (data == null) return;\n    if (this.onDrawLinkTooltip?.(ctx, link, this) == true) return;\n    let text = null;\n    if (typeof data === \"number\")\n      text = data.toFixed(2);\n    else if (typeof data === \"string\")\n      text = `\"${data}\"`;\n    else if (typeof data === \"boolean\")\n      text = String(data);\n    else if (data.toToolTip)\n      text = data.toToolTip();\n    else\n      text = `[${data.constructor.name}]`;\n    if (text == null) return;\n    text = text.substring(0, 30);\n    ctx.font = \"14px Courier New\";\n    const info = ctx.measureText(text);\n    const w = info.width + 20;\n    const h = 24;\n    ctx.shadowColor = \"black\";\n    ctx.shadowOffsetX = 2;\n    ctx.shadowOffsetY = 2;\n    ctx.shadowBlur = 3;\n    ctx.fillStyle = \"#454\";\n    ctx.beginPath();\n    ctx.roundRect(pos[0] - w * 0.5, pos[1] - 15 - h, w, h, [3]);\n    ctx.moveTo(pos[0] - 10, pos[1] - 15);\n    ctx.lineTo(pos[0] + 10, pos[1] - 15);\n    ctx.lineTo(pos[0], pos[1] - 5);\n    ctx.fill();\n    ctx.shadowColor = \"transparent\";\n    ctx.textAlign = \"center\";\n    ctx.fillStyle = \"#CEC\";\n    ctx.fillText(text, pos[0], pos[1] - 15 - h * 0.3);\n  }\n  /**\n   * Draws the shape of the given node on the canvas\n   * @param node The node to draw\n   * @param ctx 2D canvas rendering context used to draw\n   * @param size Size of the background to draw, in graph units.  Differs from node size if collapsed, etc.\n   * @param fgcolor Foreground colour - used for text\n   * @param bgcolor Background colour of the node\n   * @param _selected Whether to render the node as selected.  Likely to be removed in future, as current usage is simply the selected property of the node.\n   */\n  drawNodeShape(node2, ctx, size, fgcolor, bgcolor, _selected) {\n    ctx.strokeStyle = fgcolor;\n    ctx.fillStyle = bgcolor;\n    const title_height = LiteGraph.NODE_TITLE_HEIGHT;\n    const { low_quality } = this;\n    const { collapsed } = node2.flags;\n    const shape = node2.renderingShape;\n    const { title_mode } = node2;\n    const render_title = title_mode == TitleMode.TRANSPARENT_TITLE || title_mode == TitleMode.NO_TITLE ? false : true;\n    const area = LGraphCanvas.#tmp_area;\n    area.set(node2.boundingRect);\n    area[0] -= node2.pos[0];\n    area[1] -= node2.pos[1];\n    const old_alpha = ctx.globalAlpha;\n    ctx.beginPath();\n    if (shape == RenderShape.BOX || low_quality) {\n      ctx.rect(area[0], area[1], area[2], area[3]);\n    } else if (shape == RenderShape.ROUND || shape == RenderShape.CARD) {\n      ctx.roundRect(\n        area[0],\n        area[1],\n        area[2],\n        area[3],\n        shape == RenderShape.CARD ? [LiteGraph.ROUND_RADIUS, LiteGraph.ROUND_RADIUS, 0, 0] : [LiteGraph.ROUND_RADIUS]\n      );\n    } else if (shape == RenderShape.CIRCLE) {\n      ctx.arc(size[0] * 0.5, size[1] * 0.5, size[0] * 0.5, 0, Math.PI * 2);\n    }\n    ctx.fill();\n    if (!collapsed && render_title) {\n      ctx.shadowColor = \"transparent\";\n      ctx.fillStyle = \"rgba(0,0,0,0.2)\";\n      ctx.fillRect(0, -1, area[2], 2);\n    }\n    ctx.shadowColor = \"transparent\";\n    node2.onDrawBackground?.(ctx);\n    if (render_title || title_mode == TitleMode.TRANSPARENT_TITLE) {\n      node2.drawTitleBarBackground(ctx, {\n        scale: this.ds.scale,\n        low_quality\n      });\n      node2.drawTitleBox(ctx, {\n        scale: this.ds.scale,\n        low_quality,\n        box_size: 10\n      });\n      ctx.globalAlpha = old_alpha;\n      node2.drawTitleText(ctx, {\n        scale: this.ds.scale,\n        default_title_color: this.node_title_color,\n        low_quality\n      });\n      node2.onDrawTitle?.(ctx);\n    }\n    for (const getStyle of Object.values(node2.strokeStyles)) {\n      const strokeStyle = getStyle.call(node2);\n      if (strokeStyle) {\n        strokeShape(ctx, area, {\n          shape,\n          title_height,\n          title_mode,\n          collapsed,\n          ...strokeStyle\n        });\n      }\n    }\n    node2.drawProgressBar(ctx);\n    if (node2.execute_triggered != null && node2.execute_triggered > 0) node2.execute_triggered--;\n    if (node2.action_triggered != null && node2.action_triggered > 0) node2.action_triggered--;\n  }\n  /**\n   * Draws a snap guide for a {@link Positionable} item.\n   *\n   * Initial design was a simple white rectangle representing the location the\n   * item would land if dropped.\n   * @param ctx The 2D canvas context to draw on\n   * @param item The item to draw a snap guide for\n   * @param shape The shape of the snap guide to draw\n   * @todo Update to align snapping with boundingRect\n   * @todo Shapes\n   */\n  drawSnapGuide(ctx, item, shape = RenderShape.ROUND) {\n    const snapGuide = LGraphCanvas.#temp;\n    snapGuide.set(item.boundingRect);\n    const { pos } = item;\n    const offsetX = pos[0] - snapGuide[0];\n    const offsetY = pos[1] - snapGuide[1];\n    snapGuide[0] += offsetX;\n    snapGuide[1] += offsetY;\n    if (this.#snapToGrid) snapPoint(snapGuide, this.#snapToGrid);\n    snapGuide[0] -= offsetX;\n    snapGuide[1] -= offsetY;\n    const { globalAlpha } = ctx;\n    ctx.globalAlpha = 1;\n    ctx.beginPath();\n    const [x2, y, w, h] = snapGuide;\n    if (shape === RenderShape.CIRCLE) {\n      const midX = x2 + w * 0.5;\n      const midY = y + h * 0.5;\n      const radius = Math.min(w * 0.5, h * 0.5);\n      ctx.arc(midX, midY, radius, 0, Math.PI * 2);\n    } else {\n      ctx.rect(x2, y, w, h);\n    }\n    ctx.lineWidth = 0.5;\n    ctx.strokeStyle = \"#FFFFFF66\";\n    ctx.fillStyle = \"#FFFFFF22\";\n    ctx.fill();\n    ctx.stroke();\n    ctx.globalAlpha = globalAlpha;\n  }\n  drawConnections(ctx) {\n    this.renderedPaths.clear();\n    if (this.links_render_mode === LinkRenderType.HIDDEN_LINK) return;\n    const { graph, subgraph } = this;\n    if (!graph) throw new NullGraphError();\n    const visibleReroutes = [];\n    const now = LiteGraph.getTime();\n    const { visible_area } = this;\n    LGraphCanvas.#margin_area[0] = visible_area[0] - 20;\n    LGraphCanvas.#margin_area[1] = visible_area[1] - 20;\n    LGraphCanvas.#margin_area[2] = visible_area[2] + 40;\n    LGraphCanvas.#margin_area[3] = visible_area[3] + 40;\n    ctx.lineWidth = this.connections_width;\n    ctx.fillStyle = \"#AAA\";\n    ctx.strokeStyle = \"#AAA\";\n    ctx.globalAlpha = this.editor_alpha;\n    const nodes = graph._nodes;\n    for (const node2 of nodes) {\n      const { inputs } = node2;\n      if (!inputs?.length) continue;\n      for (const [i, input] of inputs.entries()) {\n        if (!input || input.link == null) continue;\n        const link_id = input.link;\n        const link = graph._links.get(link_id);\n        if (!link) continue;\n        const endPos = node2.getInputPos(i);\n        const start_node = graph.getNodeById(link.origin_id);\n        if (start_node == null) continue;\n        const outputId = link.origin_slot;\n        const startPos = outputId === -1 ? [start_node.pos[0] + 10, start_node.pos[1] + 10] : start_node.getOutputPos(outputId);\n        const output = start_node.outputs[outputId];\n        if (!output) continue;\n        this.#renderAllLinkSegments(ctx, link, startPos, endPos, visibleReroutes, now, output.dir, input.dir);\n      }\n    }\n    if (subgraph) {\n      for (const output of subgraph.inputNode.slots) {\n        if (!output.linkIds.length) continue;\n        for (const linkId of output.linkIds) {\n          const resolved = LLink.resolve(linkId, graph);\n          if (!resolved) continue;\n          const { link, inputNode, input } = resolved;\n          if (!inputNode || !input) continue;\n          const endPos = inputNode.getInputPos(link.target_slot);\n          this.#renderAllLinkSegments(ctx, link, output.pos, endPos, visibleReroutes, now, input.dir, input.dir);\n        }\n      }\n      for (const input of subgraph.outputNode.slots) {\n        if (!input.linkIds.length) continue;\n        const resolved = LLink.resolve(input.linkIds[0], graph);\n        if (!resolved) continue;\n        const { link, outputNode, output } = resolved;\n        if (!outputNode || !output) continue;\n        const startPos = outputNode.getOutputPos(link.origin_slot);\n        this.#renderAllLinkSegments(ctx, link, startPos, input.pos, visibleReroutes, now, output.dir, input.dir);\n      }\n    }\n    if (graph.floatingLinks.size > 0) {\n      this.#renderFloatingLinks(ctx, graph, visibleReroutes, now);\n    }\n    const rerouteSet = this.#visibleReroutes;\n    rerouteSet.clear();\n    visibleReroutes.sort((a, b) => a.linkIds.size - b.linkIds.size);\n    for (const reroute of visibleReroutes) {\n      rerouteSet.add(reroute);\n      if (this.#snapToGrid && this.isDragging && this.selectedItems.has(reroute)) {\n        this.drawSnapGuide(ctx, reroute, RenderShape.CIRCLE);\n      }\n      reroute.draw(ctx, this._pattern);\n      if (!this.pointer.isDown) reroute.drawSlots(ctx);\n    }\n    ctx.globalAlpha = 1;\n  }\n  #renderFloatingLinks(ctx, graph, visibleReroutes, now) {\n    const { globalAlpha } = ctx;\n    ctx.globalAlpha = globalAlpha * 0.33;\n    for (const link of graph.floatingLinks.values()) {\n      const reroutes = LLink.getReroutes(graph, link);\n      const firstReroute = reroutes[0];\n      const reroute = reroutes.at(-1);\n      if (!firstReroute || !reroute?.floating) continue;\n      if (reroute.floating.slotType === \"input\") {\n        const node2 = graph.getNodeById(link.target_id);\n        if (!node2) continue;\n        const startPos = firstReroute.pos;\n        const endPos = node2.getInputPos(link.target_slot);\n        const endDirection = node2.inputs[link.target_slot]?.dir;\n        firstReroute._dragging = true;\n        this.#renderAllLinkSegments(ctx, link, startPos, endPos, visibleReroutes, now, LinkDirection.CENTER, endDirection, true);\n      } else {\n        const node2 = graph.getNodeById(link.origin_id);\n        if (!node2) continue;\n        const startPos = node2.getOutputPos(link.origin_slot);\n        const endPos = reroute.pos;\n        const startDirection = node2.outputs[link.origin_slot]?.dir;\n        link._dragging = true;\n        this.#renderAllLinkSegments(ctx, link, startPos, endPos, visibleReroutes, now, startDirection, LinkDirection.CENTER, true);\n      }\n    }\n    ctx.globalAlpha = globalAlpha;\n  }\n  #renderAllLinkSegments(ctx, link, startPos, endPos, visibleReroutes, now, startDirection, endDirection, disabled = false) {\n    const { graph, renderedPaths } = this;\n    if (!graph) return;\n    const reroutes = LLink.getReroutes(graph, link);\n    const points = [\n      startPos,\n      ...reroutes.map((x2) => x2.pos),\n      endPos\n    ];\n    const pointsX = points.map((x2) => x2[0]);\n    const pointsY = points.map((x2) => x2[1]);\n    LGraphCanvas.#link_bounding[0] = Math.min(...pointsX);\n    LGraphCanvas.#link_bounding[1] = Math.min(...pointsY);\n    LGraphCanvas.#link_bounding[2] = Math.max(...pointsX) - LGraphCanvas.#link_bounding[0];\n    LGraphCanvas.#link_bounding[3] = Math.max(...pointsY) - LGraphCanvas.#link_bounding[1];\n    if (!overlapBounding(LGraphCanvas.#link_bounding, LGraphCanvas.#margin_area))\n      return;\n    const start_dir = startDirection || LinkDirection.RIGHT;\n    const end_dir = endDirection || LinkDirection.LEFT;\n    if (reroutes.length) {\n      let startControl;\n      const l = reroutes.length;\n      for (let j = 0; j < l; j++) {\n        const reroute = reroutes[j];\n        if (!renderedPaths.has(reroute)) {\n          renderedPaths.add(reroute);\n          visibleReroutes.push(reroute);\n          reroute._colour = link.color || LGraphCanvas.link_type_colors[link.type] || this.default_link_color;\n          const prevReroute = graph.getReroute(reroute.parentId);\n          const rerouteStartPos = prevReroute?.pos ?? startPos;\n          reroute.calculateAngle(this.last_draw_time, graph, rerouteStartPos);\n          if (!reroute._dragging) {\n            this.renderLink(\n              ctx,\n              rerouteStartPos,\n              reroute.pos,\n              link,\n              false,\n              0,\n              null,\n              startControl === void 0 ? start_dir : LinkDirection.CENTER,\n              LinkDirection.CENTER,\n              {\n                startControl,\n                endControl: reroute.controlPoint,\n                reroute,\n                disabled\n              }\n            );\n          }\n        }\n        if (!startControl && reroutes.at(-1)?.floating?.slotType === \"input\") {\n          startControl = [0, 0];\n        } else {\n          const nextPos = reroutes[j + 1]?.pos ?? endPos;\n          const dist = Math.min(Reroute.maxSplineOffset, distance(reroute.pos, nextPos) * 0.25);\n          startControl = [dist * reroute.cos, dist * reroute.sin];\n        }\n      }\n      if (link._dragging) return;\n      const segmentStartPos = points.at(-2) ?? startPos;\n      this.renderLink(\n        ctx,\n        segmentStartPos,\n        endPos,\n        link,\n        false,\n        0,\n        null,\n        LinkDirection.CENTER,\n        end_dir,\n        { startControl, disabled }\n      );\n    } else if (!link._dragging) {\n      this.renderLink(\n        ctx,\n        startPos,\n        endPos,\n        link,\n        false,\n        0,\n        null,\n        start_dir,\n        end_dir\n      );\n    }\n    renderedPaths.add(link);\n    if (link?._last_time && now - link._last_time < 1e3) {\n      const f = 2 - (now - link._last_time) * 2e-3;\n      const tmp = ctx.globalAlpha;\n      ctx.globalAlpha = tmp * f;\n      this.renderLink(\n        ctx,\n        startPos,\n        endPos,\n        link,\n        true,\n        f,\n        \"white\",\n        start_dir,\n        end_dir\n      );\n      ctx.globalAlpha = tmp;\n    }\n  }\n  /**\n   * draws a link between two points\n   * @param ctx Canvas 2D rendering context\n   * @param a start pos\n   * @param b end pos\n   * @param link the link object with all the link info\n   * @param skip_border ignore the shadow of the link\n   * @param flow show flow animation (for events)\n   * @param color the color for the link\n   * @param start_dir the direction enum\n   * @param end_dir the direction enum\n   */\n  renderLink(ctx, a, b, link, skip_border, flow, color, start_dir, end_dir, {\n    startControl,\n    endControl,\n    reroute,\n    num_sublines = 1,\n    disabled = false\n  } = {}) {\n    const linkColour = link != null && this.highlighted_links[link.id] ? \"#FFF\" : color || link?.color || link?.type != null && LGraphCanvas.link_type_colors[link.type] || this.default_link_color;\n    const startDir = start_dir || LinkDirection.RIGHT;\n    const endDir = end_dir || LinkDirection.LEFT;\n    const dist = this.links_render_mode == LinkRenderType.SPLINE_LINK && (!endControl || !startControl) ? distance(a, b) : 0;\n    if (this.render_connections_border && !this.low_quality) {\n      ctx.lineWidth = this.connections_width + 4;\n    }\n    ctx.lineJoin = \"round\";\n    num_sublines ||= 1;\n    if (num_sublines > 1) ctx.lineWidth = 0.5;\n    const path = new Path2D();\n    const linkSegment = reroute ?? link;\n    if (linkSegment) linkSegment.path = path;\n    const innerA = LGraphCanvas.#lTempA;\n    const innerB = LGraphCanvas.#lTempB;\n    const pos = linkSegment?._pos ?? [0, 0];\n    for (let i = 0; i < num_sublines; i++) {\n      const offsety = (i - (num_sublines - 1) * 0.5) * 5;\n      innerA[0] = a[0];\n      innerA[1] = a[1];\n      innerB[0] = b[0];\n      innerB[1] = b[1];\n      if (this.links_render_mode == LinkRenderType.SPLINE_LINK) {\n        if (endControl) {\n          innerB[0] = b[0] + endControl[0];\n          innerB[1] = b[1] + endControl[1];\n        } else {\n          this.#addSplineOffset(innerB, endDir, dist);\n        }\n        if (startControl) {\n          innerA[0] = a[0] + startControl[0];\n          innerA[1] = a[1] + startControl[1];\n        } else {\n          this.#addSplineOffset(innerA, startDir, dist);\n        }\n        path.moveTo(a[0], a[1] + offsety);\n        path.bezierCurveTo(\n          innerA[0],\n          innerA[1] + offsety,\n          innerB[0],\n          innerB[1] + offsety,\n          b[0],\n          b[1] + offsety\n        );\n        findPointOnCurve(pos, a, b, innerA, innerB, 0.5);\n        if (linkSegment && this.linkMarkerShape === LinkMarkerShape.Arrow) {\n          const justPastCentre = LGraphCanvas.#lTempC;\n          findPointOnCurve(justPastCentre, a, b, innerA, innerB, 0.51);\n          linkSegment._centreAngle = Math.atan2(\n            justPastCentre[1] - pos[1],\n            justPastCentre[0] - pos[0]\n          );\n        }\n      } else {\n        const l = this.links_render_mode == LinkRenderType.LINEAR_LINK ? 15 : 10;\n        switch (startDir) {\n          case LinkDirection.LEFT:\n            innerA[0] += -l;\n            break;\n          case LinkDirection.RIGHT:\n            innerA[0] += l;\n            break;\n          case LinkDirection.UP:\n            innerA[1] += -l;\n            break;\n          case LinkDirection.DOWN:\n            innerA[1] += l;\n            break;\n        }\n        switch (endDir) {\n          case LinkDirection.LEFT:\n            innerB[0] += -l;\n            break;\n          case LinkDirection.RIGHT:\n            innerB[0] += l;\n            break;\n          case LinkDirection.UP:\n            innerB[1] += -l;\n            break;\n          case LinkDirection.DOWN:\n            innerB[1] += l;\n            break;\n        }\n        if (this.links_render_mode == LinkRenderType.LINEAR_LINK) {\n          path.moveTo(a[0], a[1] + offsety);\n          path.lineTo(innerA[0], innerA[1] + offsety);\n          path.lineTo(innerB[0], innerB[1] + offsety);\n          path.lineTo(b[0], b[1] + offsety);\n          pos[0] = (innerA[0] + innerB[0]) * 0.5;\n          pos[1] = (innerA[1] + innerB[1]) * 0.5;\n          if (linkSegment && this.linkMarkerShape === LinkMarkerShape.Arrow) {\n            linkSegment._centreAngle = Math.atan2(\n              innerB[1] - innerA[1],\n              innerB[0] - innerA[0]\n            );\n          }\n        } else if (this.links_render_mode == LinkRenderType.STRAIGHT_LINK) {\n          const midX = (innerA[0] + innerB[0]) * 0.5;\n          path.moveTo(a[0], a[1]);\n          path.lineTo(innerA[0], innerA[1]);\n          path.lineTo(midX, innerA[1]);\n          path.lineTo(midX, innerB[1]);\n          path.lineTo(innerB[0], innerB[1]);\n          path.lineTo(b[0], b[1]);\n          pos[0] = midX;\n          pos[1] = (innerA[1] + innerB[1]) * 0.5;\n          if (linkSegment && this.linkMarkerShape === LinkMarkerShape.Arrow) {\n            const diff = innerB[1] - innerA[1];\n            if (Math.abs(diff) < 4) linkSegment._centreAngle = 0;\n            else if (diff > 0) linkSegment._centreAngle = Math.PI * 0.5;\n            else linkSegment._centreAngle = -(Math.PI * 0.5);\n          }\n        } else {\n          return;\n        }\n      }\n    }\n    if (this.render_connections_border && !this.low_quality && !skip_border) {\n      ctx.strokeStyle = \"rgba(0,0,0,0.5)\";\n      ctx.stroke(path);\n    }\n    ctx.lineWidth = this.connections_width;\n    ctx.fillStyle = ctx.strokeStyle = linkColour;\n    ctx.stroke(path);\n    if (this.ds.scale >= 0.6 && this.highquality_render && linkSegment) {\n      if (this.render_connection_arrows) {\n        const posA = this.computeConnectionPoint(a, b, 0.25, startDir, endDir);\n        const posB = this.computeConnectionPoint(a, b, 0.26, startDir, endDir);\n        const posC = this.computeConnectionPoint(a, b, 0.75, startDir, endDir);\n        const posD = this.computeConnectionPoint(a, b, 0.76, startDir, endDir);\n        let angleA = 0;\n        let angleB = 0;\n        if (this.render_curved_connections) {\n          angleA = -Math.atan2(posB[0] - posA[0], posB[1] - posA[1]);\n          angleB = -Math.atan2(posD[0] - posC[0], posD[1] - posC[1]);\n        } else {\n          angleB = angleA = b[1] > a[1] ? 0 : Math.PI;\n        }\n        const transform = ctx.getTransform();\n        ctx.translate(posA[0], posA[1]);\n        ctx.rotate(angleA);\n        ctx.beginPath();\n        ctx.moveTo(-5, -3);\n        ctx.lineTo(0, 7);\n        ctx.lineTo(5, -3);\n        ctx.fill();\n        ctx.setTransform(transform);\n        ctx.translate(posC[0], posC[1]);\n        ctx.rotate(angleB);\n        ctx.beginPath();\n        ctx.moveTo(-5, -3);\n        ctx.lineTo(0, 7);\n        ctx.lineTo(5, -3);\n        ctx.fill();\n        ctx.setTransform(transform);\n      }\n      ctx.beginPath();\n      if (this.linkMarkerShape === LinkMarkerShape.Arrow) {\n        const transform = ctx.getTransform();\n        ctx.translate(pos[0], pos[1]);\n        if (linkSegment._centreAngle) ctx.rotate(linkSegment._centreAngle);\n        ctx.moveTo(-3.2, -5);\n        ctx.lineTo(7, 0);\n        ctx.lineTo(-3.2, 5);\n        ctx.setTransform(transform);\n      } else if (this.linkMarkerShape == null || this.linkMarkerShape === LinkMarkerShape.Circle) {\n        ctx.arc(pos[0], pos[1], 5, 0, Math.PI * 2);\n      }\n      if (disabled) {\n        const { fillStyle, globalAlpha } = ctx;\n        ctx.fillStyle = this._pattern ?? \"#797979\";\n        ctx.globalAlpha = 0.75;\n        ctx.fill();\n        ctx.globalAlpha = globalAlpha;\n        ctx.fillStyle = fillStyle;\n      }\n      ctx.fill();\n      if (LLink._drawDebug) {\n        const { fillStyle, font, globalAlpha, lineWidth, strokeStyle } = ctx;\n        ctx.globalAlpha = 1;\n        ctx.lineWidth = 4;\n        ctx.fillStyle = \"white\";\n        ctx.strokeStyle = \"black\";\n        ctx.font = \"16px Arial\";\n        const text = String(linkSegment.id);\n        const { width: width2, actualBoundingBoxAscent } = ctx.measureText(text);\n        const x2 = pos[0] - width2 * 0.5;\n        const y = pos[1] + actualBoundingBoxAscent * 0.5;\n        ctx.strokeText(text, x2, y);\n        ctx.fillText(text, x2, y);\n        ctx.font = font;\n        ctx.globalAlpha = globalAlpha;\n        ctx.lineWidth = lineWidth;\n        ctx.fillStyle = fillStyle;\n        ctx.strokeStyle = strokeStyle;\n      }\n    }\n    if (flow) {\n      ctx.fillStyle = linkColour;\n      for (let i = 0; i < 5; ++i) {\n        const f = (LiteGraph.getTime() * 1e-3 + i * 0.2) % 1;\n        const flowPos = this.computeConnectionPoint(a, b, f, startDir, endDir);\n        ctx.beginPath();\n        ctx.arc(flowPos[0], flowPos[1], 5, 0, 2 * Math.PI);\n        ctx.fill();\n      }\n    }\n  }\n  /**\n   * Finds a point along a spline represented by a to b, with spline endpoint directions dictacted by start_dir and end_dir.\n   * @param a Start point\n   * @param b End point\n   * @param t Time: distance between points (e.g 0.25 is 25% along the line)\n   * @param start_dir Spline start direction\n   * @param end_dir Spline end direction\n   * @returns The point at {@link t} distance along the spline a-b.\n   */\n  computeConnectionPoint(a, b, t, start_dir, end_dir) {\n    start_dir ||= LinkDirection.RIGHT;\n    end_dir ||= LinkDirection.LEFT;\n    const dist = distance(a, b);\n    const pa = [a[0], a[1]];\n    const pb = [b[0], b[1]];\n    this.#addSplineOffset(pa, start_dir, dist);\n    this.#addSplineOffset(pb, end_dir, dist);\n    const c1 = (1 - t) * (1 - t) * (1 - t);\n    const c2 = 3 * ((1 - t) * (1 - t)) * t;\n    const c3 = 3 * (1 - t) * (t * t);\n    const c4 = t * t * t;\n    const x2 = c1 * a[0] + c2 * pa[0] + c3 * pb[0] + c4 * b[0];\n    const y = c1 * a[1] + c2 * pa[1] + c3 * pb[1] + c4 * b[1];\n    return [x2, y];\n  }\n  /**\n   * Modifies an existing point, adding a single-axis offset.\n   * @param point The point to add the offset to\n   * @param direction The direction to add the offset in\n   * @param dist Distance to offset\n   * @param factor Distance is mulitplied by this value.  Default: 0.25\n   */\n  #addSplineOffset(point, direction, dist, factor = 0.25) {\n    switch (direction) {\n      case LinkDirection.LEFT:\n        point[0] += dist * -factor;\n        break;\n      case LinkDirection.RIGHT:\n        point[0] += dist * factor;\n        break;\n      case LinkDirection.UP:\n        point[1] += dist * -factor;\n        break;\n      case LinkDirection.DOWN:\n        point[1] += dist * factor;\n        break;\n    }\n  }\n  drawExecutionOrder(ctx) {\n    ctx.shadowColor = \"transparent\";\n    ctx.globalAlpha = 0.25;\n    ctx.textAlign = \"center\";\n    ctx.strokeStyle = \"white\";\n    ctx.globalAlpha = 0.75;\n    const { visible_nodes } = this;\n    for (const node2 of visible_nodes) {\n      ctx.fillStyle = \"black\";\n      ctx.fillRect(\n        node2.pos[0] - LiteGraph.NODE_TITLE_HEIGHT,\n        node2.pos[1] - LiteGraph.NODE_TITLE_HEIGHT,\n        LiteGraph.NODE_TITLE_HEIGHT,\n        LiteGraph.NODE_TITLE_HEIGHT\n      );\n      if (node2.order == 0) {\n        ctx.strokeRect(\n          node2.pos[0] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n          node2.pos[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n          LiteGraph.NODE_TITLE_HEIGHT,\n          LiteGraph.NODE_TITLE_HEIGHT\n        );\n      }\n      ctx.fillStyle = \"#FFF\";\n      ctx.fillText(\n        stringOrEmpty(node2.order),\n        node2.pos[0] + LiteGraph.NODE_TITLE_HEIGHT * -0.5,\n        node2.pos[1] - 6\n      );\n    }\n    ctx.globalAlpha = 1;\n  }\n  /**\n   * draws the widgets stored inside a node\n   * @deprecated Use {@link LGraphNode.drawWidgets} instead.\n   * @remarks Currently there are extensions hijacking this function, so we cannot remove it.\n   */\n  drawNodeWidgets(node2, _posY, ctx) {\n    node2.drawWidgets(ctx, {\n      lowQuality: this.low_quality,\n      editorAlpha: this.editor_alpha\n    });\n  }\n  /**\n   * draws every group area in the background\n   */\n  drawGroups(canvas2, ctx) {\n    if (!this.graph) return;\n    const groups = this.graph._groups;\n    ctx.save();\n    ctx.globalAlpha = 0.5 * this.editor_alpha;\n    const drawSnapGuides = this.#snapToGrid && this.isDragging;\n    for (const group of groups) {\n      if (!overlapBounding(this.visible_area, group._bounding)) {\n        continue;\n      }\n      if (drawSnapGuides && this.selectedItems.has(group))\n        this.drawSnapGuide(ctx, group);\n      group.draw(this, ctx);\n    }\n    ctx.restore();\n  }\n  /**\n   * resizes the canvas to a given size, if no size is passed, then it tries to fill the parentNode\n   * @todo Remove or rewrite\n   */\n  resize(width2, height) {\n    if (!width2 && !height) {\n      const parent = this.canvas.parentElement;\n      if (!parent) throw new TypeError(\"Attempted to resize canvas, but parent element was null.\");\n      width2 = parent.offsetWidth;\n      height = parent.offsetHeight;\n    }\n    if (this.canvas.width == width2 && this.canvas.height == height) return;\n    this.canvas.width = width2 ?? 0;\n    this.canvas.height = height ?? 0;\n    this.bgcanvas.width = this.canvas.width;\n    this.bgcanvas.height = this.canvas.height;\n    this.setDirty(true, true);\n  }\n  onNodeSelectionChange() {\n  }\n  /**\n   * Determines the furthest nodes in each direction for the currently selected nodes\n   */\n  boundaryNodesForSelection() {\n    return LGraphCanvas.getBoundaryNodes(this.selected_nodes);\n  }\n  showLinkMenu(segment, e2) {\n    const { graph } = this;\n    if (!graph) throw new NullGraphError();\n    const title = \"data\" in segment && segment.data != null ? segment.data.constructor.name : void 0;\n    const { origin_id, origin_slot } = segment;\n    if (origin_id == null || origin_slot == null) {\n      new LiteGraph.ContextMenu([\"Link has no origin\"], {\n        event: e2,\n        title\n      });\n      return false;\n    }\n    const node_left = graph.getNodeById(origin_id);\n    const fromType = node_left?.outputs?.[origin_slot]?.type;\n    const options = [\"Add Node\", \"Add Reroute\", null, \"Delete\", null];\n    const menu = new LiteGraph.ContextMenu(options, {\n      event: e2,\n      title,\n      callback: inner_clicked.bind(this)\n    });\n    return false;\n    function inner_clicked(v2, options2, e22) {\n      if (!graph) throw new NullGraphError();\n      switch (v2) {\n        case \"Add Node\":\n          LGraphCanvas.onMenuAdd(null, null, e22, menu, (node2) => {\n            if (!node2?.inputs?.length || !node2?.outputs?.length || origin_slot == null) return;\n            const options3 = { afterRerouteId: segment.parentId };\n            if (node_left?.connectByType(origin_slot, node2, fromType ?? \"*\", options3)) {\n              node2.pos[0] -= node2.size[0] * 0.5;\n            }\n          });\n          break;\n        case \"Add Reroute\": {\n          try {\n            this.emitBeforeChange();\n            this.adjustMouseEvent(e22);\n            graph.createReroute(segment._pos, segment);\n            this.setDirty(false, true);\n          } catch (error) {\n            console.error(error);\n          } finally {\n            this.emitAfterChange();\n          }\n          break;\n        }\n        case \"Delete\":\n          graph.removeLink(segment.id);\n          break;\n      }\n    }\n  }\n  createDefaultNodeForSlot(optPass) {\n    const opts = Object.assign({\n      nodeFrom: null,\n      slotFrom: null,\n      nodeTo: null,\n      slotTo: null,\n      position: [0, 0],\n      nodeType: void 0,\n      posAdd: [0, 0],\n      posSizeFix: [0, 0]\n    }, optPass);\n    const { afterRerouteId } = opts;\n    const isFrom = opts.nodeFrom && opts.slotFrom !== null;\n    const isTo = !isFrom && opts.nodeTo && opts.slotTo !== null;\n    if (!isFrom && !isTo) {\n      console.warn(`No data passed to createDefaultNodeForSlot`, opts.nodeFrom, opts.slotFrom, opts.nodeTo, opts.slotTo);\n      return false;\n    }\n    if (!opts.nodeType) {\n      console.warn(\"No type to createDefaultNodeForSlot\");\n      return false;\n    }\n    const nodeX = isFrom ? opts.nodeFrom : opts.nodeTo;\n    if (!nodeX) throw new TypeError(\"nodeX was null when creating default node for slot.\");\n    let slotX = isFrom ? opts.slotFrom : opts.slotTo;\n    let iSlotConn = false;\n    if (nodeX instanceof SubgraphIONodeBase) {\n      if (typeof slotX !== \"object\" || !slotX) {\n        console.warn(\"Cant get slot information\", slotX);\n        return false;\n      }\n      const { name } = slotX;\n      iSlotConn = nodeX.slots.findIndex((s) => s.name === name);\n      slotX = nodeX.slots[iSlotConn];\n      if (!slotX) {\n        console.warn(\"Cant get slot information\", slotX);\n        return false;\n      }\n    } else {\n      switch (typeof slotX) {\n        case \"string\":\n          iSlotConn = isFrom ? nodeX.findOutputSlot(slotX, false) : nodeX.findInputSlot(slotX, false);\n          slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n          break;\n        case \"object\":\n          if (slotX === null) {\n            console.warn(\"Cant get slot information\", slotX);\n            return false;\n          }\n          iSlotConn = isFrom ? nodeX.findOutputSlot(slotX.name) : nodeX.findInputSlot(slotX.name);\n          break;\n        case \"number\":\n          iSlotConn = slotX;\n          slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n          break;\n        case \"undefined\":\n        default:\n          console.warn(\"Cant get slot information\", slotX);\n          return false;\n      }\n    }\n    const fromSlotType = slotX.type == LiteGraph.EVENT ? \"_event_\" : slotX.type;\n    const slotTypesDefault = isFrom ? LiteGraph.slot_types_default_out : LiteGraph.slot_types_default_in;\n    if (slotTypesDefault?.[fromSlotType]) {\n      let nodeNewType = false;\n      if (typeof slotTypesDefault[fromSlotType] == \"object\") {\n        for (const typeX in slotTypesDefault[fromSlotType]) {\n          if (opts.nodeType == slotTypesDefault[fromSlotType][typeX] || opts.nodeType == \"AUTO\") {\n            nodeNewType = slotTypesDefault[fromSlotType][typeX];\n            break;\n          }\n        }\n      } else if (opts.nodeType == slotTypesDefault[fromSlotType] || opts.nodeType == \"AUTO\") {\n        nodeNewType = slotTypesDefault[fromSlotType];\n      }\n      if (nodeNewType) {\n        let nodeNewOpts = false;\n        if (typeof nodeNewType == \"object\" && nodeNewType.node) {\n          nodeNewOpts = nodeNewType;\n          nodeNewType = nodeNewType.node;\n        }\n        const newNode = LiteGraph.createNode(nodeNewType);\n        if (newNode) {\n          if (nodeNewOpts) {\n            if (nodeNewOpts.properties) {\n              for (const i in nodeNewOpts.properties) {\n                newNode.addProperty(i, nodeNewOpts.properties[i]);\n              }\n            }\n            if (nodeNewOpts.inputs) {\n              newNode.inputs = [];\n              for (const i in nodeNewOpts.inputs) {\n                newNode.addOutput(\n                  nodeNewOpts.inputs[i][0],\n                  nodeNewOpts.inputs[i][1]\n                );\n              }\n            }\n            if (nodeNewOpts.outputs) {\n              newNode.outputs = [];\n              for (const i in nodeNewOpts.outputs) {\n                newNode.addOutput(\n                  nodeNewOpts.outputs[i][0],\n                  nodeNewOpts.outputs[i][1]\n                );\n              }\n            }\n            if (nodeNewOpts.title) {\n              newNode.title = nodeNewOpts.title;\n            }\n            if (nodeNewOpts.json) {\n              newNode.configure(nodeNewOpts.json);\n            }\n          }\n          if (!this.graph) throw new NullGraphError();\n          this.graph.add(newNode);\n          newNode.pos = [\n            opts.position[0] + opts.posAdd[0] + (opts.posSizeFix[0] ? opts.posSizeFix[0] * newNode.size[0] : 0),\n            opts.position[1] + opts.posAdd[1] + (opts.posSizeFix[1] ? opts.posSizeFix[1] * newNode.size[1] : 0)\n          ];\n          const detail = { node: newNode, opts };\n          const mayConnectLinks = this.canvas.dispatchEvent(new CustomEvent(\"connect-new-default-node\", { detail, cancelable: true }));\n          if (!mayConnectLinks) return true;\n          if (isFrom) {\n            if (!opts.nodeFrom) throw new TypeError(\"createDefaultNodeForSlot - nodeFrom was null\");\n            opts.nodeFrom.connectByType(iSlotConn, newNode, fromSlotType, { afterRerouteId });\n          } else {\n            if (!opts.nodeTo) throw new TypeError(\"createDefaultNodeForSlot - nodeTo was null\");\n            opts.nodeTo.connectByTypeOutput(iSlotConn, newNode, fromSlotType, { afterRerouteId });\n          }\n          return true;\n        }\n        console.log(`failed creating ${nodeNewType}`);\n      }\n    }\n    return false;\n  }\n  showConnectionMenu(optPass) {\n    const opts = Object.assign({\n      nodeFrom: null,\n      slotFrom: null,\n      nodeTo: null,\n      slotTo: null,\n      e: void 0,\n      allow_searchbox: this.allow_searchbox,\n      showSearchBox: this.showSearchBox\n    }, optPass || {});\n    const dirty = () => this.#dirty();\n    const that = this;\n    const { graph } = this;\n    const { afterRerouteId } = opts;\n    const isFrom = opts.nodeFrom && opts.slotFrom;\n    const isTo = !isFrom && opts.nodeTo && opts.slotTo;\n    if (!isFrom && !isTo) {\n      console.warn(\"No data passed to showConnectionMenu\");\n      return;\n    }\n    const nodeX = isFrom ? opts.nodeFrom : opts.nodeTo;\n    if (!nodeX) throw new TypeError(\"nodeX was null when creating default node for slot.\");\n    let slotX = isFrom ? opts.slotFrom : opts.slotTo;\n    let iSlotConn;\n    if (nodeX instanceof SubgraphIONodeBase) {\n      if (typeof slotX !== \"object\" || !slotX) {\n        console.warn(\"Cant get slot information\", slotX);\n        return;\n      }\n      const { name } = slotX;\n      iSlotConn = nodeX.slots.findIndex((s) => s.name === name);\n      if (iSlotConn !== -1) {\n        slotX = nodeX.slots[iSlotConn];\n      }\n      if (!slotX) {\n        console.warn(\"Cant get slot information\", slotX);\n        return;\n      }\n    } else {\n      switch (typeof slotX) {\n        case \"string\":\n          iSlotConn = isFrom ? nodeX.findOutputSlot(slotX, false) : nodeX.findInputSlot(slotX, false);\n          slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n          break;\n        case \"object\":\n          if (slotX === null) {\n            console.warn(\"Cant get slot information\", slotX);\n            return;\n          }\n          iSlotConn = isFrom ? nodeX.findOutputSlot(slotX.name) : nodeX.findInputSlot(slotX.name);\n          break;\n        case \"number\":\n          iSlotConn = slotX;\n          slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n          break;\n        default:\n          console.warn(\"Cant get slot information\", slotX);\n          return;\n      }\n    }\n    const options = [\"Add Node\", \"Add Reroute\", null];\n    if (opts.allow_searchbox) {\n      options.push(\"Search\", null);\n    }\n    const fromSlotType = slotX.type == LiteGraph.EVENT ? \"_event_\" : slotX.type;\n    const slotTypesDefault = isFrom ? LiteGraph.slot_types_default_out : LiteGraph.slot_types_default_in;\n    if (slotTypesDefault?.[fromSlotType]) {\n      if (typeof slotTypesDefault[fromSlotType] == \"object\") {\n        for (const typeX in slotTypesDefault[fromSlotType]) {\n          options.push(slotTypesDefault[fromSlotType][typeX]);\n        }\n      } else {\n        options.push(slotTypesDefault[fromSlotType]);\n      }\n    }\n    const menu = new LiteGraph.ContextMenu(options, {\n      event: opts.e,\n      extra: slotX,\n      title: (slotX && slotX.name != \"\" ? slotX.name + (fromSlotType ? \" | \" : \"\") : \"\") + (slotX && fromSlotType ? fromSlotType : \"\"),\n      callback: inner_clicked\n    });\n    return menu;\n    function inner_clicked(v2, options2, e2) {\n      switch (v2) {\n        case \"Add Node\":\n          LGraphCanvas.onMenuAdd(null, null, e2, menu, function(node2) {\n            if (!node2) return;\n            if (isFrom) {\n              if (!opts.nodeFrom) throw new TypeError(\"Cannot add node to SubgraphInputNode: nodeFrom was null\");\n              const slot = opts.nodeFrom.connectByType(iSlotConn, node2, fromSlotType, { afterRerouteId });\n              if (!slot) console.warn(\"Failed to make new connection.\");\n            } else {\n              if (!opts.nodeTo) throw new TypeError(\"Cannot add node to SubgraphInputNode: nodeTo was null\");\n              opts.nodeTo.connectByTypeOutput(iSlotConn, node2, fromSlotType, { afterRerouteId });\n            }\n          });\n          break;\n        case \"Add Reroute\": {\n          const node2 = isFrom ? opts.nodeFrom : opts.nodeTo;\n          const slot = options2.extra;\n          if (!graph) throw new NullGraphError();\n          if (!node2) throw new TypeError(\"Cannot add reroute: node was null\");\n          if (!slot) throw new TypeError(\"Cannot add reroute: slot was null\");\n          if (!opts.e) throw new TypeError(\"Cannot add reroute: CanvasPointerEvent was null\");\n          if (node2 instanceof SubgraphIONodeBase) {\n            throw new TypeError(\"Cannot add floating reroute to Subgraph IO Nodes\");\n          } else {\n            const reroute = node2.connectFloatingReroute([opts.e.canvasX, opts.e.canvasY], slot, afterRerouteId);\n            if (!reroute) throw new Error(\"Failed to create reroute\");\n          }\n          dirty();\n          break;\n        }\n        case \"Search\":\n          if (isFrom) {\n            opts.showSearchBox(e2, { node_from: opts.nodeFrom, slot_from: slotX, type_filter_in: fromSlotType });\n          } else {\n            opts.showSearchBox(e2, { node_to: opts.nodeTo, slot_from: slotX, type_filter_out: fromSlotType });\n          }\n          break;\n        default: {\n          const customProps = {\n            position: [opts.e?.canvasX ?? 0, opts.e?.canvasY ?? 0],\n            nodeType: v2,\n            afterRerouteId\n          };\n          const options3 = Object.assign(opts, customProps);\n          if (!that.createDefaultNodeForSlot(options3))\n            break;\n        }\n      }\n    }\n  }\n  // refactor: there are different dialogs, some uses createDialog some dont\n  prompt(title, value, callback, event, multiline) {\n    const that = this;\n    title = title || \"\";\n    const customProperties = {\n      is_modified: false,\n      className: \"graphdialog rounded\",\n      innerHTML: multiline ? \"<span class='name'></span> <textarea autofocus class='value'></textarea><button class='rounded'>OK</button>\" : \"<span class='name'></span> <input autofocus type='text' class='value'/><button class='rounded'>OK</button>\",\n      close() {\n        that.prompt_box = null;\n        if (dialog.parentNode) {\n          dialog.remove();\n        }\n      }\n    };\n    const div = document.createElement(\"div\");\n    const dialog = Object.assign(div, customProperties);\n    const graphcanvas = LGraphCanvas.active_canvas;\n    const { canvas: canvas2 } = graphcanvas;\n    if (!canvas2.parentNode) throw new TypeError(\"canvas element parentNode was null when opening a prompt.\");\n    canvas2.parentNode.append(dialog);\n    if (this.ds.scale > 1) dialog.style.transform = `scale(${this.ds.scale})`;\n    let dialogCloseTimer;\n    let prevent_timeout = 0;\n    LiteGraph.pointerListenerAdd(dialog, \"leave\", function() {\n      if (prevent_timeout) return;\n      if (LiteGraph.dialog_close_on_mouse_leave) {\n        if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave) {\n          dialogCloseTimer = setTimeout(\n            dialog.close,\n            LiteGraph.dialog_close_on_mouse_leave_delay\n          );\n        }\n      }\n    });\n    LiteGraph.pointerListenerAdd(dialog, \"enter\", function() {\n      if (LiteGraph.dialog_close_on_mouse_leave && dialogCloseTimer)\n        clearTimeout(dialogCloseTimer);\n    });\n    const selInDia = dialog.querySelectorAll(\"select\");\n    if (selInDia) {\n      for (const selIn of selInDia) {\n        selIn.addEventListener(\"click\", function() {\n          prevent_timeout++;\n        });\n        selIn.addEventListener(\"blur\", function() {\n          prevent_timeout = 0;\n        });\n        selIn.addEventListener(\"change\", function() {\n          prevent_timeout = -1;\n        });\n      }\n    }\n    this.prompt_box?.close();\n    this.prompt_box = dialog;\n    const name_element = dialog.querySelector(\".name\");\n    if (!name_element) throw new TypeError(\"name_element was null\");\n    name_element.textContent = title;\n    const value_element = dialog.querySelector(\".value\");\n    if (!value_element) throw new TypeError(\"value_element was null\");\n    value_element.value = value;\n    value_element.select();\n    const input = value_element;\n    input.addEventListener(\"keydown\", function(e2) {\n      dialog.is_modified = true;\n      if (e2.key == \"Escape\") {\n        dialog.close();\n      } else if (e2.key == \"Enter\" && e2.target.localName != \"textarea\") {\n        if (callback) {\n          callback(this.value);\n        }\n        dialog.close();\n      } else {\n        return;\n      }\n      e2.preventDefault();\n      e2.stopPropagation();\n    });\n    const button = dialog.querySelector(\"button\");\n    if (!button) throw new TypeError(\"button was null when opening prompt\");\n    button.addEventListener(\"click\", function() {\n      callback?.(input.value);\n      that.setDirty(true);\n      dialog.close();\n    });\n    const rect = canvas2.getBoundingClientRect();\n    let offsetx = -20;\n    let offsety = -20;\n    if (rect) {\n      offsetx -= rect.left;\n      offsety -= rect.top;\n    }\n    if (event) {\n      dialog.style.left = `${event.clientX + offsetx}px`;\n      dialog.style.top = `${event.clientY + offsety}px`;\n    } else {\n      dialog.style.left = `${canvas2.width * 0.5 + offsetx}px`;\n      dialog.style.top = `${canvas2.height * 0.5 + offsety}px`;\n    }\n    setTimeout(function() {\n      input.focus();\n      const clickTime = Date.now();\n      function handleOutsideClick(e2) {\n        if (e2.target === canvas2 && Date.now() - clickTime > 256) {\n          dialog.close();\n          canvas2.parentElement?.removeEventListener(\"click\", handleOutsideClick);\n          canvas2.parentElement?.removeEventListener(\"touchend\", handleOutsideClick);\n        }\n      }\n      canvas2.parentElement?.addEventListener(\"click\", handleOutsideClick);\n      canvas2.parentElement?.addEventListener(\"touchend\", handleOutsideClick);\n    }, 10);\n    return dialog;\n  }\n  showSearchBox(event, searchOptions) {\n    const options = {\n      slot_from: null,\n      node_from: null,\n      node_to: null,\n      // TODO check for registered_slot_[in/out]_types not empty\n      // this will be checked for functionality enabled : filter on slot type, in and out\n      do_type_filter: LiteGraph.search_filter_enabled,\n      // these are default: pass to set initially set values\n      // @ts-expect-error\n      type_filter_in: false,\n      type_filter_out: false,\n      show_general_if_none_on_typefilter: true,\n      show_general_after_typefiltered: true,\n      hide_on_mouse_leave: LiteGraph.search_hide_on_mouse_leave,\n      show_all_if_empty: true,\n      show_all_on_open: LiteGraph.search_show_all_on_open\n    };\n    Object.assign(options, searchOptions);\n    const that = this;\n    const graphcanvas = LGraphCanvas.active_canvas;\n    const { canvas: canvas2 } = graphcanvas;\n    const root_document = canvas2.ownerDocument || document;\n    const div = document.createElement(\"div\");\n    const dialog = Object.assign(div, {\n      close() {\n        that.search_box = void 0;\n        this.blur();\n        canvas2.focus();\n        root_document.body.style.overflow = \"\";\n        setTimeout(() => canvas2.focus(), 20);\n        dialog.remove();\n      }\n    });\n    dialog.className = \"litegraph litesearchbox graphdialog rounded\";\n    dialog.innerHTML = \"<span class='name'>Search</span> <input autofocus type='text' class='value rounded'/>\";\n    if (options.do_type_filter) {\n      dialog.innerHTML += \"<select class='slot_in_type_filter'><option value=''></option></select>\";\n      dialog.innerHTML += \"<select class='slot_out_type_filter'><option value=''></option></select>\";\n    }\n    const helper = document.createElement(\"div\");\n    helper.className = \"helper\";\n    dialog.append(helper);\n    if (root_document.fullscreenElement) {\n      root_document.fullscreenElement.append(dialog);\n    } else {\n      root_document.body.append(dialog);\n      root_document.body.style.overflow = \"hidden\";\n    }\n    let selIn;\n    let selOut;\n    if (options.do_type_filter) {\n      selIn = dialog.querySelector(\".slot_in_type_filter\");\n      selOut = dialog.querySelector(\".slot_out_type_filter\");\n    }\n    if (this.ds.scale > 1) {\n      dialog.style.transform = `scale(${this.ds.scale})`;\n    }\n    if (options.hide_on_mouse_leave) {\n      let prevent_timeout = false;\n      let timeout_close = null;\n      LiteGraph.pointerListenerAdd(dialog, \"enter\", function() {\n        if (timeout_close) {\n          clearTimeout(timeout_close);\n          timeout_close = null;\n        }\n      });\n      dialog.addEventListener(\"pointerleave\", function() {\n        if (prevent_timeout) return;\n        const hideDelay = options.hide_on_mouse_leave;\n        const delay = typeof hideDelay === \"number\" ? hideDelay : 500;\n        timeout_close = setTimeout(dialog.close, delay);\n      });\n      if (options.do_type_filter) {\n        if (!selIn) throw new TypeError(\"selIn was null when showing search box\");\n        if (!selOut) throw new TypeError(\"selOut was null when showing search box\");\n        selIn.addEventListener(\"click\", function() {\n          prevent_timeout++;\n        });\n        selIn.addEventListener(\"blur\", function() {\n          prevent_timeout = 0;\n        });\n        selIn.addEventListener(\"change\", function() {\n          prevent_timeout = -1;\n        });\n        selOut.addEventListener(\"click\", function() {\n          prevent_timeout++;\n        });\n        selOut.addEventListener(\"blur\", function() {\n          prevent_timeout = 0;\n        });\n        selOut.addEventListener(\"change\", function() {\n          prevent_timeout = -1;\n        });\n      }\n    }\n    that.search_box?.close();\n    that.search_box = dialog;\n    let first = null;\n    let timeout = null;\n    let selected = null;\n    const maybeInput = dialog.querySelector(\"input\");\n    if (!maybeInput) throw new TypeError(\"Could not create search input box.\");\n    const input = maybeInput;\n    if (input) {\n      input.addEventListener(\"blur\", function() {\n        this.focus();\n      });\n      input.addEventListener(\"keydown\", function(e2) {\n        if (e2.key == \"ArrowUp\") {\n          changeSelection(false);\n        } else if (e2.key == \"ArrowDown\") {\n          changeSelection(true);\n        } else if (e2.key == \"Escape\") {\n          dialog.close();\n        } else if (e2.key == \"Enter\") {\n          if (selected instanceof HTMLElement) {\n            select(unescape(String(selected.dataset[\"type\"])));\n          } else if (first) {\n            select(first);\n          } else {\n            dialog.close();\n          }\n        } else {\n          if (timeout) {\n            clearInterval(timeout);\n          }\n          timeout = setTimeout(refreshHelper, 10);\n          return;\n        }\n        e2.preventDefault();\n        e2.stopPropagation();\n        e2.stopImmediatePropagation();\n        return true;\n      });\n    }\n    if (options.do_type_filter) {\n      if (selIn) {\n        const aSlots = LiteGraph.slot_types_in;\n        const nSlots = aSlots.length;\n        if (options.type_filter_in == LiteGraph.EVENT || options.type_filter_in == LiteGraph.ACTION) {\n          options.type_filter_in = \"_event_\";\n        }\n        for (let iK = 0; iK < nSlots; iK++) {\n          const opt = document.createElement(\"option\");\n          opt.value = aSlots[iK];\n          opt.innerHTML = aSlots[iK];\n          selIn.append(opt);\n          if (\n            // @ts-expect-error\n            options.type_filter_in !== false && String(options.type_filter_in).toLowerCase() == String(aSlots[iK]).toLowerCase()\n          ) {\n            opt.selected = true;\n          }\n        }\n        selIn.addEventListener(\"change\", function() {\n          refreshHelper();\n        });\n      }\n      if (selOut) {\n        const aSlots = LiteGraph.slot_types_out;\n        if (options.type_filter_out == LiteGraph.EVENT || options.type_filter_out == LiteGraph.ACTION) {\n          options.type_filter_out = \"_event_\";\n        }\n        for (const aSlot of aSlots) {\n          const opt = document.createElement(\"option\");\n          opt.value = aSlot;\n          opt.innerHTML = aSlot;\n          selOut.append(opt);\n          if (options.type_filter_out !== false && String(options.type_filter_out).toLowerCase() == String(aSlot).toLowerCase()) {\n            opt.selected = true;\n          }\n        }\n        selOut.addEventListener(\"change\", function() {\n          refreshHelper();\n        });\n      }\n    }\n    const rect = canvas2.getBoundingClientRect();\n    const left = (event ? event.clientX : rect.left + rect.width * 0.5) - 80;\n    const top = (event ? event.clientY : rect.top + rect.height * 0.5) - 20;\n    dialog.style.left = `${left}px`;\n    dialog.style.top = `${top}px`;\n    if (event.layerY > rect.height - 200) {\n      helper.style.maxHeight = `${rect.height - event.layerY - 20}px`;\n    }\n    requestAnimationFrame(function() {\n      input.focus();\n    });\n    if (options.show_all_on_open) refreshHelper();\n    function select(name) {\n      if (name) {\n        if (that.onSearchBoxSelection) {\n          that.onSearchBoxSelection(name, event, graphcanvas);\n        } else {\n          if (!graphcanvas.graph) throw new NullGraphError();\n          graphcanvas.graph.beforeChange();\n          const node2 = LiteGraph.createNode(name);\n          if (node2) {\n            node2.pos = graphcanvas.convertEventToCanvasOffset(event);\n            graphcanvas.graph.add(node2, false);\n          }\n          if (options.node_from) {\n            let iS = false;\n            switch (typeof options.slot_from) {\n              case \"string\":\n                iS = options.node_from.findOutputSlot(options.slot_from);\n                break;\n              case \"object\":\n                if (options.slot_from == null) throw new TypeError(\"options.slot_from was null when showing search box\");\n                iS = options.slot_from.name ? options.node_from.findOutputSlot(options.slot_from.name) : -1;\n                if (iS == -1 && options.slot_from.slot_index !== void 0) iS = options.slot_from.slot_index;\n                break;\n              case \"number\":\n                iS = options.slot_from;\n                break;\n              default:\n                iS = 0;\n            }\n            if (options.node_from.outputs[iS] !== void 0) {\n              if (iS !== false && iS > -1) {\n                if (node2 == null) throw new TypeError(\"options.slot_from was null when showing search box\");\n                options.node_from.connectByType(iS, node2, options.node_from.outputs[iS].type);\n              }\n            }\n          }\n          if (options.node_to) {\n            let iS = false;\n            switch (typeof options.slot_from) {\n              case \"string\":\n                iS = options.node_to.findInputSlot(options.slot_from);\n                break;\n              case \"object\":\n                if (options.slot_from == null) throw new TypeError(\"options.slot_from was null when showing search box\");\n                iS = options.slot_from.name ? options.node_to.findInputSlot(options.slot_from.name) : -1;\n                if (iS == -1 && options.slot_from.slot_index !== void 0) iS = options.slot_from.slot_index;\n                break;\n              case \"number\":\n                iS = options.slot_from;\n                break;\n              default:\n                iS = 0;\n            }\n            if (options.node_to.inputs[iS] !== void 0) {\n              if (iS !== false && iS > -1) {\n                if (node2 == null) throw new TypeError(\"options.slot_from was null when showing search box\");\n                options.node_to.connectByTypeOutput(iS, node2, options.node_to.inputs[iS].type);\n              }\n            }\n          }\n          graphcanvas.graph.afterChange();\n        }\n      }\n      dialog.close();\n    }\n    function changeSelection(forward) {\n      const prev = selected;\n      if (!selected) {\n        selected = forward ? helper.childNodes[0] : helper.childNodes[helper.childNodes.length];\n      } else if (selected instanceof Element) {\n        selected.classList.remove(\"selected\");\n        selected = forward ? selected.nextSibling : selected.previousSibling;\n        selected ||= prev;\n      }\n      if (selected instanceof Element) {\n        selected.classList.add(\"selected\");\n        selected.scrollIntoView({ block: \"end\", behavior: \"smooth\" });\n      }\n    }\n    function refreshHelper() {\n      timeout = null;\n      let str = input.value;\n      first = null;\n      helper.innerHTML = \"\";\n      if (!str && !options.show_all_if_empty) return;\n      if (that.onSearchBox) {\n        const list = that.onSearchBox(helper, str, graphcanvas);\n        if (list) {\n          for (const item of list) {\n            addResult(item);\n          }\n        }\n      } else {\n        let inner_test_filter = function(type, optsIn) {\n          optsIn = optsIn || {};\n          const optsDef = {\n            skipFilter: false,\n            inTypeOverride: false,\n            outTypeOverride: false\n          };\n          const opts = Object.assign(optsDef, optsIn);\n          const ctor = LiteGraph.registered_node_types[type];\n          if (filter && ctor.filter != filter) return false;\n          if ((!options.show_all_if_empty || str) && !type.toLowerCase().includes(str) && (!ctor.title || !ctor.title.toLowerCase().includes(str))) {\n            return false;\n          }\n          if (options.do_type_filter && !opts.skipFilter) {\n            const sType = type;\n            let sV = opts.inTypeOverride !== false ? opts.inTypeOverride : sIn.value;\n            if (sIn && sV && LiteGraph.registered_slot_in_types[sV]?.nodes) {\n              const doesInc = LiteGraph.registered_slot_in_types[sV].nodes.includes(sType);\n              if (doesInc === false) return false;\n            }\n            sV = sOut.value;\n            if (opts.outTypeOverride !== false) sV = opts.outTypeOverride;\n            if (sOut && sV && LiteGraph.registered_slot_out_types[sV]?.nodes) {\n              const doesInc = LiteGraph.registered_slot_out_types[sV].nodes.includes(sType);\n              if (doesInc === false) return false;\n            }\n          }\n          return true;\n        };\n        let c = 0;\n        str = str.toLowerCase();\n        if (!graphcanvas.graph) throw new NullGraphError();\n        const filter = graphcanvas.filter || graphcanvas.graph.filter;\n        let sIn = false;\n        let sOut = false;\n        if (options.do_type_filter && that.search_box) {\n          sIn = that.search_box.querySelector(\".slot_in_type_filter\");\n          sOut = that.search_box.querySelector(\".slot_out_type_filter\");\n        }\n        const keys = Object.keys(LiteGraph.registered_node_types);\n        const filtered = keys.filter((x2) => inner_test_filter(x2));\n        for (const item of filtered) {\n          addResult(item);\n          if (LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit)\n            break;\n        }\n        if (options.show_general_after_typefiltered && (sIn.value || sOut.value)) {\n          filtered_extra = [];\n          for (const i in LiteGraph.registered_node_types) {\n            if (inner_test_filter(i, {\n              inTypeOverride: sIn && sIn.value ? \"*\" : false,\n              outTypeOverride: sOut && sOut.value ? \"*\" : false\n            })) {\n              filtered_extra.push(i);\n            }\n          }\n          for (const extraItem of filtered_extra) {\n            addResult(extraItem, \"generic_type\");\n            if (LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit)\n              break;\n          }\n        }\n        if ((sIn.value || sOut.value) && helper.childNodes.length == 0 && options.show_general_if_none_on_typefilter) {\n          filtered_extra = [];\n          for (const i in LiteGraph.registered_node_types) {\n            if (inner_test_filter(i, { skipFilter: true }))\n              filtered_extra.push(i);\n          }\n          for (const extraItem of filtered_extra) {\n            addResult(extraItem, \"not_in_filter\");\n            if (LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit)\n              break;\n          }\n        }\n      }\n      function addResult(type, className) {\n        const help = document.createElement(\"div\");\n        first ||= type;\n        const nodeType = LiteGraph.registered_node_types[type];\n        if (nodeType?.title) {\n          help.textContent = nodeType?.title;\n          const typeEl = document.createElement(\"span\");\n          typeEl.className = \"litegraph lite-search-item-type\";\n          typeEl.textContent = type;\n          help.append(typeEl);\n        } else {\n          help.textContent = type;\n        }\n        help.dataset[\"type\"] = escape(type);\n        help.className = \"litegraph lite-search-item\";\n        if (className) {\n          help.className += ` ${className}`;\n        }\n        help.addEventListener(\"click\", function() {\n          select(unescape(String(this.dataset[\"type\"])));\n        });\n        helper.append(help);\n      }\n    }\n    return dialog;\n  }\n  showEditPropertyValue(node2, property, options) {\n    if (!node2 || node2.properties[property] === void 0) return;\n    options = options || {};\n    const info = node2.getPropertyInfo(property);\n    const { type } = info;\n    let input_html = \"\";\n    if (type == \"string\" || type == \"number\" || type == \"array\" || type == \"object\") {\n      input_html = \"<input autofocus type='text' class='value'/>\";\n    } else if ((type == \"enum\" || type == \"combo\") && info.values) {\n      input_html = \"<select autofocus type='text' class='value'>\";\n      for (const i in info.values) {\n        const v2 = Array.isArray(info.values) ? info.values[i] : i;\n        const selected = v2 == node2.properties[property] ? \"selected\" : \"\";\n        input_html += `<option value='${v2}' ${selected}>${info.values[i]}</option>`;\n      }\n      input_html += \"</select>\";\n    } else if (type == \"boolean\" || type == \"toggle\") {\n      const checked = node2.properties[property] ? \"checked\" : \"\";\n      input_html = `<input autofocus type='checkbox' class='value' ${checked}/>`;\n    } else {\n      console.warn(`unknown type: ${type}`);\n      return;\n    }\n    const dialog = this.createDialog(\n      `<span class='name'>${info.label || property}</span>${input_html}<button>OK</button>`,\n      options\n    );\n    let input;\n    if ((type == \"enum\" || type == \"combo\") && info.values) {\n      input = dialog.querySelector(\"select\");\n      input?.addEventListener(\"change\", function(e2) {\n        dialog.modified();\n        setValue(e2.target?.value);\n      });\n    } else if (type == \"boolean\" || type == \"toggle\") {\n      input = dialog.querySelector(\"input\");\n      input?.addEventListener(\"click\", function() {\n        dialog.modified();\n        setValue(!!input.checked);\n      });\n    } else {\n      input = dialog.querySelector(\"input\");\n      if (input) {\n        input.addEventListener(\"blur\", function() {\n          this.focus();\n        });\n        let v2 = node2.properties[property] !== void 0 ? node2.properties[property] : \"\";\n        if (type !== \"string\") {\n          v2 = JSON.stringify(v2);\n        }\n        input.value = v2;\n        input.addEventListener(\"keydown\", function(e2) {\n          if (e2.key == \"Escape\") {\n            dialog.close();\n          } else if (e2.key == \"Enter\") {\n            inner();\n          } else {\n            dialog.modified();\n            return;\n          }\n          e2.preventDefault();\n          e2.stopPropagation();\n        });\n      }\n    }\n    input?.focus();\n    const button = dialog.querySelector(\"button\");\n    if (!button) throw new TypeError(\"Show edit property value button was null.\");\n    button.addEventListener(\"click\", inner);\n    function inner() {\n      setValue(input?.value);\n    }\n    const dirty = () => this.#dirty();\n    function setValue(value) {\n      if (info?.values && typeof info.values === \"object\" && info.values[value] != void 0) {\n        value = info.values[value];\n      }\n      if (typeof node2.properties[property] == \"number\") {\n        value = Number(value);\n      }\n      if (type == \"array\" || type == \"object\") {\n        value = JSON.parse(value);\n      }\n      node2.properties[property] = value;\n      if (node2.graph) {\n        node2.graph._version++;\n      }\n      node2.onPropertyChanged?.(property, value);\n      options.onclose?.();\n      dialog.close();\n      dirty();\n    }\n    return dialog;\n  }\n  // TODO refactor, theer are different dialog, some uses createDialog, some dont\n  createDialog(html, options) {\n    const def_options = {\n      checkForInput: false,\n      closeOnLeave: true,\n      closeOnLeave_checkModified: true\n    };\n    options = Object.assign(def_options, options || {});\n    const customProperties = {\n      className: \"graphdialog\",\n      innerHTML: html,\n      is_modified: false,\n      modified() {\n        this.is_modified = true;\n      },\n      close() {\n        this.remove();\n      }\n    };\n    const div = document.createElement(\"div\");\n    const dialog = Object.assign(div, customProperties);\n    const rect = this.canvas.getBoundingClientRect();\n    let offsetx = -20;\n    let offsety = -20;\n    if (rect) {\n      offsetx -= rect.left;\n      offsety -= rect.top;\n    }\n    if (options.position) {\n      offsetx += options.position[0];\n      offsety += options.position[1];\n    } else if (options.event) {\n      offsetx += options.event.clientX;\n      offsety += options.event.clientY;\n    } else {\n      offsetx += this.canvas.width * 0.5;\n      offsety += this.canvas.height * 0.5;\n    }\n    dialog.style.left = `${offsetx}px`;\n    dialog.style.top = `${offsety}px`;\n    if (!this.canvas.parentNode) throw new TypeError(\"Canvas parent element was null.\");\n    this.canvas.parentNode.append(dialog);\n    if (options.checkForInput) {\n      const aI = dialog.querySelectorAll(\"input\");\n      if (aI) {\n        for (const iX of aI) {\n          iX.addEventListener(\"keydown\", function(e2) {\n            dialog.modified();\n            if (e2.key == \"Escape\") {\n              dialog.close();\n            } else if (e2.key != \"Enter\") {\n              return;\n            }\n            e2.preventDefault();\n            e2.stopPropagation();\n          });\n          iX.focus();\n        }\n      }\n    }\n    let dialogCloseTimer;\n    let prevent_timeout = 0;\n    dialog.addEventListener(\"mouseleave\", function() {\n      if (prevent_timeout) return;\n      if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave) {\n        dialogCloseTimer = setTimeout(\n          dialog.close,\n          LiteGraph.dialog_close_on_mouse_leave_delay\n        );\n      }\n    });\n    dialog.addEventListener(\"mouseenter\", function() {\n      if (options.closeOnLeave || LiteGraph.dialog_close_on_mouse_leave) {\n        if (dialogCloseTimer) clearTimeout(dialogCloseTimer);\n      }\n    });\n    const selInDia = dialog.querySelectorAll(\"select\");\n    if (selInDia) {\n      for (const selIn of selInDia) {\n        selIn.addEventListener(\"click\", function() {\n          prevent_timeout++;\n        });\n        selIn.addEventListener(\"blur\", function() {\n          prevent_timeout = 0;\n        });\n        selIn.addEventListener(\"change\", function() {\n          prevent_timeout = -1;\n        });\n      }\n    }\n    return dialog;\n  }\n  createPanel(title, options) {\n    options = options || {};\n    const ref_window = options.window || window;\n    const root = document.createElement(\"div\");\n    root.className = \"litegraph dialog\";\n    root.innerHTML = \"<div class='dialog-header'><span class='dialog-title'></span></div><div class='dialog-content'></div><div style='display:none;' class='dialog-alt-content'></div><div class='dialog-footer'></div>\";\n    root.header = root.querySelector(\".dialog-header\");\n    if (options.width)\n      root.style.width = options.width + (typeof options.width === \"number\" ? \"px\" : \"\");\n    if (options.height)\n      root.style.height = options.height + (typeof options.height === \"number\" ? \"px\" : \"\");\n    if (options.closable) {\n      const close = document.createElement(\"span\");\n      close.innerHTML = \"&#10005;\";\n      close.classList.add(\"close\");\n      close.addEventListener(\"click\", function() {\n        root.close();\n      });\n      root.header.append(close);\n    }\n    root.title_element = root.querySelector(\".dialog-title\");\n    root.title_element.textContent = title;\n    root.content = root.querySelector(\".dialog-content\");\n    root.alt_content = root.querySelector(\".dialog-alt-content\");\n    root.footer = root.querySelector(\".dialog-footer\");\n    root.close = function() {\n      if (typeof root.onClose == \"function\") root.onClose();\n      root.remove();\n      this.remove();\n    };\n    root.toggleAltContent = function(force) {\n      let vTo;\n      let vAlt;\n      if (force !== void 0) {\n        vTo = force ? \"block\" : \"none\";\n        vAlt = force ? \"none\" : \"block\";\n      } else {\n        vTo = root.alt_content.style.display != \"block\" ? \"block\" : \"none\";\n        vAlt = root.alt_content.style.display != \"block\" ? \"none\" : \"block\";\n      }\n      root.alt_content.style.display = vTo;\n      root.content.style.display = vAlt;\n    };\n    root.toggleFooterVisibility = function(force) {\n      let vTo;\n      if (force !== void 0) {\n        vTo = force ? \"block\" : \"none\";\n      } else {\n        vTo = root.footer.style.display != \"block\" ? \"block\" : \"none\";\n      }\n      root.footer.style.display = vTo;\n    };\n    root.clear = function() {\n      this.content.innerHTML = \"\";\n    };\n    root.addHTML = function(code, classname, on_footer) {\n      const elem = document.createElement(\"div\");\n      if (classname) elem.className = classname;\n      elem.innerHTML = code;\n      if (on_footer) root.footer.append(elem);\n      else root.content.append(elem);\n      return elem;\n    };\n    root.addButton = function(name, callback, options2) {\n      const elem = document.createElement(\"button\");\n      elem.textContent = name;\n      elem.options = options2;\n      elem.classList.add(\"btn\");\n      elem.addEventListener(\"click\", callback);\n      root.footer.append(elem);\n      return elem;\n    };\n    root.addSeparator = function() {\n      const elem = document.createElement(\"div\");\n      elem.className = \"separator\";\n      root.content.append(elem);\n    };\n    root.addWidget = function(type, name, value, options2, callback) {\n      options2 = options2 || {};\n      let str_value = String(value);\n      type = type.toLowerCase();\n      if (type == \"number\" && typeof value === \"number\") str_value = value.toFixed(3);\n      const elem = document.createElement(\"div\");\n      elem.className = \"property\";\n      elem.innerHTML = \"<span class='property_name'></span><span class='property_value'></span>\";\n      const nameSpan = elem.querySelector(\".property_name\");\n      if (!nameSpan) throw new TypeError(\"Property name element was null.\");\n      nameSpan.textContent = options2.label || name;\n      const value_element = elem.querySelector(\".property_value\");\n      if (!value_element) throw new TypeError(\"Property name element was null.\");\n      value_element.textContent = str_value;\n      elem.dataset[\"property\"] = name;\n      elem.dataset[\"type\"] = options2.type || type;\n      elem.options = options2;\n      elem.value = value;\n      if (type == \"code\") {\n        elem.addEventListener(\"click\", function() {\n          root.inner_showCodePad(this.dataset[\"property\"]);\n        });\n      } else if (type == \"boolean\") {\n        elem.classList.add(\"boolean\");\n        if (value) elem.classList.add(\"bool-on\");\n        elem.addEventListener(\"click\", () => {\n          const propname = elem.dataset[\"property\"];\n          elem.value = !elem.value;\n          elem.classList.toggle(\"bool-on\");\n          if (!value_element) throw new TypeError(\"Property name element was null.\");\n          value_element.textContent = elem.value ? \"true\" : \"false\";\n          innerChange(propname, elem.value);\n        });\n      } else if (type == \"string\" || type == \"number\") {\n        if (!value_element) throw new TypeError(\"Property name element was null.\");\n        value_element.setAttribute(\"contenteditable\", \"true\");\n        value_element.addEventListener(\"keydown\", function(e2) {\n          if (e2.code == \"Enter\" && (type != \"string\" || !e2.shiftKey)) {\n            e2.preventDefault();\n            this.blur();\n          }\n        });\n        value_element.addEventListener(\"blur\", function() {\n          let v2 = this.textContent;\n          const propname = this.parentElement?.dataset[\"property\"];\n          const proptype = this.parentElement?.dataset[\"type\"];\n          if (proptype == \"number\") v2 = Number(v2);\n          innerChange(propname, v2);\n        });\n      } else if (type == \"enum\" || type == \"combo\") {\n        const str_value2 = LGraphCanvas.getPropertyPrintableValue(value, options2.values);\n        if (!value_element) throw new TypeError(\"Property name element was null.\");\n        value_element.textContent = str_value2 ?? \"\";\n        value_element.addEventListener(\"click\", function(event) {\n          const values = options2.values || [];\n          const propname = this.parentElement?.dataset[\"property\"];\n          const inner_clicked = (v2) => {\n            this.textContent = v2;\n            innerChange(propname, v2);\n            return false;\n          };\n          new LiteGraph.ContextMenu(\n            values,\n            {\n              event,\n              className: \"dark\",\n              callback: inner_clicked\n            },\n            // @ts-expect-error\n            ref_window\n          );\n        });\n      }\n      root.content.append(elem);\n      function innerChange(name2, value2) {\n        options2.callback?.(name2, value2, options2);\n        callback?.(name2, value2, options2);\n      }\n      return elem;\n    };\n    if (typeof root.onOpen == \"function\") root.onOpen();\n    return root;\n  }\n  closePanels() {\n    document.querySelector(\"#node-panel\")?.close?.();\n    document.querySelector(\"#option-panel\")?.close?.();\n  }\n  showShowNodePanel(node2) {\n    this.SELECTED_NODE = node2;\n    this.closePanels();\n    const ref_window = this.getCanvasWindow();\n    const panel = this.createPanel(node2.title || \"\", {\n      closable: true,\n      window: ref_window,\n      onOpen: () => {\n        this.NODEPANEL_IS_OPEN = true;\n      },\n      onClose: () => {\n        this.NODEPANEL_IS_OPEN = false;\n        this.node_panel = null;\n      }\n    });\n    this.node_panel = panel;\n    panel.id = \"node-panel\";\n    panel.node = node2;\n    panel.classList.add(\"settings\");\n    const inner_refresh = () => {\n      panel.content.innerHTML = \"\";\n      panel.addHTML(`<span class='node_type'>${node2.type}</span><span class='node_desc'>${node2.constructor.desc || \"\"}</span><span class='separator'></span>`);\n      panel.addHTML(\"<h3>Properties</h3>\");\n      const fUpdate = (name, value) => {\n        if (!this.graph) throw new NullGraphError();\n        this.graph.beforeChange(node2);\n        switch (name) {\n          case \"Title\":\n            if (typeof value !== \"string\") throw new TypeError(\"Attempting to set title to non-string value.\");\n            node2.title = value;\n            break;\n          case \"Mode\": {\n            if (typeof value !== \"string\") throw new TypeError(\"Attempting to set mode to non-string value.\");\n            const kV = Object.values(LiteGraph.NODE_MODES).indexOf(value);\n            if (kV !== -1 && LiteGraph.NODE_MODES[kV]) {\n              node2.changeMode(kV);\n            } else {\n              console.warn(`unexpected mode: ${value}`);\n            }\n            break;\n          }\n          case \"Color\":\n            if (typeof value !== \"string\") throw new TypeError(\"Attempting to set colour to non-string value.\");\n            if (LGraphCanvas.node_colors[value]) {\n              node2.color = LGraphCanvas.node_colors[value].color;\n              node2.bgcolor = LGraphCanvas.node_colors[value].bgcolor;\n            } else {\n              console.warn(`unexpected color: ${value}`);\n            }\n            break;\n          default:\n            node2.setProperty(name, value);\n            break;\n        }\n        this.graph.afterChange();\n        this.dirty_canvas = true;\n      };\n      panel.addWidget(\"string\", \"Title\", node2.title, {}, fUpdate);\n      const mode = node2.mode == null ? void 0 : LiteGraph.NODE_MODES[node2.mode];\n      panel.addWidget(\"combo\", \"Mode\", mode, { values: LiteGraph.NODE_MODES }, fUpdate);\n      const nodeCol = node2.color !== void 0 ? Object.keys(LGraphCanvas.node_colors).filter(function(nK) {\n        return LGraphCanvas.node_colors[nK].color == node2.color;\n      }) : \"\";\n      panel.addWidget(\"combo\", \"Color\", nodeCol, { values: Object.keys(LGraphCanvas.node_colors) }, fUpdate);\n      for (const pName in node2.properties) {\n        const value = node2.properties[pName];\n        const info = node2.getPropertyInfo(pName);\n        if (node2.onAddPropertyToPanel?.(pName, panel)) continue;\n        panel.addWidget(info.widget || info.type, pName, value, info, fUpdate);\n      }\n      panel.addSeparator();\n      node2.onShowCustomPanelInfo?.(panel);\n      panel.footer.innerHTML = \"\";\n      panel.addButton(\"Delete\", function() {\n        if (node2.block_delete) return;\n        if (!node2.graph) throw new NullGraphError();\n        node2.graph.remove(node2);\n        panel.close();\n      }).classList.add(\"delete\");\n    };\n    panel.inner_showCodePad = function(propname) {\n      panel.classList.remove(\"settings\");\n      panel.classList.add(\"centered\");\n      panel.alt_content.innerHTML = \"<textarea class='code'></textarea>\";\n      const textarea = panel.alt_content.querySelector(\"textarea\");\n      const fDoneWith = function() {\n        panel.toggleAltContent(false);\n        panel.toggleFooterVisibility(true);\n        textarea.remove();\n        panel.classList.add(\"settings\");\n        panel.classList.remove(\"centered\");\n        inner_refresh();\n      };\n      textarea.value = String(node2.properties[propname]);\n      textarea.addEventListener(\"keydown\", function(e2) {\n        if (e2.code == \"Enter\" && e2.ctrlKey) {\n          node2.setProperty(propname, textarea.value);\n          fDoneWith();\n        }\n      });\n      panel.toggleAltContent(true);\n      panel.toggleFooterVisibility(false);\n      textarea.style.height = \"calc(100% - 40px)\";\n      const assign = panel.addButton(\"Assign\", function() {\n        node2.setProperty(propname, textarea.value);\n        fDoneWith();\n      });\n      panel.alt_content.append(assign);\n      const button = panel.addButton(\"Close\", fDoneWith);\n      button.style.float = \"right\";\n      panel.alt_content.append(button);\n    };\n    inner_refresh();\n    if (!this.canvas.parentNode) throw new TypeError(\"showNodePanel - this.canvas.parentNode was null\");\n    this.canvas.parentNode.append(panel);\n  }\n  checkPanels() {\n    if (!this.canvas) return;\n    if (!this.canvas.parentNode) throw new TypeError(\"checkPanels - this.canvas.parentNode was null\");\n    const panels = this.canvas.parentNode.querySelectorAll(\".litegraph.dialog\");\n    for (const panel of panels) {\n      if (!panel.node) continue;\n      if (!panel.node.graph || panel.graph != this.graph) panel.close();\n    }\n  }\n  getCanvasMenuOptions() {\n    let options;\n    if (this.getMenuOptions) {\n      options = this.getMenuOptions();\n    } else {\n      options = [\n        {\n          content: \"Add Node\",\n          has_submenu: true,\n          callback: LGraphCanvas.onMenuAdd\n        },\n        { content: \"Add Group\", callback: LGraphCanvas.onGroupAdd }\n        // { content: \"Arrange\", callback: that.graph.arrange },\n        // {content:\"Collapse All\", callback: LGraphCanvas.onMenuCollapseAll }\n      ];\n      if (Object.keys(this.selected_nodes).length > 1) {\n        options.push({\n          content: \"Convert to Subgraph 🆕\",\n          callback: () => {\n            if (!this.selectedItems.size) throw new Error(\"Convert to Subgraph: Nothing selected.\");\n            this._graph.convertToSubgraph(this.selectedItems);\n          }\n        }, {\n          content: \"Align\",\n          has_submenu: true,\n          callback: LGraphCanvas.onGroupAlign\n        });\n      }\n    }\n    const extra = this.getExtraMenuOptions?.(this, options);\n    return Array.isArray(extra) ? options.concat(extra) : options;\n  }\n  // called by processContextMenu to extract the menu list\n  getNodeMenuOptions(node2) {\n    let options;\n    if (node2.getMenuOptions) {\n      options = node2.getMenuOptions(this);\n    } else {\n      options = [\n        {\n          content: \"Inputs\",\n          has_submenu: true,\n          disabled: true\n        },\n        {\n          content: \"Outputs\",\n          has_submenu: true,\n          disabled: true,\n          callback: LGraphCanvas.showMenuNodeOptionalOutputs\n        },\n        null,\n        {\n          content: \"Convert to Subgraph 🆕\",\n          callback: () => {\n            if (!this.selectedItems.size) throw new Error(\"Convert to Subgraph: Nothing selected.\");\n            this._graph.convertToSubgraph(this.selectedItems);\n          }\n        },\n        {\n          content: \"Properties\",\n          has_submenu: true,\n          callback: LGraphCanvas.onShowMenuNodeProperties\n        },\n        {\n          content: \"Properties Panel\",\n          callback: function(item, options2, e2, menu, node22) {\n            LGraphCanvas.active_canvas.showShowNodePanel(node22);\n          }\n        },\n        null,\n        {\n          content: \"Title\",\n          callback: LGraphCanvas.onShowPropertyEditor\n        },\n        {\n          content: \"Mode\",\n          has_submenu: true,\n          callback: LGraphCanvas.onMenuNodeMode\n        }\n      ];\n      if (node2.resizable !== false) {\n        options.push({\n          content: \"Resize\",\n          callback: LGraphCanvas.onMenuResizeNode\n        });\n      }\n      if (node2.collapsible) {\n        options.push({\n          content: node2.collapsed ? \"Expand\" : \"Collapse\",\n          callback: LGraphCanvas.onMenuNodeCollapse\n        });\n      }\n      if (node2.widgets?.some((w) => w.advanced)) {\n        options.push({\n          content: node2.showAdvanced ? \"Hide Advanced\" : \"Show Advanced\",\n          callback: LGraphCanvas.onMenuToggleAdvanced\n        });\n      }\n      options.push(\n        {\n          content: node2.pinned ? \"Unpin\" : \"Pin\",\n          callback: () => {\n            for (const i in this.selected_nodes) {\n              const node22 = this.selected_nodes[i];\n              node22.pin();\n            }\n            this.setDirty(true, true);\n          }\n        },\n        {\n          content: \"Colors\",\n          has_submenu: true,\n          callback: LGraphCanvas.onMenuNodeColors\n        },\n        {\n          content: \"Shapes\",\n          has_submenu: true,\n          callback: LGraphCanvas.onMenuNodeShapes\n        },\n        null\n      );\n    }\n    const extra = node2.getExtraMenuOptions?.(this, options);\n    if (Array.isArray(extra) && extra.length > 0) {\n      extra.push(null);\n      options = extra.concat(options);\n    }\n    if (node2.clonable !== false) {\n      options.push({\n        content: \"Clone\",\n        callback: LGraphCanvas.onMenuNodeClone\n      });\n    }\n    if (Object.keys(this.selected_nodes).length > 1) {\n      options.push({\n        content: \"Align Selected To\",\n        has_submenu: true,\n        callback: LGraphCanvas.onNodeAlign\n      }, {\n        content: \"Distribute Nodes\",\n        has_submenu: true,\n        callback: LGraphCanvas.createDistributeMenu\n      });\n    }\n    options.push(null, {\n      content: \"Remove\",\n      disabled: !(node2.removable !== false && !node2.block_delete),\n      callback: LGraphCanvas.onMenuNodeRemove\n    });\n    node2.graph?.onGetNodeMenuOptions?.(options, node2);\n    return options;\n  }\n  /** @deprecated */\n  getGroupMenuOptions(group) {\n    console.warn(\"LGraphCanvas.getGroupMenuOptions is deprecated, use LGraphGroup.getMenuOptions instead\");\n    return group.getMenuOptions();\n  }\n  processContextMenu(node2, event) {\n    const canvas2 = LGraphCanvas.active_canvas;\n    const ref_window = canvas2.getCanvasWindow();\n    let menu_info;\n    const options = {\n      event,\n      callback: inner_option_clicked,\n      extra: node2\n    };\n    if (node2) {\n      options.title = node2.displayType ?? node2.type ?? void 0;\n      LGraphCanvas.active_node = node2;\n      const slot = node2.getSlotInPosition(event.canvasX, event.canvasY);\n      if (slot) {\n        menu_info = [];\n        if (node2.getSlotMenuOptions) {\n          menu_info = node2.getSlotMenuOptions(slot);\n        } else {\n          if (slot.output?.links?.length || slot.input?.link != null) {\n            menu_info.push({ content: \"Disconnect Links\", slot });\n          }\n          const _slot = slot.input || slot.output;\n          if (!_slot) throw new TypeError(\"Both in put and output slots were null when processing context menu.\");\n          if (_slot.removable) {\n            menu_info.push(\n              _slot.locked ? \"Cannot remove\" : { content: \"Remove Slot\", slot }\n            );\n          }\n          if (!_slot.nameLocked && !(\"link\" in _slot && _slot.widget)) {\n            menu_info.push({ content: \"Rename Slot\", slot });\n          }\n          if (node2.getExtraSlotMenuOptions) {\n            menu_info.push(...node2.getExtraSlotMenuOptions(slot));\n          }\n        }\n        options.title = (slot.input ? slot.input.type : slot.output.type) || \"*\";\n        if (slot.input && slot.input.type == LiteGraph.ACTION)\n          options.title = \"Action\";\n        if (slot.output && slot.output.type == LiteGraph.EVENT)\n          options.title = \"Event\";\n      } else {\n        menu_info = this.getNodeMenuOptions(node2);\n      }\n    } else {\n      menu_info = this.getCanvasMenuOptions();\n      if (!this.graph) throw new NullGraphError();\n      if (this.links_render_mode !== LinkRenderType.HIDDEN_LINK) {\n        const reroute = this.graph.getRerouteOnPos(event.canvasX, event.canvasY, this.#visibleReroutes);\n        if (reroute) {\n          menu_info.unshift({\n            content: \"Delete Reroute\",\n            callback: () => {\n              if (!this.graph) throw new NullGraphError();\n              this.graph.removeReroute(reroute.id);\n            }\n          }, null);\n        }\n      }\n      const group = this.graph.getGroupOnPos(\n        event.canvasX,\n        event.canvasY\n      );\n      if (group) {\n        menu_info.push(null, {\n          content: \"Edit Group\",\n          has_submenu: true,\n          submenu: {\n            title: \"Group\",\n            extra: group,\n            options: group.getMenuOptions()\n          }\n        });\n      }\n    }\n    if (!menu_info) return;\n    new LiteGraph.ContextMenu(menu_info, options, ref_window);\n    const createDialog = (options2) => this.createDialog(\n      \"<span class='name'>Name</span><input autofocus type='text'/><button>OK</button>\",\n      options2\n    );\n    const setDirty = () => this.setDirty(true);\n    function inner_option_clicked(v2, options2) {\n      if (!v2) return;\n      if (v2.content == \"Remove Slot\") {\n        if (!node2?.graph) throw new NullGraphError();\n        const info = v2.slot;\n        if (!info) throw new TypeError(\"Found-slot info was null when processing context menu.\");\n        node2.graph.beforeChange();\n        if (info.input) {\n          node2.removeInput(info.slot);\n        } else if (info.output) {\n          node2.removeOutput(info.slot);\n        }\n        node2.graph.afterChange();\n        return;\n      } else if (v2.content == \"Disconnect Links\") {\n        if (!node2?.graph) throw new NullGraphError();\n        const info = v2.slot;\n        if (!info) throw new TypeError(\"Found-slot info was null when processing context menu.\");\n        node2.graph.beforeChange();\n        if (info.output) {\n          node2.disconnectOutput(info.slot);\n        } else if (info.input) {\n          node2.disconnectInput(info.slot, true);\n        }\n        node2.graph.afterChange();\n        return;\n      } else if (v2.content == \"Rename Slot\") {\n        if (!node2) throw new TypeError(\"`node` was null when processing the context menu.\");\n        const info = v2.slot;\n        if (!info) throw new TypeError(\"Found-slot info was null when processing context menu.\");\n        const slot_info = info.input ? node2.getInputInfo(info.slot) : node2.getOutputInfo(info.slot);\n        const dialog = createDialog(options2);\n        const input = dialog.querySelector(\"input\");\n        if (input && slot_info) {\n          input.value = slot_info.label || \"\";\n        }\n        const inner = function() {\n          if (!node2.graph) throw new NullGraphError();\n          node2.graph.beforeChange();\n          if (input?.value) {\n            if (slot_info) {\n              slot_info.label = input.value;\n            }\n            setDirty();\n          }\n          dialog.close();\n          node2.graph.afterChange();\n        };\n        dialog.querySelector(\"button\")?.addEventListener(\"click\", inner);\n        if (!input) throw new TypeError(\"Input element was null when processing context menu.\");\n        input.addEventListener(\"keydown\", function(e2) {\n          dialog.is_modified = true;\n          if (e2.key == \"Escape\") {\n            dialog.close();\n          } else if (e2.key == \"Enter\") {\n            inner();\n          } else if (e2.target.localName != \"textarea\") {\n            return;\n          }\n          e2.preventDefault();\n          e2.stopPropagation();\n        });\n        input.focus();\n      }\n    }\n  }\n  /**\n   * Starts an animation to fit the view around the specified selection of nodes.\n   * @param bounds The bounds to animate the view to, defined by a rectangle.\n   */\n  animateToBounds(bounds, options = {}) {\n    const setDirty = () => this.setDirty(true, true);\n    this.ds.animateToBounds(bounds, setDirty, options);\n  }\n  /**\n   * Fits the view to the selected nodes with animation.\n   * If nothing is selected, the view is fitted around all items in the graph.\n   */\n  fitViewToSelectionAnimated(options = {}) {\n    const items = this.selectedItems.size ? Array.from(this.selectedItems) : this.positionableItems;\n    const bounds = createBounds(items);\n    if (!bounds) throw new TypeError(\"Attempted to fit to view but could not calculate bounds.\");\n    const setDirty = () => this.setDirty(true, true);\n    this.ds.animateToBounds(bounds, setDirty, options);\n  }\n}\nclass MapProxyHandler {\n  getOwnPropertyDescriptor(target, p) {\n    const value = this.get(target, p);\n    if (value) {\n      return {\n        configurable: true,\n        enumerable: true,\n        value\n      };\n    }\n  }\n  has(target, p) {\n    if (typeof p === \"symbol\") return false;\n    const int = parseInt(p, 10);\n    return target.has(!isNaN(int) ? int : p);\n  }\n  ownKeys(target) {\n    return [...target.keys()].map(String);\n  }\n  get(target, p) {\n    if (p in target) return Reflect.get(target, p, target);\n    if (typeof p === \"symbol\") return;\n    const int = parseInt(p, 10);\n    return target.get(!isNaN(int) ? int : p);\n  }\n  set(target, p, newValue2) {\n    if (typeof p === \"symbol\") return false;\n    const int = parseInt(p, 10);\n    target.set(!isNaN(int) ? int : p, newValue2);\n    return true;\n  }\n  deleteProperty(target, p) {\n    return target.delete(p);\n  }\n  static bindAllMethods(map) {\n    map.clear = map.clear.bind(map);\n    map.delete = map.delete.bind(map);\n    map.forEach = map.forEach.bind(map);\n    map.get = map.get.bind(map);\n    map.has = map.has.bind(map);\n    map.set = map.set.bind(map);\n    map.entries = map.entries.bind(map);\n    map.keys = map.keys.bind(map);\n    map.values = map.values.bind(map);\n    map[Symbol.iterator] = map[Symbol.iterator].bind(map);\n  }\n}\nclass LGraph {\n  static serialisedSchemaVersion = 1;\n  static STATUS_STOPPED = 1;\n  static STATUS_RUNNING = 2;\n  /** List of LGraph properties that are manually handled by {@link LGraph.configure}. */\n  static ConfigureProperties = /* @__PURE__ */ new Set([\n    \"nodes\",\n    \"groups\",\n    \"links\",\n    \"state\",\n    \"reroutes\",\n    \"floatingLinks\",\n    \"id\",\n    \"subgraphs\",\n    \"definitions\",\n    \"inputs\",\n    \"outputs\",\n    \"widgets\",\n    \"inputNode\",\n    \"outputNode\",\n    \"extra\"\n  ]);\n  id = zeroUuid;\n  revision = 0;\n  _version = -1;\n  /** The backing store for links.  Keys are wrapped in String() */\n  _links = /* @__PURE__ */ new Map();\n  /**\n   * Indexed property access is deprecated.\n   * Backwards compatibility with a Proxy has been added, but will eventually be removed.\n   *\n   * Use {@link Map} methods:\n   * ```\n   * const linkId = 123\n   * const link = graph.links.get(linkId)\n   * // Deprecated: const link = graph.links[linkId]\n   * ```\n   */\n  links;\n  list_of_graphcanvas;\n  status = LGraph.STATUS_STOPPED;\n  state = {\n    lastGroupId: 0,\n    lastNodeId: 0,\n    lastLinkId: 0,\n    lastRerouteId: 0\n  };\n  events = new CustomEventTarget();\n  _subgraphs = /* @__PURE__ */ new Map();\n  _nodes = [];\n  _nodes_by_id = {};\n  _nodes_in_order = [];\n  _nodes_executable = null;\n  _groups = [];\n  iteration = 0;\n  globaltime = 0;\n  /** @deprecated Unused */\n  runningtime = 0;\n  fixedtime = 0;\n  fixedtime_lapse = 0.01;\n  elapsed_time = 0.01;\n  last_update_time = 0;\n  starttime = 0;\n  catch_errors = true;\n  execution_timer_id;\n  errors_in_execution;\n  /** @deprecated Unused */\n  execution_time;\n  _last_trigger_time;\n  filter;\n  /** Must contain serialisable values, e.g. primitive types */\n  config = {};\n  vars = {};\n  nodes_executing = [];\n  nodes_actioning = [];\n  nodes_executedAction = [];\n  extra = {};\n  /** @deprecated Deserialising a workflow sets this unused property. */\n  version;\n  /** @returns Whether the graph has no items */\n  get empty() {\n    return this._nodes.length + this._groups.length + this.reroutes.size === 0;\n  }\n  /** @returns All items on the canvas that can be selected */\n  *positionableItems() {\n    for (const node2 of this._nodes) yield node2;\n    for (const group of this._groups) yield group;\n    for (const reroute of this.reroutes.values()) yield reroute;\n    return;\n  }\n  /** Internal only.  Not required for serialisation; calculated on deserialise. */\n  #lastFloatingLinkId = 0;\n  #floatingLinks = /* @__PURE__ */ new Map();\n  get floatingLinks() {\n    return this.#floatingLinks;\n  }\n  #reroutes = /* @__PURE__ */ new Map();\n  /** All reroutes in this graph. */\n  get reroutes() {\n    return this.#reroutes;\n  }\n  get rootGraph() {\n    return this;\n  }\n  get isRootGraph() {\n    return this.rootGraph === this;\n  }\n  /** @deprecated See {@link state}.{@link LGraphState.lastNodeId lastNodeId} */\n  get last_node_id() {\n    return this.state.lastNodeId;\n  }\n  set last_node_id(value) {\n    this.state.lastNodeId = value;\n  }\n  /** @deprecated See {@link state}.{@link LGraphState.lastLinkId lastLinkId} */\n  get last_link_id() {\n    return this.state.lastLinkId;\n  }\n  set last_link_id(value) {\n    this.state.lastLinkId = value;\n  }\n  _input_nodes;\n  /**\n   * See {@link LGraph}\n   * @param o data from previous serialization [optional]\n   */\n  constructor(o) {\n    if (LiteGraph.debug) console.log(\"Graph created\");\n    const links = this._links;\n    MapProxyHandler.bindAllMethods(links);\n    const handler = new MapProxyHandler();\n    this.links = new Proxy(links, handler);\n    this.list_of_graphcanvas = null;\n    this.clear();\n    if (o) this.configure(o);\n  }\n  /**\n   * Removes all nodes from this graph\n   */\n  clear() {\n    this.stop();\n    this.status = LGraph.STATUS_STOPPED;\n    this.id = zeroUuid;\n    this.revision = 0;\n    this.state = {\n      lastGroupId: 0,\n      lastNodeId: 0,\n      lastLinkId: 0,\n      lastRerouteId: 0\n    };\n    this._version = -1;\n    this._subgraphs.clear();\n    if (this._nodes) {\n      for (const _node of this._nodes) {\n        _node.onRemoved?.();\n      }\n    }\n    this._nodes = [];\n    this._nodes_by_id = {};\n    this._nodes_in_order = [];\n    this._nodes_executable = null;\n    this._links.clear();\n    this.reroutes.clear();\n    this.#floatingLinks.clear();\n    this.#lastFloatingLinkId = 0;\n    this._groups = [];\n    this.iteration = 0;\n    this.config = {};\n    this.vars = {};\n    this.extra = {};\n    this.globaltime = 0;\n    this.runningtime = 0;\n    this.fixedtime = 0;\n    this.fixedtime_lapse = 0.01;\n    this.elapsed_time = 0.01;\n    this.last_update_time = 0;\n    this.starttime = 0;\n    this.catch_errors = true;\n    this.nodes_executing = [];\n    this.nodes_actioning = [];\n    this.nodes_executedAction = [];\n    this.change();\n    this.canvasAction((c) => c.clear());\n  }\n  get subgraphs() {\n    return this.rootGraph._subgraphs;\n  }\n  get nodes() {\n    return this._nodes;\n  }\n  get groups() {\n    return this._groups;\n  }\n  /**\n   * Attach Canvas to this graph\n   */\n  attachCanvas(canvas2) {\n    if (!(canvas2 instanceof LGraphCanvas)) {\n      throw new TypeError(\"attachCanvas expects an LGraphCanvas instance\");\n    }\n    this.primaryCanvas = canvas2;\n    this.list_of_graphcanvas ??= [];\n    if (!this.list_of_graphcanvas.includes(canvas2)) {\n      this.list_of_graphcanvas.push(canvas2);\n    }\n    if (canvas2.graph === this) return;\n    canvas2.graph?.detachCanvas(canvas2);\n    canvas2.graph = this;\n    canvas2.subgraph = void 0;\n  }\n  /**\n   * Detach Canvas from this graph\n   */\n  detachCanvas(canvas2) {\n    canvas2.graph = null;\n    const canvases = this.list_of_graphcanvas;\n    if (canvases) {\n      const pos = canvases.indexOf(canvas2);\n      if (pos !== -1) canvases.splice(pos, 1);\n    }\n  }\n  /**\n   * @deprecated Will be removed in 0.9\n   * Starts running this graph every interval milliseconds.\n   * @param interval amount of milliseconds between executions, if 0 then it renders to the monitor refresh rate\n   */\n  start(interval) {\n    if (this.status == LGraph.STATUS_RUNNING) return;\n    this.status = LGraph.STATUS_RUNNING;\n    this.onPlayEvent?.();\n    this.sendEventToAllNodes(\"onStart\");\n    this.starttime = LiteGraph.getTime();\n    this.last_update_time = this.starttime;\n    interval ||= 0;\n    if (interval == 0 && typeof window != \"undefined\" && window.requestAnimationFrame) {\n      const on_frame = () => {\n        if (this.execution_timer_id != -1) return;\n        window.requestAnimationFrame(on_frame);\n        this.onBeforeStep?.();\n        this.runStep(1, !this.catch_errors);\n        this.onAfterStep?.();\n      };\n      this.execution_timer_id = -1;\n      on_frame();\n    } else {\n      this.execution_timer_id = setInterval(() => {\n        this.onBeforeStep?.();\n        this.runStep(1, !this.catch_errors);\n        this.onAfterStep?.();\n      }, interval);\n    }\n  }\n  /**\n   * @deprecated Will be removed in 0.9\n   * Stops the execution loop of the graph\n   */\n  stop() {\n    if (this.status == LGraph.STATUS_STOPPED) return;\n    this.status = LGraph.STATUS_STOPPED;\n    this.onStopEvent?.();\n    if (this.execution_timer_id != null) {\n      if (this.execution_timer_id != -1) {\n        clearInterval(this.execution_timer_id);\n      }\n      this.execution_timer_id = null;\n    }\n    this.sendEventToAllNodes(\"onStop\");\n  }\n  /**\n   * Run N steps (cycles) of the graph\n   * @param num number of steps to run, default is 1\n   * @param do_not_catch_errors [optional] if you want to try/catch errors\n   * @param limit max number of nodes to execute (used to execute from start to a node)\n   */\n  runStep(num, do_not_catch_errors, limit) {\n    num = num || 1;\n    const start = LiteGraph.getTime();\n    this.globaltime = 1e-3 * (start - this.starttime);\n    const nodes = this._nodes_executable || this._nodes;\n    if (!nodes) return;\n    limit = limit || nodes.length;\n    if (do_not_catch_errors) {\n      for (let i = 0; i < num; i++) {\n        for (let j = 0; j < limit; ++j) {\n          const node2 = nodes[j];\n          if (node2.mode == LGraphEventMode.ALWAYS && node2.onExecute) {\n            node2.doExecute?.();\n          }\n        }\n        this.fixedtime += this.fixedtime_lapse;\n        this.onExecuteStep?.();\n      }\n      this.onAfterExecute?.();\n    } else {\n      try {\n        for (let i = 0; i < num; i++) {\n          for (let j = 0; j < limit; ++j) {\n            const node2 = nodes[j];\n            if (node2.mode == LGraphEventMode.ALWAYS) {\n              node2.onExecute?.();\n            }\n          }\n          this.fixedtime += this.fixedtime_lapse;\n          this.onExecuteStep?.();\n        }\n        this.onAfterExecute?.();\n        this.errors_in_execution = false;\n      } catch (error) {\n        this.errors_in_execution = true;\n        if (LiteGraph.throw_errors) throw error;\n        if (LiteGraph.debug) console.log(\"Error during execution:\", error);\n        this.stop();\n      }\n    }\n    const now = LiteGraph.getTime();\n    let elapsed = now - start;\n    if (elapsed == 0) elapsed = 1;\n    this.execution_time = 1e-3 * elapsed;\n    this.globaltime += 1e-3 * elapsed;\n    this.iteration += 1;\n    this.elapsed_time = (now - this.last_update_time) * 1e-3;\n    this.last_update_time = now;\n    this.nodes_executing = [];\n    this.nodes_actioning = [];\n    this.nodes_executedAction = [];\n  }\n  /**\n   * Updates the graph execution order according to relevance of the nodes (nodes with only outputs have more relevance than\n   * nodes with only inputs.\n   */\n  updateExecutionOrder() {\n    this._nodes_in_order = this.computeExecutionOrder(false);\n    this._nodes_executable = [];\n    for (const node2 of this._nodes_in_order) {\n      if (node2.onExecute) {\n        this._nodes_executable.push(node2);\n      }\n    }\n  }\n  // This is more internal, it computes the executable nodes in order and returns it\n  computeExecutionOrder(only_onExecute, set_level) {\n    const L = [];\n    const S = [];\n    const M = {};\n    const visited_links = {};\n    const remaining_links = {};\n    for (const node2 of this._nodes) {\n      if (only_onExecute && !node2.onExecute) {\n        continue;\n      }\n      M[node2.id] = node2;\n      let num = 0;\n      if (node2.inputs) {\n        for (const input of node2.inputs) {\n          if (input?.link != null) {\n            num += 1;\n          }\n        }\n      }\n      if (num == 0) {\n        S.push(node2);\n        if (set_level) node2._level = 1;\n      } else {\n        if (set_level) node2._level = 0;\n        remaining_links[node2.id] = num;\n      }\n    }\n    while (true) {\n      const node2 = S.shift();\n      if (node2 === void 0) break;\n      L.push(node2);\n      delete M[node2.id];\n      if (!node2.outputs) continue;\n      for (const output of node2.outputs) {\n        if (output?.links == null || output.links.length == 0)\n          continue;\n        for (const link_id of output.links) {\n          const link = this._links.get(link_id);\n          if (!link) continue;\n          if (visited_links[link.id]) continue;\n          const target_node = this.getNodeById(link.target_id);\n          if (target_node == null) {\n            visited_links[link.id] = true;\n            continue;\n          }\n          if (set_level) {\n            node2._level ??= 0;\n            if (!target_node._level || target_node._level <= node2._level) {\n              target_node._level = node2._level + 1;\n            }\n          }\n          visited_links[link.id] = true;\n          remaining_links[target_node.id] -= 1;\n          if (remaining_links[target_node.id] == 0) S.push(target_node);\n        }\n      }\n    }\n    for (const i in M) {\n      L.push(M[i]);\n    }\n    if (L.length != this._nodes.length && LiteGraph.debug)\n      console.warn(\"something went wrong, nodes missing\");\n    function setOrder(nodes) {\n      const l = nodes.length;\n      for (let i = 0; i < l; ++i) {\n        nodes[i].order = i;\n      }\n    }\n    setOrder(L);\n    L.sort(function(A, B) {\n      const Ap = A.constructor.priority || A.priority || 0;\n      const Bp = B.constructor.priority || B.priority || 0;\n      return Ap == Bp ? A.order - B.order : Ap - Bp;\n    });\n    setOrder(L);\n    return L;\n  }\n  /**\n   * Positions every node in a more readable manner\n   */\n  arrange(margin, layout) {\n    margin = margin || 100;\n    const nodes = this.computeExecutionOrder(false, true);\n    const columns = [];\n    for (const node2 of nodes) {\n      const col = node2._level || 1;\n      columns[col] ||= [];\n      columns[col].push(node2);\n    }\n    let x2 = margin;\n    for (const column of columns) {\n      if (!column) continue;\n      let max_size = 100;\n      let y = margin + LiteGraph.NODE_TITLE_HEIGHT;\n      for (const node2 of column) {\n        node2.pos[0] = layout == LiteGraph.VERTICAL_LAYOUT ? y : x2;\n        node2.pos[1] = layout == LiteGraph.VERTICAL_LAYOUT ? x2 : y;\n        const max_size_index = layout == LiteGraph.VERTICAL_LAYOUT ? 1 : 0;\n        if (node2.size[max_size_index] > max_size) {\n          max_size = node2.size[max_size_index];\n        }\n        const node_size_index = layout == LiteGraph.VERTICAL_LAYOUT ? 0 : 1;\n        y += node2.size[node_size_index] + margin + LiteGraph.NODE_TITLE_HEIGHT;\n      }\n      x2 += max_size + margin;\n    }\n    this.setDirtyCanvas(true, true);\n  }\n  /**\n   * Returns the amount of time the graph has been running in milliseconds\n   * @returns number of milliseconds the graph has been running\n   */\n  getTime() {\n    return this.globaltime;\n  }\n  /**\n   * Returns the amount of time accumulated using the fixedtime_lapse var.\n   * This is used in context where the time increments should be constant\n   * @returns number of milliseconds the graph has been running\n   */\n  getFixedTime() {\n    return this.fixedtime;\n  }\n  /**\n   * Returns the amount of time it took to compute the latest iteration.\n   * Take into account that this number could be not correct\n   * if the nodes are using graphical actions\n   * @returns number of milliseconds it took the last cycle\n   */\n  getElapsedTime() {\n    return this.elapsed_time;\n  }\n  /**\n   * @deprecated Will be removed in 0.9\n   * Sends an event to all the nodes, useful to trigger stuff\n   * @param eventname the name of the event (function to be called)\n   * @param params parameters in array format\n   */\n  sendEventToAllNodes(eventname, params, mode) {\n    mode = mode || LGraphEventMode.ALWAYS;\n    const nodes = this._nodes_in_order || this._nodes;\n    if (!nodes) return;\n    for (const node2 of nodes) {\n      if (!node2[eventname] || node2.mode != mode) continue;\n      if (params === void 0) {\n        node2[eventname]();\n      } else if (params && params.constructor === Array) {\n        node2[eventname].apply(node2, params);\n      } else {\n        node2[eventname](params);\n      }\n    }\n  }\n  /**\n   * Runs an action on every canvas registered to this graph.\n   * @param action Action to run for every canvas\n   */\n  canvasAction(action) {\n    const canvases = this.list_of_graphcanvas;\n    if (!canvases) return;\n    for (const canvas2 of canvases) action(canvas2);\n  }\n  /** @deprecated See {@link LGraph.canvasAction} */\n  sendActionToCanvas(action, params) {\n    const { list_of_graphcanvas } = this;\n    if (!list_of_graphcanvas) return;\n    for (const c of list_of_graphcanvas) {\n      c[action]?.apply(c, params);\n    }\n  }\n  /**\n   * Adds a new node instance to this graph\n   * @param node the instance of the node\n   */\n  add(node2, skip_compute_order) {\n    if (!node2) return;\n    const { state } = this;\n    if (LiteGraph.alwaysSnapToGrid) {\n      const snapTo = this.getSnapToGridSize();\n      if (snapTo) node2.snapToGrid(snapTo);\n    }\n    if (node2 instanceof LGraphGroup) {\n      if (node2.id == null || node2.id === -1) node2.id = ++state.lastGroupId;\n      if (node2.id > state.lastGroupId) state.lastGroupId = node2.id;\n      this._groups.push(node2);\n      this.setDirtyCanvas(true);\n      this.change();\n      node2.graph = this;\n      this._version++;\n      return;\n    }\n    if (node2.id != -1 && this._nodes_by_id[node2.id] != null) {\n      console.warn(\n        \"LiteGraph: there is already a node with this ID, changing it\"\n      );\n      node2.id = LiteGraph.use_uuids ? LiteGraph.uuidv4() : ++state.lastNodeId;\n    }\n    if (this._nodes.length >= LiteGraph.MAX_NUMBER_OF_NODES) {\n      throw \"LiteGraph: max number of nodes in a graph reached\";\n    }\n    if (LiteGraph.use_uuids) {\n      if (node2.id == null || node2.id == -1)\n        node2.id = LiteGraph.uuidv4();\n    } else {\n      if (node2.id == null || node2.id == -1) {\n        node2.id = ++state.lastNodeId;\n      } else if (typeof node2.id === \"number\" && state.lastNodeId < node2.id) {\n        state.lastNodeId = node2.id;\n      }\n    }\n    node2.graph = this;\n    this._version++;\n    this._nodes.push(node2);\n    this._nodes_by_id[node2.id] = node2;\n    node2.onAdded?.(this);\n    if (this.config.align_to_grid) node2.alignToGrid();\n    if (!skip_compute_order) this.updateExecutionOrder();\n    this.onNodeAdded?.(node2);\n    this.setDirtyCanvas(true);\n    this.change();\n    return node2;\n  }\n  /**\n   * Removes a node from the graph\n   * @param node the instance of the node\n   */\n  remove(node2) {\n    if (node2 instanceof LGraphGroup) {\n      this.canvasAction((c) => c.deselect(node2));\n      const index = this._groups.indexOf(node2);\n      if (index != -1) {\n        this._groups.splice(index, 1);\n      }\n      node2.graph = void 0;\n      this._version++;\n      this.setDirtyCanvas(true, true);\n      this.change();\n      return;\n    }\n    if (this._nodes_by_id[node2.id] == null) {\n      console.warn(\"LiteGraph: node not found\", node2);\n      return;\n    }\n    if (node2.ignore_remove) {\n      console.warn(\"LiteGraph: node cannot be removed\", node2);\n      return;\n    }\n    this.beforeChange();\n    const { inputs, outputs } = node2;\n    if (inputs) {\n      for (const [i, slot] of inputs.entries()) {\n        if (slot.link != null) node2.disconnectInput(i, true);\n      }\n    }\n    if (outputs) {\n      for (const [i, slot] of outputs.entries()) {\n        if (slot.links?.length) node2.disconnectOutput(i);\n      }\n    }\n    for (const link of this.floatingLinks.values()) {\n      if (link.origin_id === node2.id || link.target_id === node2.id) {\n        this.removeFloatingLink(link);\n      }\n    }\n    node2.onRemoved?.();\n    node2.graph = null;\n    this._version++;\n    const { list_of_graphcanvas } = this;\n    if (list_of_graphcanvas) {\n      for (const canvas2 of list_of_graphcanvas) {\n        if (canvas2.selected_nodes[node2.id])\n          delete canvas2.selected_nodes[node2.id];\n        canvas2.deselect(node2);\n      }\n    }\n    const pos = this._nodes.indexOf(node2);\n    if (pos != -1) this._nodes.splice(pos, 1);\n    delete this._nodes_by_id[node2.id];\n    this.onNodeRemoved?.(node2);\n    this.canvasAction((c) => c.checkPanels());\n    this.setDirtyCanvas(true, true);\n    this.afterChange();\n    this.change();\n    this.updateExecutionOrder();\n  }\n  /**\n   * Returns a node by its id.\n   */\n  getNodeById(id) {\n    return id != null ? this._nodes_by_id[id] : null;\n  }\n  /**\n   * Returns a list of nodes that matches a class\n   * @param classObject the class itself (not an string)\n   * @returns a list with all the nodes of this type\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-function-type\n  findNodesByClass(classObject, result) {\n    result = result || [];\n    result.length = 0;\n    const { _nodes } = this;\n    for (const node2 of _nodes) {\n      if (node2.constructor === classObject)\n        result.push(node2);\n    }\n    return result;\n  }\n  /**\n   * Returns a list of nodes that matches a type\n   * @param type the name of the node type\n   * @returns a list with all the nodes of this type\n   */\n  findNodesByType(type, result) {\n    const matchType = type.toLowerCase();\n    result = result || [];\n    result.length = 0;\n    const { _nodes } = this;\n    for (const node2 of _nodes) {\n      if (node2.type?.toLowerCase() == matchType)\n        result.push(node2);\n    }\n    return result;\n  }\n  /**\n   * Returns the first node that matches a name in its title\n   * @param title the name of the node to search\n   * @returns the node or null\n   */\n  findNodeByTitle(title) {\n    const { _nodes } = this;\n    for (const node2 of _nodes) {\n      if (node2.title == title)\n        return node2;\n    }\n    return null;\n  }\n  /**\n   * Returns a list of nodes that matches a name\n   * @param title the name of the node to search\n   * @returns a list with all the nodes with this name\n   */\n  findNodesByTitle(title) {\n    const result = [];\n    const { _nodes } = this;\n    for (const node2 of _nodes) {\n      if (node2.title == title)\n        result.push(node2);\n    }\n    return result;\n  }\n  /**\n   * Returns the top-most node in this position of the canvas\n   * @param x the x coordinate in canvas space\n   * @param y the y coordinate in canvas space\n   * @param nodeList a list with all the nodes to search from, by default is all the nodes in the graph\n   * @returns the node at this position or null\n   */\n  getNodeOnPos(x2, y, nodeList) {\n    const nodes = nodeList || this._nodes;\n    let i = nodes.length;\n    while (--i >= 0) {\n      const node2 = nodes[i];\n      if (node2.isPointInside(x2, y)) return node2;\n    }\n    return null;\n  }\n  /**\n   * Returns the top-most group in that position\n   * @param x The x coordinate in canvas space\n   * @param y The y coordinate in canvas space\n   * @returns The group or null\n   */\n  getGroupOnPos(x2, y) {\n    return this._groups.toReversed().find((g) => g.isPointInside(x2, y));\n  }\n  /**\n   * Returns the top-most group with a titlebar in the provided position.\n   * @param x The x coordinate in canvas space\n   * @param y The y coordinate in canvas space\n   * @returns The group or null\n   */\n  getGroupTitlebarOnPos(x2, y) {\n    return this._groups.toReversed().find((g) => g.isPointInTitlebar(x2, y));\n  }\n  /**\n   * Finds a reroute a the given graph point\n   * @param x X co-ordinate in graph space\n   * @param y Y co-ordinate in graph space\n   * @returns The first reroute under the given co-ordinates, or undefined\n   */\n  getRerouteOnPos(x2, y, reroutes) {\n    for (const reroute of reroutes ?? this.reroutes.values()) {\n      if (reroute.containsPoint([x2, y])) return reroute;\n    }\n  }\n  /**\n   * Snaps the provided items to a grid.\n   *\n   * Item positions are reounded to the nearest multiple of {@link LiteGraph.CANVAS_GRID_SIZE}.\n   *\n   * When {@link LiteGraph.alwaysSnapToGrid} is enabled\n   * and the grid size is falsy, a default of 1 is used.\n   * @param items The items to be snapped to the grid\n   * @todo Currently only snaps nodes.\n   */\n  snapToGrid(items) {\n    const snapTo = this.getSnapToGridSize();\n    if (!snapTo) return;\n    for (const item of getAllNestedItems(items)) {\n      if (!item.pinned) item.snapToGrid(snapTo);\n    }\n  }\n  /**\n   * Finds the size of the grid that items should be snapped to when moved.\n   * @returns The size of the grid that items should be snapped to\n   */\n  getSnapToGridSize() {\n    return LiteGraph.alwaysSnapToGrid ? LiteGraph.CANVAS_GRID_SIZE || 1 : LiteGraph.CANVAS_GRID_SIZE;\n  }\n  /**\n   * @deprecated Will be removed in 0.9\n   * Checks that the node type matches the node type registered,\n   * used when replacing a nodetype by a newer version during execution\n   * this replaces the ones using the old version with the new version\n   */\n  checkNodeTypes() {\n    const { _nodes } = this;\n    for (const [i, node2] of _nodes.entries()) {\n      const ctor = LiteGraph.registered_node_types[node2.type];\n      if (node2.constructor == ctor) continue;\n      console.log(\"node being replaced by newer version:\", node2.type);\n      const newnode = LiteGraph.createNode(node2.type);\n      if (!newnode) continue;\n      _nodes[i] = newnode;\n      newnode.configure(node2.serialize());\n      newnode.graph = this;\n      this._nodes_by_id[newnode.id] = newnode;\n      if (node2.inputs) newnode.inputs = [...node2.inputs];\n      if (node2.outputs) newnode.outputs = [...node2.outputs];\n    }\n    this.updateExecutionOrder();\n  }\n  // ********** GLOBALS *****************\n  trigger(action, param) {\n    this.onTrigger?.(action, param);\n  }\n  /** @todo Clean up - never implemented. */\n  triggerInput(name, value) {\n    const nodes = this.findNodesByTitle(name);\n    for (const node2 of nodes) {\n      node2.onTrigger(value);\n    }\n  }\n  /** @todo Clean up - never implemented. */\n  setCallback(name, func) {\n    const nodes = this.findNodesByTitle(name);\n    for (const node2 of nodes) {\n      node2.setTrigger(func);\n    }\n  }\n  // used for undo, called before any change is made to the graph\n  beforeChange(info) {\n    this.onBeforeChange?.(this, info);\n    this.canvasAction((c) => c.onBeforeChange?.(this));\n  }\n  // used to resend actions, called after any change is made to the graph\n  afterChange(info) {\n    this.onAfterChange?.(this, info);\n    this.canvasAction((c) => c.onAfterChange?.(this));\n  }\n  /**\n   * clears the triggered slot animation in all links (stop visual animation)\n   */\n  clearTriggeredSlots() {\n    for (const link_info of this._links.values()) {\n      if (!link_info) continue;\n      if (link_info._last_time) link_info._last_time = 0;\n    }\n  }\n  /* Called when something visually changed (not the graph!) */\n  change() {\n    if (LiteGraph.debug) {\n      console.log(\"Graph changed\");\n    }\n    this.canvasAction((c) => c.setDirty(true, true));\n    this.on_change?.(this);\n  }\n  setDirtyCanvas(fg, bg) {\n    this.canvasAction((c) => c.setDirty(fg, bg));\n  }\n  addFloatingLink(link) {\n    if (link.id === -1) {\n      link.id = ++this.#lastFloatingLinkId;\n    }\n    this.#floatingLinks.set(link.id, link);\n    const slot = link.target_id !== -1 ? this.getNodeById(link.target_id)?.inputs?.[link.target_slot] : this.getNodeById(link.origin_id)?.outputs?.[link.origin_slot];\n    if (slot) {\n      slot._floatingLinks ??= /* @__PURE__ */ new Set();\n      slot._floatingLinks.add(link);\n    } else {\n      console.warn(`Adding invalid floating link: target/slot: [${link.target_id}/${link.target_slot}] origin/slot: [${link.origin_id}/${link.origin_slot}]`);\n    }\n    const reroutes = LLink.getReroutes(this, link);\n    for (const reroute of reroutes) {\n      reroute.floatingLinkIds.add(link.id);\n    }\n    return link;\n  }\n  removeFloatingLink(link) {\n    this.#floatingLinks.delete(link.id);\n    const slot = link.target_id !== -1 ? this.getNodeById(link.target_id)?.inputs?.[link.target_slot] : this.getNodeById(link.origin_id)?.outputs?.[link.origin_slot];\n    if (slot) {\n      slot._floatingLinks?.delete(link);\n    }\n    const reroutes = LLink.getReroutes(this, link);\n    for (const reroute of reroutes) {\n      reroute.floatingLinkIds.delete(link.id);\n      if (reroute.floatingLinkIds.size === 0) {\n        delete reroute.floating;\n      }\n      if (reroute.totalLinks === 0) this.removeReroute(reroute.id);\n    }\n  }\n  getLink(id) {\n    return id == null ? void 0 : this._links.get(id);\n  }\n  getReroute(id) {\n    return id == null ? void 0 : this.reroutes.get(id);\n  }\n  /**\n   * Configures a reroute on the graph where ID is already known (probably deserialisation).\n   * Creates the object if it does not exist.\n   * @param serialisedReroute See {@link SerialisableReroute}\n   */\n  setReroute({ id, parentId, pos, linkIds, floating }) {\n    id ??= ++this.state.lastRerouteId;\n    if (id > this.state.lastRerouteId) this.state.lastRerouteId = id;\n    const reroute = this.reroutes.get(id) ?? new Reroute(id, this);\n    reroute.update(parentId, pos, linkIds, floating);\n    this.reroutes.set(id, reroute);\n    return reroute;\n  }\n  /**\n   * Creates a new reroute and adds it to the graph.\n   * @param pos Position in graph space\n   * @param before The existing link segment (reroute, link) that will be after this reroute,\n   * going from the node output to input.\n   * @returns The newly created reroute - typically ignored.\n   */\n  createReroute(pos, before) {\n    const rerouteId = ++this.state.lastRerouteId;\n    const linkIds = before instanceof Reroute ? before.linkIds : [before.id];\n    const floatingLinkIds = before instanceof Reroute ? before.floatingLinkIds : [before.id];\n    const reroute = new Reroute(rerouteId, this, pos, before.parentId, linkIds, floatingLinkIds);\n    this.reroutes.set(rerouteId, reroute);\n    for (const linkId of linkIds) {\n      const link = this._links.get(linkId);\n      if (!link) continue;\n      if (link.parentId === before.parentId) link.parentId = rerouteId;\n      const reroutes = LLink.getReroutes(this, link);\n      for (const x2 of reroutes.filter((x22) => x22.parentId === before.parentId)) {\n        x2.parentId = rerouteId;\n      }\n    }\n    for (const linkId of floatingLinkIds) {\n      const link = this.floatingLinks.get(linkId);\n      if (!link) continue;\n      if (link.parentId === before.parentId) link.parentId = rerouteId;\n      const reroutes = LLink.getReroutes(this, link);\n      for (const x2 of reroutes.filter((x22) => x22.parentId === before.parentId)) {\n        x2.parentId = rerouteId;\n      }\n    }\n    return reroute;\n  }\n  /**\n   * Removes a reroute from the graph\n   * @param id ID of reroute to remove\n   */\n  removeReroute(id) {\n    const { reroutes } = this;\n    const reroute = reroutes.get(id);\n    if (!reroute) return;\n    this.canvasAction((c) => c.deselect(reroute));\n    const { parentId, linkIds, floatingLinkIds } = reroute;\n    for (const reroute2 of reroutes.values()) {\n      if (reroute2.parentId === id) reroute2.parentId = parentId;\n    }\n    for (const linkId of linkIds) {\n      const link = this._links.get(linkId);\n      if (link && link.parentId === id) link.parentId = parentId;\n    }\n    for (const linkId of floatingLinkIds) {\n      const link = this.floatingLinks.get(linkId);\n      if (!link) {\n        console.warn(`Removed reroute had floating link ID that did not exist [${linkId}]`);\n        continue;\n      }\n      const floatingReroutes = LLink.getReroutes(this, link);\n      const lastReroute = floatingReroutes.at(-1);\n      const secondLastReroute = floatingReroutes.at(-2);\n      if (reroute !== lastReroute) {\n        continue;\n      } else if (secondLastReroute?.totalLinks !== 1) {\n        this.removeFloatingLink(link);\n      } else if (link.parentId === id) {\n        link.parentId = parentId;\n        secondLastReroute.floating = reroute.floating;\n      }\n    }\n    reroutes.delete(id);\n    this.setDirtyCanvas(false, true);\n  }\n  /**\n   * Destroys a link\n   */\n  removeLink(link_id) {\n    const link = this._links.get(link_id);\n    if (!link) return;\n    const node2 = this.getNodeById(link.target_id);\n    node2?.disconnectInput(link.target_slot, false);\n    link.disconnect(this);\n  }\n  /**\n   * Creates a new subgraph definition, and adds it to the graph.\n   * @param data Exported data (typically serialised) to configure the new subgraph with\n   * @returns The newly created subgraph definition.\n   */\n  createSubgraph(data) {\n    const { id } = data;\n    const subgraph = new Subgraph(this.rootGraph, data);\n    this.subgraphs.set(id, subgraph);\n    this.rootGraph.events.dispatch(\"subgraph-created\", { subgraph, data });\n    return subgraph;\n  }\n  convertToSubgraph(items) {\n    if (items.size === 0) throw new Error(\"Cannot convert to subgraph: nothing to convert\");\n    const { state, revision, config } = this;\n    const { boundaryLinks, boundaryFloatingLinks, internalLinks, boundaryInputLinks, boundaryOutputLinks } = getBoundaryLinks(this, items);\n    const { nodes, reroutes, groups } = splitPositionables(items);\n    const boundingRect = createBounds(items);\n    if (!boundingRect) throw new Error(\"Failed to create bounding rect for subgraph\");\n    const resolvedInputLinks = boundaryInputLinks.map((x2) => x2.resolve(this));\n    const resolvedOutputLinks = boundaryOutputLinks.map((x2) => x2.resolve(this));\n    const clonedNodes = multiClone(nodes);\n    const links = internalLinks.map((x2) => x2.asSerialisable());\n    const inputs = mapSubgraphInputsAndLinks(resolvedInputLinks, links);\n    const outputs = mapSubgraphOutputsAndLinks(resolvedOutputLinks, links);\n    const data = {\n      id: createUuidv4(),\n      name: \"New Subgraph\",\n      inputNode: {\n        id: SUBGRAPH_INPUT_ID,\n        bounding: [0, 0, 75, 100]\n      },\n      outputNode: {\n        id: SUBGRAPH_OUTPUT_ID,\n        bounding: [0, 0, 75, 100]\n      },\n      inputs,\n      outputs,\n      widgets: [],\n      version: LGraph.serialisedSchemaVersion,\n      state,\n      revision,\n      config,\n      links,\n      nodes: clonedNodes,\n      reroutes: structuredClone([...reroutes].map((reroute) => reroute.asSerialisable())),\n      groups: structuredClone([...groups].map((group) => group.serialize()))\n    };\n    const subgraph = this.createSubgraph(data);\n    subgraph.configure(data);\n    subgraph.inputNode.arrange();\n    subgraph.outputNode.arrange();\n    const { boundingRect: inputRect } = subgraph.inputNode;\n    const { boundingRect: outputRect } = subgraph.outputNode;\n    alignOutsideContainer(inputRect, Alignment.MidLeft, boundingRect, [50, 0]);\n    alignOutsideContainer(outputRect, Alignment.MidRight, boundingRect, [50, 0]);\n    for (const resolved of resolvedInputLinks) resolved.inputNode?.disconnectInput(resolved.inputNode.inputs.indexOf(resolved.input), true);\n    for (const resolved of resolvedOutputLinks) resolved.outputNode?.disconnectOutput(resolved.outputNode.outputs.indexOf(resolved.output), resolved.inputNode);\n    for (const node2 of nodes) this.remove(node2);\n    for (const reroute of reroutes) this.removeReroute(reroute.id);\n    for (const group of groups) this.remove(group);\n    this.rootGraph.events.dispatch(\"convert-to-subgraph\", {\n      subgraph,\n      bounds: boundingRect,\n      exportedSubgraph: data,\n      boundaryLinks,\n      resolvedInputLinks,\n      resolvedOutputLinks,\n      boundaryFloatingLinks,\n      internalLinks\n    });\n    const subgraphNode = LiteGraph.createNode(subgraph.id, subgraph.name, {\n      inputs: structuredClone(inputs),\n      outputs: structuredClone(outputs)\n    });\n    if (!subgraphNode) throw new Error(\"Failed to create subgraph node\");\n    subgraphNode.setSize(subgraphNode.computeSize());\n    alignToContainer(subgraphNode._posSize, Alignment.Centre | Alignment.Middle, boundingRect);\n    this.add(subgraphNode);\n    const groupedByOutput = groupResolvedByOutput(resolvedInputLinks);\n    let i = 0;\n    for (const [, connections] of groupedByOutput.entries()) {\n      const [firstResolved, ...others] = connections;\n      const { output, outputNode, link, subgraphInput } = firstResolved;\n      i++;\n      if (link.origin_id === SUBGRAPH_INPUT_ID) {\n        link.target_id = subgraphNode.id;\n        link.target_slot = i - 1;\n        if (subgraphInput instanceof SubgraphInput) {\n          subgraphInput.connect(subgraphNode.findInputSlotByType(link.type, true, true), subgraphNode, link.parentId);\n        } else {\n          throw new TypeError(\"Subgraph input node is not a SubgraphInput\");\n        }\n        console.debug(\"Reconnect input links in parent graph\", { ...link }, this.links.get(link.id), this.links.get(link.id) === link);\n        for (const resolved of others) {\n          resolved.link.disconnect(this);\n        }\n        continue;\n      }\n      if (!output || !outputNode) {\n        console.warn(\"Convert to Subgraph reconnect: Failed to resolve input link\", connections[0]);\n        continue;\n      }\n      const input = subgraphNode.findInputSlotByType(link.type, true, true);\n      outputNode.connectSlots(\n        output,\n        subgraphNode,\n        input,\n        link.parentId\n      );\n    }\n    const outputsGroupedByOutput = groupResolvedByOutput(resolvedOutputLinks);\n    i = 0;\n    for (const [, connections] of outputsGroupedByOutput.entries()) {\n      i++;\n      for (const connection of connections) {\n        const { input, inputNode, link, subgraphOutput } = connection;\n        if (link.target_id === SUBGRAPH_OUTPUT_ID) {\n          link.origin_id = subgraphNode.id;\n          link.origin_slot = i - 1;\n          this.links.set(link.id, link);\n          if (subgraphOutput instanceof SubgraphOutput) {\n            subgraphOutput.connect(subgraphNode.findOutputSlotByType(link.type, true, true), subgraphNode, link.parentId);\n          } else {\n            throw new TypeError(\"Subgraph input node is not a SubgraphInput\");\n          }\n          continue;\n        }\n        if (!input || !inputNode) {\n          console.warn(\"Convert to Subgraph reconnect: Failed to resolve output link\", connection);\n          continue;\n        }\n        const output = subgraphNode.outputs[i - 1];\n        subgraphNode.connectSlots(\n          output,\n          inputNode,\n          input,\n          link.parentId\n        );\n      }\n    }\n    return { subgraph, node: subgraphNode };\n  }\n  /**\n   * Resolve a path of subgraph node IDs into a list of subgraph nodes.\n   * Not intended to be run from subgraphs.\n   * @param nodeIds An ordered list of node IDs, from the root graph to the most nested subgraph node\n   * @returns An ordered list of nested subgraph nodes.\n   */\n  resolveSubgraphIdPath(nodeIds) {\n    const result = [];\n    let currentGraph = this.rootGraph;\n    for (const nodeId of nodeIds) {\n      const node2 = currentGraph.getNodeById(nodeId);\n      if (!node2) throw new Error(`Node [${nodeId}] not found.  ID Path: ${nodeIds.join(\":\")}`);\n      if (!node2.isSubgraphNode()) throw new Error(`Node [${nodeId}] is not a SubgraphNode.  ID Path: ${nodeIds.join(\":\")}`);\n      result.push(node2);\n      currentGraph = node2.subgraph;\n    }\n    return result;\n  }\n  /**\n   * Creates a Object containing all the info about this graph, it can be serialized\n   * @deprecated Use {@link asSerialisable}, which returns the newer schema version.\n   * @returns value of the node\n   */\n  serialize(option) {\n    const { config, state, groups, nodes, reroutes, extra, floatingLinks, definitions } = this.asSerialisable(option);\n    const linkArray = [...this._links.values()];\n    const links = linkArray.map((x2) => x2.serialize());\n    if (reroutes?.length) {\n      extra.linkExtensions = linkArray.filter((x2) => x2.parentId !== void 0).map((x2) => ({ id: x2.id, parentId: x2.parentId }));\n    }\n    extra.reroutes = reroutes?.length ? reroutes : void 0;\n    return {\n      id: this.id,\n      revision: this.revision,\n      last_node_id: state.lastNodeId,\n      last_link_id: state.lastLinkId,\n      nodes,\n      links,\n      floatingLinks,\n      groups,\n      definitions,\n      config,\n      extra,\n      version: LiteGraph.VERSION\n    };\n  }\n  /** @returns The drag and scale state of the first attached canvas, otherwise `undefined`. */\n  #getDragAndScale() {\n    const ds = this.list_of_graphcanvas?.at(0)?.ds;\n    if (ds) return { scale: ds.scale, offset: ds.offset };\n  }\n  /**\n   * Prepares a shallow copy of this object for immediate serialisation or structuredCloning.\n   * The return value should be discarded immediately.\n   * @param options Serialise options = currently `sortNodes: boolean`, whether to sort nodes by ID.\n   * @returns A shallow copy of parts of this graph, with shallow copies of its serialisable objects.\n   * Mutating the properties of the return object may result in changes to your graph.\n   * It is intended for use with {@link structuredClone} or {@link JSON.stringify}.\n   */\n  asSerialisable(options) {\n    const { id, revision, config, state } = this;\n    const nodeList = !LiteGraph.use_uuids && options?.sortNodes ? [...this._nodes].sort((a, b) => a.id - b.id) : this._nodes;\n    const nodes = nodeList.map((node2) => node2.serialize());\n    const groups = this._groups.map((x2) => x2.serialize());\n    const links = this._links.size ? [...this._links.values()].map((x2) => x2.asSerialisable()) : void 0;\n    const floatingLinks = this.floatingLinks.size ? [...this.floatingLinks.values()].map((x2) => x2.asSerialisable()) : void 0;\n    const reroutes = this.reroutes.size ? [...this.reroutes.values()].map((x2) => x2.asSerialisable()) : void 0;\n    const extra = { ...this.extra };\n    if (LiteGraph.saveViewportWithGraph) extra.ds = this.#getDragAndScale();\n    if (!extra.ds) delete extra.ds;\n    const data = {\n      id,\n      revision,\n      version: LGraph.serialisedSchemaVersion,\n      config,\n      state,\n      groups,\n      nodes,\n      links,\n      floatingLinks,\n      reroutes,\n      extra\n    };\n    if (this.isRootGraph && this._subgraphs.size) {\n      const usedSubgraphIds = findUsedSubgraphIds(this, this._subgraphs);\n      const usedSubgraphs = [...this._subgraphs.values()].filter((subgraph) => usedSubgraphIds.has(subgraph.id)).map((x2) => x2.asSerialisable());\n      if (usedSubgraphs.length > 0) {\n        data.definitions = { subgraphs: usedSubgraphs };\n      }\n    }\n    this.onSerialize?.(data);\n    return data;\n  }\n  _configureBase(data) {\n    const { id, extra } = data;\n    if (id) {\n      this.id = id;\n    } else if (this.id === zeroUuid) {\n      this.id = createUuidv4();\n    }\n    this.extra = extra ? structuredClone(extra) : {};\n    delete this.extra.linkExtensions;\n  }\n  /**\n   * Configure a graph from a JSON string\n   * @param data The deserialised object to configure this graph from\n   * @param keep_old If `true`, the graph will not be cleared prior to\n   * adding the configuration.\n   */\n  configure(data, keep_old) {\n    const options = {\n      data,\n      clearGraph: !keep_old\n    };\n    const mayContinue = this.events.dispatch(\"configuring\", options);\n    if (!mayContinue) return;\n    try {\n      if (!data) return;\n      if (options.clearGraph) this.clear();\n      this._configureBase(data);\n      let reroutes;\n      if (data.version === 0.4) {\n        const { extra } = data;\n        if (Array.isArray(data.links)) {\n          for (const linkData of data.links) {\n            const link = LLink.createFromArray(linkData);\n            this._links.set(link.id, link);\n          }\n        }\n        if (Array.isArray(extra?.linkExtensions)) {\n          for (const linkEx of extra.linkExtensions) {\n            const link = this._links.get(linkEx.id);\n            if (link) link.parentId = linkEx.parentId;\n          }\n        }\n        reroutes = extra?.reroutes;\n      } else {\n        if (data.state) {\n          const { lastGroupId, lastLinkId, lastNodeId, lastRerouteId } = data.state;\n          const { state } = this;\n          if (lastGroupId != null) state.lastGroupId = lastGroupId;\n          if (lastLinkId != null) state.lastLinkId = lastLinkId;\n          if (lastNodeId != null) state.lastNodeId = lastNodeId;\n          if (lastRerouteId != null) state.lastRerouteId = lastRerouteId;\n        }\n        if (Array.isArray(data.links)) {\n          for (const linkData of data.links) {\n            const link = LLink.create(linkData);\n            this._links.set(link.id, link);\n          }\n        }\n        reroutes = data.reroutes;\n      }\n      if (Array.isArray(reroutes)) {\n        for (const rerouteData of reroutes) {\n          this.setReroute(rerouteData);\n        }\n      }\n      const nodesData = data.nodes;\n      for (const i in data) {\n        if (LGraph.ConfigureProperties.has(i)) continue;\n        this[i] = data[i];\n      }\n      const subgraphs = data.definitions?.subgraphs;\n      if (subgraphs) {\n        for (const subgraph of subgraphs) this.createSubgraph(subgraph);\n        for (const subgraph of subgraphs) this.subgraphs.get(subgraph.id)?.configure(subgraph);\n      }\n      let error = false;\n      const nodeDataMap = /* @__PURE__ */ new Map();\n      this._nodes = [];\n      if (nodesData) {\n        for (const n_info of nodesData) {\n          let node2 = LiteGraph.createNode(String(n_info.type), n_info.title);\n          if (!node2) {\n            if (LiteGraph.debug) console.log(\"Node not found or has errors:\", n_info.type);\n            node2 = new LGraphNode(\"\");\n            node2.last_serialization = n_info;\n            node2.has_errors = true;\n            error = true;\n          }\n          node2.id = n_info.id;\n          this.add(node2, true);\n          nodeDataMap.set(node2.id, n_info);\n        }\n        for (const [id, nodeData] of nodeDataMap) {\n          this.getNodeById(id)?.configure(nodeData);\n        }\n      }\n      if (Array.isArray(data.floatingLinks)) {\n        for (const linkData of data.floatingLinks) {\n          const floatingLink = LLink.create(linkData);\n          this.addFloatingLink(floatingLink);\n          if (floatingLink.id > this.#lastFloatingLinkId) this.#lastFloatingLinkId = floatingLink.id;\n        }\n      }\n      for (const reroute of this.reroutes.values()) {\n        if (!reroute.validateLinks(this._links, this.floatingLinks)) {\n          this.reroutes.delete(reroute.id);\n        }\n      }\n      this._groups.length = 0;\n      const groupData = data.groups;\n      if (groupData) {\n        for (const data2 of groupData) {\n          const group = new LiteGraph.LGraphGroup();\n          group.configure(data2);\n          this.add(group);\n        }\n      }\n      this.updateExecutionOrder();\n      this.onConfigure?.(data);\n      this._version++;\n      const { primaryCanvas } = this;\n      const subgraphId = primaryCanvas?.subgraph?.id;\n      if (subgraphId) {\n        const subgraph = this.subgraphs.get(subgraphId);\n        if (subgraph) {\n          primaryCanvas.setGraph(subgraph);\n        } else {\n          primaryCanvas.setGraph(this);\n        }\n      }\n      this.setDirtyCanvas(true, true);\n      return error;\n    } finally {\n      this.events.dispatch(\"configured\");\n    }\n  }\n  #canvas;\n  get primaryCanvas() {\n    return this.rootGraph.#canvas;\n  }\n  set primaryCanvas(canvas2) {\n    this.rootGraph.#canvas = canvas2;\n  }\n  load(url, callback) {\n    const that = this;\n    if (url instanceof Blob || url instanceof File) {\n      const reader = new FileReader();\n      reader.addEventListener(\"load\", function(event) {\n        const result = stringOrEmpty(event.target?.result);\n        const data = JSON.parse(result);\n        that.configure(data);\n        callback?.();\n      });\n      reader.readAsText(url);\n      return;\n    }\n    const req = new XMLHttpRequest();\n    req.open(\"GET\", url, true);\n    req.send(null);\n    req.addEventListener(\"load\", function() {\n      if (req.status !== 200) {\n        console.error(\"Error loading graph:\", req.status, req.response);\n        return;\n      }\n      const data = JSON.parse(req.response);\n      that.configure(data);\n      callback?.();\n    });\n    req.addEventListener(\"error\", (err) => {\n      console.error(\"Error loading graph:\", err);\n    });\n  }\n}\nclass Subgraph extends LGraph {\n  /** Limits the number of levels / depth that subgraphs may be nested.  Prevents uncontrolled programmatic nesting. */\n  static MAX_NESTED_SUBGRAPHS = 1e3;\n  /** The display name of the subgraph. */\n  name = \"Unnamed Subgraph\";\n  inputNode = new SubgraphInputNode(this);\n  outputNode = new SubgraphOutputNode(this);\n  /** Ordered list of inputs to the subgraph itself. Similar to a reroute, with the input side in the graph, and the output side in the subgraph. */\n  inputs = [];\n  /** Ordered list of outputs from the subgraph itself. Similar to a reroute, with the input side in the subgraph, and the output side in the graph. */\n  outputs = [];\n  /** A list of node widgets displayed in the parent graph, on the subgraph object. */\n  widgets = [];\n  #rootGraph;\n  get rootGraph() {\n    return this.#rootGraph;\n  }\n  constructor(rootGraph, data) {\n    if (!rootGraph) throw new Error(\"Root graph is required\");\n    super();\n    this.#rootGraph = rootGraph;\n    const cloned = structuredClone(data);\n    this._configureBase(cloned);\n    this.#configureSubgraph(cloned);\n  }\n  getIoNodeOnPos(x2, y) {\n    const { inputNode, outputNode } = this;\n    if (inputNode.containsPoint([x2, y])) return inputNode;\n    if (outputNode.containsPoint([x2, y])) return outputNode;\n  }\n  #configureSubgraph(data) {\n    const { name, inputs, outputs, widgets } = data;\n    this.name = name;\n    if (inputs) {\n      this.inputs.length = 0;\n      for (const input of inputs) {\n        const subgraphInput = new SubgraphInput(input, this.inputNode);\n        this.inputs.push(subgraphInput);\n        this.events.dispatch(\"input-added\", { input: subgraphInput });\n      }\n    }\n    if (outputs) {\n      this.outputs.length = 0;\n      for (const output of outputs) {\n        this.outputs.push(new SubgraphOutput(output, this.outputNode));\n      }\n    }\n    if (widgets) {\n      this.widgets.length = 0;\n      for (const widget of widgets) {\n        this.widgets.push(widget);\n      }\n    }\n    this.inputNode.configure(data.inputNode);\n    this.outputNode.configure(data.outputNode);\n  }\n  configure(data, keep_old) {\n    const r = super.configure(data, keep_old);\n    this.#configureSubgraph(data);\n    return r;\n  }\n  attachCanvas(canvas2) {\n    super.attachCanvas(canvas2);\n    canvas2.subgraph = this;\n  }\n  addInput(name, type) {\n    this.events.dispatch(\"adding-input\", { name, type });\n    const input = new SubgraphInput({\n      id: createUuidv4(),\n      name,\n      type\n    }, this.inputNode);\n    this.inputs.push(input);\n    this.events.dispatch(\"input-added\", { input });\n    return input;\n  }\n  addOutput(name, type) {\n    this.events.dispatch(\"adding-output\", { name, type });\n    const output = new SubgraphOutput({\n      id: createUuidv4(),\n      name,\n      type\n    }, this.outputNode);\n    this.outputs.push(output);\n    this.events.dispatch(\"output-added\", { output });\n    return output;\n  }\n  /**\n   * Renames an input slot in the subgraph.\n   * @param input The input slot to rename.\n   * @param name The new name for the input slot.\n   */\n  renameInput(input, name) {\n    const index = this.inputs.indexOf(input);\n    if (index === -1) throw new Error(\"Input not found\");\n    const oldName = input.displayName;\n    this.events.dispatch(\"renaming-input\", { input, index, oldName, newName: name });\n    input.label = name;\n  }\n  /**\n   * Renames an output slot in the subgraph.\n   * @param output The output slot to rename.\n   * @param name The new name for the output slot.\n   */\n  renameOutput(output, name) {\n    const index = this.outputs.indexOf(output);\n    if (index === -1) throw new Error(\"Output not found\");\n    const oldName = output.displayName;\n    this.events.dispatch(\"renaming-output\", { output, index, oldName, newName: name });\n    output.label = name;\n  }\n  /**\n   * Removes an input slot from the subgraph.\n   * @param input The input slot to remove.\n   */\n  removeInput(input) {\n    input.disconnect();\n    const index = this.inputs.indexOf(input);\n    if (index === -1) throw new Error(\"Input not found\");\n    const mayContinue = this.events.dispatch(\"removing-input\", { input, index });\n    if (!mayContinue) return;\n    this.inputs.splice(index, 1);\n    const { length } = this.inputs;\n    for (let i = index; i < length; i++) {\n      this.inputs[i].decrementSlots(\"inputs\");\n    }\n  }\n  /**\n   * Removes an output slot from the subgraph.\n   * @param output The output slot to remove.\n   */\n  removeOutput(output) {\n    output.disconnect();\n    const index = this.outputs.indexOf(output);\n    if (index === -1) throw new Error(\"Output not found\");\n    const mayContinue = this.events.dispatch(\"removing-output\", { output, index });\n    if (!mayContinue) return;\n    this.outputs.splice(index, 1);\n    const { length } = this.outputs;\n    for (let i = index; i < length; i++) {\n      this.outputs[i].decrementSlots(\"outputs\");\n    }\n  }\n  draw(ctx, colorContext, fromSlot, editorAlpha) {\n    this.inputNode.draw(ctx, colorContext, fromSlot, editorAlpha);\n    this.outputNode.draw(ctx, colorContext, fromSlot, editorAlpha);\n  }\n  /**\n   * Clones the subgraph, creating an identical copy with a new ID.\n   * @returns A new subgraph with the same configuration, but a new ID.\n   */\n  clone(keepId = false) {\n    const exported = this.asSerialisable();\n    if (!keepId) exported.id = createUuidv4();\n    const subgraph = new Subgraph(this.rootGraph, exported);\n    subgraph.configure(exported);\n    return subgraph;\n  }\n  asSerialisable() {\n    return {\n      id: this.id,\n      version: LGraph.serialisedSchemaVersion,\n      state: this.state,\n      revision: this.revision,\n      config: this.config,\n      name: this.name,\n      inputNode: this.inputNode.asSerialisable(),\n      outputNode: this.outputNode.asSerialisable(),\n      inputs: this.inputs.map((x2) => x2.asSerialisable()),\n      outputs: this.outputs.map((x2) => x2.asSerialisable()),\n      widgets: [...this.widgets],\n      nodes: this.nodes.map((node2) => node2.serialize()),\n      groups: this.groups.map((group) => group.serialize()),\n      links: [...this.links.values()].map((x2) => x2.asSerialisable()),\n      extra: this.extra\n    };\n  }\n}\nclass InputIndicators {\n  constructor(canvas2) {\n    this.canvas = canvas2;\n    this.controller = new AbortController();\n    const { signal } = this.controller;\n    const element = canvas2.canvas;\n    const options = { capture: true, signal };\n    element.addEventListener(\"pointerdown\", this.#onPointerDownOrMove, options);\n    element.addEventListener(\"pointermove\", this.#onPointerDownOrMove, options);\n    element.addEventListener(\"pointerup\", this.#onPointerUp, options);\n    element.addEventListener(\"keydown\", this.#onKeyDownOrUp, options);\n    document.addEventListener(\"keyup\", this.#onKeyDownOrUp, options);\n    const origDrawFrontCanvas = canvas2.drawFrontCanvas.bind(canvas2);\n    signal.addEventListener(\"abort\", () => {\n      canvas2.drawFrontCanvas = origDrawFrontCanvas;\n    });\n    canvas2.drawFrontCanvas = () => {\n      origDrawFrontCanvas();\n      this.draw();\n    };\n  }\n  // #region config\n  radius = 8;\n  startAngle = 0;\n  endAngle = Math.PI * 2;\n  inactiveColour = \"#ffffff10\";\n  colour1 = \"#ff5f00\";\n  colour2 = \"#00ff7c\";\n  colour3 = \"#dea7ff\";\n  fontString = \"bold 12px Arial\";\n  // #endregion\n  // #region state\n  enabled = true;\n  shiftDown = false;\n  undoDown = false;\n  redoDown = false;\n  ctrlDown = false;\n  altDown = false;\n  mouse0Down = false;\n  mouse1Down = false;\n  mouse2Down = false;\n  x = 0;\n  y = 0;\n  // #endregion\n  controller;\n  #onPointerDownOrMove = this.onPointerDownOrMove.bind(this);\n  onPointerDownOrMove(e2) {\n    this.mouse0Down = (e2.buttons & 1) === 1;\n    this.mouse1Down = (e2.buttons & 4) === 4;\n    this.mouse2Down = (e2.buttons & 2) === 2;\n    this.x = e2.clientX;\n    this.y = e2.clientY;\n    this.canvas.setDirty(true);\n  }\n  #onPointerUp = this.onPointerUp.bind(this);\n  onPointerUp() {\n    this.mouse0Down = false;\n    this.mouse1Down = false;\n    this.mouse2Down = false;\n  }\n  #onKeyDownOrUp = this.onKeyDownOrUp.bind(this);\n  onKeyDownOrUp(e2) {\n    this.ctrlDown = e2.ctrlKey;\n    this.altDown = e2.altKey;\n    this.shiftDown = e2.shiftKey;\n    this.undoDown = e2.ctrlKey && e2.code === \"KeyZ\" && e2.type === \"keydown\";\n    this.redoDown = e2.ctrlKey && e2.code === \"KeyY\" && e2.type === \"keydown\";\n  }\n  draw() {\n    const {\n      canvas: { ctx },\n      radius,\n      startAngle,\n      endAngle,\n      x: x2,\n      y,\n      inactiveColour,\n      colour1,\n      colour2,\n      colour3,\n      fontString\n    } = this;\n    const { fillStyle, font } = ctx;\n    const mouseDotX = x2;\n    const mouseDotY = y - 80;\n    const textX = mouseDotX;\n    const textY = mouseDotY - 15;\n    ctx.font = fontString;\n    textMarker(textX + 0, textY, \"Shift\", this.shiftDown ? colour1 : inactiveColour);\n    textMarker(textX + 45, textY + 20, \"Alt\", this.altDown ? colour2 : inactiveColour);\n    textMarker(textX + 30, textY, \"Control\", this.ctrlDown ? colour3 : inactiveColour);\n    textMarker(textX - 30, textY, \"↩️\", this.undoDown ? \"#000\" : \"transparent\");\n    textMarker(textX + 45, textY, \"↪️\", this.redoDown ? \"#000\" : \"transparent\");\n    ctx.beginPath();\n    drawDot(mouseDotX, mouseDotY);\n    drawDot(mouseDotX + 15, mouseDotY);\n    drawDot(mouseDotX + 30, mouseDotY);\n    ctx.fillStyle = inactiveColour;\n    ctx.fill();\n    const leftButtonColour = this.mouse0Down ? colour1 : inactiveColour;\n    const middleButtonColour = this.mouse1Down ? colour2 : inactiveColour;\n    const rightButtonColour = this.mouse2Down ? colour3 : inactiveColour;\n    if (this.mouse0Down) mouseMarker(mouseDotX, mouseDotY, leftButtonColour);\n    if (this.mouse1Down) mouseMarker(mouseDotX + 15, mouseDotY, middleButtonColour);\n    if (this.mouse2Down) mouseMarker(mouseDotX + 30, mouseDotY, rightButtonColour);\n    ctx.fillStyle = fillStyle;\n    ctx.font = font;\n    function textMarker(x22, y2, text, colour) {\n      ctx.fillStyle = colour;\n      ctx.fillText(text, x22, y2);\n    }\n    function mouseMarker(x22, y2, colour) {\n      ctx.beginPath();\n      ctx.fillStyle = colour;\n      drawDot(x22, y2);\n      ctx.fill();\n    }\n    function drawDot(x22, y2) {\n      ctx.arc(x22, y2, radius, startAngle, endAngle);\n    }\n  }\n  dispose() {\n    this.controller?.abort();\n    this.controller = void 0;\n  }\n  [Symbol.dispose]() {\n    this.dispose();\n  }\n}\nclass ContextMenu {\n  options;\n  parentMenu;\n  root;\n  current_submenu;\n  lock;\n  controller = new AbortController();\n  /**\n   * @todo Interface for values requires functionality change - currently accepts\n   * an array of strings, functions, objects, nulls, or undefined.\n   * @param values (allows object { title: \"Nice text\", callback: function ... })\n   * @param options [optional] Some options:\\\n   * - title: title to show on top of the menu\n   * - callback: function to call when an option is clicked, it receives the item information\n   * - ignore_item_callbacks: ignores the callback inside the item, it just calls the options.callback\n   * - event: you can pass a MouseEvent, this way the ContextMenu appears in that position\n   */\n  constructor(values, options) {\n    options ||= {};\n    this.options = options;\n    const parent = options.parentMenu;\n    if (parent) {\n      if (!(parent instanceof ContextMenu)) {\n        console.error(\"parentMenu must be of class ContextMenu, ignoring it\");\n        options.parentMenu = void 0;\n      } else {\n        this.parentMenu = parent;\n        this.parentMenu.lock = true;\n        this.parentMenu.current_submenu = this;\n      }\n      if (parent.options?.className === \"dark\") {\n        options.className = \"dark\";\n      }\n    }\n    const eventClass = options.event ? options.event.constructor.name : null;\n    if (eventClass !== \"MouseEvent\" && eventClass !== \"CustomEvent\" && eventClass !== \"PointerEvent\") {\n      console.error(`Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it. (${eventClass})`);\n      options.event = void 0;\n    }\n    const root = document.createElement(\"div\");\n    let classes = \"litegraph litecontextmenu litemenubar-panel\";\n    if (options.className) classes += ` ${options.className}`;\n    root.className = classes;\n    root.style.minWidth = \"100\";\n    root.style.minHeight = \"100\";\n    const { signal } = this.controller;\n    const eventOptions = { capture: true, signal };\n    if (!this.parentMenu) {\n      document.addEventListener(\"pointerdown\", (e2) => {\n        if (e2.target instanceof Node && !this.containsNode(e2.target)) {\n          this.close();\n        }\n      }, eventOptions);\n    }\n    root.addEventListener(\"pointerup\", (e2) => e2.preventDefault(), eventOptions);\n    root.addEventListener(\n      \"contextmenu\",\n      (e2) => {\n        if (e2.button === 2) e2.preventDefault();\n      },\n      eventOptions\n    );\n    root.addEventListener(\n      \"pointerdown\",\n      (e2) => {\n        if (e2.button == 2) {\n          this.close();\n          e2.preventDefault();\n        }\n      },\n      eventOptions\n    );\n    this.root = root;\n    if (options.title) {\n      const element = document.createElement(\"div\");\n      element.className = \"litemenu-title\";\n      element.innerHTML = options.title;\n      root.append(element);\n    }\n    for (let i = 0; i < values.length; i++) {\n      const value = values[i];\n      let name = Array.isArray(values) ? value : String(i);\n      if (typeof name !== \"string\") {\n        name = name != null ? name.content === void 0 ? String(name) : name.content : name;\n      }\n      this.addItem(name, value, options);\n    }\n    const ownerDocument = options.event?.target?.ownerDocument;\n    const root_document = ownerDocument || document;\n    if (root_document.fullscreenElement)\n      root_document.fullscreenElement.append(root);\n    else\n      root_document.body.append(root);\n    let left = options.left || 0;\n    let top = options.top || 0;\n    if (options.event) {\n      left = options.event.clientX - 10;\n      top = options.event.clientY - 10;\n      if (options.title) top -= 20;\n      if (parent) {\n        const rect = parent.root.getBoundingClientRect();\n        left = rect.left + rect.width;\n      }\n      const body_rect = document.body.getBoundingClientRect();\n      const root_rect = root.getBoundingClientRect();\n      if (body_rect.height == 0)\n        console.error(\"document.body height is 0. That is dangerous, set html,body { height: 100%; }\");\n      if (body_rect.width && left > body_rect.width - root_rect.width - 10)\n        left = body_rect.width - root_rect.width - 10;\n      if (body_rect.height && top > body_rect.height - root_rect.height - 10)\n        top = body_rect.height - root_rect.height - 10;\n    }\n    root.style.left = `${left}px`;\n    root.style.top = `${top}px`;\n    if (LiteGraph.context_menu_scaling && options.scale) {\n      root.style.transform = `scale(${Math.round(options.scale * 4) * 0.25})`;\n    }\n  }\n  /**\n   * Checks if {@link node} is inside this context menu or any of its submenus\n   * @param node The {@link Node} to check\n   * @param visited A set of visited menus to avoid circular references\n   * @returns `true` if {@link node} is inside this context menu or any of its submenus\n   */\n  containsNode(node2, visited = /* @__PURE__ */ new Set()) {\n    if (visited.has(this)) return false;\n    visited.add(this);\n    return this.current_submenu?.containsNode(node2, visited) || this.root.contains(node2);\n  }\n  addItem(name, value, options) {\n    options ||= {};\n    const element = document.createElement(\"div\");\n    element.className = \"litemenu-entry submenu\";\n    let disabled = false;\n    if (value === null) {\n      element.classList.add(\"separator\");\n    } else {\n      const innerHtml = name === null ? \"\" : String(name);\n      if (typeof value === \"string\") {\n        element.innerHTML = innerHtml;\n      } else {\n        element.innerHTML = value?.title ?? innerHtml;\n        if (value.disabled) {\n          disabled = true;\n          element.classList.add(\"disabled\");\n          element.setAttribute(\"aria-disabled\", \"true\");\n        }\n        if (value.submenu || value.has_submenu) {\n          element.classList.add(\"has_submenu\");\n          element.setAttribute(\"aria-haspopup\", \"true\");\n          element.setAttribute(\"aria-expanded\", \"false\");\n        }\n        if (value.className) element.className += ` ${value.className}`;\n      }\n      element.value = value;\n      element.setAttribute(\"role\", \"menuitem\");\n      if (typeof value === \"function\") {\n        element.dataset[\"value\"] = String(name);\n        element.onclick_callback = value;\n      } else {\n        element.dataset[\"value\"] = String(value);\n      }\n    }\n    this.root.append(element);\n    if (!disabled) element.addEventListener(\"click\", inner_onclick);\n    if (!disabled && options.autoopen)\n      element.addEventListener(\"pointerenter\", inner_over);\n    const setAriaExpanded = () => {\n      const entries = this.root.querySelectorAll(\"div.litemenu-entry.has_submenu\");\n      if (entries) {\n        for (const entry of entries) {\n          entry.setAttribute(\"aria-expanded\", \"false\");\n        }\n      }\n      element.setAttribute(\"aria-expanded\", \"true\");\n    };\n    function inner_over(e2) {\n      const value2 = this.value;\n      if (!value2 || !value2.has_submenu) return;\n      inner_onclick.call(this, e2);\n      setAriaExpanded();\n    }\n    const that = this;\n    function inner_onclick(e2) {\n      const value2 = this.value;\n      let close_parent = true;\n      that.current_submenu?.close(e2);\n      if (value2?.has_submenu || value2?.submenu) {\n        setAriaExpanded();\n      }\n      if (options.callback) {\n        const r = options.callback.call(\n          this,\n          value2,\n          options,\n          e2,\n          that,\n          options.node\n        );\n        if (r === true) close_parent = false;\n      }\n      if (typeof value2 === \"object\") {\n        if (value2.callback && !options.ignore_item_callbacks && value2.disabled !== true) {\n          const r = value2.callback.call(\n            this,\n            value2,\n            options,\n            e2,\n            that,\n            options.extra\n          );\n          if (r === true) close_parent = false;\n        }\n        if (value2.submenu) {\n          if (!value2.submenu.options) throw \"ContextMenu submenu needs options\";\n          new that.constructor(value2.submenu.options, {\n            callback: value2.submenu.callback,\n            event: e2,\n            parentMenu: that,\n            ignore_item_callbacks: value2.submenu.ignore_item_callbacks,\n            title: value2.submenu.title,\n            extra: value2.submenu.extra,\n            autoopen: options.autoopen\n          });\n          close_parent = false;\n        }\n      }\n      if (close_parent && !that.lock) that.close();\n    }\n    return element;\n  }\n  close(e2, ignore_parent_menu) {\n    this.controller.abort();\n    this.root.remove();\n    if (this.parentMenu && !ignore_parent_menu) {\n      this.parentMenu.lock = false;\n      this.parentMenu.current_submenu = void 0;\n      if (e2 === void 0) {\n        this.parentMenu.close();\n      } else if (e2 && !ContextMenu.isCursorOverElement(e2, this.parentMenu.root)) {\n        ContextMenu.trigger(\n          this.parentMenu.root,\n          `${LiteGraph.pointerevents_method}leave`,\n          e2\n        );\n      }\n    }\n    this.current_submenu?.close(e2, true);\n  }\n  /** @deprecated Likely unused, however code search was inconclusive (too many results to check by hand). */\n  // this code is used to trigger events easily (used in the context menu mouseleave\n  static trigger(element, event_name, params) {\n    const evt = document.createEvent(\"CustomEvent\");\n    evt.initCustomEvent(event_name, true, true, params);\n    if (element.dispatchEvent) element.dispatchEvent(evt);\n    return evt;\n  }\n  // returns the top most menu\n  getTopMenu() {\n    return this.options.parentMenu ? this.options.parentMenu.getTopMenu() : this;\n  }\n  getFirstEvent() {\n    return this.options.parentMenu ? this.options.parentMenu.getFirstEvent() : this.options.event;\n  }\n  /** @deprecated Unused. */\n  static isCursorOverElement(event, element) {\n    const left = event.clientX;\n    const top = event.clientY;\n    const rect = element.getBoundingClientRect();\n    if (!rect) return false;\n    if (top > rect.top && top < rect.top + rect.height && left > rect.left && left < rect.left + rect.width) {\n      return true;\n    }\n    return false;\n  }\n}\nclass CurveEditor {\n  points;\n  selected;\n  nearest;\n  size;\n  must_update;\n  margin;\n  _nearest;\n  constructor(points) {\n    this.points = points;\n    this.selected = -1;\n    this.nearest = -1;\n    this.size = null;\n    this.must_update = true;\n    this.margin = 5;\n  }\n  static sampleCurve(f, points) {\n    if (!points) return;\n    for (let i = 0; i < points.length - 1; ++i) {\n      const p = points[i];\n      const pn = points[i + 1];\n      if (pn[0] < f) continue;\n      const r = pn[0] - p[0];\n      if (Math.abs(r) < 1e-5) return p[1];\n      const local_f = (f - p[0]) / r;\n      return p[1] * (1 - local_f) + pn[1] * local_f;\n    }\n    return 0;\n  }\n  draw(ctx, size, graphcanvas, background_color, line_color, inactive = false) {\n    const points = this.points;\n    if (!points) return;\n    this.size = size;\n    const w = size[0] - this.margin * 2;\n    const h = size[1] - this.margin * 2;\n    line_color = line_color || \"#666\";\n    ctx.save();\n    ctx.translate(this.margin, this.margin);\n    if (background_color) {\n      ctx.fillStyle = \"#111\";\n      ctx.fillRect(0, 0, w, h);\n      ctx.fillStyle = \"#222\";\n      ctx.fillRect(w * 0.5, 0, 1, h);\n      ctx.strokeStyle = \"#333\";\n      ctx.strokeRect(0, 0, w, h);\n    }\n    ctx.strokeStyle = line_color;\n    if (inactive) ctx.globalAlpha = 0.5;\n    ctx.beginPath();\n    for (const p of points) {\n      ctx.lineTo(p[0] * w, (1 - p[1]) * h);\n    }\n    ctx.stroke();\n    ctx.globalAlpha = 1;\n    if (!inactive) {\n      for (const [i, p] of points.entries()) {\n        ctx.fillStyle = this.selected == i ? \"#FFF\" : this.nearest == i ? \"#DDD\" : \"#AAA\";\n        ctx.beginPath();\n        ctx.arc(p[0] * w, (1 - p[1]) * h, 2, 0, Math.PI * 2);\n        ctx.fill();\n      }\n    }\n    ctx.restore();\n  }\n  // localpos is mouse in curve editor space\n  onMouseDown(localpos, graphcanvas) {\n    const points = this.points;\n    if (!points) return;\n    if (localpos[1] < 0) return;\n    if (this.size == null) throw new Error(\"CurveEditor.size was null or undefined.\");\n    const w = this.size[0] - this.margin * 2;\n    const h = this.size[1] - this.margin * 2;\n    const x2 = localpos[0] - this.margin;\n    const y = localpos[1] - this.margin;\n    const pos = [x2, y];\n    const max_dist = 30 / graphcanvas.ds.scale;\n    this.selected = this.getCloserPoint(pos, max_dist);\n    if (this.selected == -1) {\n      const point = [x2 / w, 1 - y / h];\n      points.push(point);\n      points.sort(function(a, b) {\n        return a[0] - b[0];\n      });\n      this.selected = points.indexOf(point);\n      this.must_update = true;\n    }\n    if (this.selected != -1) return true;\n  }\n  onMouseMove(localpos, graphcanvas) {\n    const points = this.points;\n    if (!points) return;\n    const s = this.selected;\n    if (s < 0) return;\n    if (this.size == null) throw new Error(\"CurveEditor.size was null or undefined.\");\n    const x2 = (localpos[0] - this.margin) / (this.size[0] - this.margin * 2);\n    const y = (localpos[1] - this.margin) / (this.size[1] - this.margin * 2);\n    const curvepos = [\n      localpos[0] - this.margin,\n      localpos[1] - this.margin\n    ];\n    const max_dist = 30 / graphcanvas.ds.scale;\n    this._nearest = this.getCloserPoint(curvepos, max_dist);\n    const point = points[s];\n    if (point) {\n      const is_edge_point = s == 0 || s == points.length - 1;\n      if (!is_edge_point && (localpos[0] < -10 || localpos[0] > this.size[0] + 10 || localpos[1] < -10 || localpos[1] > this.size[1] + 10)) {\n        points.splice(s, 1);\n        this.selected = -1;\n        return;\n      }\n      if (!is_edge_point) point[0] = clamp(x2, 0, 1);\n      else point[0] = s == 0 ? 0 : 1;\n      point[1] = 1 - clamp(y, 0, 1);\n      points.sort(function(a, b) {\n        return a[0] - b[0];\n      });\n      this.selected = points.indexOf(point);\n      this.must_update = true;\n    }\n  }\n  // Former params: localpos, graphcanvas\n  onMouseUp() {\n    this.selected = -1;\n    return false;\n  }\n  getCloserPoint(pos, max_dist) {\n    const points = this.points;\n    if (!points) return -1;\n    max_dist = max_dist || 30;\n    if (this.size == null) throw new Error(\"CurveEditor.size was null or undefined.\");\n    const w = this.size[0] - this.margin * 2;\n    const h = this.size[1] - this.margin * 2;\n    const num = points.length;\n    const p2 = [0, 0];\n    let min_dist = 1e6;\n    let closest = -1;\n    for (let i = 0; i < num; ++i) {\n      const p = points[i];\n      p2[0] = p[0] * w;\n      p2[1] = (1 - p[1]) * h;\n      const dist = distance(pos, p2);\n      if (dist > min_dist || dist > max_dist) continue;\n      closest = i;\n      min_dist = dist;\n    }\n    return closest;\n  }\n}\nclass LiteGraphGlobal {\n  // Enums\n  SlotShape = SlotShape;\n  SlotDirection = SlotDirection;\n  SlotType = SlotType;\n  LabelPosition = LabelPosition;\n  /** Used in serialised graphs at one point. */\n  VERSION = 0.4;\n  CANVAS_GRID_SIZE = 10;\n  NODE_TITLE_HEIGHT = 30;\n  NODE_TITLE_TEXT_Y = 20;\n  NODE_SLOT_HEIGHT = 20;\n  NODE_WIDGET_HEIGHT = 20;\n  NODE_WIDTH = 140;\n  NODE_MIN_WIDTH = 50;\n  NODE_COLLAPSED_RADIUS = 10;\n  NODE_COLLAPSED_WIDTH = 80;\n  NODE_TITLE_COLOR = \"#999\";\n  NODE_SELECTED_TITLE_COLOR = \"#FFF\";\n  NODE_TEXT_SIZE = 14;\n  NODE_TEXT_COLOR = \"#AAA\";\n  NODE_TEXT_HIGHLIGHT_COLOR = \"#EEE\";\n  NODE_SUBTEXT_SIZE = 12;\n  NODE_DEFAULT_COLOR = \"#333\";\n  NODE_DEFAULT_BGCOLOR = \"#353535\";\n  NODE_DEFAULT_BOXCOLOR = \"#666\";\n  NODE_DEFAULT_SHAPE = RenderShape.ROUND;\n  NODE_BOX_OUTLINE_COLOR = \"#FFF\";\n  NODE_ERROR_COLOUR = \"#E00\";\n  NODE_FONT = \"Arial\";\n  DEFAULT_FONT = \"Arial\";\n  DEFAULT_SHADOW_COLOR = \"rgba(0,0,0,0.5)\";\n  DEFAULT_GROUP_FONT = 24;\n  DEFAULT_GROUP_FONT_SIZE;\n  GROUP_FONT = \"Arial\";\n  WIDGET_BGCOLOR = \"#222\";\n  WIDGET_OUTLINE_COLOR = \"#666\";\n  WIDGET_ADVANCED_OUTLINE_COLOR = \"rgba(56, 139, 253, 0.8)\";\n  WIDGET_TEXT_COLOR = \"#DDD\";\n  WIDGET_SECONDARY_TEXT_COLOR = \"#999\";\n  WIDGET_DISABLED_TEXT_COLOR = \"#666\";\n  LINK_COLOR = \"#9A9\";\n  EVENT_LINK_COLOR = \"#A86\";\n  CONNECTING_LINK_COLOR = \"#AFA\";\n  /** avoid infinite loops */\n  MAX_NUMBER_OF_NODES = 1e4;\n  /** default node position */\n  DEFAULT_POSITION = [100, 100];\n  /** ,\"circle\" */\n  VALID_SHAPES = [\"default\", \"box\", \"round\", \"card\"];\n  ROUND_RADIUS = 8;\n  // shapes are used for nodes but also for slots\n  BOX_SHAPE = RenderShape.BOX;\n  ROUND_SHAPE = RenderShape.ROUND;\n  CIRCLE_SHAPE = RenderShape.CIRCLE;\n  CARD_SHAPE = RenderShape.CARD;\n  ARROW_SHAPE = RenderShape.ARROW;\n  /** intended for slot arrays */\n  GRID_SHAPE = RenderShape.GRID;\n  // enums\n  INPUT = NodeSlotType.INPUT;\n  OUTPUT = NodeSlotType.OUTPUT;\n  // TODO: -1 can lead to ambiguity in JS; these should be updated to a more explicit constant or Symbol.\n  /** for outputs */\n  EVENT = -1;\n  /** for inputs */\n  ACTION = -1;\n  /** helper, will add \"On Request\" and more in the future */\n  NODE_MODES = [\"Always\", \"On Event\", \"Never\", \"On Trigger\"];\n  /** use with node_box_coloured_by_mode */\n  NODE_MODES_COLORS = [\"#666\", \"#422\", \"#333\", \"#224\", \"#626\"];\n  ALWAYS = LGraphEventMode.ALWAYS;\n  ON_EVENT = LGraphEventMode.ON_EVENT;\n  NEVER = LGraphEventMode.NEVER;\n  ON_TRIGGER = LGraphEventMode.ON_TRIGGER;\n  UP = LinkDirection.UP;\n  DOWN = LinkDirection.DOWN;\n  LEFT = LinkDirection.LEFT;\n  RIGHT = LinkDirection.RIGHT;\n  CENTER = LinkDirection.CENTER;\n  /** helper */\n  LINK_RENDER_MODES = [\"Straight\", \"Linear\", \"Spline\"];\n  HIDDEN_LINK = LinkRenderType.HIDDEN_LINK;\n  STRAIGHT_LINK = LinkRenderType.STRAIGHT_LINK;\n  LINEAR_LINK = LinkRenderType.LINEAR_LINK;\n  SPLINE_LINK = LinkRenderType.SPLINE_LINK;\n  NORMAL_TITLE = TitleMode.NORMAL_TITLE;\n  NO_TITLE = TitleMode.NO_TITLE;\n  TRANSPARENT_TITLE = TitleMode.TRANSPARENT_TITLE;\n  AUTOHIDE_TITLE = TitleMode.AUTOHIDE_TITLE;\n  /** arrange nodes vertically */\n  VERTICAL_LAYOUT = \"vertical\";\n  /** used to redirect calls */\n  proxy = null;\n  node_images_path = \"\";\n  debug = false;\n  catch_exceptions = true;\n  throw_errors = true;\n  /** if set to true some nodes like Formula would be allowed to evaluate code that comes from unsafe sources (like node configuration), which could lead to exploits */\n  allow_scripts = false;\n  /** nodetypes by string */\n  registered_node_types = {};\n  /** @deprecated used for dropping files in the canvas.  It appears the code that enables this was removed, but the object remains and is references by built-in drag drop. */\n  node_types_by_file_extension = {};\n  /** node types by classname */\n  Nodes = {};\n  /** used to store vars between graphs */\n  Globals = {};\n  /** @deprecated Unused and will be deleted. */\n  searchbox_extras = {};\n  /** [true!] this make the nodes box (top left circle) coloured when triggered (execute/action), visual feedback */\n  node_box_coloured_when_on = false;\n  /** [true!] nodebox based on node mode, visual feedback */\n  node_box_coloured_by_mode = false;\n  /** [false on mobile] better true if not touch device, TODO add an helper/listener to close if false */\n  dialog_close_on_mouse_leave = false;\n  dialog_close_on_mouse_leave_delay = 500;\n  /** [false!] prefer false if results too easy to break links - implement with ALT or TODO custom keys */\n  shift_click_do_break_link_from = false;\n  /** [false!]prefer false, way too easy to break links */\n  click_do_break_link_to = false;\n  /** [true!] who accidentally ctrl-alt-clicks on an in/output? nobody! that's who! */\n  ctrl_alt_click_do_break_link = true;\n  /** [true!] snaps links when dragging connections over valid targets */\n  snaps_for_comfy = true;\n  /** [true!] renders a partial border to highlight when a dragged link is snapped to a node */\n  snap_highlights_node = true;\n  /**\n   * If `true`, items always snap to the grid - modifier keys are ignored.\n   * When {@link snapToGrid} is falsy, a value of `1` is used.\n   * Default: `false`\n   */\n  alwaysSnapToGrid;\n  /**\n   * When set to a positive number, when nodes are moved their positions will\n   * be rounded to the nearest multiple of this value.  Half up.\n   * Default: `undefined`\n   * @todo Not implemented - see {@link LiteGraph.CANVAS_GRID_SIZE}\n   */\n  snapToGrid;\n  /** [false on mobile] better true if not touch device, TODO add an helper/listener to close if false */\n  search_hide_on_mouse_leave = true;\n  /**\n   * [true!] enable filtering slots type in the search widget\n   * !requires auto_load_slot_types or manual set registered_slot_[in/out]_types and slot_types_[in/out]\n   */\n  search_filter_enabled = false;\n  /** [true!] opens the results list when opening the search widget */\n  search_show_all_on_open = true;\n  /**\n   * [if want false, use true, run, get vars values to be statically set, than disable]\n   * nodes types and nodeclass association with node types need to be calculated,\n   * if dont want this, calculate once and set registered_slot_[in/out]_types and slot_types_[in/out]\n   */\n  auto_load_slot_types = false;\n  // set these values if not using auto_load_slot_types\n  /** slot types for nodeclass */\n  registered_slot_in_types = {};\n  /** slot types for nodeclass */\n  registered_slot_out_types = {};\n  /** slot types IN */\n  slot_types_in = [];\n  /** slot types OUT */\n  slot_types_out = [];\n  /**\n   * specify for each IN slot type a(/many) default node(s), use single string, array, or object\n   * (with node, title, parameters, ..) like for search\n   */\n  slot_types_default_in = {};\n  /**\n   * specify for each OUT slot type a(/many) default node(s), use single string, array, or object\n   * (with node, title, parameters, ..) like for search\n   */\n  slot_types_default_out = {};\n  /** [true!] very handy, ALT click to clone and drag the new node */\n  alt_drag_do_clone_nodes = false;\n  /**\n   * [true!] will create and connect event slots when using action/events connections,\n   * !WILL CHANGE node mode when using onTrigger (enable mode colors), onExecuted does not need this\n   */\n  do_add_triggers_slots = false;\n  /** [false!] being events, it is strongly reccomended to use them sequentially, one by one */\n  allow_multi_output_for_events = true;\n  /** [true!] allows to create and connect a ndoe clicking with the third button (wheel) */\n  middle_click_slot_add_default_node = false;\n  /** [true!] dragging a link to empty space will open a menu, add from list, search or defaults */\n  release_link_on_empty_shows_menu = false;\n  /** \"mouse\"|\"pointer\" use mouse for retrocompatibility issues? (none found @ now) */\n  pointerevents_method = \"pointer\";\n  /**\n   * [true!] allows ctrl + shift + v to paste nodes with the outputs of the unselected nodes connected\n   * with the inputs of the newly pasted nodes\n   */\n  ctrl_shift_v_paste_connect_unselected_outputs = true;\n  // if true, all newly created nodes/links will use string UUIDs for their id fields instead of integers.\n  // use this if you must have node IDs that are unique across all graphs and subgraphs.\n  use_uuids = false;\n  // Whether to highlight the bounding box of selected groups\n  highlight_selected_group = true;\n  /** Whether to scale context with the graph when zooming in.  Zooming out never makes context menus smaller. */\n  context_menu_scaling = false;\n  /**\n   * Debugging flag. Repeats deprecation warnings every time they are reported.\n   * May impact performance.\n   */\n  alwaysRepeatWarnings = false;\n  /**\n   * Array of callbacks to execute when Litegraph first reports a deprecated API being used.\n   * @see alwaysRepeatWarnings By default, will not repeat identical messages.\n   */\n  onDeprecationWarning = [console.warn];\n  /**\n   * If `true`, mouse wheel events will be interpreted as trackpad gestures.\n   * Tested on MacBook M4 Pro.\n   * @default false\n   * @see macGesturesRequireMac\n   */\n  macTrackpadGestures = false;\n  /**\n   * If both this setting and {@link macTrackpadGestures} are `true`, trackpad gestures will\n   * only be enabled when the browser user agent includes \"Mac\".\n   * @default true\n   * @see macTrackpadGestures\n   */\n  macGesturesRequireMac = true;\n  /**\n   * \"standard\": change the dragging on left mouse button click to select, enable middle-click or spacebar+left-click dragging\n   * \"legacy\": Enable dragging on left-click (original behavior)\n   * @default \"legacy\"\n   */\n  canvasNavigationMode = \"legacy\";\n  /**\n   * If `true`, widget labels and values will both be truncated (proportionally to size),\n   * until they fit within the widget.\n   *\n   * Otherwise, the label will be truncated completely before the value is truncated.\n   * @default false\n   */\n  truncateWidgetTextEvenly = false;\n  /**\n   * If `true`, widget values will be completely truncated when shrinking a widget,\n   * before truncating widget labels.  {@link truncateWidgetTextEvenly} must be `false`.\n   * @default false\n   */\n  truncateWidgetValuesFirst = false;\n  /**\n   * If `true`, the current viewport scale & offset of the first attached canvas will be included with the graph when exporting.\n   * @default true\n   */\n  saveViewportWithGraph = true;\n  // TODO: Remove legacy accessors\n  LGraph = LGraph;\n  LLink = LLink;\n  LGraphNode = LGraphNode;\n  LGraphGroup = LGraphGroup;\n  DragAndScale = DragAndScale;\n  LGraphCanvas = LGraphCanvas;\n  ContextMenu = ContextMenu;\n  CurveEditor = CurveEditor;\n  Reroute = Reroute;\n  constructor() {\n    Object.defineProperty(this, \"Classes\", { writable: false });\n  }\n  Classes = {\n    get SubgraphSlot() {\n      return SubgraphSlot;\n    },\n    get SubgraphIONodeBase() {\n      return SubgraphIONodeBase;\n    },\n    // Rich drawing\n    get Rectangle() {\n      return Rectangle;\n    },\n    // Debug / helpers\n    get InputIndicators() {\n      return InputIndicators;\n    }\n  };\n  /**\n   * Register a node class so it can be listed when the user wants to create a new one\n   * @param type name of the node and path\n   * @param base_class class containing the structure of a node\n   */\n  registerNodeType(type, base_class) {\n    if (!base_class.prototype)\n      throw \"Cannot register a simple object, it must be a class with a prototype\";\n    base_class.type = type;\n    if (this.debug) console.log(\"Node registered:\", type);\n    const classname = base_class.name;\n    const pos = type.lastIndexOf(\"/\");\n    base_class.category = type.substring(0, pos);\n    base_class.title ||= classname;\n    for (const i in LGraphNode.prototype) {\n      base_class.prototype[i] ||= LGraphNode.prototype[i];\n    }\n    const prev = this.registered_node_types[type];\n    if (prev && this.debug) {\n      console.log(\"replacing node type:\", type);\n    }\n    this.registered_node_types[type] = base_class;\n    if (base_class.constructor.name) this.Nodes[classname] = base_class;\n    this.onNodeTypeRegistered?.(type, base_class);\n    if (prev) this.onNodeTypeReplaced?.(type, base_class, prev);\n    if (base_class.prototype.onPropertyChange)\n      console.warn(`LiteGraph node class ${type} has onPropertyChange method, it must be called onPropertyChanged with d at the end`);\n    if (this.auto_load_slot_types) new base_class(base_class.title || \"tmpnode\");\n  }\n  /**\n   * removes a node type from the system\n   * @param type name of the node or the node constructor itself\n   */\n  unregisterNodeType(type) {\n    const base_class = typeof type === \"string\" ? this.registered_node_types[type] : type;\n    if (!base_class) throw `node type not found: ${String(type)}`;\n    delete this.registered_node_types[String(base_class.type)];\n    const name = base_class.constructor.name;\n    if (name) delete this.Nodes[name];\n  }\n  /**\n   * Save a slot type and his node\n   * @param type name of the node or the node constructor itself\n   * @param slot_type name of the slot type (variable type), eg. string, number, array, boolean, ..\n   */\n  registerNodeAndSlotType(type, slot_type, out) {\n    out ||= false;\n    const base_class = typeof type === \"string\" && this.registered_node_types[type] !== \"anonymous\" ? this.registered_node_types[type] : type;\n    const class_type = base_class.constructor.type;\n    let allTypes = [];\n    if (typeof slot_type === \"string\") {\n      allTypes = slot_type.split(\",\");\n    } else if (slot_type == this.EVENT || slot_type == this.ACTION) {\n      allTypes = [\"_event_\"];\n    } else {\n      allTypes = [\"*\"];\n    }\n    for (let slotType of allTypes) {\n      if (slotType === \"\") slotType = \"*\";\n      const register = out ? this.registered_slot_out_types : this.registered_slot_in_types;\n      register[slotType] ??= { nodes: [] };\n      const { nodes } = register[slotType];\n      if (!nodes.includes(class_type)) nodes.push(class_type);\n      const types = out ? this.slot_types_out : this.slot_types_in;\n      const type2 = slotType.toLowerCase();\n      if (!types.includes(type2)) {\n        types.push(type2);\n        types.sort();\n      }\n    }\n  }\n  /**\n   * Removes all previously registered node's types\n   */\n  clearRegisteredTypes() {\n    this.registered_node_types = {};\n    this.node_types_by_file_extension = {};\n    this.Nodes = {};\n    this.searchbox_extras = {};\n  }\n  /**\n   * Create a node of a given type with a name. The node is not attached to any graph yet.\n   * @param type full name of the node class. p.e. \"math/sin\"\n   * @param title a name to distinguish from other nodes\n   * @param options to set options\n   */\n  createNode(type, title, options) {\n    const base_class = this.registered_node_types[type];\n    if (!base_class) {\n      if (this.debug) console.log(`GraphNode type \"${type}\" not registered.`);\n      return null;\n    }\n    title = title || base_class.title || type;\n    let node2 = null;\n    if (this.catch_exceptions) {\n      try {\n        node2 = new base_class(title);\n      } catch (error) {\n        console.error(error);\n        return null;\n      }\n    } else {\n      node2 = new base_class(title);\n    }\n    node2.type = type;\n    if (!node2.title && title) node2.title = title;\n    node2.properties ||= {};\n    node2.properties_info ||= [];\n    node2.flags ||= {};\n    node2.size ||= node2.computeSize();\n    node2.pos ||= [this.DEFAULT_POSITION[0], this.DEFAULT_POSITION[1]];\n    node2.mode ||= LGraphEventMode.ALWAYS;\n    if (options) {\n      for (const i in options) {\n        node2[i] = options[i];\n      }\n    }\n    node2.onNodeCreated?.();\n    return node2;\n  }\n  /**\n   * Returns a registered node type with a given name\n   * @param type full name of the node class. p.e. \"math/sin\"\n   * @returns the node class\n   */\n  getNodeType(type) {\n    return this.registered_node_types[type];\n  }\n  /**\n   * Returns a list of node types matching one category\n   * @param category category name\n   * @returns array with all the node classes\n   */\n  getNodeTypesInCategory(category, filter) {\n    const r = [];\n    for (const i in this.registered_node_types) {\n      const type = this.registered_node_types[i];\n      if (type.filter != filter) continue;\n      if (category == \"\") {\n        if (type.category == null) r.push(type);\n      } else if (type.category == category) {\n        r.push(type);\n      }\n    }\n    return r;\n  }\n  /**\n   * Returns a list with all the node type categories\n   * @param filter only nodes with ctor.filter equal can be shown\n   * @returns array with all the names of the categories\n   */\n  getNodeTypesCategories(filter) {\n    const categories = { \"\": 1 };\n    for (const i in this.registered_node_types) {\n      const type = this.registered_node_types[i];\n      if (type.category && !type.skip_list) {\n        if (type.filter != filter) continue;\n        categories[type.category] = 1;\n      }\n    }\n    const result = [];\n    for (const i in categories) {\n      result.push(i);\n    }\n    return result;\n  }\n  // debug purposes: reloads all the js scripts that matches a wildcard\n  reloadNodes(folder_wildcard) {\n    const tmp = document.getElementsByTagName(\"script\");\n    const script_files = [];\n    for (const element of tmp) {\n      script_files.push(element);\n    }\n    const docHeadObj = document.getElementsByTagName(\"head\")[0];\n    folder_wildcard = document.location.href + folder_wildcard;\n    for (const script_file of script_files) {\n      const src = script_file.src;\n      if (!src || src.substr(0, folder_wildcard.length) != folder_wildcard)\n        continue;\n      try {\n        if (this.debug) console.log(\"Reloading:\", src);\n        const dynamicScript = document.createElement(\"script\");\n        dynamicScript.type = \"text/javascript\";\n        dynamicScript.src = src;\n        docHeadObj.append(dynamicScript);\n        script_file.remove();\n      } catch (error) {\n        if (this.throw_errors) throw error;\n        if (this.debug) console.log(\"Error while reloading\", src);\n      }\n    }\n    if (this.debug) console.log(\"Nodes reloaded\");\n  }\n  // separated just to improve if it doesn't work\n  /** @deprecated Prefer {@link structuredClone} */\n  cloneObject(obj, target) {\n    if (obj == null) return null;\n    const r = JSON.parse(JSON.stringify(obj));\n    if (!target) return r;\n    for (const i in r) {\n      target[i] = r[i];\n    }\n    return target;\n  }\n  /** @see {@link createUuidv4} @inheritdoc */\n  uuidv4 = createUuidv4;\n  /**\n   * Returns if the types of two slots are compatible (taking into account wildcards, etc)\n   * @param type_a output\n   * @param type_b input\n   * @returns true if they can be connected\n   */\n  isValidConnection(type_a, type_b) {\n    if (type_a == \"\" || type_a === \"*\") type_a = 0;\n    if (type_b == \"\" || type_b === \"*\") type_b = 0;\n    if (!type_a || !type_b || type_a == type_b || type_a == this.EVENT && type_b == this.ACTION) {\n      return true;\n    }\n    type_a = String(type_a);\n    type_b = String(type_b);\n    type_a = type_a.toLowerCase();\n    type_b = type_b.toLowerCase();\n    if (!type_a.includes(\",\") && !type_b.includes(\",\"))\n      return type_a == type_b;\n    const supported_types_a = type_a.split(\",\");\n    const supported_types_b = type_b.split(\",\");\n    for (const a of supported_types_a) {\n      for (const b of supported_types_b) {\n        if (this.isValidConnection(a, b))\n          return true;\n      }\n    }\n    return false;\n  }\n  // used to create nodes from wrapping functions\n  getParameterNames(func) {\n    return String(func).replaceAll(/\\/\\/.*$/gm, \"\").replaceAll(/\\s+/g, \"\").replaceAll(/\\/\\*[^*/]*\\*\\//g, \"\").split(\"){\", 1)[0].replace(/^[^(]*\\(/, \"\").replaceAll(/=[^,]+/g, \"\").split(\",\").filter(Boolean);\n  }\n  /* helper for interaction: pointer, touch, mouse Listeners\n    used by LGraphCanvas DragAndScale ContextMenu */\n  pointerListenerAdd(oDOM, sEvIn, fCall, capture = false) {\n    if (!oDOM || !oDOM.addEventListener || !sEvIn || typeof fCall !== \"function\") return;\n    let sMethod = this.pointerevents_method;\n    let sEvent = sEvIn;\n    if (sMethod == \"pointer\" && !window.PointerEvent) {\n      console.warn(\"sMethod=='pointer' && !window.PointerEvent\");\n      console.log(`Converting pointer[${sEvent}] : down move up cancel enter TO touchstart touchmove touchend, etc ..`);\n      switch (sEvent) {\n        case \"down\": {\n          sMethod = \"touch\";\n          sEvent = \"start\";\n          break;\n        }\n        case \"move\": {\n          sMethod = \"touch\";\n          break;\n        }\n        case \"up\": {\n          sMethod = \"touch\";\n          sEvent = \"end\";\n          break;\n        }\n        case \"cancel\": {\n          sMethod = \"touch\";\n          break;\n        }\n        case \"enter\": {\n          console.log(\"debug: Should I send a move event?\");\n          break;\n        }\n        // case \"over\": case \"out\": not used at now\n        default: {\n          console.warn(`PointerEvent not available in this browser ? The event ${sEvent} would not be called`);\n        }\n      }\n    }\n    switch (sEvent) {\n      // @ts-expect-error\n      // both pointer and move events\n      case \"down\":\n      case \"up\":\n      case \"move\":\n      case \"over\":\n      case \"out\":\n      case \"enter\": {\n        oDOM.addEventListener(sMethod + sEvent, fCall, capture);\n      }\n      // @ts-expect-error\n      // only pointerevents\n      case \"leave\":\n      case \"cancel\":\n      case \"gotpointercapture\":\n      case \"lostpointercapture\": {\n        if (sMethod != \"mouse\") {\n          return oDOM.addEventListener(sMethod + sEvent, fCall, capture);\n        }\n      }\n      // not \"pointer\" || \"mouse\"\n      default:\n        return oDOM.addEventListener(sEvent, fCall, capture);\n    }\n  }\n  pointerListenerRemove(oDOM, sEvent, fCall, capture = false) {\n    if (!oDOM || !oDOM.removeEventListener || !sEvent || typeof fCall !== \"function\") return;\n    switch (sEvent) {\n      // @ts-expect-error\n      // both pointer and move events\n      case \"down\":\n      case \"up\":\n      case \"move\":\n      case \"over\":\n      case \"out\":\n      case \"enter\": {\n        if (this.pointerevents_method == \"pointer\" || this.pointerevents_method == \"mouse\") {\n          oDOM.removeEventListener(this.pointerevents_method + sEvent, fCall, capture);\n        }\n      }\n      // @ts-expect-error\n      // only pointerevents\n      case \"leave\":\n      case \"cancel\":\n      case \"gotpointercapture\":\n      case \"lostpointercapture\": {\n        if (this.pointerevents_method == \"pointer\") {\n          return oDOM.removeEventListener(this.pointerevents_method + sEvent, fCall, capture);\n        }\n      }\n      // not \"pointer\" || \"mouse\"\n      default:\n        return oDOM.removeEventListener(sEvent, fCall, capture);\n    }\n  }\n  getTime() {\n    return performance.now();\n  }\n  distance = distance;\n  colorToString(c) {\n    return `rgba(${Math.round(c[0] * 255).toFixed()},${Math.round(c[1] * 255).toFixed()},${Math.round(c[2] * 255).toFixed()},${c.length == 4 ? c[3].toFixed(2) : \"1.0\"})`;\n  }\n  isInsideRectangle = isInsideRectangle;\n  // [minx,miny,maxx,maxy]\n  growBounding(bounding, x2, y) {\n    if (x2 < bounding[0]) {\n      bounding[0] = x2;\n    } else if (x2 > bounding[2]) {\n      bounding[2] = x2;\n    }\n    if (y < bounding[1]) {\n      bounding[1] = y;\n    } else if (y > bounding[3]) {\n      bounding[3] = y;\n    }\n  }\n  overlapBounding = overlapBounding;\n  // point inside bounding box\n  isInsideBounding(p, bb) {\n    if (p[0] < bb[0][0] || p[1] < bb[0][1] || p[0] > bb[1][0] || p[1] > bb[1][1]) {\n      return false;\n    }\n    return true;\n  }\n  // Convert a hex value to its decimal value - the inputted hex must be in the\n  // format of a hex triplet - the kind we use for HTML colours. The function\n  // will return an array with three values.\n  hex2num(hex) {\n    if (hex.charAt(0) == \"#\") {\n      hex = hex.slice(1);\n    }\n    hex = hex.toUpperCase();\n    const hex_alphabets = \"0123456789ABCDEF\";\n    const value = new Array(3);\n    let k = 0;\n    let int1, int2;\n    for (let i = 0; i < 6; i += 2) {\n      int1 = hex_alphabets.indexOf(hex.charAt(i));\n      int2 = hex_alphabets.indexOf(hex.charAt(i + 1));\n      value[k] = int1 * 16 + int2;\n      k++;\n    }\n    return value;\n  }\n  // Give a array with three values as the argument and the function will return\n  // the corresponding hex triplet.\n  num2hex(triplet) {\n    const hex_alphabets = \"0123456789ABCDEF\";\n    let hex = \"#\";\n    let int1, int2;\n    for (let i = 0; i < 3; i++) {\n      int1 = triplet[i] / 16;\n      int2 = triplet[i] % 16;\n      hex += hex_alphabets.charAt(int1) + hex_alphabets.charAt(int2);\n    }\n    return hex;\n  }\n  closeAllContextMenus(ref_window = window) {\n    const elements = [...ref_window.document.querySelectorAll(\".litecontextmenu\")];\n    if (!elements.length) return;\n    for (const element of elements) {\n      if (\"close\" in element && typeof element.close === \"function\") {\n        element.close();\n      } else {\n        element.remove();\n      }\n    }\n  }\n  extendClass(target, origin) {\n    for (const i in origin) {\n      if (target.hasOwnProperty(i)) continue;\n      target[i] = origin[i];\n    }\n    if (origin.prototype) {\n      for (const i in origin.prototype) {\n        if (!origin.prototype.hasOwnProperty(i)) continue;\n        if (target.prototype.hasOwnProperty(i)) continue;\n        if (origin.prototype.__lookupGetter__(i)) {\n          target.prototype.__defineGetter__(\n            i,\n            origin.prototype.__lookupGetter__(i)\n          );\n        } else {\n          target.prototype[i] = origin.prototype[i];\n        }\n        if (origin.prototype.__lookupSetter__(i)) {\n          target.prototype.__defineSetter__(\n            i,\n            origin.prototype.__lookupSetter__(i)\n          );\n        }\n      }\n    }\n  }\n}\nSymbol.dispose ??= Symbol(\"Symbol.dispose\");\nSymbol.asyncDispose ??= Symbol(\"Symbol.asyncDispose\");\nfunction loadPolyfills() {\n  if (typeof window != \"undefined\" && window.CanvasRenderingContext2D && !window.CanvasRenderingContext2D.prototype.roundRect) {\n    window.CanvasRenderingContext2D.prototype.roundRect = function(x2, y, w, h, radius, radius_low) {\n      let top_left_radius = 0;\n      let top_right_radius = 0;\n      let bottom_left_radius = 0;\n      let bottom_right_radius = 0;\n      if (radius === 0) {\n        this.rect(x2, y, w, h);\n        return;\n      }\n      if (radius_low === void 0) radius_low = radius;\n      if (Array.isArray(radius)) {\n        if (radius.length == 1) {\n          top_left_radius = top_right_radius = bottom_left_radius = bottom_right_radius = radius[0];\n        } else if (radius.length == 2) {\n          top_left_radius = bottom_right_radius = radius[0];\n          top_right_radius = bottom_left_radius = radius[1];\n        } else if (radius.length == 4) {\n          top_left_radius = radius[0];\n          top_right_radius = radius[1];\n          bottom_left_radius = radius[2];\n          bottom_right_radius = radius[3];\n        } else {\n          return;\n        }\n      } else {\n        top_left_radius = radius || 0;\n        top_right_radius = radius || 0;\n        const low = !Array.isArray(radius_low) && radius_low ? radius_low : 0;\n        bottom_left_radius = low;\n        bottom_right_radius = low;\n      }\n      this.moveTo(x2 + top_left_radius, y);\n      this.lineTo(x2 + w - top_right_radius, y);\n      this.quadraticCurveTo(x2 + w, y, x2 + w, y + top_right_radius);\n      this.lineTo(x2 + w, y + h - bottom_right_radius);\n      this.quadraticCurveTo(\n        x2 + w,\n        y + h,\n        x2 + w - bottom_right_radius,\n        y + h\n      );\n      this.lineTo(x2 + bottom_right_radius, y + h);\n      this.quadraticCurveTo(x2, y + h, x2, y + h - bottom_left_radius);\n      this.lineTo(x2, y + bottom_left_radius);\n      this.quadraticCurveTo(x2, y, x2 + top_left_radius, y);\n    };\n  }\n  if (typeof window != \"undefined\" && !window[\"requestAnimationFrame\"]) {\n    window.requestAnimationFrame = // @ts-expect-error Legacy code\n    window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback) {\n      window.setTimeout(callback, 1e3 / 60);\n    };\n  }\n}\nclass InvalidLinkError extends Error {\n  constructor(message = \"Attempted to access a link that was invalid.\", cause) {\n    super(message, { cause });\n    this.name = \"InvalidLinkError\";\n  }\n}\nclass RecursionError extends Error {\n  constructor(subject) {\n    super(subject);\n    this.name = \"RecursionError\";\n  }\n}\nclass SlotIndexError extends Error {\n  constructor(message = \"Attempted to access a slot that was out of bounds.\", cause) {\n    super(message, { cause });\n    this.name = \"SlotIndexError\";\n  }\n}\nclass ExecutableNodeDTO {\n  constructor(node2, subgraphNodePath, nodesByExecutionId, subgraphNode) {\n    this.node = node2;\n    this.subgraphNodePath = subgraphNodePath;\n    this.nodesByExecutionId = nodesByExecutionId;\n    this.subgraphNode = subgraphNode;\n    if (!node2.graph) throw new NullGraphError();\n    this.#id = [...this.subgraphNodePath, this.node.id].join(\":\");\n    this.graph = node2.graph;\n    this.inputs = this.node.inputs.map((x2) => ({\n      linkId: x2.link,\n      name: x2.name,\n      type: x2.type\n    }));\n    if (this.node.applyToGraph) {\n      this.applyToGraph = (...args) => this.node.applyToGraph?.(...args);\n    }\n  }\n  /** The graph that this node is a part of. */\n  graph;\n  inputs;\n  /** Backing field for {@link id}. */\n  #id;\n  /**\n   * The path to the acutal node through subgraph instances, represented as a list of all subgraph node IDs (instances),\n   * followed by the actual original node ID within the subgraph. Each segment is separated by `:`.\n   *\n   * e.g. `1:2:3`:\n   * - `1` is the node ID of the first subgraph node in the parent workflow\n   * - `2` is the node ID of the second subgraph node in the first subgraph\n   * - `3` is the node ID of the actual node in the subgraph definition\n   */\n  get id() {\n    return this.#id;\n  }\n  get type() {\n    return this.node.type;\n  }\n  get title() {\n    return this.node.title;\n  }\n  get mode() {\n    return this.node.mode;\n  }\n  get comfyClass() {\n    return this.node.comfyClass;\n  }\n  get isVirtualNode() {\n    return this.node.isVirtualNode;\n  }\n  get widgets() {\n    return this.node.widgets;\n  }\n  get subgraphId() {\n    return this.subgraphNode?.subgraph.id;\n  }\n  /** Returns either the DTO itself, or the DTOs of the inner nodes of the subgraph. */\n  getInnerNodes() {\n    return this.node.isSubgraphNode() ? this.node.getInnerNodes(this.nodesByExecutionId, this.subgraphNodePath) : [this];\n  }\n  /**\n   * Resolves the executable node & link IDs for a given input slot.\n   * @param slot The slot index of the input.\n   * @param visited Leave empty unless overriding this method.\n   * A set of unique IDs, used to guard against infinite recursion.\n   * If overriding, ensure that the set is passed on all recursive calls.\n   * @returns The node and the origin ID / slot index of the output.\n   */\n  resolveInput(slot, visited = /* @__PURE__ */ new Set()) {\n    const uniqueId = `${this.subgraphNode?.subgraph.id}:${this.node.id}[I]${slot}`;\n    if (visited.has(uniqueId)) {\n      const nodeInfo = `${this.node.id}${this.node.title ? ` (${this.node.title})` : \"\"}`;\n      const pathInfo = this.subgraphNodePath.length > 0 ? ` at path ${this.subgraphNodePath.join(\":\")}` : \"\";\n      throw new RecursionError(\n        `Circular reference detected while resolving input ${slot} of node ${nodeInfo}${pathInfo}. This creates an infinite loop in link resolution. UniqueID: [${uniqueId}]`\n      );\n    }\n    visited.add(uniqueId);\n    const input = this.inputs.at(slot);\n    if (!input) throw new SlotIndexError(`No input found for flattened id [${this.id}] slot [${slot}]`);\n    if (input.linkId == null) return;\n    const link = this.graph.getLink(input.linkId);\n    if (!link) throw new InvalidLinkError(`No link found in parent graph for id [${this.id}] slot [${slot}] ${input.name}`);\n    const { subgraphNode } = this;\n    if (subgraphNode && link.originIsIoNode) {\n      const subgraphNodeInput = subgraphNode.inputs.at(link.origin_slot);\n      if (!subgraphNodeInput) throw new SlotIndexError(`No input found for slot [${link.origin_slot}] ${input.name}`);\n      const linkId = subgraphNodeInput.link;\n      if (linkId == null) {\n        const widget = subgraphNode.getWidgetFromSlot(subgraphNodeInput);\n        if (!widget) return;\n        return {\n          node: this,\n          origin_id: this.id,\n          origin_slot: -1,\n          widgetInfo: { value: widget.value }\n        };\n      }\n      const outerLink = subgraphNode.graph.getLink(linkId);\n      if (!outerLink) throw new InvalidLinkError(`No outer link found for slot [${link.origin_slot}] ${input.name}`);\n      const subgraphNodeExecutionId = this.subgraphNodePath.join(\":\");\n      const subgraphNodeDto = this.nodesByExecutionId.get(subgraphNodeExecutionId);\n      if (!subgraphNodeDto) throw new Error(`No subgraph node DTO found for id [${subgraphNodeExecutionId}]`);\n      return subgraphNodeDto.resolveInput(outerLink.target_slot, visited);\n    }\n    const outputNode = this.graph.getNodeById(link.origin_id);\n    if (!outputNode) throw new InvalidLinkError(`No input node found for id [${this.id}] slot [${slot}] ${input.name}`);\n    const outputNodeExecutionId = [...this.subgraphNodePath, outputNode.id].join(\":\");\n    const outputNodeDto = this.nodesByExecutionId.get(outputNodeExecutionId);\n    if (!outputNodeDto) throw new Error(`No output node DTO found for id [${outputNodeExecutionId}]`);\n    return outputNodeDto.resolveOutput(link.origin_slot, input.type, visited);\n  }\n  /**\n   * Determines whether this output is a valid endpoint for a link (non-virtual, non-bypass).\n   * @param slot The slot index of the output.\n   * @param type The type of the input\n   * @param visited A set of unique IDs to guard against infinite recursion. See {@link resolveInput}.\n   * @returns The node and the origin ID / slot index of the output.\n   */\n  resolveOutput(slot, type, visited) {\n    const uniqueId = `${this.subgraphNode?.subgraph.id}:${this.node.id}[O]${slot}`;\n    if (visited.has(uniqueId)) {\n      const nodeInfo = `${this.node.id}${this.node.title ? ` (${this.node.title})` : \"\"}`;\n      const pathInfo = this.subgraphNodePath.length > 0 ? ` at path ${this.subgraphNodePath.join(\":\")}` : \"\";\n      throw new RecursionError(\n        `Circular reference detected while resolving output ${slot} of node ${nodeInfo}${pathInfo}. This creates an infinite loop in link resolution. UniqueID: [${uniqueId}]`\n      );\n    }\n    visited.add(uniqueId);\n    if (this.mode === LGraphEventMode.BYPASS) {\n      const { inputs } = this;\n      const parentInputIndexes = Object.keys(inputs).map(Number);\n      const indexes = [slot, ...parentInputIndexes];\n      const matchingIndex = indexes.find((i) => inputs[i]?.type === type);\n      if (matchingIndex === void 0) {\n        console.debug(`[ExecutableNodeDTO.resolveOutput] No input types match type [${type}] for id [${this.id}] slot [${slot}]`, this);\n        return;\n      }\n      return this.resolveInput(matchingIndex, visited);\n    }\n    const { node: node2 } = this;\n    if (node2.isSubgraphNode()) return this.#resolveSubgraphOutput(slot, type, visited);\n    if (node2.isVirtualNode) {\n      if (this.inputs.at(slot)) return this.resolveInput(slot, visited);\n      const virtualLink = this.node.getInputLink(slot);\n      if (virtualLink) {\n        const outputNode = this.graph.getNodeById(virtualLink.origin_id);\n        if (!outputNode) throw new InvalidLinkError(`Virtual node failed to resolve parent [${this.id}] slot [${slot}]`);\n        const outputNodeExecutionId = [...this.subgraphNodePath, outputNode.id].join(\":\");\n        const outputNodeDto = this.nodesByExecutionId.get(outputNodeExecutionId);\n        if (!outputNodeDto) throw new Error(`No output node DTO found for id [${outputNode.id}]`);\n        return outputNodeDto.resolveOutput(virtualLink.origin_slot, type, visited);\n      }\n      return;\n    }\n    return {\n      node: this,\n      origin_id: this.id,\n      origin_slot: slot\n    };\n  }\n  /**\n   * Resolves the link inside a subgraph node, from the subgraph IO node to the node inside the subgraph.\n   * @param slot The slot index of the output on the subgraph node.\n   * @param visited A set of unique IDs to guard against infinite recursion. See {@link resolveInput}.\n   * @returns A DTO for the node, and the origin ID / slot index of the output.\n   */\n  #resolveSubgraphOutput(slot, type, visited) {\n    const { node: node2 } = this;\n    const output = node2.outputs.at(slot);\n    if (!output) throw new SlotIndexError(`No output found for flattened id [${this.id}] slot [${slot}]`);\n    if (!node2.isSubgraphNode()) throw new TypeError(`Node is not a subgraph node: ${node2.id}`);\n    const innerResolved = node2.resolveSubgraphOutputLink(slot);\n    if (!innerResolved) return;\n    const innerNode = innerResolved.outputNode;\n    if (!innerNode) throw new Error(`No output node found for id [${this.id}] slot [${slot}] ${output.name}`);\n    const innerNodeExecutionId = [...this.subgraphNodePath, node2.id, innerNode.id].join(\":\");\n    const innerNodeDto = this.nodesByExecutionId.get(innerNodeExecutionId);\n    if (!innerNodeDto) throw new Error(`No inner node DTO found for id [${innerNodeExecutionId}]`);\n    return innerNodeDto.resolveOutput(innerResolved.link.origin_slot, type, visited);\n  }\n}\nclass SubgraphNode extends LGraphNode {\n  constructor(graph, subgraph, instanceData) {\n    super(subgraph.name, subgraph.id);\n    this.graph = graph;\n    this.subgraph = subgraph;\n    const subgraphEvents = this.subgraph.events;\n    const { signal } = this.#eventAbortController;\n    subgraphEvents.addEventListener(\"input-added\", (e2) => {\n      const subgraphInput = e2.detail.input;\n      const { name, type } = subgraphInput;\n      if (this.inputs.some((i) => i.name == name))\n        return;\n      const input = this.addInput(name, type);\n      this.#addSubgraphInputListeners(subgraphInput, input);\n    }, { signal });\n    subgraphEvents.addEventListener(\"removing-input\", (e2) => {\n      const widget = e2.detail.input._widget;\n      if (widget) this.ensureWidgetRemoved(widget);\n      this.removeInput(e2.detail.index);\n      this.setDirtyCanvas(true, true);\n    }, { signal });\n    subgraphEvents.addEventListener(\"output-added\", (e2) => {\n      const { name, type } = e2.detail.output;\n      this.addOutput(name, type);\n    }, { signal });\n    subgraphEvents.addEventListener(\"removing-output\", (e2) => {\n      this.removeOutput(e2.detail.index);\n      this.setDirtyCanvas(true, true);\n    }, { signal });\n    subgraphEvents.addEventListener(\"renaming-input\", (e2) => {\n      const { index, newName } = e2.detail;\n      const input = this.inputs.at(index);\n      if (!input) throw new Error(\"Subgraph input not found\");\n      input.label = newName;\n    }, { signal });\n    subgraphEvents.addEventListener(\"renaming-output\", (e2) => {\n      const { index, newName } = e2.detail;\n      const output = this.outputs.at(index);\n      if (!output) throw new Error(\"Subgraph output not found\");\n      output.label = newName;\n    }, { signal });\n    this.type = subgraph.id;\n    this.configure(instanceData);\n    this.addTitleButton({\n      name: \"enter_subgraph\",\n      text: \"\",\n      // Unicode for pi-window-maximize\n      yOffset: 0,\n      // No vertical offset needed, button is centered\n      xOffset: -10,\n      fontSize: 16\n    });\n  }\n  type;\n  isVirtualNode = true;\n  get rootGraph() {\n    return this.graph.rootGraph;\n  }\n  get displayType() {\n    return \"Subgraph node\";\n  }\n  isSubgraphNode() {\n    return true;\n  }\n  widgets = [];\n  /** Manages lifecycle of all subgraph event listeners */\n  #eventAbortController = new AbortController();\n  onTitleButtonClick(button, canvas2) {\n    if (button.name === \"enter_subgraph\") {\n      canvas2.openSubgraph(this.subgraph);\n    } else {\n      super.onTitleButtonClick(button, canvas2);\n    }\n  }\n  #addSubgraphInputListeners(subgraphInput, input) {\n    input._listenerController?.abort();\n    input._listenerController = new AbortController();\n    const { signal } = input._listenerController;\n    subgraphInput.events.addEventListener(\n      \"input-connected\",\n      () => {\n        if (input._widget) return;\n        const widget = subgraphInput._widget;\n        if (!widget) return;\n        this.#setWidget(subgraphInput, input, widget);\n      },\n      { signal }\n    );\n    subgraphInput.events.addEventListener(\n      \"input-disconnected\",\n      () => {\n        const connectedWidgets = subgraphInput.getConnectedWidgets();\n        if (connectedWidgets.length > 0) return;\n        this.removeWidgetByName(input.name);\n        delete input.pos;\n        delete input.widget;\n        input._widget = void 0;\n      },\n      { signal }\n    );\n  }\n  configure(info) {\n    for (const input of this.inputs) {\n      input._listenerController?.abort();\n    }\n    this.inputs.length = 0;\n    this.inputs.push(\n      ...this.subgraph.inputNode.slots.map(\n        (slot) => new NodeInputSlot({ name: slot.name, localized_name: slot.localized_name, label: slot.label, type: slot.type, link: null }, this)\n      )\n    );\n    this.outputs.length = 0;\n    this.outputs.push(\n      ...this.subgraph.outputNode.slots.map(\n        (slot) => new NodeOutputSlot({ name: slot.name, localized_name: slot.localized_name, label: slot.label, type: slot.type, links: null }, this)\n      )\n    );\n    super.configure(info);\n  }\n  _internalConfigureAfterSlots() {\n    this.widgets.length = 0;\n    for (const input of this.inputs) {\n      const subgraphInput = this.subgraph.inputNode.slots.find((slot) => slot.name === input.name);\n      if (!subgraphInput) throw new Error(`[SubgraphNode.configure] No subgraph input found for input ${input.name}`);\n      this.#addSubgraphInputListeners(subgraphInput, input);\n      for (const linkId of subgraphInput.linkIds) {\n        const link = this.subgraph.getLink(linkId);\n        if (!link) {\n          console.warn(`[SubgraphNode.configure] No link found for link ID ${linkId}`, this);\n          continue;\n        }\n        const resolved = link.resolve(this.subgraph);\n        if (!resolved.input || !resolved.inputNode) {\n          console.warn(\"Invalid resolved link\", resolved, this);\n          continue;\n        }\n        const widget = resolved.inputNode.getWidgetFromSlot(resolved.input);\n        if (!widget) continue;\n        this.#setWidget(subgraphInput, input, widget);\n        break;\n      }\n    }\n  }\n  #setWidget(subgraphInput, input, widget) {\n    const promotedWidget = toConcreteWidget(widget, this).createCopyForNode(this);\n    Object.assign(promotedWidget, {\n      get name() {\n        return subgraphInput.name;\n      },\n      set name(value) {\n        console.warn(\"Promoted widget: setting name is not allowed\", this, value);\n      },\n      get localized_name() {\n        return subgraphInput.localized_name;\n      },\n      set localized_name(value) {\n        console.warn(\"Promoted widget: setting localized_name is not allowed\", this, value);\n      },\n      get label() {\n        return subgraphInput.label;\n      },\n      set label(value) {\n        console.warn(\"Promoted widget: setting label is not allowed\", this, value);\n      },\n      get tooltip() {\n        return widget.tooltip;\n      },\n      set tooltip(value) {\n        console.warn(\"Promoted widget: setting tooltip is not allowed\", this, value);\n      }\n    });\n    this.widgets.push(promotedWidget);\n    this.subgraph.events.dispatch(\"widget-promoted\", { widget: promotedWidget, subgraphNode: this });\n    input.widget = { name: subgraphInput.name };\n    input._widget = promotedWidget;\n  }\n  /**\n   * Ensures the subgraph slot is in the params before adding the input as normal.\n   * @param name The name of the input slot.\n   * @param type The type of the input slot.\n   * @param inputProperties Properties that are directly assigned to the created input. Default: a new, empty object.\n   * @returns The new input slot.\n   * @remarks Assertion is required to instantiate empty generic POJO.\n   */\n  addInput(name, type, inputProperties = {}) {\n    return super.addInput(name, type, inputProperties);\n  }\n  getInputLink(slot) {\n    const innerLink = this.subgraph.outputNode.slots[slot].getLinks().at(0);\n    if (!innerLink) {\n      console.warn(`SubgraphNode.getInputLink: no inner link found for slot ${slot}`);\n      return null;\n    }\n    const newLink = LLink.create(innerLink);\n    newLink.origin_id = `${this.id}:${innerLink.origin_id}`;\n    newLink.origin_slot = innerLink.origin_slot;\n    return newLink;\n  }\n  /**\n   * Finds the internal links connected to the given input slot inside the subgraph, and resolves the nodes / slots.\n   * @param slot The slot index\n   * @returns The resolved connections, or undefined if no input node is found.\n   * @remarks This is used to resolve the input links when dragging a link from a subgraph input slot.\n   */\n  resolveSubgraphInputLinks(slot) {\n    const inputSlot = this.subgraph.inputNode.slots[slot];\n    const innerLinks = inputSlot.getLinks();\n    if (innerLinks.length === 0) {\n      console.debug(`[SubgraphNode.resolveSubgraphInputLinks] No inner links found for input slot [${slot}] ${inputSlot.name}`, this);\n      return [];\n    }\n    return innerLinks.map((link) => link.resolve(this.subgraph));\n  }\n  /**\n   * Finds the internal link connected to the given output slot inside the subgraph, and resolves the nodes / slots.\n   * @param slot The slot index\n   * @returns The output node if found, otherwise undefined.\n   */\n  resolveSubgraphOutputLink(slot) {\n    const outputSlot = this.subgraph.outputNode.slots[slot];\n    const innerLink = outputSlot.getLinks().at(0);\n    if (innerLink) return innerLink.resolve(this.subgraph);\n    console.debug(`[SubgraphNode.resolveSubgraphOutputLink] No inner link found for output slot [${slot}] ${outputSlot.name}`, this);\n  }\n  /** @internal Used to flatten the subgraph before execution. */\n  getInnerNodes(executableNodes, subgraphNodePath = [], nodes = [], visited = /* @__PURE__ */ new Set()) {\n    if (visited.has(this)) {\n      const nodeInfo = `${this.id}${this.title ? ` (${this.title})` : \"\"}`;\n      const subgraphInfo = `'${this.subgraph.name || \"Unnamed Subgraph\"}'`;\n      const depth = subgraphNodePath.length;\n      throw new RecursionError(\n        `Circular reference detected at depth ${depth} in node ${nodeInfo} of subgraph ${subgraphInfo}. This creates an infinite loop in the subgraph hierarchy.`\n      );\n    }\n    visited.add(this);\n    const subgraphInstanceIdPath = [...subgraphNodePath, this.id];\n    const parentSubgraphNode = this.graph.rootGraph.resolveSubgraphIdPath(subgraphNodePath).at(-1);\n    const subgraphNodeDto = new ExecutableNodeDTO(this, subgraphNodePath, executableNodes, parentSubgraphNode);\n    executableNodes.set(subgraphNodeDto.id, subgraphNodeDto);\n    for (const node2 of this.subgraph.nodes) {\n      if (\"getInnerNodes\" in node2) {\n        node2.getInnerNodes(executableNodes, subgraphInstanceIdPath, nodes, new Set(visited));\n      } else {\n        const aVeryRealNode = new ExecutableNodeDTO(node2, subgraphInstanceIdPath, executableNodes, this);\n        executableNodes.set(aVeryRealNode.id, aVeryRealNode);\n        nodes.push(aVeryRealNode);\n      }\n    }\n    return nodes;\n  }\n  removeWidgetByName(name) {\n    const widget = this.widgets.find((w) => w.name === name);\n    if (widget) {\n      this.subgraph.events.dispatch(\"widget-demoted\", { widget, subgraphNode: this });\n    }\n    super.removeWidgetByName(name);\n  }\n  ensureWidgetRemoved(widget) {\n    if (this.widgets.includes(widget)) {\n      this.subgraph.events.dispatch(\"widget-demoted\", { widget, subgraphNode: this });\n    }\n    super.ensureWidgetRemoved(widget);\n  }\n  onRemoved() {\n    this.#eventAbortController.abort();\n    for (const widget of this.widgets) {\n      this.subgraph.events.dispatch(\"widget-demoted\", { widget, subgraphNode: this });\n    }\n    for (const input of this.inputs) {\n      input._listenerController?.abort();\n    }\n  }\n}\nconst LiteGraph = new LiteGraphGlobal();\nloadPolyfills();\nexport {\n  BadgePosition,\n  BaseSteppedWidget,\n  BaseWidget,\n  BooleanWidget,\n  ButtonWidget,\n  CanvasItem,\n  CanvasPointer,\n  ComboWidget,\n  constants as Constants,\n  ContextMenu,\n  CurveEditor,\n  DragAndScale,\n  EaseFunction,\n  ExecutableNodeDTO,\n  InputIndicators,\n  KnobWidget,\n  LGraph,\n  LGraphBadge,\n  LGraphCanvas,\n  LGraphEventMode,\n  LGraphGroup,\n  LGraphNode,\n  LLink,\n  LabelPosition,\n  LegacyWidget,\n  LinkConnector,\n  LinkMarkerShape,\n  LiteGraph,\n  NumberWidget,\n  Rectangle,\n  RenderShape,\n  Reroute,\n  SliderWidget,\n  SlotDirection,\n  SlotShape,\n  SlotType,\n  Subgraph,\n  SubgraphNode,\n  TextWidget,\n  TitleMode,\n  clamp,\n  createBounds,\n  createUuidv4,\n  isColorable,\n  isComboWidget,\n  isOverNodeInput,\n  isOverNodeOutput,\n  strokeShape\n};\n//# sourceMappingURL=litegraph.es.js.map\n","/**\n * Lazy node registration for LiteGraph.\n *\n * IMPORTANT: We do NOT import node files at the module top level.\n * All LiteGraph.registerNodeType() calls happen inside\n * registerAllNodes(), which is called from the React component's\n * useEffect — only after the DOM is ready and the component has\n * mounted.\n */\n\nimport { LiteGraph, LGraphNode } from \"@comfyorg/litegraph\";\n\nlet registered = false;\n\n/**\n * Register all FiftyOne node types with LiteGraph.\n * Safe to call multiple times — only registers once.\n */\nexport function registerAllNodes(): void {\n  if (registered) return;\n  registered = true;\n\n  // ─── Source ────────────────────────────────────────────────────\n\n  class FO_LoadDataset extends LGraphNode {\n    static title = \"Current Dataset\";\n    static desc = \"Use the dataset currently loaded in the App\";\n    constructor() {\n      super();\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.properties = {};\n      this.size = [220, 50];\n      this.color = \"#1B4F72\";\n      this.bgcolor = \"#154360\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Source/Current Dataset\", FO_LoadDataset as any);\n\n  class FO_LoadSavedView extends LGraphNode {\n    static title = \"Load Saved View\";\n    static desc = \"Load a saved view from the dataset\";\n    constructor() {\n      super();\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"view_name\", \"\", (v: string) => {\n        this.properties.view_name = v;\n      }, { values: [] as string[] });\n      this.properties = { view_name: \"\" };\n      this.size = [280, 70];\n      this.color = \"#1B4F72\";\n      this.bgcolor = \"#154360\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Source/Load Saved View\", FO_LoadSavedView as any);\n\n  // ─── View Stages ──────────────────────────────────────────────\n\n  class FO_Match extends LGraphNode {\n    static title = \"Match\";\n    static desc = \"Filter samples by a ViewExpression\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"expression\", \"F('confidence') > 0.5\", (v: string) => {\n        this.properties.expression = v;\n      });\n      this.properties = { expression: \"F('confidence') > 0.5\" };\n      this.size = [320, 80];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Match\", FO_Match as any);\n\n  class FO_FilterLabels extends LGraphNode {\n    static title = \"Filter Labels\";\n    static desc = \"Filter detections/classifications within a label field\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"field\", \"\", (v: string) => { this.properties.field = v; }, { values: [] as string[] });\n      this.addWidget(\"text\", \"expression\", \"F('confidence') > 0.5\", (v: string) => { this.properties.expression = v; });\n      this.addWidget(\"toggle\", \"only_matches\", true, (v: boolean) => { this.properties.only_matches = v; });\n      this.properties = { field: \"\", expression: \"F('confidence') > 0.5\", only_matches: true };\n      this.size = [320, 130];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Filter Labels\", FO_FilterLabels as any);\n\n  class FO_SortBy extends LGraphNode {\n    static title = \"Sort By\";\n    static desc = \"Sort samples by a field\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"field\", \"\", (v: string) => { this.properties.field = v; }, { values: [] as string[] });\n      this.addWidget(\"toggle\", \"reverse\", false, (v: boolean) => { this.properties.reverse = v; });\n      this.properties = { field: \"\", reverse: false };\n      this.size = [280, 90];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Sort By\", FO_SortBy as any);\n\n  class FO_Limit extends LGraphNode {\n    static title = \"Limit\";\n    static desc = \"Limit number of samples\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"number\", \"count\", 100, (v: number) => { this.properties.count = v; }, { min: 1, max: 100000, step: 10 });\n      this.properties = { count: 100 };\n      this.size = [220, 70];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Limit\", FO_Limit as any);\n\n  class FO_Exists extends LGraphNode {\n    static title = \"Exists\";\n    static desc = \"Filter samples where a field exists\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"field\", \"\", (v: string) => { this.properties.field = v; }, { values: [] as string[] });\n      this.addWidget(\"toggle\", \"bool\", true, (v: boolean) => { this.properties.bool = v; });\n      this.properties = { field: \"\", bool: true };\n      this.size = [260, 90];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Exists\", FO_Exists as any);\n\n  class FO_MatchTags extends LGraphNode {\n    static title = \"Match Tags\";\n    static desc = \"Filter samples by tags (comma-separated)\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"tags\", \"\", (v: string) => { this.properties.tags = v; });\n      this.properties = { tags: \"\" };\n      this.size = [280, 70];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Match Tags\", FO_MatchTags as any);\n\n  class FO_Take extends LGraphNode {\n    static title = \"Take\";\n    static desc = \"Randomly sample N samples\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"number\", \"count\", 100, (v: number) => { this.properties.count = v; }, { min: 1, max: 100000, step: 10 });\n      this.addWidget(\"number\", \"seed\", 0, (v: number) => { this.properties.seed = v || null; }, { min: 0, max: 99999, step: 1 });\n      this.properties = { count: 100, seed: null };\n      this.size = [240, 90];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Take\", FO_Take as any);\n\n  class FO_Shuffle extends LGraphNode {\n    static title = \"Shuffle\";\n    static desc = \"Randomly shuffle samples\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"number\", \"seed\", 0, (v: number) => { this.properties.seed = v || null; }, { min: 0, max: 99999, step: 1 });\n      this.properties = { seed: null };\n      this.size = [220, 70];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Shuffle\", FO_Shuffle as any);\n\n  class FO_SelectFields extends LGraphNode {\n    static title = \"Select Fields\";\n    static desc = \"Select only specified fields (comma-separated)\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"fields\", \"\", (v: string) => { this.properties.fields = v; });\n      this.properties = { fields: \"\" };\n      this.size = [280, 70];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Select Fields\", FO_SelectFields as any);\n\n  class FO_ExcludeFields extends LGraphNode {\n    static title = \"Exclude Fields\";\n    static desc = \"Exclude specified fields (comma-separated)\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"fields\", \"\", (v: string) => { this.properties.fields = v; });\n      this.properties = { fields: \"\" };\n      this.size = [280, 70];\n      this.color = \"#2A633A\";\n      this.bgcolor = \"#1E4A2B\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/View Stages/Exclude Fields\", FO_ExcludeFields as any);\n\n  // ─── Brain ────────────────────────────────────────────────────\n\n  class FO_ComputeEmbeddings extends LGraphNode {\n    static title = \"Compute Embeddings\";\n    static desc = \"Compute embeddings using a zoo model\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"model\", \"clip-vit-base32-torch\", (v: string) => { this.properties.model = v; }, {\n        values: [\"clip-vit-base32-torch\", \"clip-vit-large14-torch\", \"open-clip-vit-b-32\", \"dinov2-vits14-torch\"],\n      });\n      this.addWidget(\"text\", \"embeddings_field\", \"embeddings\", (v: string) => { this.properties.embeddings_field = v; });\n      this.properties = { model: \"clip-vit-base32-torch\", embeddings_field: \"embeddings\" };\n      this.size = [340, 100];\n      this.color = \"#5B2C6F\";\n      this.bgcolor = \"#4A235A\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Brain/Compute Embeddings\", FO_ComputeEmbeddings as any);\n\n  class FO_ComputeVisualization extends LGraphNode {\n    static title = \"Compute Visualization\";\n    static desc = \"Compute UMAP/t-SNE/PCA embedding visualization\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"brain_key\", \"visualization\", (v: string) => { this.properties.brain_key = v; });\n      this.addWidget(\"combo\", \"method\", \"umap\", (v: string) => { this.properties.method = v; }, { values: [\"umap\", \"tsne\", \"pca\"] });\n      this.addWidget(\"combo\", \"num_dims\", \"2\", (v: string) => { this.properties.num_dims = parseInt(v); }, { values: [\"2\", \"3\"] });\n      this.addWidget(\"text\", \"embeddings\", \"\", (v: string) => { this.properties.embeddings = v; });\n      this.properties = { brain_key: \"visualization\", method: \"umap\", num_dims: 2, embeddings: \"\" };\n      this.size = [340, 150];\n      this.color = \"#5B2C6F\";\n      this.bgcolor = \"#4A235A\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Brain/Compute Visualization\", FO_ComputeVisualization as any);\n\n  class FO_ComputeSimilarity extends LGraphNode {\n    static title = \"Compute Similarity\";\n    static desc = \"Create a similarity index\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"brain_key\", \"similarity\", (v: string) => { this.properties.brain_key = v; });\n      this.addWidget(\"combo\", \"backend\", \"sklearn\", (v: string) => { this.properties.backend = v; }, { values: [\"sklearn\", \"qdrant\", \"pinecone\", \"milvus\", \"lancedb\"] });\n      this.addWidget(\"text\", \"embeddings\", \"\", (v: string) => { this.properties.embeddings = v; });\n      this.properties = { brain_key: \"similarity\", backend: \"sklearn\", embeddings: \"\" };\n      this.size = [340, 130];\n      this.color = \"#5B2C6F\";\n      this.bgcolor = \"#4A235A\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Brain/Compute Similarity\", FO_ComputeSimilarity as any);\n\n  class FO_ComputeUniqueness extends LGraphNode {\n    static title = \"Compute Uniqueness\";\n    static desc = \"Compute uniqueness score per sample\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"uniqueness_field\", \"uniqueness\", (v: string) => { this.properties.uniqueness_field = v; });\n      this.addWidget(\"text\", \"embeddings\", \"\", (v: string) => { this.properties.embeddings = v; });\n      this.properties = { uniqueness_field: \"uniqueness\", embeddings: \"\" };\n      this.size = [320, 100];\n      this.color = \"#5B2C6F\";\n      this.bgcolor = \"#4A235A\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Brain/Compute Uniqueness\", FO_ComputeUniqueness as any);\n\n  class FO_FindExactDuplicates extends LGraphNode {\n    static title = \"Find Exact Duplicates\";\n    static desc = \"Find samples with identical media files\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.properties = {};\n      this.size = [280, 50];\n      this.color = \"#5B2C6F\";\n      this.bgcolor = \"#4A235A\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Brain/Find Exact Duplicates\", FO_FindExactDuplicates as any);\n\n  class FO_FindNearDuplicates extends LGraphNode {\n    static title = \"Find Near Duplicates\";\n    static desc = \"Find near-duplicate samples using embeddings\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addOutput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"number\", \"threshold\", 0.1, (v: number) => { this.properties.threshold = v; }, { min: 0.001, max: 1.0, step: 0.01, precision: 3 });\n      this.addWidget(\"text\", \"embeddings\", \"\", (v: string) => { this.properties.embeddings = v; });\n      this.properties = { threshold: 0.1, embeddings: \"\" };\n      this.size = [320, 100];\n      this.color = \"#5B2C6F\";\n      this.bgcolor = \"#4A235A\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Brain/Find Near Duplicates\", FO_FindNearDuplicates as any);\n\n  // ─── Aggregations ─────────────────────────────────────────────\n\n  class FO_Count extends LGraphNode {\n    static title = \"Count\";\n    static desc = \"Count samples in the view\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.properties = { result: null };\n      this.size = [200, 70];\n      this.color = \"#7D6608\";\n      this.bgcolor = \"#5C4B08\";\n    }\n    onDrawForeground(ctx: CanvasRenderingContext2D) {\n      if (this.properties.result !== null && this.properties.result !== undefined) {\n        ctx.font = \"bold 20px monospace\";\n        ctx.fillStyle = \"#FFD700\";\n        ctx.textAlign = \"center\";\n        ctx.fillText(String(this.properties.result), this.size[0] / 2, this.size[1] - 15);\n      }\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Aggregations/Count\", FO_Count as any);\n\n  class FO_CountValues extends LGraphNode {\n    static title = \"Count Values\";\n    static desc = \"Count occurrences of each value in a field\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"field\", \"\", (v: string) => { this.properties.field = v; }, { values: [] as string[] });\n      this.properties = { field: \"\", result: null };\n      this.size = [300, 140];\n      this.color = \"#7D6608\";\n      this.bgcolor = \"#5C4B08\";\n    }\n    onDrawForeground(ctx: CanvasRenderingContext2D) {\n      if (this.properties.result) {\n        ctx.font = \"12px monospace\";\n        ctx.fillStyle = \"#FFD700\";\n        ctx.textAlign = \"left\";\n        let y = 70;\n        const entries = Object.entries(this.properties.result).slice(0, 5);\n        for (const [key, val] of entries) {\n          ctx.fillText(`${key}: ${val}`, 10, y);\n          y += 16;\n        }\n        if (Object.keys(this.properties.result).length > 5) {\n          ctx.fillText(\"...\", 10, y);\n        }\n      }\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Aggregations/Count Values\", FO_CountValues as any);\n\n  class FO_Distinct extends LGraphNode {\n    static title = \"Distinct\";\n    static desc = \"Get distinct values for a field\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"field\", \"\", (v: string) => { this.properties.field = v; }, { values: [] as string[] });\n      this.properties = { field: \"\", result: null };\n      this.size = [280, 120];\n      this.color = \"#7D6608\";\n      this.bgcolor = \"#5C4B08\";\n    }\n    onDrawForeground(ctx: CanvasRenderingContext2D) {\n      if (this.properties.result) {\n        ctx.font = \"12px monospace\";\n        ctx.fillStyle = \"#FFD700\";\n        ctx.textAlign = \"left\";\n        const vals = (this.properties.result as any[]).slice(0, 6);\n        let y = 70;\n        for (const val of vals) { ctx.fillText(String(val), 10, y); y += 16; }\n      }\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Aggregations/Distinct\", FO_Distinct as any);\n\n  class FO_Bounds extends LGraphNode {\n    static title = \"Bounds\";\n    static desc = \"Get min/max bounds for a numeric field\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"combo\", \"field\", \"\", (v: string) => { this.properties.field = v; }, { values: [] as string[] });\n      this.properties = { field: \"\", result: null };\n      this.size = [240, 90];\n      this.color = \"#7D6608\";\n      this.bgcolor = \"#5C4B08\";\n    }\n    onDrawForeground(ctx: CanvasRenderingContext2D) {\n      if (this.properties.result) {\n        const [min, max] = this.properties.result;\n        ctx.font = \"14px monospace\";\n        ctx.fillStyle = \"#FFD700\";\n        ctx.textAlign = \"left\";\n        ctx.fillText(`[${min}, ${max}]`, 10, this.size[1] - 15);\n      }\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Aggregations/Bounds\", FO_Bounds as any);\n\n  // ─── Output ───────────────────────────────────────────────────\n\n  class FO_SetAppView extends LGraphNode {\n    static title = \"Set App View\";\n    static desc = \"Push the resulting view into the FiftyOne App\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.properties = {};\n      this.size = [220, 50];\n      this.color = \"#922B21\";\n      this.bgcolor = \"#7B241C\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Output/Set App View\", FO_SetAppView as any);\n\n  class FO_SaveView extends LGraphNode {\n    static title = \"Save View\";\n    static desc = \"Save the view as a named saved view\";\n    constructor() {\n      super();\n      this.addInput(\"view\", \"FO_VIEW\");\n      this.addWidget(\"text\", \"name\", \"my_view\", (v: string) => { this.properties.name = v; });\n      this.addWidget(\"text\", \"description\", \"\", (v: string) => { this.properties.description = v; });\n      this.addWidget(\"toggle\", \"overwrite\", false, (v: boolean) => { this.properties.overwrite = v; });\n      this.properties = { name: \"my_view\", description: \"\", overwrite: false };\n      this.size = [300, 120];\n      this.color = \"#922B21\";\n      this.bgcolor = \"#7B241C\";\n    }\n  }\n  LiteGraph.registerNodeType(\"FiftyComfy/Output/Save View\", FO_SaveView as any);\n\n  console.log(\"[FiftyComfy] Registered all node types\");\n}\n","/**\n * TypeScript operators for FiftyComfy.\n *\n * These are event handlers triggered by the Python backend via ctx.trigger().\n * They use a simple global event bus (no Recoil) so the React component\n * can subscribe to updates.\n */\n\nimport { Operator, OperatorConfig } from \"@fiftyone/operators\";\n\n// ─── Types ─────────────────────────────────────────────────────────\n\nexport interface NodeStatusPayload {\n  node_id: number;\n  status: \"running\" | \"complete\" | \"error\" | \"skipped\";\n  result?: any;\n  error?: string;\n}\n\nexport interface ExecutionCompletePayload {\n  status: \"complete\" | \"error\";\n  total_nodes?: number;\n  completed?: number;\n  failed?: number;\n}\n\n// ─── Global event bus ──────────────────────────────────────────────\n// Simple pub/sub so the React component can receive updates from\n// operators without needing Recoil as a dependency.\n\ntype Listener = (data: any) => void;\nconst listeners: Record<string, Listener[]> = {};\n\nexport function onEvent(event: string, fn: Listener) {\n  if (!listeners[event]) listeners[event] = [];\n  listeners[event].push(fn);\n  return () => {\n    listeners[event] = listeners[event].filter((f) => f !== fn);\n  };\n}\n\nfunction emit(event: string, data: any) {\n  (listeners[event] || []).forEach((fn) => {\n    try {\n      fn(data);\n    } catch (e) {\n      console.error(`[FiftyComfy] Event listener error (${event}):`, e);\n    }\n  });\n}\n\n// ─── Node Status Update Operator ───────────────────────────────────\n\nexport class NodeStatusUpdateOperator extends Operator {\n  get config(): OperatorConfig {\n    return new OperatorConfig({\n      name: \"node_status_update\",\n      label: \"Node Status Update\",\n      unlisted: true,\n    });\n  }\n\n  async execute({ params }: any) {\n    emit(\"node_status\", params as NodeStatusPayload);\n  }\n}\n\n// ─── Execution Complete Operator ───────────────────────────────────\n\nexport class ExecutionCompleteOperator extends Operator {\n  get config(): OperatorConfig {\n    return new OperatorConfig({\n      name: \"execution_complete\",\n      label: \"Execution Complete\",\n      unlisted: true,\n    });\n  }\n\n  async execute({ params }: any) {\n    emit(\"execution_complete\", params as ExecutionCompletePayload);\n  }\n}\n","/**\n * FiftyComfyView — The main panel component.\n *\n * This is a standalone JS panel (Pattern A). It wraps a LiteGraph\n * canvas and communicates with Python operators via useOperatorExecutor.\n */\n\nimport * as React from \"react\";\nimport { useRef, useEffect, useCallback, useState } from \"react\";\nimport { useOperatorExecutor } from \"@fiftyone/operators\";\nimport { LGraph, LGraphCanvas } from \"@comfyorg/litegraph\";\nimport litegraphCss from \"@comfyorg/litegraph/style.css?inline\";\nimport { registerAllNodes } from \"./litegraph/registerNodes\";\nimport { onEvent, type NodeStatusPayload, type ExecutionCompletePayload } from \"./operators\";\n\n// ─── Plugin namespace ──────────────────────────────────────────────\nconst NS = \"@harpreetsahota/FiftyComfy\";\n\n// ─── Styles ────────────────────────────────────────────────────────\nconst TH = 42;\nconst toolbarCss: React.CSSProperties = {\n  position: \"absolute\", top: 0, left: 0, right: 0, height: TH, zIndex: 10,\n  display: \"flex\", alignItems: \"center\", gap: 6, padding: \"0 8px\",\n  background: \"rgba(25,25,25,0.95)\", borderBottom: \"1px solid #444\",\n  fontFamily: \"'Inter','Segoe UI',sans-serif\",\n};\nconst btn: React.CSSProperties = {\n  padding: \"5px 12px\", border: \"1px solid #555\", borderRadius: 4,\n  background: \"#333\", color: \"#ddd\", cursor: \"pointer\", fontSize: 13, fontWeight: 500,\n};\nconst btnG: React.CSSProperties = { ...btn, background: \"#2d6a4f\", borderColor: \"#40916c\", color: \"#fff\" };\nconst sep: React.CSSProperties = { width: 1, height: 24, background: \"#555\", margin: \"0 4px\" };\n\n// ─── Component ─────────────────────────────────────────────────────\n\nexport default function FiftyComfyView() {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const graphRef = useRef<LGraph | null>(null);\n\n  // Python operators via useOperatorExecutor\n  const executeGraphOp = useOperatorExecutor(`${NS}/execute_graph`);\n  const saveGraphOp = useOperatorExecutor(`${NS}/save_graph`);\n  const loadGraphsOp = useOperatorExecutor(`${NS}/load_graphs`);\n  const loadGraphOp = useOperatorExecutor(`${NS}/load_graph`);\n  const getDatasetInfoOp = useOperatorExecutor(`${NS}/get_dataset_info`);\n\n  const [status, setStatus] = useState(\"Ready\");\n  const [running, setRunning] = useState(false);\n  const [showLoad, setShowLoad] = useState(false);\n  const [saved, setSaved] = useState<{ id: string; name: string }[]>([]);\n\n  // ---- Init LiteGraph on mount ----\n  useEffect(() => {\n    const el = canvasRef.current;\n    if (!el) return;\n\n    try {\n      // Inject LiteGraph CSS\n      if (!document.getElementById(\"fiftycomfy-lg-css\")) {\n        const style = document.createElement(\"style\");\n        style.id = \"fiftycomfy-lg-css\";\n        style.textContent = litegraphCss;\n        document.head.appendChild(style);\n      }\n\n      registerAllNodes();\n\n      const graph = new LGraph();\n      const canvas = new LGraphCanvas(el, graph);\n\n      canvas.render_shadows = false;\n      canvas.max_zoom = 4;\n      canvas.min_zoom = 0.1;\n      canvas.allow_searchbox = true;\n      (canvas as any).show_searchbox_on_double_click = true;\n      (canvas as any).background_image = undefined;\n      (canvas as any).clear_background_color = \"#1e1e1e\";\n      canvas.render_curved_connections = true;\n      (canvas as any).render_connection_arrows = false;\n\n      graphRef.current = graph;\n      graph.start();\n\n      const parent = el.parentElement!;\n      const resize = () => {\n        el.width = parent.offsetWidth;\n        el.height = parent.offsetHeight - TH;\n        canvas.setDirty(true, true);\n      };\n      resize();\n      const ro = new ResizeObserver(resize);\n      ro.observe(parent);\n\n      // Fetch dataset info\n      getDatasetInfoOp.execute({}).then((result: any) => {\n        if (result?.fields) {\n          (globalThis as any).__fiftycomfy_dataset_info = result;\n        }\n      }).catch(() => {});\n\n      console.log(\"[FiftyComfy] Canvas ready\");\n\n      return () => {\n        graph.stop();\n        ro.disconnect();\n      };\n    } catch (err) {\n      console.error(\"[FiftyComfy] Init failed:\", err);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // ---- Subscribe to execution events ----\n  useEffect(() => {\n    const u1 = onEvent(\"node_status\", (p: NodeStatusPayload) => {\n      const g = graphRef.current;\n      if (!g) return;\n      const n = g.getNodeById(p.node_id);\n      if (!n) return;\n      (n as any).boxcolor =\n        p.status === \"running\" ? \"#FFA500\" :\n        p.status === \"complete\" ? \"#00FF00\" :\n        p.status === \"error\" ? \"#FF0000\" :\n        p.status === \"skipped\" ? \"#888\" : null;\n      if (p.status === \"complete\" && p.result !== undefined) {\n        n.properties.result = p.result;\n      }\n      n.setDirtyCanvas(true, true);\n    });\n    const u2 = onEvent(\"execution_complete\", (p: ExecutionCompletePayload) => {\n      setRunning(false);\n      setStatus(`Done — ${p.completed ?? 0}/${p.total_nodes ?? 0} nodes`);\n    });\n    return () => { u1(); u2(); };\n  }, []);\n\n  // ---- Toolbar actions ----\n  const handleQueue = useCallback(async () => {\n    const g = graphRef.current;\n    if (!g) return;\n    for (const n of (g as any)._nodes || []) { n.boxcolor = null; n.setDirtyCanvas(true, true); }\n    setRunning(true);\n    setStatus(\"Executing...\");\n    try {\n      const serialized = g.serialize();\n      await executeGraphOp.execute({ graph_json: JSON.stringify(serialized) });\n    } catch (e: any) {\n      setRunning(false);\n      setStatus(\"Error: \" + (e?.message || \"unknown\"));\n    }\n  }, [executeGraphOp]);\n\n  const handleSave = useCallback(async () => {\n    const g = graphRef.current;\n    if (!g) return;\n    const name = prompt(\"Workflow name:\");\n    if (!name) return;\n    try {\n      await saveGraphOp.execute({ name, graph_json: JSON.stringify(g.serialize()) });\n      setStatus(\"Saved: \" + name);\n    } catch (e: any) { console.error(e); }\n  }, [saveGraphOp]);\n\n  const handleLoadList = useCallback(async () => {\n    try {\n      const result = await loadGraphsOp.execute({});\n      setSaved((result as any)?.graphs || []);\n      setShowLoad(true);\n    } catch (e: any) { console.error(e); }\n  }, [loadGraphsOp]);\n\n  const handleLoad = useCallback(async (id: string) => {\n    const g = graphRef.current;\n    if (!g) return;\n    try {\n      const result = await loadGraphOp.execute({ graph_id: id });\n      if ((result as any)?.data?.graph) g.configure((result as any).data.graph);\n    } catch (e: any) { console.error(e); }\n    setShowLoad(false);\n  }, [loadGraphOp]);\n\n  const handleClear = useCallback(() => { graphRef.current?.clear(); setStatus(\"Ready\"); }, []);\n\n  // ---- Render ----\n  return React.createElement(\"div\", {\n    style: { width: \"100%\", height: \"100%\", position: \"relative\", overflow: \"hidden\" },\n  },\n    // Toolbar\n    React.createElement(\"div\", { style: toolbarCss },\n      React.createElement(\"button\", { style: btnG, onClick: handleQueue, disabled: running }, \"\\u25B6 Queue\"),\n      React.createElement(\"div\", { style: sep }),\n      React.createElement(\"button\", { style: btn, onClick: handleSave }, \"Save\"),\n      React.createElement(\"button\", { style: btn, onClick: handleLoadList }, \"Load\"),\n      React.createElement(\"div\", { style: sep }),\n      React.createElement(\"button\", { style: btn, onClick: handleClear }, \"Clear\"),\n      React.createElement(\"span\", { style: { marginLeft: \"auto\", fontSize: 12, color: \"#888\" } }, status),\n    ),\n    // Load dropdown\n    showLoad && React.createElement(\"div\", {\n      style: {\n        position: \"absolute\", top: TH + 2, left: 120, zIndex: 20,\n        background: \"#2a2a2a\", border: \"1px solid #555\", borderRadius: 6,\n        padding: 8, minWidth: 220, maxHeight: 300, overflowY: \"auto\" as const,\n        boxShadow: \"0 4px 16px rgba(0,0,0,0.5)\",\n      },\n    },\n      React.createElement(\"div\", {\n        style: { fontSize: 12, color: \"#888\", marginBottom: 6, display: \"flex\", justifyContent: \"space-between\" },\n      },\n        React.createElement(\"span\", null, \"Saved Workflows\"),\n        React.createElement(\"span\", { style: { cursor: \"pointer\", color: \"#aaa\" }, onClick: () => setShowLoad(false) }, \"\\u2715\"),\n      ),\n      saved.length === 0\n        ? React.createElement(\"div\", { style: { fontSize: 13, color: \"#666\", padding: 8 } }, \"No saved workflows\")\n        : saved.map((g) =>\n            React.createElement(\"div\", {\n              key: g.id,\n              onClick: () => handleLoad(g.id),\n              style: { padding: \"6px 8px\", cursor: \"pointer\", borderRadius: 4, fontSize: 13, color: \"#ddd\" },\n              onMouseOver: (e: any) => { e.currentTarget.style.background = \"#3a3a3a\"; },\n              onMouseOut: (e: any) => { e.currentTarget.style.background = \"transparent\"; },\n            }, g.name)\n          ),\n    ),\n    // Canvas\n    React.createElement(\"canvas\", {\n      ref: canvasRef,\n      style: { position: \"absolute\", top: TH, left: 0, width: \"100%\", height: `calc(100% - ${TH}px)` },\n    }),\n  );\n}\n","/**\n * FiftyComfy — Plugin entry point.\n *\n * Registers FiftyComfyView as a standalone JS panel (Pattern A),\n * exactly like the official Hello World example.\n * No Python Panel class — the panel IS this JS component.\n * Python operators handle all backend computation.\n */\n\nimport { registerComponent, PluginComponentType } from \"@fiftyone/plugins\";\nimport { registerOperator } from \"@fiftyone/operators\";\nimport FiftyComfyView from \"./FiftyComfyView\";\nimport { NodeStatusUpdateOperator, ExecutionCompleteOperator } from \"./operators\";\n\n// Register the panel — this creates the panel in the FiftyOne App\nregisterComponent({\n  name: \"FiftyComfyView\",\n  label: \"FiftyComfy\",\n  component: FiftyComfyView,\n  type: PluginComponentType.Panel,\n  activator: ({ dataset }: any) => !!dataset,\n});\n\n// Register TS operators for receiving Python execution status\nconst NS = \"@harpreetsahota/FiftyComfy\";\nregisterOperator(NodeStatusUpdateOperator, NS);\nregisterOperator(ExecutionCompleteOperator, NS);\n\nconsole.log(\"[FiftyComfy] Panel and operators registered\");\n"],"names":["type","detail","event","listener","options","random","i","a","_LLink","id","origin_id","origin_slot","target_id","target_slot","parentId","__publicField","__privateAdd","_color","__privateGet","value","__privateSet","data","network","linkSegment","_a","rerouteId","linkId","linkIds","resolved","inputNode","input","subgraphInput","outputNode","output","subgraphOutput","_b","o","nodeId","outputIndex","inputIndex","slotType","exported","keepReroutes","reroutes","lastReroute","newLink","reroute","copy","NodeSlotType2","RenderShape2","CanvasItem2","LinkDirection2","LinkRenderType2","LinkMarkerShape2","TitleMode2","LGraphEventMode2","EaseFunction2","Alignment2","flagSet","flag","b","x1","y1","x2","y2","y","left","top","width2","height","point","rect","aRight","aBottom","bRight","bBottom","centreX","centreY","out","controlA","controlB","t","iT","c1","c2","c3","c4","objects","padding","bounds","obj","pos","snapTo","anchors","containerX","containerY","containerWidth","containerHeight","insetX","insetY","otherX","otherY","otherWidth","otherHeight","outsetX","outsetY","min","max","_Rectangle","_pos","_size","begin","end","byteOffset","length","other","right","bottom","otherRight","otherBottom","cornerSize","edgeSize","currentWidth","currentHeight","ctx","colour","strokeStyle","lineWidth","node2","inputs","index","_c","outputs","canvasx","canvasy","slot_pos","result","message","cause","unicode","fontFamily","color","bgColor","fontSize","circlePadding","xOffset","yOffset","font","textBaseline","textAlign","fillStyle","iconRadius","BadgePosition2","text","fgColor","cornerRadius","iconOptions","iconWidth","textWidth","badgeWidth","badgeX","drawX","centerY","adjustedX","adjustedY","titleTextColor","centerX","SlotType2","SlotShape2","SlotDirection2","LabelPosition2","area","shape","round_radius","title_height","title_mode","collapsed","thickness","height2","radius","cornerRadii","maxWidth","ellipsisWidth","bestLen","mid","sub","align","truncated","ellipsis","name","boundingRect","colorContext","slot","maybeSubgraphSlot","_listenerController","rest","rectangle","_NodeSlot_instances","_node","labelPosition","lowQuality","highlight","doStroke","originalFillStyle","originalStrokeStyle","originalLineWidth","labelColor","centreOffset_get","slot_type","slot_shape","doFill","nodePos","diameter","_LGraphGroup","title","pale_blue","colorOption","v2","graphCanvas","resizeLength","defaultColour","font_size","deltaX","deltaY","skipChildren","item","nodes","groups","children","group","boundingBox","_Reroute","floatingLinkIds","_Reroute_instances","_malloc","_network","_parentId","_lastRenderTime","_inputSlot","_outputSlot","gap","floating","links","floatingLinks","visited","parent","withParentId","link","results","addAllResults","network2","from","idProp","floatingOutLinks","floatingLink","lastRenderTime","linkStart","thisPos","angles","sum","calculateAngles","originToReroute","diff","dist","originDiff","cos","sin","angle","backgroundPattern","globalAlpha","idBadge","firstFloatingLink","hasLink","showInput","showOutput","hoverArea_get","outlineOnly","__privateMethod","contains_fn","isInput","_reroute","_offsetMultiplier","_hovering","_showOutline","showOutline","hovering","linkPos","fromPos","toPos","existingNames","baseName","_ConstrainedSize","_width","_height","_desiredWidth","_desiredHeight","size","_SubgraphSlot","e2","subgraph","inputsOrOutputs","linkProperty","defaultHeight","fromSlot","editorAlpha","isPointerOver","isValidTarget","isValid","previousAlpha","labelX","labelY","localized_name","label","dir","color_off","color_on","afterRerouteId","existingLink","link2","_SubgraphIONodeBase","_SubgraphIONodeBase_instances","_boundingRect","containsPoint","underPointer","getSlotMenuOptions_fn","onSlotMenuAction_fn","minWidth","roundedRadius","currentY","slotWidth","slotHeight","selectedItem","c","newName","pointer","linkConnector","eUp","target_node","target_slotType","optsIn","outputSlot","transform","items","subgraphInputNodes","subgraphOutputNodes","unknown","graph","internalLinks","boundaryLinks","boundaryInputLinks","boundaryOutputLinks","boundaryFloatingLinks","addFloatingLinks","many","reroutesOutside","reroute2","clonedNodes","newNode","resolvedConnections","groupedByOutput","groupBy","resolvedInputLinks","connections","inputLinks","input2","linkData","hasErrors","uniqueName","uniqueLocalizedName","inputData","resolvedOutputLinks","outputLinks","output2","outputData","subgraphIds","rootGraph","subgraphRegistry","usedSubgraphIds","toVisit","directIds","_widget","widget","locked","nameLocked","removable","widgetOrPos","slot_index","outputWidget","source","callback","totalSpace","requests","totalMinSize","req","allocations","remainingSpace","alloc","growableItems","sharePerItem","spaceUsedThisRound","growth","computedSize","availableWidth","low","high","bestFit","testText","cls","args","_BaseWidget","_value","_","outline_color","background_color","text_color","secondary_text_color","disabledTextColor","displayName","displayValue","labelBaseline","safeValues","showText","margin","leftPadding","rightPadding","_displayValue","labelWidth","valueWidth","totalWidth","requiredWidth","scale","cappedLabelWidth","cappedValueWidth","canvas2","oldValue","cloned","arrowMargin","arrowWidth","arrowTipX","arrowInnerX","values","_ComboWidget_instances","rawValues","canUseButton_fn","tryChangeValue_fn","getValues_fn","values_list","text_values","increment","valuesArray","firstValue","lastValue","delta2","indexedValues","foundIndex","gradient_stops","effective_height","size_modifier","arc_center","arc_size","gradient2","arc","range","nvalue","gradient","gs","stop","value_end_angle","fixedValue","step","range_10_percent","range_1_percent","step_for","use_y","drag_threshold","adjustment","step_with_shift_modifier","deltaValue","newValue2","H","marker_nvalue","slideFactor","wrapLegacyWidgets","narrowedWidget","_LGraphNode","_LGraphNode_instances","_concreteInputs","_concreteOutputs","_renderArea","getErrorStrokeStyle_fn","getSelectedStrokeStyle_fn","nodeRelativeX","nodeRelativeY","button","modeColour","posX","posY","bX","bY","info","j","k","_d","_e","_f","_g","_h","w","_i","widgetsWithValue","_j","widgets","prev_value","output_info","force_update","link_id","slot_name","link_info","r","trigS","param","modeTo","action","target_connection","newSize","default_value","extra_info","slot_info","ctorSize","rows","padLeft","padRight","title_width","compute_text_size","input_width","widgetWidth","output_width","text_width","centrePadding","slotsWidth","widgetMargin","widgetPadding","widgets_height","widget_height","minHeight","minWidth2","widgetWidth2","fontStyle","canvasX","canvasY","outputs_offset","property","properties_info","propInfo","custom_widget","widgetIndex","error","titleMode","titleHeight","includeExternal","renderArea","squareLength","includeDisabled","nodeWidth","h","returnObj","findFreeSlot_fn","preferFreeSlot","doNotUseOccupied","findSlotByType_fn","findInputs","opts","nodeById","generalSlot","opt","nonEventSlot","slotIndex","source_node","source_slotType","toSlot","targetIndex","requestedIndex","parentReroute","fromLastFloatingReroute","target","l","is_input","slot_number","nodeX","nodeY","inputPos","outputPos","offset","defaultVerticalInputs_get","defaultVerticalOutputs_get","halfTitle","offsetX","nodeOffsetY","slotY","width22","msg","dirty_foreground","dirty_background","url","img","dirty","list","force","dragAndScale","badgeInstances","badge","currentX","acc","low_quality","fgcolor","box_size","default_title_color","selected","rawTitle","buttonsWidth","savedFont","displayTitle","_links","madeAnyConnections","inLink","inNode","bypassAllLinks","graph2","outLinks","outLink","outNode","outlineColour","isMouseOverSlot","isMouseOverSlot_fn","isMouseOverWidget_fn","slotsBounds","measureSlots_fn","widgetStartY","arrangeWidgets_fn","arrangeWidgetInputSlots_fn","slots","sourceTypes","occupiedSlot","destTypes","sourceType","destType","dest","measureSlot_fn","getMouseOverSlot_fn","mouseOverId","bodyHeight","startY","freeSpace","fixedWidgetHeight","growableWidgets","maxHeight","spaceRequests","d","slotByWidgetName","actualSlot","allItems","addRecursively","flatSet","child","hasNoLinks","wildSlot","occupiedWildSlot","validTypes","slotTypes","validType","array","found","_widgetRef","inputWidget","widgetNamePojo","otherWidget","inputSlot","newSubgraphInput","newSlotIndex","subgraphInputIndex","toType","fromReroute","dragDirection","outputNodeId","inputNodeId","_events","events","originalReroutes","floatingTerminus","cl","nuRenderLink","setConnectingLinks","_LinkConnector_instances","_setConnectingLinks","state","renderLinks","renderLink","setLegacyLinks_fn","firstReroute","renderLink2","locator","ioNode","connectingTo","dropOnOutput_fn","inputOrSocket","dropOnInput_fn","maybeReroutes","fromSlotIndex","originalReroute","filtered","firstLink","eventName","hiddenReroutes","fromSlotIsInput","_CanvasPointer","element","_CanvasPointer_instances","_finally","_maxClickDrift","_maxClickDrift2","eDown","completeClick_fn","hasSamePosition_fn","setDragStarted_fn","dragStarted","pointerId","isDoubleClick_fn","tolerance2","eLastDown","eMove","_DragAndScale_instances","viewport","visible_area","stateHasChanged_fn","startx","starty","endx","endy","zooming_center","roundToScaleOne","normalizedCenter","center","new_center","delta_offset","zoom","cw","ch","targetScale","targetScaleX","targetScaleY","scaledWidth","scaledHeight","targetX","targetY","setDirty","duration","easing","easeFunctions","easeFunction","startTimestamp","startX","startX2","startY2","targetX2","targetY2","animate","timestamp","elapsed","progress","easedProgress","currentX2","currentY2","animationId","current","previous","to","valid","horizontal","nodeCount","total","highest","sorted","lowest","startAt","direction","align_to","boundary","_LGraphCanvas","_LGraphCanvas_instances","_subgraph","_maximumFrameGap","_visible_node_ids","_visibleReroutes","_snapToGrid","_shiftDown","_dragZoomStart","dirty_fn","customEvent","linkReleaseContext","updateCursorStyle_fn","entry","mouse_event","_nodes","prev_menu","inner_clicked","value2","ref_window","inner_onMenuAdded","base_category","prev_menu2","categories","category","entries","base_category_regex","category_name","category_path","mouseEvent","contextMenu","first_event","node22","_options","retEntries","v22","e22","prev","entries2","str","menu","fApplyMultiNode","dialog","inner","canvasEl","offsetx","offsety","dialogCloseTimer","setValue","desc_value","graphcanvas","kV","fApplyColor","newSelected","newNodes","newnode","newGraph","skip_events","validateCanvas_fn","document2","fgcanvas","bgcanvas","doc","renderFrame","window2","otherNode","processPrimaryButton_fn","processMiddleButton_fn","upEvent","processDragZoom_fn","resizingGroup","mouse","relativeX","relativeY","dragRect","inputId","outputId","overWidget","mouseOver","highlightPos","highlightInput","updateReroutes_fn","segment","getLinkCentreOnPos_fn","now","block_default","noItemsSelected_fn","serialisable","subgraphs","connectInputs","position","parsed","offsetY","created","originalId","rerouteInfo","mapped","ids","n","sticky","addModifier","subtractModifier","eitherModifier","modifySelection","add_to_current_selection","itemsToSelect","keepSelected","wasSelected","sel","oldNode","dpi","clientX_rel","clientY_rel","visible_nodes","force_canvas","force_bgcanvas","drawSnapGuides","getHighlightPosition_fn","fromDirection","connShape","connType","renderSnapHighlight_fn","ratio","bg_already_painted","that","pattern","bgcolor","editor_alpha","_temp_vec2","current_x","button_width","button_y","_selected","render_title","_tmp_area","old_alpha","getStyle","snapGuide","_temp","midX","midY","visibleReroutes","_margin_area","endPos","start_node","startPos","renderAllLinkSegments_fn","renderFloatingLinks_fn","rerouteSet","skip_border","flow","start_dir","end_dir","startControl","endControl","num_sublines","disabled","linkColour","startDir","endDir","path","innerA","_lTempA","innerB","_lTempB","addSplineOffset_fn","justPastCentre","_lTempC","posA","posB","posC","posD","angleA","angleB","actualBoundingBoxAscent","f","flowPos","pa","pb","_posY","node_left","fromType","options2","options3","optPass","isFrom","isTo","slotX","iSlotConn","s","fromSlotType","slotTypesDefault","nodeNewType","typeX","nodeNewOpts","customProps","multiline","customProperties","div","prevent_timeout","selInDia","selIn","name_element","value_element","clickTime","handleOutsideClick","searchOptions","root_document","helper","selOut","timeout_close","hideDelay","delay","first","timeout","maybeInput","changeSelection","select","refreshHelper","aSlots","nSlots","iK","aSlot","iS","forward","addResult","inner_test_filter","ctor","filter","sType","sV","sIn","sOut","extraItem","className","help","nodeType","typeEl","input_html","html","aI","iX","root","close","vTo","vAlt","code","classname","on_footer","elem","str_value","nameSpan","propname","innerChange","str_value2","name2","panel","inner_refresh","fUpdate","mode","nodeCol","nK","pName","textarea","fDoneWith","assign","panels","extra","menu_info","inner_option_clicked","_slot","createDialog","_link_bounding","crosshairItems","cursor","el","linkConnectorDrop_fn","getPositionableOnPos_fn","ctrlOrMeta","setupNodeSelectionDrag_fn","newType","subgraph2","node_data","pointer2","startDraggingItems_fn","processDraggedItems_fn","processNodeClick_fn","processSubgraphIONode","overReroute","centre","newReroute","headerHeight","clickedItem","handleMultiSelect_fn","inCollapse","link_pos","shouldBreakLink","processWidgetClick_fn","resizeDirection","startBounds","newBounds","originalX","originalY","widgetInstance","mClikSlot","mClikSlot_index","mClikSlot_isOut","alphaPosY","node_bounding","posRef","start","anyChanges","selectedItems","isSelected","notSelected","addPositionable","linkConnectorSnap","inverter","hx","hy","gRadius","linearGradient","computedHeight","endDirection","startDirection","renderedPaths","points","pointsX","pointsY","prevReroute","rerouteStartPos","nextPos","segmentStartPos","tmp","factor","p","int","map","_LGraph","_LGraph_instances","_lastFloatingLinkId","_floatingLinks","_reroutes","_canvas","handler","canvases","interval","on_frame","num","do_not_catch_errors","limit","only_onExecute","set_level","L","S","M","visited_links","remaining_links","setOrder","A","B","Ap","Bp","layout","columns","col","column","max_size","max_size_index","node_size_index","eventname","params","list_of_graphcanvas","skip_compute_order","classObject","matchType","nodeList","g","func","fg","bg","__privateWrapper","before","x22","floatingReroutes","secondLastReroute","revision","config","inputRect","outputRect","subgraphNode","firstResolved","others","outputsGroupedByOutput","connection","nodeIds","currentGraph","option","definitions","linkArray","getDragAndScale_fn","usedSubgraphs","keep_old","linkEx","lastGroupId","lastLinkId","lastNodeId","lastRerouteId","rerouteData","nodesData","nodeDataMap","n_info","nodeData","groupData","data2","primaryCanvas","subgraphId","reader","err","ds","_Subgraph","_Subgraph_instances","_rootGraph","configureSubgraph_fn","oldName","keepId","_onPointerDownOrMove","_onPointerUp","_onKeyDownOrUp","signal","origDrawFrontCanvas","startAngle","endAngle","inactiveColour","colour1","colour2","colour3","fontString","mouseDotX","mouseDotY","textX","textY","textMarker","drawDot","leftButtonColour","middleButtonColour","rightButtonColour","mouseMarker","eventClass","classes","eventOptions","body_rect","root_rect","innerHtml","inner_onclick","inner_over","setAriaExpanded","close_parent","ignore_parent_menu","event_name","evt","pn","local_f","line_color","inactive","localpos","max_dist","curvepos","is_edge_point","p2","min_dist","closest","base_class","class_type","allTypes","register","types","type2","folder_wildcard","script_files","docHeadObj","script_file","src","dynamicScript","type_a","type_b","supported_types_a","supported_types_b","oDOM","sEvIn","fCall","capture","sMethod","sEvent","bounding","bb","hex","hex_alphabets","int1","int2","triplet","elements","origin","radius_low","top_left_radius","top_right_radius","bottom_left_radius","bottom_right_radius","subject","subgraphNodePath","nodesByExecutionId","_ExecutableNodeDTO_instances","_id","uniqueId","nodeInfo","pathInfo","subgraphNodeInput","outerLink","subgraphNodeExecutionId","subgraphNodeDto","outputNodeExecutionId","outputNodeDto","parentInputIndexes","matchingIndex","resolveSubgraphOutput_fn","virtualLink","innerResolved","innerNode","innerNodeExecutionId","innerNodeDto","instanceData","_SubgraphNode_instances","_eventAbortController","subgraphEvents","addSubgraphInputListeners_fn","setWidget_fn","inputProperties","innerLink","innerLinks","executableNodes","subgraphInfo","depth","subgraphInstanceIdPath","parentSubgraphNode","aVeryRealNode","promotedWidget","FO_LoadDataset","FO_LoadSavedView","v","FO_Match","FO_FilterLabels","FO_SortBy","FO_Limit","FO_Exists","FO_MatchTags","FO_Take","FO_Shuffle","FO_SelectFields","FO_ExcludeFields","FO_ComputeEmbeddings","FO_ComputeVisualization","FO_ComputeSimilarity","FO_ComputeUniqueness","FO_FindExactDuplicates","FO_FindNearDuplicates","FO_Count","FO_CountValues","key","val","FO_Distinct","vals","FO_Bounds","FO_SetAppView","FO_SaveView","fn","e","Operator","OperatorConfig","NS","canvasRef","useRef","graphRef","executeGraphOp","useOperatorExecutor","saveGraphOp","loadGraphsOp","loadGraphOp","getDatasetInfoOp","status","setStatus","useState","running","setRunning","showLoad","setShowLoad","saved","setSaved","useEffect","style","canvas","resize","ro","u1","u2","handleQueue","useCallback","serialized","handleSave","handleLoadList","handleLoad","handleClear","React","registerComponent","PluginComponentType","dataset","registerOperator"],"mappings":"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","x_google_ignoreList":[0]}